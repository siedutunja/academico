{"version":3,"sources":["webpack:///./src/views/informes/consolidados/AsignaturasPerdidas.vue?1962","webpack:///./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js","webpack:///./src/views/informes/Consolidados.vue?d69e","webpack:///./src/views/informes/consolidados/ResumenPeriodo.vue?0148","webpack:///src/views/informes/consolidados/ResumenPeriodo.vue","webpack:///./src/views/informes/consolidados/ResumenPeriodo.vue?fe45","webpack:///./src/views/informes/consolidados/ResumenPeriodo.vue","webpack:///./src/views/informes/consolidados/ConsolidadoPromedio.vue?5b66","webpack:///src/views/informes/consolidados/ConsolidadoPromedio.vue","webpack:///./src/views/informes/consolidados/ConsolidadoPromedio.vue?d01a","webpack:///./src/views/informes/consolidados/ConsolidadoPromedio.vue","webpack:///./src/views/informes/consolidados/NotasFaltantes.vue?5100","webpack:///src/views/informes/consolidados/NotasFaltantes.vue","webpack:///./src/views/informes/consolidados/NotasFaltantes.vue?d997","webpack:///./src/views/informes/consolidados/NotasFaltantes.vue","webpack:///./src/views/informes/consolidados/NotasFaltantesArea.vue?e8cd","webpack:///src/views/informes/consolidados/NotasFaltantesArea.vue","webpack:///./src/views/informes/consolidados/NotasFaltantesArea.vue?c0bd","webpack:///./src/views/informes/consolidados/NotasFaltantesArea.vue","webpack:///./src/views/informes/consolidados/ConsolidadoPonderado.vue?2ed0","webpack:///src/views/informes/consolidados/ConsolidadoPonderado.vue","webpack:///./src/views/informes/consolidados/ConsolidadoPonderado.vue?af28","webpack:///./src/views/informes/consolidados/ConsolidadoPonderado.vue","webpack:///./src/views/informes/consolidados/AusenciasPeriodo.vue?e701","webpack:///src/views/informes/consolidados/AusenciasPeriodo.vue","webpack:///./src/views/informes/consolidados/AusenciasPeriodo.vue?23f6","webpack:///./src/views/informes/consolidados/AusenciasPeriodo.vue","webpack:///./src/views/informes/consolidados/AusenciasPeriodos.vue?1e37","webpack:///src/views/informes/consolidados/AusenciasPeriodos.vue","webpack:///./src/views/informes/consolidados/AusenciasPeriodos.vue?0874","webpack:///./src/views/informes/consolidados/AusenciasPeriodos.vue","webpack:///./src/views/informes/consolidados/ResumenFinal.vue?123f","webpack:///src/views/informes/consolidados/ResumenFinal.vue","webpack:///./src/views/informes/consolidados/ResumenFinal.vue?4bb8","webpack:///./src/views/informes/consolidados/ResumenFinal.vue","webpack:///./src/views/informes/consolidados/ResumenFinalHab.vue?1254","webpack:///src/views/informes/consolidados/ResumenFinalHab.vue","webpack:///./src/views/informes/consolidados/ResumenFinalHab.vue?b9fe","webpack:///./src/views/informes/consolidados/ResumenFinalHab.vue","webpack:///./src/views/informes/consolidados/ResumenPromocionAreas.vue?bc18","webpack:///./src/views/informes/consolidados/AreasPerdidas.vue?08c4","webpack:///src/views/informes/consolidados/AreasPerdidas.vue","webpack:///./src/views/informes/consolidados/AreasPerdidas.vue?68c7","webpack:///./src/views/informes/consolidados/AreasPerdidas.vue","webpack:///src/views/informes/consolidados/ResumenPromocionAreas.vue","webpack:///./src/views/informes/consolidados/ResumenPromocionAreas.vue?dc0d","webpack:///./src/views/informes/consolidados/ResumenPromocionAreas.vue","webpack:///./src/views/informes/consolidados/AsignaturasPerdidas.vue?db84","webpack:///src/views/informes/consolidados/AsignaturasPerdidas.vue","webpack:///./src/views/informes/consolidados/AsignaturasPerdidas.vue?13f8","webpack:///./src/views/informes/consolidados/AsignaturasPerdidas.vue","webpack:///./src/views/informes/consolidados/ConsolidadoFinal.vue?8b3b","webpack:///src/views/informes/consolidados/ConsolidadoFinal.vue","webpack:///./src/views/informes/consolidados/ConsolidadoFinal.vue?9c4d","webpack:///./src/views/informes/consolidados/ConsolidadoFinal.vue","webpack:///./src/views/informes/consolidados/ConsolidadoFinalEmiliani.vue?4a77","webpack:///src/views/informes/consolidados/ConsolidadoFinalEmiliani.vue","webpack:///./src/views/informes/consolidados/ConsolidadoFinalEmiliani.vue?6c19","webpack:///./src/views/informes/consolidados/ConsolidadoFinalEmiliani.vue","webpack:///./src/views/informes/consolidados/ConsolidadoFinalInem.vue?f4f3","webpack:///src/views/informes/consolidados/ConsolidadoFinalInem.vue","webpack:///./src/views/informes/consolidados/ConsolidadoFinalInem.vue?0a2b","webpack:///./src/views/informes/consolidados/ConsolidadoFinalInem.vue","webpack:///./src/views/informes/consolidados/ResumenFinalAsigPerdidas.vue?493a","webpack:///src/views/informes/consolidados/ResumenFinalAsigPerdidas.vue","webpack:///./src/views/informes/consolidados/ResumenFinalAsigPerdidas.vue?d296","webpack:///./src/views/informes/consolidados/ResumenFinalAsigPerdidas.vue","webpack:///./src/views/informes/consolidados/ConsolidadoFinalAreas.vue?2f84","webpack:///src/views/informes/consolidados/ConsolidadoFinalAreas.vue","webpack:///./src/views/informes/consolidados/ConsolidadoFinalAreas.vue?81f2","webpack:///./src/views/informes/consolidados/ConsolidadoFinalAreas.vue","webpack:///./src/views/informes/consolidados/ResumenPromocionAreasDefinitivo.vue?b362","webpack:///src/views/informes/consolidados/ResumenPromocionAreasDefinitivo.vue","webpack:///./src/views/informes/consolidados/ResumenPromocionAreasDefinitivo.vue?3ecd","webpack:///./src/views/informes/consolidados/ResumenPromocionAreasDefinitivo.vue","webpack:///src/views/informes/Consolidados.vue","webpack:///./src/views/informes/Consolidados.vue?3886","webpack:///./src/views/informes/Consolidados.vue","webpack:///./src/views/informes/consolidados/ConsolidadoFinal.vue?5713","webpack:///./node_modules/@babel/runtime/helpers/esm/arrayWithoutHoles.js","webpack:///./node_modules/@babel/runtime/helpers/esm/iterableToArray.js","webpack:///./node_modules/@babel/runtime/helpers/esm/nonIterableSpread.js","webpack:///./node_modules/@babel/runtime/helpers/esm/toConsumableArray.js","webpack:///./src/views/informes/consolidados/ConsolidadoFinalEmiliani.vue?62a3","webpack:///./src/views/informes/consolidados/AusenciasPeriodos.vue?206d","webpack:///./src/views/informes/consolidados/NotasFaltantesArea.vue?4716","webpack:///./src/views/informes/consolidados/ConsolidadoFinalInem.vue?9b0c","webpack:///./src/views/informes/consolidados/ConsolidadoPromedio.vue?769c","webpack:///./src/views/informes/consolidados/ResumenFinalAsigPerdidas.vue?f456","webpack:///./src/views/informes/consolidados/AreasPerdidas.vue?f684","webpack:///./node_modules/regenerator-runtime/runtime.js","webpack:///./src/views/informes/consolidados/NotasFaltantes.vue?3fed","webpack:///./src/views/informes/consolidados/ResumenPeriodo.vue?6061","webpack:///./src/views/informes/consolidados/ConsolidadoPonderado.vue?012d","webpack:///./src/views/informes/consolidados/ResumenPromocionAreas.vue?e8ef","webpack:///./src/views/informes/consolidados/ConsolidadoFinalAreas.vue?171a","webpack:///./src/views/informes/consolidados/AusenciasPeriodo.vue?0075","webpack:///./src/views/informes/consolidados/ResumenPromocionAreasDefinitivo.vue?d1e0"],"names":["asyncGeneratorStep","gen","resolve","reject","_next","_throw","key","arg","info","value","error","done","Promise","then","_asyncToGenerator","fn","self","this","args","arguments","apply","err","undefined","render","_vm","_h","$createElement","_c","_self","staticClass","attrs","scopedSlots","_u","_v","proxy","ref","ariaDescribedby","model","callback","$$v","idConsolidado","expression","_e","staticRenderFns","comboPeriodos","on","$event","idSede","idCurso","idPeriodo","comboSedes","ocuparComboCursosSede","comboCursosSede","consultarEstudiantes","staticStyle","btnCargando","_l","asigs","area","length","_s","Object","keys","encabezadoPorArea","i","asig","k","areas","estudiante","j","class","obtenerColor","obtenerNota","fueRecuperada","obtenerOriginal","obtenerRecuperacion","id_conceptual","calcularPromedioArea","obtenerColorGeneral","calcularPromedioGeneral","contarDesempenoEstudiante","ausJ","ausS","iconoPuesto","puestosPorEstudiante","contarNotasPorAsignatura","totalBajosPromedioArea","contarNotasTotales","contarAusencias","imprimir","exportarAExcel","val","tipo","nota","component","colspanArea","periodosVisibles","p","est","nombre","obtenerPromedioAsignatura","obtenerPromedioArea","totalBajosPorPeriodo","totalBajosPromedioAsignatura","totales","bajo","basico","alto","superior","l","obtenerAcumulado","obtenerNotaFaltante","style","redondear","datosSeccion","minBas","toFixed","periodos","asignatura","cont","getAusencia","totalAusJ","totalAusS","getAusenciaTotal","getTotalGeneral","t","idMatricula","totalesPorAsignatura","ausenciasConsolidadas","reduce","sum","ocuparComboEstudiantes","consultaAsignaturasCurso","comboEstudiantes","estudiantesNotas","encabColumnas","listaNotasAsignaturasCurso","props","column","field","row","nombreAsignatura","promedioFinal","desempeno","slot","habilitacion","mostrarEstadoPromocion","contarDesempenoEstudianteArea","fila","perdidas","join","total","mostrarNotasPorAsignaturaPerdidas","obs_comision","_arrayWithoutHoles","arr","Array","isArray","arrayLikeToArray","_iterableToArray","iter","Symbol","iterator","from","_nonIterableSpread","TypeError","_toConsumableArray","arrayWithoutHoles","iterableToArray","unsupportedIterableToArray","nonIterableSpread","runtime","exports","Op","prototype","hasOwn","hasOwnProperty","$Symbol","iteratorSymbol","asyncIteratorSymbol","asyncIterator","toStringTagSymbol","toStringTag","define","obj","defineProperty","enumerable","configurable","writable","wrap","innerFn","outerFn","tryLocsList","protoGenerator","Generator","generator","create","context","Context","_invoke","makeInvokeMethod","tryCatch","type","call","GenStateSuspendedStart","GenStateSuspendedYield","GenStateExecuting","GenStateCompleted","ContinueSentinel","GeneratorFunction","GeneratorFunctionPrototype","IteratorPrototype","getProto","getPrototypeOf","NativeIteratorPrototype","values","Gp","defineIteratorMethods","forEach","method","AsyncIterator","PromiseImpl","invoke","record","result","__await","unwrapped","previousPromise","enqueue","callInvokeWithMethodAndArg","state","Error","doneResult","delegate","delegateResult","maybeInvokeDelegate","sent","_sent","dispatchException","abrupt","resultName","next","nextLoc","pushTryEntry","locs","entry","tryLoc","catchLoc","finallyLoc","afterLoc","tryEntries","push","resetTryEntry","completion","reset","iterable","iteratorMethod","isNaN","constructor","displayName","isGeneratorFunction","genFun","ctor","name","mark","setPrototypeOf","__proto__","awrap","async","toString","object","reverse","pop","skipTempReset","prev","charAt","slice","stop","rootEntry","rootRecord","rval","exception","handle","loc","caught","hasCatch","hasFinally","finallyEntry","complete","finish","thrown","delegateYield","module","regeneratorRuntime","accidentalStrictMode","Function"],"mappings":"oKAAA,W,gFCAA,SAASA,EAAmBC,EAAKC,EAASC,EAAQC,EAAOC,EAAQC,EAAKC,GACpE,IACE,IAAIC,EAAOP,EAAIK,GAAKC,GAChBE,EAAQD,EAAKC,MACjB,MAAOC,GAEP,YADAP,EAAOO,GAILF,EAAKG,KACPT,EAAQO,GAERG,QAAQV,QAAQO,GAAOI,KAAKT,EAAOC,GAIxB,SAASS,EAAkBC,GACxC,OAAO,WACL,IAAIC,EAAOC,KACPC,EAAOC,UACX,OAAO,IAAIP,SAAQ,SAAUV,EAASC,GACpC,IAAIF,EAAMc,EAAGK,MAAMJ,EAAME,GAEzB,SAASd,EAAMK,GACbT,EAAmBC,EAAKC,EAASC,EAAQC,EAAOC,EAAQ,OAAQI,GAGlE,SAASJ,EAAOgB,GACdrB,EAAmBC,EAAKC,EAASC,EAAQC,EAAOC,EAAQ,QAASgB,GAGnEjB,OAAMkB,S,2CC/BZ,IAAIC,EAAS,WAAa,IAAIC,EAAIP,KAASQ,EAAGD,EAAIE,eAAmBC,EAAGH,EAAII,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACA,EAAG,QAAQ,CAACE,YAAY,QAAQ,CAACF,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,OAAO,CAACH,EAAG,SAAS,CAACI,YAAYP,EAAIQ,GAAG,CAAC,CAAC1B,IAAI,SAASS,GAAG,WAAW,MAAO,CAACY,EAAG,KAAK,CAACE,YAAY,QAAQ,CAACF,EAAG,SAAS,CAACG,MAAM,CAAC,KAAO,iBAAiB,cAAc,UAAUN,EAAIS,GAAG,kBAAkB,KAAKC,OAAM,MAAS,CAACP,EAAG,cAAc,CAACA,EAAG,QAAQ,CAACA,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,OAAO,CAACH,EAAG,SAAS,CAACG,MAAM,CAAC,aAAa,QAAQ,eAAe,KAAK,CAACH,EAAG,cAAc,CAACA,EAAG,QAAQ,CAACA,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,MAAM,CAACH,EAAG,KAAK,CAACH,EAAIS,GAAG,kBAAkBN,EAAG,eAAe,CAACG,MAAM,CAAC,MAAQ,IAAIC,YAAYP,EAAIQ,GAAG,CAAC,CAAC1B,IAAI,UAAUS,GAAG,SAASoB,GAChrB,IAAIC,EAAkBD,EAAIC,gBAC1B,MAAO,CAACT,EAAG,eAAe,CAACG,MAAM,CAAC,mBAAmBM,EAAgB,KAAO,cAAc,MAAQ,KAAKC,MAAM,CAAC5B,MAAOe,EAAiB,cAAEc,SAAS,SAAUC,GAAMf,EAAIgB,cAAcD,GAAKE,WAAW,kBAAkB,CAACjB,EAAIS,GAAG,yBAAyBN,EAAG,eAAe,CAACG,MAAM,CAAC,mBAAmBM,EAAgB,KAAO,cAAc,MAAQ,KAAKC,MAAM,CAAC5B,MAAOe,EAAiB,cAAEc,SAAS,SAAUC,GAAMf,EAAIgB,cAAcD,GAAKE,WAAW,kBAAkB,CAACjB,EAAIS,GAAG,oCAAoCN,EAAG,eAAe,CAACG,MAAM,CAAC,mBAAmBM,EAAgB,KAAO,cAAc,MAAQ,KAAKC,MAAM,CAAC5B,MAAOe,EAAiB,cAAEc,SAAS,SAAUC,GAAMf,EAAIgB,cAAcD,GAAKE,WAAW,kBAAkB,CAACjB,EAAIS,GAAG,qCAAqCN,EAAG,eAAe,CAACG,MAAM,CAAC,mBAAmBM,EAAgB,KAAO,cAAc,MAAQ,KAAKC,MAAM,CAAC5B,MAAOe,EAAiB,cAAEc,SAAS,SAAUC,GAAMf,EAAIgB,cAAcD,GAAKE,WAAW,kBAAkB,CAACjB,EAAIS,GAAG,oCAAoCN,EAAG,eAAe,CAACG,MAAM,CAAC,mBAAmBM,EAAgB,KAAO,cAAc,MAAQ,KAAKC,MAAM,CAAC5B,MAAOe,EAAiB,cAAEc,SAAS,SAAUC,GAAMf,EAAIgB,cAAcD,GAAKE,WAAW,kBAAkB,CAACjB,EAAIS,GAAG,sCAAsC,GAAGN,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,MAAM,CAACH,EAAG,KAAK,CAACH,EAAIS,GAAG,eAAeN,EAAG,eAAe,CAACG,MAAM,CAAC,MAAQ,IAAIC,YAAYP,EAAIQ,GAAG,CAAC,CAAC1B,IAAI,UAAUS,GAAG,SAASoB,GACn3C,IAAIC,EAAkBD,EAAIC,gBAC1B,MAAO,CAACT,EAAG,eAAe,CAACG,MAAM,CAAC,mBAAmBM,EAAgB,KAAO,cAAc,MAAQ,MAAMC,MAAM,CAAC5B,MAAOe,EAAiB,cAAEc,SAAS,SAAUC,GAAMf,EAAIgB,cAAcD,GAAKE,WAAW,kBAAkB,CAACjB,EAAIS,GAAG,2BAA2BN,EAAG,eAAe,CAACG,MAAM,CAAC,mBAAmBM,EAAgB,KAAO,cAAc,MAAQ,MAAMC,MAAM,CAAC5B,MAAOe,EAAiB,cAAEc,SAAS,SAAUC,GAAMf,EAAIgB,cAAcD,GAAKE,WAAW,kBAAkB,CAACjB,EAAIS,GAAG,kCAAkCN,EAAG,KAAK,CAACH,EAAIS,GAAG,cAAcN,EAAG,eAAe,CAACG,MAAM,CAAC,MAAQ,IAAIC,YAAYP,EAAIQ,GAAG,CAAC,CAAC1B,IAAI,UAAUS,GAAG,SAASoB,GACpmB,IAAIC,EAAkBD,EAAIC,gBAC1B,MAAO,CAACT,EAAG,eAAe,CAACG,MAAM,CAAC,mBAAmBM,EAAgB,KAAO,cAAc,MAAQ,MAAMC,MAAM,CAAC5B,MAAOe,EAAiB,cAAEc,SAAS,SAAUC,GAAMf,EAAIgB,cAAcD,GAAKE,WAAW,kBAAkB,CAACjB,EAAIS,GAAG,0BAA0BN,EAAG,eAAe,CAACG,MAAM,CAAC,mBAAmBM,EAAgB,KAAO,cAAc,MAAQ,MAAMC,MAAM,CAAC5B,MAAOe,EAAiB,cAAEc,SAAS,SAAUC,GAAMf,EAAIgB,cAAcD,GAAKE,WAAW,kBAAkB,CAACjB,EAAIS,GAAG,4BAA4B,GAAGN,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,MAAM,CAACH,EAAG,KAAK,CAACH,EAAIS,GAAG,aAAaN,EAAG,eAAe,CAACG,MAAM,CAAC,MAAQ,IAAIC,YAAYP,EAAIQ,GAAG,CAAC,CAAC1B,IAAI,UAAUS,GAAG,SAASoB,GAC9nB,IAAIC,EAAkBD,EAAIC,gBAC1B,MAAO,CAACT,EAAG,eAAe,CAACG,MAAM,CAAC,mBAAmBM,EAAgB,KAAO,cAAc,MAAQ,MAAMC,MAAM,CAAC5B,MAAOe,EAAiB,cAAEc,SAAS,SAAUC,GAAMf,EAAIgB,cAAcD,GAAKE,WAAW,kBAAkB,CAACjB,EAAIS,GAAG,sDAAsDN,EAAG,eAAe,CAACG,MAAM,CAAC,mBAAmBM,EAAgB,KAAO,cAAc,MAAQ,MAAMC,MAAM,CAAC5B,MAAOe,EAAiB,cAAEc,SAAS,SAAUC,GAAMf,EAAIgB,cAAcD,GAAKE,WAAW,kBAAkB,CAACjB,EAAIS,GAAG,gDAAgDN,EAAG,eAAe,CAACG,MAAM,CAAC,mBAAmBM,EAAgB,KAAO,cAAc,MAAQ,MAAMC,MAAM,CAAC5B,MAAOe,EAAiB,cAAEc,SAAS,SAAUC,GAAMf,EAAIgB,cAAcD,GAAKE,WAAW,kBAAkB,CAACjB,EAAIS,GAAG,qCAAqCN,EAAG,eAAe,CAACG,MAAM,CAAC,mBAAmBM,EAAgB,KAAO,cAAc,MAAQ,MAAMC,MAAM,CAAC5B,MAAOe,EAAiB,cAAEc,SAAS,SAAUC,GAAMf,EAAIgB,cAAcD,GAAKE,WAAW,kBAAkB,CAACjB,EAAIS,GAAG,uDAAuDN,EAAG,eAAe,CAACG,MAAM,CAAC,mBAAmBM,EAAgB,KAAO,cAAc,MAAQ,MAAMC,MAAM,CAAC5B,MAAOe,EAAiB,cAAEc,SAAS,SAAUC,GAAMf,EAAIgB,cAAcD,GAAKE,WAAW,kBAAkB,CAACjB,EAAIS,GAAG,kDAAkD,IAAI,IAAI,IAAI,IAAI,IAAI,GAAGN,EAAG,QAAQ,CAACA,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,OAAO,CAAqB,GAAnBN,EAAIgB,cAAkBb,EAAG,MAAM,CAACA,EAAG,mBAAmB,GAAGH,EAAIkB,KAAyB,GAAnBlB,EAAIgB,cAAkBb,EAAG,MAAM,CAACA,EAAG,wBAAwB,GAAGH,EAAIkB,KAAyB,GAAnBlB,EAAIgB,cAAkBb,EAAG,MAAM,CAACA,EAAG,yBAAyB,GAAGH,EAAIkB,KAAyB,GAAnBlB,EAAIgB,cAAkBb,EAAG,MAAM,CAACA,EAAG,mBAAmB,GAAGH,EAAIkB,KAAyB,GAAnBlB,EAAIgB,cAAkBb,EAAG,MAAM,CAACA,EAAG,uBAAuB,GAAGH,EAAIkB,KAAyB,IAAnBlB,EAAIgB,cAAmBb,EAAG,MAAM,CAACA,EAAG,qBAAqB,GAAGH,EAAIkB,KAAyB,IAAnBlB,EAAIgB,cAAmBb,EAAG,MAAM,CAACA,EAAG,sBAAsB,GAAGH,EAAIkB,KAAyB,IAAnBlB,EAAIgB,cAAmBb,EAAG,MAAM,CAACA,EAAG,wBAAwB,GAAGH,EAAIkB,KAAyB,IAAnBlB,EAAIgB,cAAmBb,EAAG,MAAM,CAACA,EAAG,kBAAkB,GAAGH,EAAIkB,KAAyB,IAAnBlB,EAAIgB,cAAmBb,EAAG,MAAM,CAACA,EAAG,iBAAiB,GAAGH,EAAIkB,KAAyB,IAAnBlB,EAAIgB,cAAmBb,EAAG,MAAM,CAACA,EAAG,oBAAoB,GAAGH,EAAIkB,KAAyB,IAAnBlB,EAAIgB,cAAmBb,EAAG,MAAM,CAACA,EAAG,0BAA0B,GAAGH,EAAIkB,KAAyB,IAAnBlB,EAAIgB,cAAmBb,EAAG,MAAM,CAACA,EAAG,qBAAqB,GAAGH,EAAIkB,KAAyB,IAAnBlB,EAAIgB,cAAmBb,EAAG,MAAM,CAACA,EAAG,6BAA6B,GAAGH,EAAIkB,KAAyB,IAAnBlB,EAAIgB,cAAmBb,EAAG,MAAM,CAACA,EAAG,0BAA0B,GAAGH,EAAIkB,KAAyB,IAAnBlB,EAAIgB,cAAmBb,EAAG,MAAM,CAACA,EAAG,oCAAoC,GAAGH,EAAIkB,QAAQ,IAAI,IAAI,IAAI,IAAI,IAAI,IAC7/EC,EAAkB,G,iCCTlB,EAAS,WAAa,IAAInB,EAAIP,KAASQ,EAAGD,EAAIE,eAAmBC,EAAGH,EAAII,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACA,EAAG,QAAQ,CAACE,YAAY,QAAQ,CAACF,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,OAAO,CAACH,EAAG,SAAS,CAACI,YAAYP,EAAIQ,GAAG,CAAC,CAAC1B,IAAI,SAASS,GAAG,WAAW,MAAO,CAACY,EAAG,KAAK,CAACE,YAAY,QAAQ,CAACF,EAAG,SAAS,CAACG,MAAM,CAAC,KAAO,iBAAiB,cAAc,UAAUN,EAAIS,GAAG,yCAAyC,KAAKC,OAAM,MAAS,CAACP,EAAG,cAAc,CAACA,EAAG,QAAQ,CAACA,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,MAAM,CAACH,EAAG,eAAe,CAACE,YAAY,WAAWC,MAAM,CAAC,MAAQ,WAAW,YAAY,YAAY,CAACH,EAAG,gBAAgB,CAACQ,IAAI,UAAUL,MAAM,CAAC,GAAK,UAAU,QAAUN,EAAIoB,eAAeC,GAAG,CAAC,OAAS,SAASC,GAAQtB,EAAIuB,OAAO,KAAKvB,EAAIwB,QAAQ,OAAOX,MAAM,CAAC5B,MAAOe,EAAa,UAAEc,SAAS,SAAUC,GAAMf,EAAIyB,UAAUV,GAAKE,WAAW,gBAAgB,IAAI,GAAGd,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,MAAM,CAACH,EAAG,eAAe,CAACE,YAAY,WAAWC,MAAM,CAAC,MAAQ,sBAAsB,YAAY,UAAU,CAACH,EAAG,gBAAgB,CAACQ,IAAI,QAAQL,MAAM,CAAC,GAAK,QAAQ,QAAUN,EAAI0B,WAAW,SAA0B,MAAf1B,EAAIyB,WAAgCJ,GAAG,CAAC,OAAS,SAASC,GAAQtB,EAAIwB,QAAQ,KAAKxB,EAAI2B,0BAA0Bd,MAAM,CAAC5B,MAAOe,EAAU,OAAEc,SAAS,SAAUC,GAAMf,EAAIuB,OAAOR,GAAKE,WAAW,aAAa,IAAI,GAAGd,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,MAAM,CAACH,EAAG,eAAe,CAACE,YAAY,WAAWC,MAAM,CAAC,MAAQ,uBAAuB,YAAY,WAAW,CAACH,EAAG,gBAAgB,CAACQ,IAAI,SAASL,MAAM,CAAC,GAAK,SAAS,QAAUN,EAAI4B,gBAAgB,SAAuB,MAAZ5B,EAAIuB,QAA6BF,GAAG,CAAC,OAAS,SAASC,GAAQ,OAAOtB,EAAI6B,yBAAyBhB,MAAM,CAAC5B,MAAOe,EAAW,QAAEc,SAAS,SAAUC,GAAMf,EAAIwB,QAAQT,GAAKE,WAAW,cAAc,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,GAAGd,EAAG,QAAQ,CAACA,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,OAAO,CAAEN,EAAe,YAAEG,EAAG,MAAM,CAACA,EAAG,MAAM,CAACE,YAAY,gCAAgC,CAACF,EAAG,YAAY,CAAC2B,YAAY,CAAC,MAAQ,OAAO,OAAS,QAAQxB,MAAM,CAAC,MAAQ,aAAaH,EAAG,MAAMA,EAAG,SAAS,CAACH,EAAIS,GAAG,0BAA0B,KAAKT,EAAIkB,QAAQ,GAAKlB,EAAI+B,aAA4B,MAAb/B,EAAIwB,QAKkhCxB,EAAIkB,KALvgCf,EAAG,QAAQ,CAACA,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,OAAO,CAACH,EAAG,QAAQ,CAACE,YAAY,mBAAmBC,MAAM,CAAC,OAAS,IAAI,YAAc,IAAI,YAAc,MAAM,CAACH,EAAG,QAAQ,CAACA,EAAG,KAAK,CAACA,EAAG,KAAK,CAACG,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAG,OAAON,EAAG,KAAK,CAACG,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAG,gBAAgBT,EAAIgC,GAAIhC,EAAqB,mBAAE,SAASiC,EAAMC,GAAM,OAAO/B,EAAG,KAAK,CAACrB,IAAI,OAASoD,EAAK5B,MAAM,CAAC,QAAU2B,EAAME,OAAS,IAAI,CAACnC,EAAIS,GAAG,IAAIT,EAAIoC,GAAGF,GAAM,UAAS/B,EAAG,KAAK,CAACG,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAG,aAAaN,EAAG,KAAK,CAACG,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAG,SAASN,EAAG,KAAK,CAACG,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAG,SAASN,EAAG,KAAK,CAACG,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAG,SAASN,EAAG,KAAK,CAACG,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAG,SAASN,EAAG,KAAK,CAACG,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAG,SAASN,EAAG,KAAK,CAACG,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAG,SAASN,EAAG,KAAK,CAACG,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAG,SAASN,EAAG,KAAK,CAACG,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAG,QAAQ,GAAGN,EAAG,KAAK,CAACH,EAAIgC,GAAIK,OAAOC,KAAKtC,EAAIuC,oBAAoB,SAASL,EAAKM,GAAG,MAAO,CAACxC,EAAIgC,GAAIhC,EAAIuC,kBAAkBL,IAAO,SAASO,EAAKC,GAAG,OAAOvC,EAAG,KAAK,CAACrB,IAAI,UAAYoD,EAAOO,EAAOC,GAAG,CAAC1C,EAAIS,GAAGT,EAAIoC,GAAGK,SAAWtC,EAAG,KAAK,CAACrB,IAAI,OAAOoD,EAAOM,GAAG,CAACxC,EAAIS,GAAG,eAAc,KAAKN,EAAG,QAAQ,CAACH,EAAIgC,GAAIhC,EAAoB,kBAAE,SAAS2C,EAAMC,EAAWJ,GAAG,OAAOrC,EAAG,KAAK,CAACrB,IAAI8D,GAAY,CAACzC,EAAG,KAAK,CAACE,YAAY,aAAa,CAACL,EAAIS,GAAGT,EAAIoC,GAAGI,EAAI,MAAMrC,EAAG,KAAK,CAAC2B,YAAY,CAAC,aAAa,SAAS,CAAC9B,EAAIS,GAAGT,EAAIoC,GAAGQ,MAAe5C,EAAIgC,GAAIK,OAAOC,KAAKtC,EAAIuC,oBAAoB,SAASL,GAAM,MAAO,CAAClC,EAAIgC,GAAIhC,EAAIuC,kBAAkBL,IAAO,SAASO,EAAKI,GAAG,OAAO1C,EAAG,KAAK,CAACrB,IAAIoD,EAAOO,EAAOI,EAAEC,MAAM,CACh+G9C,EAAI+C,aAAa/C,EAAIgD,YAAYL,EAAOT,EAAMO,GAAOE,EAAOT,EAAMO,GAClEzC,EAAIiD,cAAcN,EAAOT,EAAMO,GAAQ,kBAAoB,IAC3DnC,MAAM,CAAC,MAAQN,EAAIiD,cAAcN,EAAOT,EAAMO,GAC3C,oBAAuBzC,EAAIkD,gBAAgBP,EAAOT,EAAMO,GAAS,MAASzC,EAAImD,oBAAoBR,EAAOT,EAAMO,GAC/G,eAAkBzC,EAAIgD,YAAYL,EAAOT,EAAMO,KAAU,CAACzC,EAAIS,GAAG,IAAIT,EAAIoC,GAAwB,KAArBO,EAAMS,cAAqBpD,EAAIgD,YAAYL,EAAOT,EAAMO,GAAQ,KAAK,UAAStC,EAAG,KAAK,CAACrB,IAAIoD,EAAOM,EAAEV,YAAY,CAAC,cAAc,SAAS,CAAC9B,EAAIS,GAAG,IAAIT,EAAIoC,GAAwB,KAArBO,EAAMS,cAAqBpD,EAAIqD,qBAAqBV,EAAOT,GAAQ,KAAK,WAAU/B,EAAG,KAAK,CAAC2C,MAAM9C,EAAIsD,oBAAoBtD,EAAIuD,wBAAwBZ,IAAQb,YAAY,CAAC,cAAc,OAAO,aAAa,WAAW,CAAC9B,EAAIS,GAAG,IAAIT,EAAIoC,GAAwB,KAArBO,EAAMS,cAAqBpD,EAAIuD,wBAAwBZ,GAAS,KAAK,OAAOxC,EAAG,KAAK,CAAC2B,YAAY,CAAC,aAAa,SAAS,MAAQ,YAAY,CAAC9B,EAAIS,GAAG,IAAIT,EAAIoC,GAAwB,KAArBO,EAAMS,cAAqBpD,EAAIwD,0BAA0Bb,EAAO,QAAU,KAAK,OAAOxC,EAAG,KAAK,CAAC2B,YAAY,CAAC,aAAa,SAAS,MAAQ,YAAY,CAAC9B,EAAIS,GAAG,IAAIT,EAAIoC,GAAwB,KAArBO,EAAMS,cAAqBpD,EAAIwD,0BAA0Bb,EAAO,UAAY,KAAK,OAAOxC,EAAG,KAAK,CAAC2B,YAAY,CAAC,aAAa,SAAS,MAAQ,YAAY,CAAC9B,EAAIS,GAAG,IAAIT,EAAIoC,GAAwB,KAArBO,EAAMS,cAAqBpD,EAAIwD,0BAA0Bb,EAAO,QAAU,KAAK,OAAOxC,EAAG,KAAK,CAAC2B,YAAY,CAAC,aAAa,SAAS,MAAQ,YAAY,CAAC9B,EAAIS,GAAG,IAAIT,EAAIoC,GAAwB,KAArBO,EAAMS,cAAqBpD,EAAIwD,0BAA0Bb,EAAO,YAAc,KAAK,OAAOxC,EAAG,KAAK,CAAC2B,YAAY,CAAC,aAAa,WAAW,CAAC9B,EAAIS,GAAG,IAAIT,EAAIoC,GAAwB,KAArBO,EAAMS,cAAqBT,EAAMc,KAAO,KAAK,OAAOtD,EAAG,KAAK,CAAC2B,YAAY,CAAC,aAAa,WAAW,CAAC9B,EAAIS,GAAG,IAAIT,EAAIoC,GAAwB,KAArBO,EAAMS,cAAqBT,EAAMe,KAAO,KAAK,OAAOvD,EAAG,KAAK,CAAC2B,YAAY,CAAC,aAAa,SAAS,cAAc,SAAS,CAAC9B,EAAIS,GAAG,IAAIT,EAAIoC,GAAwB,KAArBO,EAAMS,cAAqBpD,EAAI2D,YAAY3D,EAAI4D,qBAAqBhB,IAAe,KAAK,IAAI5C,EAAIoC,GAAwB,KAArBO,EAAMS,cAAqBpD,EAAI4D,qBAAqBhB,GAAc,KAAK,OAAOzC,EAAG,KAAK,CAACE,YAAY,aAAa,CAACL,EAAIS,GAAGT,EAAIoC,GAAGI,EAAI,OAAO,MAAKrC,EAAG,KAAK,CAAC2B,YAAY,CAAC,mBAAmB,UAAU,cAAc,SAAS,CAAC3B,EAAG,KAAK,CAACG,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAG,iBAAiBT,EAAIgC,GAAIK,OAAOC,KAAKtC,EAAIuC,oBAAoB,SAASL,GAAM,MAAO,CAAClC,EAAIgC,GAAIhC,EAAIuC,kBAAkBL,IAAO,SAASO,GAAM,MAAO,CAACtC,EAAG,KAAK,CAACrB,IAAI2D,EAAOP,EAAKJ,YAAY,CAAC,aAAa,SAAS,MAAQ,YAAY,CAAC9B,EAAIS,GAAG,IAAIT,EAAIoC,GAAGpC,EAAI6D,yBAAyB3B,EAAMO,EAAM,SAAS,WAAUtC,EAAG,KAAK,CAACrB,IAAI,MAAQoD,GAAM,CAAClC,EAAIS,GAAG,IAAIT,EAAIoC,GAAGpC,EAAI8D,uBAAuB5B,IAAO,WAAU/B,EAAG,MAAMH,EAAIS,GAAG,KAAKN,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAGpC,EAAI+D,mBAAmB,YAAY5D,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAGpC,EAAI+D,mBAAmB,cAAc5D,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAGpC,EAAI+D,mBAAmB,YAAY5D,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAGpC,EAAI+D,mBAAmB,gBAAgB5D,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAGpC,EAAIgE,gBAAgB,YAAY7D,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAGpC,EAAIgE,gBAAgB,YAAY7D,EAAG,MAAMH,EAAIS,GAAG,KAAKN,EAAG,OAAO,IAAI,KAAKA,EAAG,MAAM,CAAC2B,YAAY,CAAC,gBAAgB,SAAS,CAAC3B,EAAG,WAAW,CAACE,YAAY,kBAAkBC,MAAM,CAAC,QAAU,WAAWe,GAAG,CAAC,MAAQrB,EAAIiE,WAAW,CAACjE,EAAIS,GAAG,0BAA0BN,EAAG,WAAW,CAACE,YAAY,kBAAkBC,MAAM,CAAC,QAAU,mBAAmBe,GAAG,CAAC,MAAQrB,EAAIkE,iBAAiB,CAAClE,EAAIS,GAAG,uBAAuB,MAAM,IAAa,IACx/F,EAAkB,G,wMCsJtB,GACE,KAAF,iBACE,WAAF,GAEE,KAJF,WAKI,MAAJ,CACM,OAAN,KACM,WAAN,GACM,UAAN,KACM,cAAN,KACM,QAAN,KACM,gBAAN,GACM,WAAN,KACM,YAAN,KACM,QAAN,KACM,aAAN,EACM,SAAN,GACM,aAAN,GACM,sBAAN,KAGE,QAAF,CACI,uBADJ,SACA,GAAM,IAAN,OACA,IAQM,OAJA,OAAN,mDACQ,IAAR,2CACA,0CAEA,GAEI,gBAZJ,SAYA,GACM,IAAN,IAKM,OAJA,OAAN,mDACA,2BACA,8BAEA,GAEI,yBApBJ,SAoBA,OAAM,IAAN,OACA,IAoBM,OAnBA,OAAN,mDAAQ,IAAR,IACA,+FACA,gCACA,YAAU,OAAV,gCAEA,mDACA,sBACA,OACA,qCACA,iEACA,+DACA,qEAHA,KAKA,sCACA,mEACA,iEACA,uEAHA,QAMA,GAEI,mBA3CJ,SA2CA,GAAM,IAAN,OACA,IAmBM,OAlBA,OAAN,mDACQ,EAAR,2CAAU,IAAV,gCACA,+FACA,6GACA,sBACsB,IAAR0D,GACW,SAATC,GAAmBC,EAAO,EAA1C,qBACA,iEACA,+DACA,qEAHA,KAKyB,SAATD,GAAmBC,EAAO,EAA1C,sBACA,mEACA,iEACA,uEAHA,WAOA,GAEI,YAjEJ,SAiEA,GACM,OAAN,WACA,WACA,WACA,IAEI,wBAvEJ,SAuEA,GAAM,IAAN,OACA,qEAAQ,OAAR,YACA,IACA,IAoBM,OAnBA,EAAN,qBACQ,GAAR,8BACU,IAAV,8CAAY,OAAZ,4BACU,IAAV,gBACU,IAAV,0CACA,WACY,GAAZ,EACY,SAEZ,CACU,IAAV,8CAAY,OAAZ,0CACU,IAAV,gBACU,IAAV,0CACA,WACY,GAAZ,EACY,SAIZ,yBAEI,0BAhGJ,SAgGA,KAAM,IAAN,OACA,IAiBM,OAhBA,KAAN,2CAAQ,IAAR,gCACA,+FACA,6GACA,sBACA,OACA,qCACA,iEACA,+DACA,qEAHA,KAKA,sCACA,mEACA,iEACA,uEAHA,QAMA,GAEI,YApHJ,SAoHA,OAAM,IAAN,MACA,2HACM,MAAN,oCAEI,cAxHJ,SAwHA,OAAM,IAAN,MACM,OAAN,iIAEI,gBA3HJ,SA2HA,OAAM,IAAN,IACA,mGACM,MAAN,wCAEI,oBA/HJ,SA+HA,OAAM,IAAN,IACA,uGACM,MAAN,wCAEI,aAnIJ,SAmIA,SAAM,IAAN,IACA,6GACM,GAAN,IACQ,GAAR,OACU,GAAV,kDACU,GAAV,oDACU,GAAV,kDACU,GAAV,2DACA,CACU,GAAV,mDACU,GAAV,qDACU,GAAV,mDACU,GAAV,wDAGM,MAAN,mBAEI,oBApJJ,SAoJA,GACM,OAAN,4CACA,8CACA,4CACA,iDACA,mBAEI,qBA3JJ,SA2JA,KACM,IAAN,KAKM,GAHE,EADR,gCACA,+CAAU,OAAV,4BAEA,+CAAQ,OAAR,2CACA,kBACA,gBAAM,IACN,IAiBM,OAfA,EAAN,qBAAQ,IAAR,MACA,qIACQ,GAAR,wBAaA,qCAEI,qBAtLJ,WAsLM,IAAN,OAAM,OAAN,yIACA,iBACA,mGACA,gBAHA,wBAIA,sGACA,gDACA,kBACA,yBAGA,2BAVA,SAWA,IACA,+EACA,kBACA,cACA,sFACA,kBAEA,kBACA,yCAIA,mBACA,gIACA,oBAzBA,cA2BA,cA3BA,UA4BA,IACA,uIACA,kBACA,cACA,+FACA,kBAEA,kBACA,4BAIA,mBACA,yIACA,oBA1CA,QA8CA,iBA9CA,+CAgDI,SAtOJ,WAuOM,IAAN,wCACA,wCACA,4CACA,uCACM,EAAN,y6BAsBA,oCAtBA,qCAsBA,EAtBA,qBAsBA,gBAtBA,qBAsBA,iBAtBA,0BAsBA,2BAtBA,uBAsBA,eAtBA,2BAuBA,EAvBA,2EAwBA,EAxBA,+CA2BM,EAAN,iBACM,EAAN,SAEI,eAzQJ,WA0QM,IAAN,kCACA,8BACM,EAAN,8BAEI,UA9QJ,SA8QA,GACM,IAAN,2CACM,OAAN,+BAEI,sBAlRJ,WAkRM,IAAN,OAAM,OAAN,sIACA,qBACA,gDACA,qBACA,0EAJA,8CAQI,iBA1RJ,WA0RM,IAAN,OAAM,OAAN,sIACA,gBACA,+CACA,6DAHA,8CAMI,oBAhSJ,WAgSM,IAAN,OAAM,OAAN,sIACA,mBACA,6CACA,mEAHA,8CAMI,iBAtSJ,SAsSA,OACM,KAAN,kBAAQ,MAAR,EAAQ,QAAR,EAAQ,QAAR,uBAAQ,OAAR,EAAQ,cAAR,IAAQ,aAAR,MAGE,SAAF,CACI,0BADJ,WAEM,IAAN,sDAAQ,OAAR,WACM,OAAN,QAEI,qBALJ,WAKM,IAAN,OACA,yDAAQ,IAAR,oCACA,2CACQ,MAAR,CAAU,OAAV,EAAU,SAAV,iBAGM,EAAN,oBAAQ,OAAR,yBACM,IAAN,KACA,IACA,IACA,OASM,OARA,EAAN,qBACA,iBACU,EAAV,EACU,EAAV,YAEQ,EAAR,YACQ,OAER,GAEI,kBA1BJ,WA2BM,IAAN,KAKM,OAJA,KAAN,2CAAQ,IAAR,wBACA,gBACQ,EAAR,cAEA,GAEI,iBAlCJ,WAkCM,IAAN,OACA,KAgCM,OA/BA,KAAN,8BACQ,IAAR,oLACA,aAAU,cAAV,EAAU,KAAV,EAAU,KAAV,IACA,sBACQ,IAAR,IAGY,EAFZ,OACA,8BACA,EAEA,0BAGA,aACA,0BAEA,IACA,QAEA,GAGQ,EAAR,UACU,KAAV,EACU,cAAV,IACU,SAAV,EACU,aAAV,EACU,mBAAV,GAEQ,EAAR,cACQ,EAAR,iBAEA,IAGE,YArYF,WAsYI,KAAJ,mBACI,KAAJ,sBACI,KAAJ,+ECpiBsX,I,wBCQlXC,EAAY,eACd,EACA,EACA,GACA,EACA,KACA,WACA,MAIa,EAAAA,E,QCnBX,EAAS,WAAa,IAAItE,EAAIP,KAASQ,EAAGD,EAAIE,eAAmBC,EAAGH,EAAII,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACA,EAAG,QAAQ,CAACE,YAAY,QAAQ,CAACF,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,OAAO,CAACH,EAAG,SAAS,CAACI,YAAYP,EAAIQ,GAAG,CAAC,CAAC1B,IAAI,SAASS,GAAG,WAAW,MAAO,CAACY,EAAG,KAAK,CAACE,YAAY,QAAQ,CAACF,EAAG,SAAS,CAACG,MAAM,CAAC,KAAO,iBAAiB,cAAc,UAAUN,EAAIS,GAAG,qDAAqD,KAAKC,OAAM,MAAS,CAACP,EAAG,cAAc,CAACA,EAAG,QAAQ,CAACA,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,MAAM,CAACH,EAAG,eAAe,CAACE,YAAY,WAAWC,MAAM,CAAC,MAAQ,WAAW,YAAY,YAAY,CAACH,EAAG,gBAAgB,CAACQ,IAAI,UAAUL,MAAM,CAAC,GAAK,UAAU,QAAUN,EAAIoB,eAAeC,GAAG,CAAC,OAAS,SAASC,GAAQtB,EAAIuB,OAAO,KAAKvB,EAAIwB,QAAQ,OAAOX,MAAM,CAAC5B,MAAOe,EAAa,UAAEc,SAAS,SAAUC,GAAMf,EAAIyB,UAAUV,GAAKE,WAAW,gBAAgB,IAAI,GAAGd,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,MAAM,CAACH,EAAG,eAAe,CAACE,YAAY,WAAWC,MAAM,CAAC,MAAQ,sBAAsB,YAAY,UAAU,CAACH,EAAG,gBAAgB,CAACQ,IAAI,QAAQL,MAAM,CAAC,GAAK,QAAQ,QAAUN,EAAI0B,WAAW,SAA0B,MAAf1B,EAAIyB,WAAgCJ,GAAG,CAAC,OAAS,SAASC,GAAQtB,EAAIwB,QAAQ,KAAKxB,EAAI2B,0BAA0Bd,MAAM,CAAC5B,MAAOe,EAAU,OAAEc,SAAS,SAAUC,GAAMf,EAAIuB,OAAOR,GAAKE,WAAW,aAAa,IAAI,GAAGd,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,MAAM,CAACH,EAAG,eAAe,CAACE,YAAY,WAAWC,MAAM,CAAC,MAAQ,uBAAuB,YAAY,WAAW,CAACH,EAAG,gBAAgB,CAACQ,IAAI,SAASL,MAAM,CAAC,GAAK,SAAS,QAAUN,EAAI4B,gBAAgB,SAAuB,MAAZ5B,EAAIuB,QAA6BF,GAAG,CAAC,OAAS,SAASC,GAAQ,OAAOtB,EAAI6B,yBAAyBhB,MAAM,CAAC5B,MAAOe,EAAW,QAAEc,SAAS,SAAUC,GAAMf,EAAIwB,QAAQT,GAAKE,WAAW,cAAc,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,GAAGd,EAAG,QAAQ,CAACA,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,OAAO,CAAEN,EAAe,YAAEG,EAAG,MAAM,CAACA,EAAG,MAAM,CAACE,YAAY,gCAAgC,CAACF,EAAG,YAAY,CAAC2B,YAAY,CAAC,MAAQ,OAAO,OAAS,QAAQxB,MAAM,CAAC,MAAQ,aAAaH,EAAG,MAAMA,EAAG,SAAS,CAACH,EAAIS,GAAG,0BAA0B,KAAKT,EAAIkB,QAAQ,GAAKlB,EAAI+B,aAA4B,MAAb/B,EAAIwB,QAA8gJxB,EAAIkB,KAAngJf,EAAG,QAAQ,CAACA,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,OAAO,CAACH,EAAG,QAAQ,CAACE,YAAY,mBAAmBC,MAAM,CAAC,OAAS,IAAI,YAAc,IAAI,YAAc,MAAM,CAACH,EAAG,QAAQ,CAACA,EAAG,KAAK,CAACA,EAAG,KAAK,CAACG,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAG,OAAON,EAAG,KAAK,CAACG,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAG,gBAAgBT,EAAIgC,GAAIhC,EAAqB,mBAAE,SAASiC,EAAMC,GAAM,MAAO,CAAC/B,EAAG,KAAK,CAACrB,IAAIoD,EAAK5B,MAAM,CAAC,QAAUN,EAAIuE,YAAYrC,KAAQ,CAAClC,EAAIS,GAAG,IAAIT,EAAIoC,GAAGF,GAAM,WAAU/B,EAAG,KAAK,CAACG,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAG,aAAaN,EAAG,KAAK,CAACG,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAG,SAASN,EAAG,KAAK,CAACG,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAG,SAASN,EAAG,KAAK,CAACG,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAG,SAASN,EAAG,KAAK,CAACG,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAG,SAASN,EAAG,KAAK,CAACG,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAG,SAASN,EAAG,KAAK,CAACG,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAG,SAASN,EAAG,KAAK,CAACG,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAG,SAASN,EAAG,KAAK,CAACG,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAG,QAAQ,GAAGN,EAAG,KAAK,CAACH,EAAIgC,GAAIhC,EAAqB,mBAAE,SAASiC,EAAMC,GAAM,MAAO,CAAClC,EAAIgC,GAAG,GAAQ,SAASS,EAAKC,GAAG,MAAO,CAACvC,EAAG,KAAK,CAACrB,IAAI,QAAU2D,EAAOC,EAAEpC,MAAM,CAAC,QAAUN,EAAIwE,iBAAiBrC,OAAS,IAAI,CAACnC,EAAIS,GAAG,IAAIT,EAAIoC,GAAGK,GAAM,WAAUtC,EAAG,KAAK,CAACrB,IAAI,aAAeoD,EAAK7B,YAAY,iBAAiB,CAACL,EAAIS,GAAG,iBAAgB,GAAGN,EAAG,KAAK,CAACH,EAAIgC,GAAIhC,EAAqB,mBAAE,SAASiC,EAAMC,GAAM,MAAO,CAAClC,EAAIgC,GAAG,GAAQ,SAASS,GAAM,MAAO,CAACzC,EAAIgC,GAAIhC,EAAoB,kBAAE,SAASyE,GAAG,OAAOtE,EAAG,KAAK,CAACrB,IAAI,IAAMoD,EAAOO,EAAOgC,GAAG,CAACzE,EAAIS,GAAG,KAAKT,EAAIoC,GAAGqC,GAAG,UAAStE,EAAG,KAAK,CAACrB,IAAI,OAAS2D,EAAOP,GAAM,CAAClC,EAAIS,GAAG,YAAWN,EAAG,KAAK,CAACrB,IAAI,OAASoD,SAAW,KAAK/B,EAAG,QAAQ,CAACH,EAAIgC,GAAIhC,EAAoB,kBAAE,SAAS0E,EAAIC,EAAOnC,GAAG,OAAOrC,EAAG,KAAK,CAACrB,IAAI6F,GAAQ,CAACxE,EAAG,KAAK,CAACE,YAAY,aAAa,CAACL,EAAIS,GAAGT,EAAIoC,GAAGI,EAAI,MAAMrC,EAAG,KAAK,CAAC2B,YAAY,CAAC,aAAa,SAAS,CAAC9B,EAAIS,GAAGT,EAAIoC,GAAGuC,MAAW3E,EAAIgC,GAAIhC,EAAqB,mBAAE,SAASiC,EAAMC,GAAM,MAAO,CAAClC,EAAIgC,GAAG,GAAQ,SAASS,GAAM,MAAO,CAACzC,EAAIgC,GAAIhC,EAAoB,kBAAE,SAASyE,GAAG,OAAOtE,EAAG,KAAK,CAACrB,IAAI6F,EAASzC,EAAOO,EAAOgC,GAAG,CAACzE,EAAIS,GAAG,IAAIT,EAAIoC,GAAsB,KAAnBsC,EAAItB,cAAqBpD,EAAIgD,YAAY0B,EAAKxC,EAAMO,EAAMgC,GAAK,KAAK,UAAStE,EAAG,KAAK,CAACrB,IAAI,OAAS6F,EAASzC,EAAOO,EAAKpC,YAAY,cAAcyB,YAAY,CAAC,cAAc,OAAO,aAAa,WAAW,CAAC9B,EAAIS,GAAG,IAAIT,EAAIoC,GAAsB,KAAnBsC,EAAItB,cAAqBpD,EAAI4E,0BAA0BF,EAAKxC,EAAMO,GAAQ,KAAK,WAAUtC,EAAG,KAAK,CAACrB,IAAI,WAAa6F,EAASzC,EAAK7B,YAAY,6BAA6B,CAACL,EAAIS,GAAG,IAAIT,EAAIoC,GAAsB,KAAnBsC,EAAItB,cAAqBpD,EAAI6E,oBAAoBH,EAAKxC,GAAQ,KAAK,WAAU/B,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAsB,KAAnBsC,EAAItB,cAAqBpD,EAAIuD,wBAAwBmB,GAAO,QAAQvE,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAsB,KAAnBsC,EAAItB,cAAqBpD,EAAIwD,0BAA0BkB,EAAI/B,MAAO,QAAU,QAAQxC,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAsB,KAAnBsC,EAAItB,cAAqBpD,EAAIwD,0BAA0BkB,EAAI/B,MAAO,UAAY,QAAQxC,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAsB,KAAnBsC,EAAItB,cAAqBpD,EAAIwD,0BAA0BkB,EAAI/B,MAAO,QAAU,QAAQxC,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAsB,KAAnBsC,EAAItB,cAAqBpD,EAAIwD,0BAA0BkB,EAAI/B,MAAO,YAAc,QAAQxC,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAsB,KAAnBsC,EAAItB,cAAqBsB,EAAIjB,KAAO,QAAQtD,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAsB,KAAnBsC,EAAItB,cAAqBsB,EAAIhB,KAAO,QAAQvD,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAsB,KAAnBsC,EAAItB,cAAqBpD,EAAI2D,YAAY3D,EAAI4D,qBAAqBe,IAAW,KAAK,IAAI3E,EAAIoC,GAAsB,KAAnBsC,EAAItB,cAAqBpD,EAAI4D,qBAAqBe,GAAU,QAAQxE,EAAG,KAAK,CAACE,YAAY,aAAa,CAACL,EAAIS,GAAGT,EAAIoC,GAAGI,EAAI,OAAO,MAAKrC,EAAG,KAAK,CAAC2B,YAAY,CAAC,mBAAmB,UAAU,cAAc,SAAS,CAAC3B,EAAG,KAAK,CAACG,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAG,iBAAiBT,EAAIgC,GAAIhC,EAAqB,mBAAE,SAASiC,EAAMC,GAAM,MAAO,CAAClC,EAAIgC,GAAG,GAAQ,SAASS,GAAM,MAAO,CAACzC,EAAIgC,GAAIhC,EAAoB,kBAAE,SAASyE,GAAG,OAAOtE,EAAG,KAAK,CAACrB,IAAI,KAAOoD,EAAOO,EAAOgC,GAAG,CAACzE,EAAIS,GAAG,IAAIT,EAAIoC,GAAGpC,EAAI8E,qBAAqB5C,EAAMO,EAAMgC,IAAI,UAAStE,EAAG,KAAK,CAACrB,IAAI,KAAOoD,EAAOO,GAAM,CAACzC,EAAIS,GAAG,IAAIT,EAAIoC,GAAGpC,EAAI+E,6BAA6B7C,EAAMO,IAAO,WAAUtC,EAAG,KAAK,CAACrB,IAAI,MAAQoD,EAAK7B,YAAY,iBAAiB,CAACL,EAAIS,GAAG,IAAIT,EAAIoC,GAAGpC,EAAI8D,uBAAuB5B,IAAO,WAAU/B,EAAG,MAAMH,EAAIS,GAAG,KAAKN,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAGpC,EAAIgF,QAAQC,SAAS9E,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAGpC,EAAIgF,QAAQE,WAAW/E,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAGpC,EAAIgF,QAAQG,SAAShF,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAGpC,EAAIgF,QAAQI,aAAajF,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAGpC,EAAIgF,QAAQvB,SAAStD,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAGpC,EAAIgF,QAAQtB,SAASvD,EAAG,MAAMH,EAAIS,GAAG,KAAKN,EAAG,OAAO,IAAI,KAAKA,EAAG,MAAM,CAAC2B,YAAY,CAAC,gBAAgB,SAAS,CAAC3B,EAAG,WAAW,CAACE,YAAY,kBAAkBC,MAAM,CAAC,QAAU,WAAWe,GAAG,CAAC,MAAQrB,EAAIiE,WAAW,CAACjE,EAAIS,GAAG,0BAA0BN,EAAG,WAAW,CAACE,YAAY,kBAAkBC,MAAM,CAAC,QAAU,mBAAmBe,GAAG,CAAC,MAAQrB,EAAIkE,iBAAiB,CAAClE,EAAIS,GAAG,uBAAuB,MAAM,IAAa,IAChgN,EAAkB,GC4JtB,G,UAAA,CACE,KAAF,sBACE,WAAF,GAEE,KAJF,WAKI,MAAJ,CACM,OAAN,KACM,WAAN,GACM,UAAN,KACM,cAAN,KACM,QAAN,KACM,gBAAN,GACM,WAAN,KACM,YAAN,KACM,QAAN,KACM,aAAN,EACM,SAAN,GACM,aAAN,GACM,sBAAN,GACM,iBAAN,KAGE,QAAF,CACI,YADJ,SACA,GACM,IAAN,gCACA,iCACA,IACM,OAAN,cAGI,qBARJ,SAQA,OAAM,IAAN,OACA,IACA,mCACA,YAAQ,OAAR,gCAEA,mDASM,OARA,OAAN,mDAAQ,IAAR,UACA,sMACA,MACA,kCAEA,sCAGA,GAEI,6BAxBJ,SAwBA,KAAM,IAAN,OACA,IACA,mCACA,YAAQ,OAAR,gCAEA,mDAWM,OAVA,OAAN,mDAAQ,IAAR,MACA,sIACQ,GAAR,EAAQ,CACA,IAAR,8CACA,MACA,6BAEA,kCAGA,GAEI,uBA1CJ,SA0CA,GAAM,IAAN,OACA,IAKM,OAJA,OAAN,mDACQ,IAAR,0CACA,0CAEA,GAEI,gBAlDJ,WAkDM,IAAN,OACA,wBAUM,OATA,OAAN,mDACQ,GAAR,4CACQ,GAAR,8CACQ,GAAR,4CACQ,GAAR,gDACQ,GAAR,UACQ,GAAR,aAGA,CAAQ,KAAR,EAAQ,OAAR,EAAQ,KAAR,EAAQ,SAAR,EAAQ,KAAR,EAAQ,KAAR,IAEI,aA/DJ,SA+DA,GAGM,IAAN,iDAAQ,OAAR,cACM,QAAN,oBAAQ,OAAR,kCACA,oBAAQ,OAAR,mDAGI,oBAvEJ,SAuEA,KACM,IAAN,sBACM,OAAN,mCAEI,YA3EJ,SA2EA,SAAM,IAAN,UACA,sMAEM,OADN,cACA,oCAEI,0BAhFJ,SAgFA,OAAM,IAAN,MACA,sIACM,OAAN,yCAEI,2BApFJ,SAoFA,GACA,QAAM,IACN,aACA,UACM,GAAN,kDAGM,IAFA,IAAN,IACA,IACA,cAAQ,IAAR,EACA,kCACA,MACU,GAAV,EACU,KAGJ,GAAN,eACM,IAAN,MAEM,OAAN,8BAEI,qBAvGJ,SAuGA,GAAM,IAAN,OACA,+BACM,IAAN,sBACM,IAAN,IAKM,OAJA,EAAN,qBACQ,GAAR,qDACQ,GAAR,gEAEA,qCAEI,wBAjHJ,SAiHA,GAAM,IAAN,OACA,2BACA,IACA,IASM,OARA,EAAN,qBACQ,GAAR,kBAAQ,CACA,IAAR,iDACA,WACU,GAAV,EACU,SAGV,yBAEI,gBA/HJ,SA+HA,GACM,IAAN,IAKM,OAJA,OAAN,mDACA,2BACA,8BAEA,GAEI,yBAvIJ,SAuIA,OAAM,IAAN,OACA,IAiBM,OAhBA,OAAN,mDAAQ,IAAR,QACA,+FACA,6GACA,sBACA,OACA,qCACA,iEACA,+DACA,qEAHA,KAKA,sCACA,mEACA,iEACA,uEAHA,QAMA,GAEI,mBA3JJ,SA2JA,GAAM,IAAN,OACA,IAmBM,OAlBA,OAAN,mDACQ,EAAR,2CAAU,IAAV,gCACA,+FACA,6GACA,sBACA,OACA,qCACA,iEACA,+DACA,qEAHA,KAKA,sCACA,mEACA,iEACA,uEAHA,WAOA,GAEI,YAjLJ,SAiLA,GACM,OAAN,WACA,WACA,WACA,IAEI,0BAvLJ,SAuLA,KAAM,IAAN,OACA,IAmBM,OAlBA,OAAN,mCACQ,OAAR,+CACU,IAAV,8CACA,uBACA,sBACA,OACA,qCACA,iEACA,+DACA,qEAHA,KAKA,sCACA,mEACA,iEACA,uEAHA,WAOA,GAEI,cA7MJ,SA6MA,OAAM,IAAN,MACM,OAAN,iIAEI,gBAhNJ,SAgNA,OAAM,IAAN,IACA,mGACM,MAAN,wCAEI,oBApNJ,SAoNA,OAAM,IAAN,IACA,uGACM,MAAN,wCAEI,aAxNJ,SAwNA,SAAM,IAAN,IACA,6GACM,OAAN,MACA,4CACA,8CACA,4CACA,iDACA,kBAEA,6CACA,+CACA,6CACA,kDACA,mBAGI,eAxOJ,SAwOA,GAEM,OADA,QAAN,OACA,sCACA,qBACA,uBACA,uBACA,0BACA,mBAEI,oBAjPJ,SAiPA,GACM,OAAN,4CACA,8CACA,4CACA,iDACA,mBAEI,qBAxPJ,WAwPM,IAAN,OAAM,OAAN,yIACA,iBACA,yCACA,2CACA,6CACA,+CACA,mGACA,gBAPA,wBAQA,sGACA,gDACA,kBACA,yBAGA,2BAdA,UAeA,IACA,+EACA,kBACA,cACA,sFACA,kBAEA,kBACA,yCAIA,mBACA,gIACA,oBA7BA,eA+BA,cA/BA,UAgCA,IACA,yIACA,kBACA,cACA,+FACA,kBAEA,kBACA,4BAIA,mBACA,yIACA,oBA9CA,QAkDA,iBAlDA,+CAoDI,SA5SJ,WA6SM,IAAN,wCACA,oDACA,4CACA,uCACM,EAAN,y6BAsBA,oCAtBA,qCAsBA,EAtBA,qBAsBA,gBAtBA,qBAsBA,iBAtBA,0BAsBA,2BAtBA,uBAsBA,eAtBA,2BAuBA,EAvBA,2EAwBA,EAxBA,+CA2BM,EAAN,iBACM,EAAN,SAEI,eA/UJ,WAgVM,IAAN,kCACA,8BACM,EAAN,8BAEI,UApVJ,SAoVA,GACM,IAAN,2CACM,OAAN,+BAEI,sBAxVJ,WAwVM,IAAN,OAAM,OAAN,sIACA,qBACA,gDACA,qBACA,0EAJA,8CAQI,iBAhWJ,WAgWM,IAAN,OAAM,OAAN,sIACA,gBACA,+CACA,6DAHA,8CAMI,oBAtWJ,WAsWM,IAAN,OAAM,OAAN,sIACA,mBACA,6CACA,mEAHA,8CAMI,iBA5WJ,SA4WA,OACM,KAAN,kBAAQ,MAAR,EAAQ,QAAR,EAAQ,QAAR,uBAAQ,OAAR,EAAQ,cAAR,IAAQ,aAAR,MAGE,SAAF,CACI,QADJ,WAEM,OAAN,wBAEI,iBAJJ,WAIM,IAAN,OACA,KAoCM,OAnCA,KAAN,8BACQ,IAAR,+MACA,OACU,EAAV,IAAY,cAAZ,EAAY,KAAZ,EAAY,KAAZ,EAAY,MAAZ,KAEA,gBACU,EAAV,aAAY,YAAZ,KAEA,+BACU,EAAV,4BACY,SAAZ,GACY,MAAZ,EACY,mBAAZ,EACY,WAAZ,EACY,MAAZ,CAAc,EAAd,GAAc,EAAd,GAAc,EAAd,GAAc,EAAd,MAGQ,IAAR,IAGY,EAFZ,OACA,8BACA,EAEA,aAGA,aACA,0BAEA,QAGQ,EAAR,yCACQ,EAAR,cACQ,EAAR,iBAEA,GAEI,0BA3CJ,WA4CM,IAAN,sDAAQ,OAAR,WACM,OAAN,QAEI,qBA/CJ,WA+CM,IAAN,OACA,yDAAQ,IAAR,oCACA,2CACQ,MAAR,CAAU,OAAV,EAAU,SAAV,iBAGM,EAAN,oBAAQ,OAAR,yBACM,IAAN,KACA,IACA,IACA,OASM,OARA,EAAN,qBACA,iBACU,EAAV,EACU,EAAV,YAEQ,EAAR,YACQ,OAER,GAEI,kBApEJ,WAqEM,IAAN,KAKM,OAJA,KAAN,2CAAQ,IAAR,wBACA,gBACQ,EAAR,cAEA,IAGE,YAndF,WAodI,KAAJ,mBACI,KAAJ,sBACI,KAAJ,gFCnnB2X,ICQvX,G,UAAY,eACd,EACA,EACA,GACA,EACA,KACA,WACA,OAIa,I,QCnBX,EAAS,WAAa,IAAIT,EAAIP,KAASQ,EAAGD,EAAIE,eAAmBC,EAAGH,EAAII,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACA,EAAG,QAAQ,CAACE,YAAY,QAAQ,CAACF,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,OAAO,CAACH,EAAG,SAAS,CAACI,YAAYP,EAAIQ,GAAG,CAAC,CAAC1B,IAAI,SAASS,GAAG,WAAW,MAAO,CAACY,EAAG,KAAK,CAACE,YAAY,QAAQ,CAACF,EAAG,SAAS,CAACG,MAAM,CAAC,KAAO,iBAAiB,cAAc,UAAUN,EAAIS,GAAG,gDAAgD,KAAKC,OAAM,MAAS,CAACP,EAAG,cAAc,CAACA,EAAG,QAAQ,CAACA,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,MAAM,CAACH,EAAG,eAAe,CAACE,YAAY,WAAWC,MAAM,CAAC,MAAQ,WAAW,YAAY,YAAY,CAACH,EAAG,gBAAgB,CAACQ,IAAI,UAAUL,MAAM,CAAC,GAAK,UAAU,QAAUN,EAAIoB,eAAeC,GAAG,CAAC,OAAS,SAASC,GAAQtB,EAAIuB,OAAO,KAAKvB,EAAIwB,QAAQ,OAAOX,MAAM,CAAC5B,MAAOe,EAAa,UAAEc,SAAS,SAAUC,GAAMf,EAAIyB,UAAUV,GAAKE,WAAW,gBAAgB,IAAI,GAAGd,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,MAAM,CAACH,EAAG,eAAe,CAACE,YAAY,WAAWC,MAAM,CAAC,MAAQ,sBAAsB,YAAY,UAAU,CAACH,EAAG,gBAAgB,CAACQ,IAAI,QAAQL,MAAM,CAAC,GAAK,QAAQ,QAAUN,EAAI0B,WAAW,SAA0B,MAAf1B,EAAIyB,WAAgCJ,GAAG,CAAC,OAAS,SAASC,GAAQtB,EAAIwB,QAAQ,KAAKxB,EAAI2B,0BAA0Bd,MAAM,CAAC5B,MAAOe,EAAU,OAAEc,SAAS,SAAUC,GAAMf,EAAIuB,OAAOR,GAAKE,WAAW,aAAa,IAAI,GAAGd,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,MAAM,CAACH,EAAG,eAAe,CAACE,YAAY,WAAWC,MAAM,CAAC,MAAQ,uBAAuB,YAAY,WAAW,CAACH,EAAG,gBAAgB,CAACQ,IAAI,SAASL,MAAM,CAAC,GAAK,SAAS,QAAUN,EAAI4B,gBAAgB,SAAuB,MAAZ5B,EAAIuB,QAA6BF,GAAG,CAAC,OAAS,SAASC,GAAQ,OAAOtB,EAAI6B,yBAAyBhB,MAAM,CAAC5B,MAAOe,EAAW,QAAEc,SAAS,SAAUC,GAAMf,EAAIwB,QAAQT,GAAKE,WAAW,cAAc,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,GAAGd,EAAG,QAAQ,CAACA,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,OAAO,CAAEN,EAAe,YAAEG,EAAG,MAAM,CAACA,EAAG,MAAM,CAACE,YAAY,gCAAgC,CAACF,EAAG,YAAY,CAAC2B,YAAY,CAAC,MAAQ,OAAO,OAAS,QAAQxB,MAAM,CAAC,MAAQ,aAAaH,EAAG,MAAMA,EAAG,SAAS,CAACH,EAAIS,GAAG,0BAA0B,KAAKT,EAAIkB,QAAQ,GAAKlB,EAAI+B,aAA4B,MAAb/B,EAAIwB,QAAkrExB,EAAIkB,KAAvqEf,EAAG,QAAQ,CAACA,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,OAAO,CAACH,EAAG,QAAQ,CAACE,YAAY,mBAAmBC,MAAM,CAAC,OAAS,IAAI,YAAc,IAAI,YAAc,MAAM,CAACH,EAAG,QAAQ,CAACA,EAAG,KAAK,CAACA,EAAG,KAAK,CAACG,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAG,OAAON,EAAG,KAAK,CAACG,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAG,gBAAgBT,EAAIgC,GAAIhC,EAAqB,mBAAE,SAASiC,EAAMC,GAAM,MAAO,CAAC/B,EAAG,KAAK,CAACrB,IAAIoD,EAAK5B,MAAM,CAAC,QAAUN,EAAIuE,YAAYrC,KAAQ,CAAClC,EAAIS,GAAG,IAAIT,EAAIoC,GAAGF,GAAM,WAAU/B,EAAG,KAAK,CAACG,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAG,QAAQ,GAAGN,EAAG,KAAK,CAACH,EAAIgC,GAAIhC,EAAqB,mBAAE,SAASiC,GAAO,MAAO,CAACjC,EAAIgC,GAAG,GAAQ,SAASS,EAAKC,GAAG,MAAO,CAACvC,EAAG,KAAK,CAACrB,IAAI,QAAU2D,EAAOC,EAAEpC,MAAM,CAAC,QAAUN,EAAIwE,iBAAiBrC,OAAS,IAAI,CAACnC,EAAIS,GAAG,IAAIT,EAAIoC,GAAGK,GAAM,gBAAc,GAAGtC,EAAG,KAAK,CAACH,EAAIgC,GAAIhC,EAAqB,mBAAE,SAASiC,EAAMC,GAAM,MAAO,CAAClC,EAAIgC,GAAG,GAAQ,SAASS,EAAK4C,GAAG,MAAO,CAAClF,EAAG,KAAK,CAACrB,IAAI,OAAS2D,EAAOP,EAAOmD,GAAG,CAACrF,EAAIS,GAAG,SAASN,EAAG,KAAK,CAACrB,IAAI,OAAS2D,EAAOP,EAAOmD,GAAG,CAACrF,EAAIS,GAAG,SAASN,EAAG,KAAK,CAACrB,IAAI,QAAU2D,EAAOP,EAAOmD,GAAG,CAACrF,EAAIS,GAAG,oBAAkB,KAAKN,EAAG,QAAQH,EAAIgC,GAAIhC,EAAoB,kBAAE,SAAS0E,EAAIC,EAAOnC,GAAG,OAAOrC,EAAG,KAAK,CAACrB,IAAI6F,GAAQ,CAACxE,EAAG,KAAK,CAACE,YAAY,aAAa,CAACL,EAAIS,GAAGT,EAAIoC,GAAGI,EAAI,MAAMrC,EAAG,KAAK,CAAC2B,YAAY,CAAC,aAAa,SAAS,CAAC9B,EAAIS,GAAGT,EAAIoC,GAAGuC,MAAW3E,EAAIgC,GAAIhC,EAAqB,mBAAE,SAASiC,EAAMC,GAAM,MAAO,CAAClC,EAAIgC,GAAG,GAAQ,SAASS,GAAM,MAAO,CAACtC,EAAG,KAAK,CAACrB,IAAI,OAAS6F,EAASzC,EAAOO,EAAKpC,YAAY,eAAe,CAACL,EAAIS,GAAG,IAAIT,EAAIoC,GAAGpC,EAAIsF,iBAAiBZ,EAAKxC,EAAMO,IAAO,OAAOtC,EAAG,KAAK,CAACrB,IAAI,OAAS6F,EAASzC,EAAOO,EAAO,EAAEpC,YAAY,eAAe,CAACL,EAAIS,GAAG,IAAIT,EAAIoC,GAAGpC,EAAI4E,0BAA0BF,EAAKxC,EAAMO,IAAO,OAAOtC,EAAG,KAAK,CAACrB,IAAI,OAAS6F,EAASzC,EAAOO,EAAO,EAAEpC,YAAY,cAAcyB,YAAY,CAAC,cAAc,OAAO,aAAa,WAAW,CAAC9B,EAAIS,GAAG,IAAIT,EAAIoC,GAAGpC,EAAIuF,oBAAoBb,EAAKxC,EAAMO,IAAO,eAAatC,EAAG,KAAK,CAACE,YAAY,aAAa,CAACL,EAAIS,GAAGT,EAAIoC,GAAGI,EAAI,OAAO,MAAK,KAAKrC,EAAG,MAAM,CAAC2B,YAAY,CAAC,gBAAgB,SAAS,CAAC3B,EAAG,WAAW,CAACE,YAAY,kBAAkBC,MAAM,CAAC,QAAU,WAAWe,GAAG,CAAC,MAAQrB,EAAIiE,WAAW,CAACjE,EAAIS,GAAG,0BAA0BN,EAAG,WAAW,CAACE,YAAY,kBAAkBC,MAAM,CAAC,QAAU,mBAAmBe,GAAG,CAAC,MAAQrB,EAAIkE,iBAAiB,CAAClE,EAAIS,GAAG,uBAAuB,MAAM,IAAa,IAC/pI,EAAkB,GC4GtB,GACE,KAAF,sBACE,WAAF,GAEE,KAJF,WAKI,MAAJ,CACM,OAAN,KACM,WAAN,GACM,UAAN,KACM,cAAN,KACM,QAAN,KACM,gBAAN,GACM,WAAN,KACM,YAAN,KACM,QAAN,KACM,aAAN,EACM,SAAN,GACM,aAAN,GACM,sBAAN,GACM,iBAAN,KAGE,QAAF,CACI,YADJ,SACA,GACM,IAAN,gCACA,iCACA,IACM,OAAN,cAEI,aAPJ,SAOA,GAGM,IAAN,iDAAQ,OAAR,cACM,QAAN,oBAAQ,OAAR,kCACA,oBAAQ,OAAR,mDAGI,YAfJ,SAeA,SAAM,IAAN,UACA,sMAEM,OADN,cACA,oCAEI,oBApBJ,SAoBA,OAAM,IAAN,MACA,sIACM,OAAN,mCAEI,qBAxBJ,SAwBA,GACM,IAAN,uBACA,aACA,UACM,GAAN,kDAEM,IADA,IAAN,IACA,cAAQ,IAAR,EACA,kCACQ,GAAR,EAEM,GAAN,eACM,IAAN,IAMM,OAJE,EADR,MACA,6BAEA,8BAEA,cAEI,iBA3CJ,SA2CA,OAAM,IAAN,MACA,sIACM,OAAN,gCAEI,kBA/CJ,SA+CA,GACA,QAAM,IACN,aACA,UACM,GAAN,kDAEM,IADA,IAAN,IACA,cAAQ,IAAR,EACA,kCACQ,GAAR,EAEM,OAAN,SACA,cAEI,0BA5DJ,SA4DA,OAAM,IAAN,MACA,sIACM,OAAN,yCAEI,2BAhEJ,SAgEA,GACA,QAAM,IACN,aACA,UACM,GAAN,kDAEM,IADA,IAAN,IACA,cAAQ,IAAR,EACA,kCACQ,GAAR,EAEM,GAAN,eACM,IAAN,mBACM,OAAN,8BAEI,gBA9EJ,SA8EA,GACM,IAAN,IAKM,OAJA,OAAN,mDACA,2BACA,8BAEA,GAEI,yBAtFJ,SAsFA,OAAM,IAAN,OACA,IAiBM,OAhBA,OAAN,mDAAQ,IAAR,QACA,+FACA,6GACA,sBACA,OACA,qCACA,iEACA,+DACA,qEAHA,KAKA,sCACA,mEACA,iEACA,uEAHA,QAMA,GAEI,cA1GJ,SA0GA,OAAM,IAAN,MACM,OAAN,iIAEI,gBA7GJ,SA6GA,OAAM,IAAN,IACA,mGACM,MAAN,wCAEI,oBAjHJ,SAiHA,OAAM,IAAN,IACA,uGACM,MAAN,wCAEI,aArHJ,SAqHA,SAAM,IAAN,IACA,6GACM,OAAN,MACA,4CACA,8CACA,4CACA,iDACA,kBAEA,6CACA,+CACA,6CACA,kDACA,mBAGI,eArIJ,SAqIA,GACM,MAAN,sCACA,qBACA,uBACA,uBACA,0BACA,mBAEI,oBA7IJ,SA6IA,GACM,OAAN,4CACA,8CACA,4CACA,iDACA,mBAEI,qBApJJ,WAoJM,IAAN,OAAM,OAAN,yIACA,iBACA,yBACA,mGACA,gBAJA,wBAKA,sGACA,gDACA,kBACA,yBAGA,2BAXA,SAYA,IACA,+EACA,kBACA,cACA,sFACA,kBAEA,kBACA,yCAIA,mBACA,gIACA,oBA1BA,cA4BA,cA5BA,UA6BA,IACA,yIACA,kBACA,cACA,+FACA,kBAEA,kBACA,4BAIA,mBACA,yIACA,oBA3CA,QA+CA,iBA/CA,+CAiDI,SArMJ,WAsMM,IAAN,wCACA,+CACA,4CACA,iDACM,EAAN,u7BAsBA,oCAtBA,qCAsBA,EAtBA,qBAsBA,gBAtBA,qBAsBA,iBAtBA,0BAsBA,2BAtBA,uBAsBA,eAtBA,2BAuBA,EAvBA,2EAwBA,EAxBA,+CA2BM,EAAN,iBACM,EAAN,SAEI,eAxOJ,WAyOM,IAAN,kCACA,8BACM,EAAN,+CAEI,UA7OJ,SA6OA,GACM,IAAN,2CACM,OAAN,+BAEI,sBAjPJ,WAiPM,IAAN,OAAM,OAAN,sIACA,qBACA,gDACA,qBACA,0EAJA,8CAQI,iBAzPJ,WAyPM,IAAN,OAAM,OAAN,sIACA,gBACA,+CACA,6DAHA,8CAMI,oBA/PJ,WA+PM,IAAN,OAAM,OAAN,sIACA,mBACA,6CACA,mEAHA,8CAMI,iBArQJ,SAqQA,OACM,KAAN,kBAAQ,MAAR,EAAQ,QAAR,EAAQ,QAAR,uBAAQ,OAAR,EAAQ,cAAR,IAAQ,aAAR,MAGE,SAAF,CACI,iBADJ,WACM,IAAN,OACA,KAgCM,OA/BA,KAAN,8BACQ,IAAR,0KACA,OACU,EAAV,IAAY,KAAZ,EAAY,KAAZ,EAAY,MAAZ,KAEA,gBACU,EAAV,aAAY,YAAZ,KAEA,+BACU,EAAV,4BACY,SAAZ,GACY,MAAZ,EACY,mBAAZ,EACY,WAAZ,EACY,MAAZ,CAAc,EAAd,GAAc,EAAd,GAAc,EAAd,GAAc,EAAd,MAGQ,IAAR,IAGY,EAFZ,OACA,8BACA,EAEA,aAGA,QAEQ,EAAR,yCACQ,EAAR,cACQ,EAAR,iBAEA,GAEI,0BApCJ,WAqCM,IAAN,sDAAQ,OAAR,WACM,OAAN,QAEI,kBAxCJ,WAyCM,IAAN,KAKM,OAJA,KAAN,2CAAQ,IAAR,wBACA,gBACQ,EAAR,cAEA,IAGE,YAhVF,WAiVI,KAAJ,mBACI,KAAJ,sBACI,KAAJ,+EChcsX,ICQlX,G,UAAY,eACd,EACA,EACA,GACA,EACA,KACA,WACA,OAIa,I,QCnBX,EAAS,WAAa,IAAIT,EAAIP,KAASQ,EAAGD,EAAIE,eAAmBC,EAAGH,EAAII,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACA,EAAG,QAAQ,CAACE,YAAY,QAAQ,CAACF,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,OAAO,CAACH,EAAG,SAAS,CAACI,YAAYP,EAAIQ,GAAG,CAAC,CAAC1B,IAAI,SAASS,GAAG,WAAW,MAAO,CAACY,EAAG,KAAK,CAACE,YAAY,QAAQ,CAACF,EAAG,SAAS,CAACG,MAAM,CAAC,KAAO,iBAAiB,cAAc,UAAUN,EAAIS,GAAG,0CAA0C,KAAKC,OAAM,MAAS,CAACP,EAAG,cAAc,CAACA,EAAG,QAAQ,CAACA,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,MAAM,CAACH,EAAG,eAAe,CAACE,YAAY,WAAWC,MAAM,CAAC,MAAQ,WAAW,YAAY,YAAY,CAACH,EAAG,gBAAgB,CAACQ,IAAI,UAAUL,MAAM,CAAC,GAAK,UAAU,QAAUN,EAAIoB,eAAeC,GAAG,CAAC,OAAS,SAASC,GAAQtB,EAAIuB,OAAO,KAAKvB,EAAIwB,QAAQ,OAAOX,MAAM,CAAC5B,MAAOe,EAAa,UAAEc,SAAS,SAAUC,GAAMf,EAAIyB,UAAUV,GAAKE,WAAW,gBAAgB,IAAI,GAAGd,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,MAAM,CAACH,EAAG,eAAe,CAACE,YAAY,WAAWC,MAAM,CAAC,MAAQ,sBAAsB,YAAY,UAAU,CAACH,EAAG,gBAAgB,CAACQ,IAAI,QAAQL,MAAM,CAAC,GAAK,QAAQ,QAAUN,EAAI0B,WAAW,SAA0B,MAAf1B,EAAIyB,WAAgCJ,GAAG,CAAC,OAAS,SAASC,GAAQtB,EAAIwB,QAAQ,KAAKxB,EAAI2B,0BAA0Bd,MAAM,CAAC5B,MAAOe,EAAU,OAAEc,SAAS,SAAUC,GAAMf,EAAIuB,OAAOR,GAAKE,WAAW,aAAa,IAAI,GAAGd,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,MAAM,CAACH,EAAG,eAAe,CAACE,YAAY,WAAWC,MAAM,CAAC,MAAQ,uBAAuB,YAAY,WAAW,CAACH,EAAG,gBAAgB,CAACQ,IAAI,SAASL,MAAM,CAAC,GAAK,SAAS,QAAUN,EAAI4B,gBAAgB,SAAuB,MAAZ5B,EAAIuB,QAA6BF,GAAG,CAAC,OAAS,SAASC,GAAQ,OAAOtB,EAAI6B,yBAAyBhB,MAAM,CAAC5B,MAAOe,EAAW,QAAEc,SAAS,SAAUC,GAAMf,EAAIwB,QAAQT,GAAKE,WAAW,cAAc,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,GAAGd,EAAG,QAAQ,CAACA,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,OAAO,CAAEN,EAAe,YAAEG,EAAG,MAAM,CAACA,EAAG,MAAM,CAACE,YAAY,gCAAgC,CAACF,EAAG,YAAY,CAAC2B,YAAY,CAAC,MAAQ,OAAO,OAAS,QAAQxB,MAAM,CAAC,MAAQ,aAAaH,EAAG,MAAMA,EAAG,SAAS,CAACH,EAAIS,GAAG,0BAA0B,KAAKT,EAAIkB,QAAQ,GAAKlB,EAAI+B,aAA4B,MAAb/B,EAAIwB,QAA0nFxB,EAAIkB,KAA/mFf,EAAG,QAAQ,CAACA,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,OAAO,CAACH,EAAG,QAAQ,CAACE,YAAY,mBAAmBC,MAAM,CAAC,OAAS,IAAI,YAAc,IAAI,YAAc,MAAM,CAACH,EAAG,QAAQ,CAACA,EAAG,KAAK,CAACA,EAAG,KAAK,CAACG,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAG,OAAON,EAAG,KAAK,CAACG,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAG,gBAAgBT,EAAIgC,GAAIhC,EAAqB,mBAAE,SAASiC,EAAMC,GAAM,MAAO,CAAC/B,EAAG,KAAK,CAACrB,IAAIoD,EAAK5B,MAAM,CAAC,QAAUN,EAAIuE,YAAYrC,GAAQ,IAAI,CAAClC,EAAIS,GAAG,IAAIT,EAAIoC,GAAGF,GAAM,WAAU/B,EAAG,KAAK,CAACG,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAG,QAAQ,GAAGN,EAAG,KAAK,CAACH,EAAIgC,GAAIhC,EAAqB,mBAAE,SAASiC,EAAMC,GAAM,MAAO,CAAClC,EAAIgC,GAAG,GAAQ,SAASS,EAAKC,GAAG,MAAO,CAACvC,EAAG,KAAK,CAACrB,IAAI,QAAU2D,EAAOC,EAAEpC,MAAM,CAAC,QAAU,IAAI,CAACN,EAAIS,GAAG,IAAIT,EAAIoC,GAAGK,GAAM,WAAUtC,EAAG,KAAK,CAACrB,IAAI,aAAeoD,EAAK7B,YAAY,iBAAiB,CAACL,EAAIS,GAAG,UAAUN,EAAG,KAAK,CAACrB,IAAI,SAAWoD,EAAK7B,YAAY,iBAAiB,CAACL,EAAIS,GAAG,eAAc,GAAGN,EAAG,KAAK,CAACH,EAAIgC,GAAIhC,EAAqB,mBAAE,SAASiC,EAAMC,GAAM,MAAO,CAAClC,EAAIgC,GAAG,GAAQ,SAASS,GAAM,MAAO,CAACtC,EAAG,KAAK,CAACrB,IAAI,OAAS2D,EAAOP,QAAU/B,EAAG,KAAK,CAACrB,IAAI,OAASoD,GAAM,CAAClC,EAAIS,GAAG,UAAUN,EAAG,KAAK,CAACrB,IAAI,QAAUoD,GAAM,CAAClC,EAAIS,GAAG,gBAAe,KAAKN,EAAG,QAAQH,EAAIgC,GAAIhC,EAAoB,kBAAE,SAAS0E,EAAIC,EAAOnC,GAAG,OAAOrC,EAAG,KAAK,CAACrB,IAAI6F,GAAQ,CAACxE,EAAG,KAAK,CAACE,YAAY,aAAa,CAACL,EAAIS,GAAGT,EAAIoC,GAAGI,EAAI,MAAMrC,EAAG,KAAK,CAAC2B,YAAY,CAAC,aAAa,SAAS,CAAC9B,EAAIS,GAAGT,EAAIoC,GAAGuC,MAAW3E,EAAIgC,GAAIhC,EAAqB,mBAAE,SAASiC,EAAMC,GAAM,MAAO,CAAClC,EAAIgC,GAAG,GAAQ,SAASS,GAAM,MAAO,CAACtC,EAAG,KAAK,CAACrB,IAAI,OAAS6F,EAASzC,EAAOO,EAAKpC,YAAY,cAAcyB,YAAY,CAAC,cAAc,OAAO,aAAa,WAAW,CAAC9B,EAAIS,GAAG,IAAIT,EAAIoC,GAAsB,KAAnBsC,EAAItB,cAAqBpD,EAAI4E,0BAA0BF,EAAKxC,EAAMO,GAAQ,KAAK,WAAUtC,EAAG,KAAK,CAACrB,IAAI,WAAa6F,EAASzC,GAAM,CAAClC,EAAIS,GAAG,IAAIT,EAAIoC,GAAsB,KAAnBsC,EAAItB,cAAqBpD,EAAI6E,oBAAoBH,EAAKxC,GAAQ,KAAK,OAAO/B,EAAG,KAAK,CAACrB,IAAI,YAAc6F,EAASzC,EAAK7B,YAAY,6BAA6B,CAACF,EAAG,OAAO,CAACqF,MAAOxF,EAAIyF,UAAqC,EAA1BzF,EAAI0F,aAAaC,OAAmD,EAArC3F,EAAI6E,oBAAoBH,EAAKxC,IAAW0D,QAAQ,GAAK,EAAI,aAAe,IAAK,CAAC5F,EAAIS,GAAGT,EAAIoC,GAAsB,KAAnBsC,EAAItB,eAAuBpD,EAAIyF,UAAqC,EAA1BzF,EAAI0F,aAAaC,OAAmD,EAArC3F,EAAI6E,oBAAoBH,EAAKxC,IAAW0D,QAAQ,GAAK,GAAM5F,EAAIyF,UAAqC,EAA1BzF,EAAI0F,aAAaC,OAAmD,EAArC3F,EAAI6E,oBAAoBH,EAAKxC,IAAW0D,QAAQ,GAAK,cAAazF,EAAG,KAAK,CAACE,YAAY,aAAa,CAACL,EAAIS,GAAGT,EAAIoC,GAAGI,EAAI,OAAO,MAAK,KAAKrC,EAAG,MAAM,CAAC2B,YAAY,CAAC,gBAAgB,SAAS,CAAC3B,EAAG,WAAW,CAACE,YAAY,kBAAkBC,MAAM,CAAC,QAAU,WAAWe,GAAG,CAAC,MAAQrB,EAAIiE,WAAW,CAACjE,EAAIS,GAAG,0BAA0BN,EAAG,WAAW,CAACE,YAAY,kBAAkBC,MAAM,CAAC,QAAU,mBAAmBe,GAAG,CAAC,MAAQrB,EAAIkE,iBAAiB,CAAClE,EAAIS,GAAG,uBAAuB,MAAM,IAAa,IACjmJ,EAAkB,GC+GtB,GACE,KAAF,qBACE,WAAF,GAEE,KAJF,WAKI,MAAJ,CACM,OAAN,KACM,WAAN,GACM,UAAN,KACM,cAAN,KACM,QAAN,KACM,gBAAN,GACM,WAAN,KACM,YAAN,KACM,QAAN,KACM,aAAN,EACM,SAAN,GACM,aAAN,GACM,sBAAN,GACM,iBAAN,KAGE,QAAF,CACI,YADJ,SACA,GACM,IAAN,gCACA,IACA,IACM,OAAN,cAGI,qBARJ,SAQA,OAAM,IAAN,OACA,IACA,mCACA,YAAQ,OAAR,gCAEA,mDASM,OARA,OAAN,mDAAQ,IAAR,UACA,sMACA,MACA,kCAEA,sCAGA,GAEI,6BAxBJ,SAwBA,KAAM,IAAN,OACA,IACA,mCACA,YAAQ,OAAR,gCAEA,mDAWM,OAVA,OAAN,mDAAQ,IAAR,MACA,sIACQ,GAAR,EAAQ,CACA,IAAR,8CACA,MACA,6BAEA,kCAGA,GAEI,uBA1CJ,SA0CA,GAAM,IAAN,OACA,IAKM,OAJA,OAAN,mDACQ,IAAR,0CACA,0CAEA,GAEI,gBAlDJ,WAkDM,IAAN,OACA,wBAUM,OATA,OAAN,mDACQ,GAAR,4CACQ,GAAR,8CACQ,GAAR,4CACQ,GAAR,gDACQ,GAAR,UACQ,GAAR,aAGA,CAAQ,KAAR,EAAQ,OAAR,EAAQ,KAAR,EAAQ,SAAR,EAAQ,KAAR,EAAQ,KAAR,IAEI,aA/DJ,SA+DA,GAGM,IAAN,iDAAQ,OAAR,cACM,QAAN,oBAAQ,OAAR,kCACA,oBAAQ,OAAR,mDAGI,oBAvEJ,SAuEA,KACM,IAAN,sBACM,OAAN,mCAEI,YA3EJ,SA2EA,SAAM,IAAN,UACA,sMAEM,OADN,cACA,oCAEI,0BAhFJ,SAgFA,OAAM,IAAN,MACA,sIACM,OAAN,yCAEI,2BApFJ,SAoFA,GACA,QAAM,IACN,aACA,UACM,GAAN,kDAGM,IAFA,IAAN,IACA,IACA,cAAQ,IAAR,EACA,kCACQ,GAAR,EACA,SAEM,GAAN,eACM,IAAN,MAEM,OAAN,8BAEI,qBArGJ,SAqGA,GAAM,IAAN,OACA,+BACM,IAAN,sBACM,IAAN,IAKM,OAJA,EAAN,qBACQ,GAAR,qDACQ,GAAR,gEAEA,qCAEI,wBA/GJ,SA+GA,GAAM,IAAN,OACA,2BACA,IACA,IASM,OARA,EAAN,qBACQ,GAAR,kBAAQ,CACA,IAAR,iDACA,WACU,GAAV,EACU,SAGV,yBAEI,gBA7HJ,SA6HA,GACM,IAAN,IAKM,OAJA,OAAN,mDACA,2BACA,8BAEA,GAEI,yBArIJ,SAqIA,OAAM,IAAN,OACA,IAiBM,OAhBA,OAAN,mDAAQ,IAAR,QACA,+FACA,6GACA,sBACA,OACA,qCACA,iEACA,+DACA,qEAHA,KAKA,sCACA,mEACA,iEACA,uEAHA,QAMA,GAEI,mBAzJJ,SAyJA,GAAM,IAAN,OACA,IAmBM,OAlBA,OAAN,mDACQ,EAAR,2CAAU,IAAV,gCACA,+FACA,6GACA,sBACA,OACA,qCACA,iEACA,+DACA,qEAHA,KAKA,sCACA,mEACA,iEACA,uEAHA,WAOA,GAEI,YA/KJ,SA+KA,GACM,OAAN,WACA,WACA,WACA,IAEI,0BArLJ,SAqLA,KAAM,IAAN,OACA,IAmBM,OAlBA,OAAN,mCACQ,OAAR,+CACU,IAAV,8CACA,uBACA,sBACA,OACA,qCACA,iEACA,+DACA,qEAHA,KAKA,sCACA,mEACA,iEACA,uEAHA,WAOA,GAEI,cA3MJ,SA2MA,OAAM,IAAN,MACM,OAAN,iIAEI,gBA9MJ,SA8MA,OAAM,IAAN,IACA,mGACM,MAAN,wCAEI,oBAlNJ,SAkNA,OAAM,IAAN,IACA,uGACM,MAAN,wCAEI,aAtNJ,SAsNA,SAAM,IAAN,IACA,6GACM,OAAN,MACA,4CACA,8CACA,4CACA,iDACA,kBAEA,6CACA,+CACA,6CACA,kDACA,mBAGI,eAtOJ,SAsOA,GAEM,OADA,QAAN,OACA,sCACA,qBACA,uBACA,uBACA,0BACA,mBAEI,oBA/OJ,SA+OA,GACM,OAAN,4CACA,8CACA,4CACA,iDACA,mBAEI,qBAtPJ,WAsPM,IAAN,OAAM,OAAN,yIACA,iBACA,yCACA,2CACA,6CACA,+CACA,mGACA,gBAPA,wBAQA,sGACA,gDACA,kBACA,yBAGA,2BAdA,UAeA,IACA,+EACA,kBACA,cACA,sFACA,kBAEA,kBACA,yCAIA,mBACA,gIACA,oBA7BA,eA+BA,cA/BA,UAgCA,IACA,yIACA,kBACA,cACA,+FACA,kBAEA,kBACA,4BAIA,mBACA,yIACA,oBA9CA,QAkDA,iBAlDA,+CAoDI,SA1SJ,WA2SM,IAAN,wCACA,yCACA,4CACA,2CACM,EAAN,i7BAsBA,oCAtBA,qCAsBA,EAtBA,qBAsBA,gBAtBA,qBAsBA,iBAtBA,0BAsBA,2BAtBA,uBAsBA,eAtBA,2BAuBA,EAvBA,2EAwBA,EAxBA,+CA2BM,EAAN,iBACM,EAAN,SAEI,eA7UJ,WA8UM,IAAN,kCACA,8BACM,EAAN,yCAEI,UAlVJ,SAkVA,GACM,IAAN,2CACM,OAAN,+BAEI,sBAtVJ,WAsVM,IAAN,OAAM,OAAN,sIACA,qBACA,gDACA,qBACA,0EAJA,8CAQI,iBA9VJ,WA8VM,IAAN,OAAM,OAAN,sIACA,gBACA,+CACA,6DAHA,8CAMI,oBApWJ,WAoWM,IAAN,OAAM,OAAN,sIACA,mBACA,6CACA,mEAHA,8CAMI,iBA1WJ,SA0WA,OACM,KAAN,kBAAQ,MAAR,EAAQ,QAAR,EAAQ,QAAR,uBAAQ,OAAR,EAAQ,cAAR,IAAQ,aAAR,MAGE,SAAF,CACI,QADJ,WAEM,OAAN,wBAEI,iBAJJ,WAIM,IAAN,OACA,KAgCM,OA/BA,KAAN,8BACQ,IAAR,4LACA,OACU,EAAV,IAAY,cAAZ,EAAY,KAAZ,EAAY,KAAZ,EAAY,MAAZ,KAEA,gBACU,EAAV,aAAY,YAAZ,KAEA,+BACU,EAAV,4BACY,SAAZ,GACY,MAAZ,EACY,mBAAZ,EACY,WAAZ,EACY,MAAZ,CAAc,EAAd,GAAc,EAAd,GAAc,EAAd,GAAc,EAAd,MAGQ,IAAR,IAGY,EAFZ,OACA,8BACA,EAEA,aAGA,QAEQ,EAAR,yCACQ,EAAR,cACQ,EAAR,iBAEA,GAEI,0BAvCJ,WAwCM,IAAN,sDAAQ,OAAR,WACM,OAAN,QAEI,qBA3CJ,WA2CM,IAAN,OACA,yDAAQ,IAAR,oCACA,2CACQ,MAAR,CAAU,OAAV,EAAU,SAAV,iBAGM,EAAN,oBAAQ,OAAR,yBACM,IAAN,KACA,IACA,IACA,OASM,OARA,EAAN,qBACA,iBACU,EAAV,EACU,EAAV,YAEQ,EAAR,YACQ,OAER,GAEI,kBAhEJ,WAiEM,IAAN,KAKM,OAJA,KAAN,2CAAQ,IAAR,wBACA,gBACQ,EAAR,cAEA,IAGE,YA7cF,WA8cI,KAAJ,mBACI,KAAJ,sBACI,KAAJ,+EChkB0X,ICQtX,G,UAAY,eACd,EACA,EACA,GACA,EACA,KACA,WACA,OAIa,I,QCnBX,EAAS,WAAa,IAAIT,EAAIP,KAASQ,EAAGD,EAAIE,eAAmBC,EAAGH,EAAII,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACA,EAAG,QAAQ,CAACE,YAAY,QAAQ,CAACF,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,OAAO,CAACH,EAAG,SAAS,CAACI,YAAYP,EAAIQ,GAAG,CAAC,CAAC1B,IAAI,SAASS,GAAG,WAAW,MAAO,CAACY,EAAG,KAAK,CAACE,YAAY,QAAQ,CAACF,EAAG,SAAS,CAACG,MAAM,CAAC,KAAO,iBAAiB,cAAc,UAAUN,EAAIS,GAAG,kDAAkD,KAAKC,OAAM,MAAS,CAACP,EAAG,cAAc,CAACA,EAAG,QAAQ,CAACA,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,MAAM,CAACH,EAAG,eAAe,CAACE,YAAY,WAAWC,MAAM,CAAC,MAAQ,WAAW,YAAY,YAAY,CAACH,EAAG,gBAAgB,CAACQ,IAAI,UAAUL,MAAM,CAAC,GAAK,UAAU,QAAUN,EAAIoB,eAAeC,GAAG,CAAC,OAAS,SAASC,GAAQtB,EAAIuB,OAAO,KAAKvB,EAAIwB,QAAQ,OAAOX,MAAM,CAAC5B,MAAOe,EAAa,UAAEc,SAAS,SAAUC,GAAMf,EAAIyB,UAAUV,GAAKE,WAAW,gBAAgB,IAAI,GAAGd,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,MAAM,CAACH,EAAG,eAAe,CAACE,YAAY,WAAWC,MAAM,CAAC,MAAQ,sBAAsB,YAAY,UAAU,CAACH,EAAG,gBAAgB,CAACQ,IAAI,QAAQL,MAAM,CAAC,GAAK,QAAQ,QAAUN,EAAI0B,WAAW,SAA0B,MAAf1B,EAAIyB,WAAgCJ,GAAG,CAAC,OAAS,SAASC,GAAQtB,EAAIwB,QAAQ,KAAKxB,EAAI2B,0BAA0Bd,MAAM,CAAC5B,MAAOe,EAAU,OAAEc,SAAS,SAAUC,GAAMf,EAAIuB,OAAOR,GAAKE,WAAW,aAAa,IAAI,GAAGd,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,MAAM,CAACH,EAAG,eAAe,CAACE,YAAY,WAAWC,MAAM,CAAC,MAAQ,uBAAuB,YAAY,WAAW,CAACH,EAAG,gBAAgB,CAACQ,IAAI,SAASL,MAAM,CAAC,GAAK,SAAS,QAAUN,EAAI4B,gBAAgB,SAAuB,MAAZ5B,EAAIuB,QAA6BF,GAAG,CAAC,OAAS,SAASC,GAAQ,OAAOtB,EAAI6B,yBAAyBhB,MAAM,CAAC5B,MAAOe,EAAW,QAAEc,SAAS,SAAUC,GAAMf,EAAIwB,QAAQT,GAAKE,WAAW,cAAc,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,GAAGd,EAAG,QAAQ,CAACA,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,OAAO,CAAEN,EAAe,YAAEG,EAAG,MAAM,CAACA,EAAG,MAAM,CAACE,YAAY,gCAAgC,CAACF,EAAG,YAAY,CAAC2B,YAAY,CAAC,MAAQ,OAAO,OAAS,QAAQxB,MAAM,CAAC,MAAQ,aAAaH,EAAG,MAAMA,EAAG,SAAS,CAACH,EAAIS,GAAG,0BAA0B,KAAKT,EAAIkB,QAAQ,GAAKlB,EAAI+B,aAA4B,MAAb/B,EAAIwB,QAAuwExB,EAAIkB,KAA5vEf,EAAG,QAAQ,CAACA,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,OAAO,CAACH,EAAG,QAAQ,CAACE,YAAY,mBAAmBC,MAAM,CAAC,OAAS,IAAI,YAAc,IAAI,YAAc,MAAM,CAACH,EAAG,QAAQ,CAACA,EAAG,KAAK,CAACA,EAAG,KAAK,CAACG,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAG,OAAON,EAAG,KAAK,CAACG,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAG,gBAAgBT,EAAIgC,GAAIhC,EAAqB,mBAAE,SAASiC,EAAMC,GAAM,MAAO,CAAC/B,EAAG,KAAK,CAACrB,IAAIoD,EAAK5B,MAAM,CAAC,QAAyB,EAAf2B,EAAME,OAAa,IAAI,CAACnC,EAAIS,GAAGT,EAAIoC,GAAGF,UAAY/B,EAAG,KAAK,CAACG,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAG,SAASN,EAAG,KAAK,CAACG,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAG,UAAU,GAAGN,EAAG,KAAK,CAACH,EAAIgC,GAAIhC,EAAqB,mBAAE,SAASiC,EAAMC,GAAM,MAAO,CAAClC,EAAIgC,GAAG,GAAQ,SAASS,EAAKC,GAAG,MAAO,CAACvC,EAAG,KAAK,CAACrB,IAAI,QAAU2D,EAAOC,EAAEpC,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAGT,EAAIoC,GAAGK,UAAYtC,EAAG,KAAK,CAACrB,IAAI,aAAeoD,EAAK5B,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAG,iBAAgB,GAAGN,EAAG,KAAK,CAACH,EAAIgC,GAAIhC,EAAqB,mBAAE,SAASiC,EAAMC,GAAM,MAAO,CAAClC,EAAIgC,GAAG,GAAQ,SAASS,GAAM,MAAO,CAACtC,EAAG,KAAK,CAACrB,IAAI,KAAO2D,EAAOP,GAAM,CAAClC,EAAIS,GAAG,QAAQN,EAAG,KAAK,CAACrB,IAAI,KAAO2D,EAAOP,GAAM,CAAClC,EAAIS,GAAG,QAAQN,EAAG,KAAK,CAACrB,IAAI,KAAO2D,EAAOP,GAAM,CAAClC,EAAIS,GAAG,QAAQN,EAAG,KAAK,CAACrB,IAAI,KAAO2D,EAAOP,GAAM,CAAClC,EAAIS,GAAG,QAAQN,EAAG,KAAK,CAACrB,IAAI,OAAS2D,EAAOP,GAAM,CAAClC,EAAIS,GAAG,gBAAcN,EAAG,MAAMH,EAAIS,GAAG,KAAKN,EAAG,OAAO,KAAKA,EAAG,QAAQH,EAAIgC,GAAIhC,EAAoB,kBAAE,SAAS0E,EAAIC,EAAOnC,GAAG,OAAOrC,EAAG,KAAK,CAACrB,IAAI6F,GAAQ,CAACxE,EAAG,KAAK,CAACE,YAAY,aAAa,CAACL,EAAIS,GAAGT,EAAIoC,GAAGI,EAAI,MAAMrC,EAAG,KAAK,CAAC2B,YAAY,CAAC,aAAa,SAAS,CAAC9B,EAAIS,GAAGT,EAAIoC,GAAGuC,MAAW3E,EAAIgC,GAAIhC,EAAqB,mBAAE,SAASiC,EAAMC,GAAM,MAAO,CAAClC,EAAIgC,GAAG,GAAQ,SAASS,GAAM,MAAO,CAACzC,EAAIgC,GAAG,CAAE,EAAE,EAAE,EAAE,IAAI,SAASyC,GAAG,OAAOtE,EAAG,KAAK,CAACrB,IAAI6F,EAASzC,EAAOO,EAAOgC,GAAG,CAACzE,EAAIS,GAAG,IAAIT,EAAIoC,GAAGpC,EAAIgD,YAAY0B,EAAKxC,EAAMO,EAAMgC,IAAI,UAAStE,EAAG,KAAK,CAACrB,IAAI,OAAS6F,EAASzC,EAAOO,GAAM,CAACzC,EAAIS,GAAG,IAAIT,EAAIoC,GAAGpC,EAAI4E,0BAA0BF,EAAKxC,EAAMO,IAAO,WAAUtC,EAAG,KAAK,CAACrB,IAAI,WAAa6F,EAASzC,GAAM,CAAClC,EAAIS,GAAG,IAAIT,EAAIoC,GAAGpC,EAAI6E,oBAAoBH,EAAKxC,IAAO,WAAU/B,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAGsC,EAAIjB,SAAStD,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAGsC,EAAIhB,UAAU,MAAK,KAAKvD,EAAG,MAAM,CAAC2B,YAAY,CAAC,gBAAgB,SAAS,CAAC3B,EAAG,WAAW,CAACE,YAAY,kBAAkBC,MAAM,CAAC,QAAU,WAAWe,GAAG,CAAC,MAAQrB,EAAIiE,WAAW,CAACjE,EAAIS,GAAG,0BAA0BN,EAAG,WAAW,CAACE,YAAY,kBAAkBC,MAAM,CAAC,QAAU,mBAAmBe,GAAG,CAAC,MAAQrB,EAAIkE,iBAAiB,CAAClE,EAAIS,GAAG,uBAAuB,MAAM,IAAa,IACtvI,EAAkB,GC+GtB,GACE,KAAF,uBACE,WAAF,GAEE,KAJF,WAKI,MAAJ,CACM,OAAN,KACM,WAAN,GACM,UAAN,KACM,cAAN,KACM,QAAN,KACM,gBAAN,GACM,WAAN,KACM,YAAN,KACM,QAAN,KACM,aAAN,EACM,SAAN,GACM,aAAN,GACM,sBAAN,KAGE,QAAF,CACI,oBADJ,SACA,KACM,IAAN,sBACM,OAAN,sCAEI,YALJ,SAKA,SAAM,IAAN,UACA,sMACM,MAAN,oCAEI,0BATJ,SASA,OAAM,IAAN,MACA,sIACM,OAAN,4CAEI,2BAbJ,SAaA,GACM,IAAN,UACA,aACA,UACM,GAAN,gBACM,IAAN,IACM,GAAN,gFAEQ,IADA,IAAR,IACA,cAAU,IAAV,EACA,kCACA,MACY,GAAZ,EACY,KAGJ,GAAR,eACQ,GAAR,OAEQ,IAAR,kBAAU,IAAV,EACA,kCACU,GAAV,WAGM,OAAN,8BAEI,qBAtCJ,SAsCA,GAAM,IAAN,OACA,+BACM,IAAN,qBACM,IAAN,IAIM,OAHA,EAAN,qBACQ,GAAR,gDAEA,wBAEI,wBA/CJ,SA+CA,GAAM,IAAN,OACA,yBACM,IAAN,sBACM,IAAN,IAIM,OAHA,EAAN,qBACQ,GAAR,0CAEA,wBAEI,gBAxDJ,SAwDA,GACM,IAAN,IAKM,OAJA,OAAN,mDACA,2BACA,8BAEA,GAEI,yBAhEJ,SAgEA,OAAM,IAAN,OACA,IAiBM,OAhBA,OAAN,mDAAQ,IAAR,QACA,+FACA,6GACA,sBACA,OACA,qCACA,iEACA,+DACA,qEAHA,KAKA,sCACA,mEACA,iEACA,uEAHA,QAMA,GAEI,mBApFJ,SAoFA,GAAM,IAAN,OACA,IAmBM,OAlBA,OAAN,mDACQ,EAAR,2CAAU,IAAV,gCACA,+FACA,6GACA,sBACsB,IAAR0D,GACW,SAATC,GAAmBC,EAAO,EAA1C,qBACA,iEACA,+DACA,qEAHA,KAKyB,SAATD,GAAmBC,EAAO,EAA1C,sBACA,mEACA,iEACA,uEAHA,WAOA,GAEI,YA1GJ,SA0GA,GACM,OAAN,WACA,WACA,WACA,IAEI,0BAhHJ,SAgHA,KAAM,IAAN,OACA,IAiBM,OAhBA,KAAN,2CAAQ,IAAR,gCACA,+FACA,6GACA,sBACA,OACA,qCACA,iEACA,+DACA,qEAHA,KAKA,sCACA,mEACA,iEACA,uEAHA,QAMA,GAEI,cApIJ,SAoIA,OAAM,IAAN,MACM,OAAN,iIAEI,gBAvIJ,SAuIA,OAAM,IAAN,IACA,mGACM,MAAN,wCAEI,oBA3IJ,SA2IA,OAAM,IAAN,IACA,uGACM,MAAN,wCAEI,aA/IJ,SA+IA,SAAM,IAAN,IACA,6GACM,OAAN,MACA,4CACA,8CACA,4CACA,iDACA,kBAEA,6CACA,+CACA,6CACA,kDACA,mBAGI,oBA/JJ,SA+JA,GACM,OAAN,4CACA,8CACA,4CACA,iDACA,mBAEI,qBAtKJ,WAsKM,IAAN,OAAM,OAAN,yIACA,iBACA,mGACA,gBAHA,wBAIA,sGACA,gDACA,kBACA,yBAGA,2BAVA,SAWA,IACA,+EACA,kBACA,cACA,sFACA,kBAEA,iBAEA,kCACA,aACA,sCAMA,mBACA,gIACA,oBA9BA,cAgCA,cAhCA,UAiCA,IACA,yIACA,kBACA,cACA,+FACA,kBAEA,kBACA,4BAIA,mBACA,yIACA,oBA/CA,QAmDA,iBAnDA,+CAqDI,SA3NJ,WA4NM,IAAN,wCACA,iDACA,4CACA,uCACM,EAAN,y6BAsBA,oCAtBA,qCAsBA,EAtBA,qBAsBA,gBAtBA,qBAsBA,iBAtBA,0BAsBA,2BAtBA,uBAsBA,eAtBA,2BAuBA,EAvBA,2EAwBA,EAxBA,+CA2BM,EAAN,iBACM,EAAN,SAEI,eA9PJ,WA+PM,IAAN,kCACA,8BACM,EAAN,8BAEI,UAnQJ,SAmQA,GACM,IAAN,2CACM,OAAN,+BAEI,sBAvQJ,WAuQM,IAAN,OAAM,OAAN,sIACA,qBACA,gDACA,qBACA,0EAJA,8CAQI,iBA/QJ,WA+QM,IAAN,OAAM,OAAN,sIACA,gBACA,+CACA,6DAHA,8CAMI,oBArRJ,WAqRM,IAAN,OAAM,OAAN,sIACA,mBACA,6CACA,mEAHA,8CAMI,iBA3RJ,SA2RA,OACM,KAAN,kBAAQ,MAAR,EAAQ,QAAR,EAAQ,QAAR,uBAAQ,OAAR,EAAQ,cAAR,IAAQ,aAAR,MAGE,SAAF,CACI,iBADJ,WACM,IAAN,OACA,KA0BM,OAzBA,KAAN,8BACQ,IAAR,2JACA,OACU,EAAV,IAAY,KAAZ,EAAY,KAAZ,EAAY,MAAZ,KAEA,gBACU,EAAV,aAAY,YAAZ,KAEA,+BACU,EAAV,4BACY,SAAZ,GACY,MAAZ,EACY,MAAZ,CAAc,EAAd,sBAAc,EAAd,sBAAc,EAAd,sBAAc,EAAd,yBAGQ,IAAR,IAEU,EADV,OACA,aAEA,QAEQ,EAAR,yCACQ,EAAR,cACQ,EAAR,iBAEA,GAMI,0BAlCJ,WAmCM,IAAN,sDAAQ,OAAR,WACM,OAAN,QAEI,qBAtCJ,WAsCM,IAAN,OACA,yDAAQ,IAAR,oCACA,2CACQ,MAAR,CAAU,OAAV,EAAU,SAAV,iBAGM,EAAN,oBAAQ,OAAR,yBACM,IAAN,KACA,IACA,IACA,OASM,OARA,EAAN,qBACA,iBACU,EAAV,EACU,EAAV,YAEQ,EAAR,YACQ,OAER,GAEI,kBA3DJ,WA4DM,IAAN,KAKM,OAJA,KAAN,2CAAQ,IAAR,wBACA,gBACQ,EAAR,cAEA,IAGE,YAxXF,WAyXI,KAAJ,mBACI,KAAJ,sBACI,KAAJ,+EC3e4X,ICQxX,G,UAAY,eACd,EACA,EACA,GACA,EACA,KACA,WACA,OAIa,I,QCnBX,EAAS,WAAa,IAAIrE,EAAIP,KAASQ,EAAGD,EAAIE,eAAmBC,EAAGH,EAAII,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACA,EAAG,QAAQ,CAACE,YAAY,QAAQ,CAACF,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,OAAO,CAACH,EAAG,SAAS,CAACI,YAAYP,EAAIQ,GAAG,CAAC,CAAC1B,IAAI,SAASS,GAAG,WAAW,MAAO,CAACY,EAAG,KAAK,CAACE,YAAY,QAAQ,CAACF,EAAG,SAAS,CAACG,MAAM,CAAC,KAAO,iBAAiB,cAAc,UAAUN,EAAIS,GAAG,2BAA2B,KAAKC,OAAM,MAAS,CAACP,EAAG,cAAc,CAACA,EAAG,QAAQ,CAACA,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,MAAM,CAACH,EAAG,eAAe,CAACE,YAAY,WAAWC,MAAM,CAAC,MAAQ,WAAW,YAAY,YAAY,CAACH,EAAG,gBAAgB,CAACQ,IAAI,UAAUL,MAAM,CAAC,GAAK,UAAU,QAAUN,EAAIoB,eAAeC,GAAG,CAAC,OAAS,SAASC,GAAQtB,EAAIuB,OAAO,KAAKvB,EAAIwB,QAAQ,OAAOX,MAAM,CAAC5B,MAAOe,EAAa,UAAEc,SAAS,SAAUC,GAAMf,EAAIyB,UAAUV,GAAKE,WAAW,gBAAgB,IAAI,GAAGd,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,MAAM,CAACH,EAAG,eAAe,CAACE,YAAY,WAAWC,MAAM,CAAC,MAAQ,sBAAsB,YAAY,UAAU,CAACH,EAAG,gBAAgB,CAACQ,IAAI,QAAQL,MAAM,CAAC,GAAK,QAAQ,QAAUN,EAAI0B,WAAW,SAA0B,MAAf1B,EAAIyB,WAAgCJ,GAAG,CAAC,OAAS,SAASC,GAAQtB,EAAIwB,QAAQ,KAAKxB,EAAI2B,0BAA0Bd,MAAM,CAAC5B,MAAOe,EAAU,OAAEc,SAAS,SAAUC,GAAMf,EAAIuB,OAAOR,GAAKE,WAAW,aAAa,IAAI,GAAGd,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,MAAM,CAACH,EAAG,eAAe,CAACE,YAAY,WAAWC,MAAM,CAAC,MAAQ,uBAAuB,YAAY,WAAW,CAACH,EAAG,gBAAgB,CAACQ,IAAI,SAASL,MAAM,CAAC,GAAK,SAAS,QAAUN,EAAI4B,gBAAgB,SAAuB,MAAZ5B,EAAIuB,QAA6BF,GAAG,CAAC,OAAS,SAASC,GAAQ,OAAOtB,EAAI6B,yBAAyBhB,MAAM,CAAC5B,MAAOe,EAAW,QAAEc,SAAS,SAAUC,GAAMf,EAAIwB,QAAQT,GAAKE,WAAW,cAAc,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,GAAGd,EAAG,QAAQ,CAACA,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,OAAO,CAAEN,EAAe,YAAEG,EAAG,MAAM,CAACA,EAAG,MAAM,CAACE,YAAY,gCAAgC,CAACF,EAAG,YAAY,CAAC2B,YAAY,CAAC,MAAQ,OAAO,OAAS,QAAQxB,MAAM,CAAC,MAAQ,aAAaH,EAAG,MAAMA,EAAG,SAAS,CAACH,EAAIS,GAAG,0BAA0B,KAAKT,EAAIkB,QAAQ,GAAKlB,EAAI+B,aAA4B,MAAb/B,EAAIwB,QAAolFxB,EAAIkB,KAAzkFf,EAAG,QAAQ,CAACA,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,OAAO,CAACH,EAAG,QAAQ,CAACE,YAAY,kBAAkBC,MAAM,CAAC,OAAS,IAAI,YAAc,IAAI,YAAc,MAAM,CAACH,EAAG,QAAQ,CAACA,EAAG,KAAK,CAACA,EAAG,KAAK,CAACG,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAG,OAAON,EAAG,KAAK,CAACG,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAG,gBAAgBT,EAAIgC,GAAIhC,EAAsB,oBAAE,SAASyC,EAAKD,GAAG,MAAO,CAACrC,EAAG,KAAK,CAACrB,IAAI,QAAU0D,EAAElC,MAAM,CAAC,QAAgC,EAAtBN,EAAI6F,SAAS1D,SAAa,CAACnC,EAAIS,GAAGT,EAAIoC,GAAGK,EAAKqD,mBAAkB3F,EAAG,KAAK,CAACG,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAG,QAAQN,EAAG,KAAK,CAACG,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAG,QAAQN,EAAG,KAAK,CAACG,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAG,QAAQ,GAAGN,EAAG,KAAK,CAACH,EAAIgC,GAAIhC,EAAsB,oBAAE,SAASyC,EAAKD,GAAG,MAAO,CAACxC,EAAIgC,GAAIhC,EAAY,UAAE,SAASyE,GAAG,MAAO,CAACtE,EAAG,KAAK,CAACrB,IAAI,KAAO0D,EAAI,IAAMiC,EAAEnE,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAGT,EAAIoC,GAAGqC,eAAa,GAAGtE,EAAG,KAAK,CAACH,EAAIgC,GAAIhC,EAAsB,oBAAE,SAASyC,EAAKD,GAAG,MAAO,CAACxC,EAAIgC,GAAIhC,EAAY,UAAE,SAASyE,GAAG,MAAO,CAACtE,EAAG,KAAK,CAACrB,IAAI,SAAW0D,EAAI,IAAMiC,GAAG,CAACzE,EAAIS,GAAG,OAAON,EAAG,KAAK,CAACrB,IAAI,SAAW0D,EAAI,IAAMiC,GAAG,CAACzE,EAAIS,GAAG,gBAAc,KAAKN,EAAG,QAAQ,CAACH,EAAIgC,GAAIhC,EAAwB,sBAAE,SAAS0E,EAAIqB,GAAM,OAAO5F,EAAG,KAAK,CAACrB,IAAI4F,EAAI9B,YAAY,CAACzC,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAG2D,EAAO,MAAM5F,EAAG,KAAK,CAAC2B,YAAY,CAAC,aAAa,SAAS,CAAC9B,EAAIS,GAAGT,EAAIoC,GAAGsC,EAAI9B,eAAe5C,EAAIgC,GAAIhC,EAAsB,oBAAE,SAASyC,EAAKD,GAAG,MAAO,CAACxC,EAAIgC,GAAIhC,EAAY,UAAE,SAASyE,GAAG,MAAO,CAACtE,EAAG,KAAK,CAACrB,IAAI0D,EAAI,KAAOkC,EAAI9B,WAAaH,EAAKqD,WAAarB,GAAG,CAACzE,EAAIS,GAAGT,EAAIoC,GAAGpC,EAAIgG,YAAYtB,EAAKjC,EAAMgC,EAAG,YAAYtE,EAAG,KAAK,CAACrB,IAAI0D,EAAI,KAAOkC,EAAI9B,WAAaH,EAAKqD,WAAarB,GAAG,CAACzE,EAAIS,GAAGT,EAAIoC,GAAGpC,EAAIgG,YAAYtB,EAAKjC,EAAMgC,EAAG,oBAAkBtE,EAAG,KAAK,CAACA,EAAG,SAAS,CAACH,EAAIS,GAAGT,EAAIoC,GAAGsC,EAAIuB,gBAAgB9F,EAAG,KAAK,CAACA,EAAG,SAAS,CAACH,EAAIS,GAAGT,EAAIoC,GAAGsC,EAAIwB,gBAAgB/F,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAG2D,EAAO,OAAO,MAAK5F,EAAG,KAAK,CAAC2B,YAAY,CAAC,mBAAmB,UAAU,cAAc,SAAS,CAAC3B,EAAG,KAAK,CAACG,MAAM,CAAC,QAAU,MAAM,CAACH,EAAG,SAAS,CAACH,EAAIS,GAAG,eAAeT,EAAIgC,GAAIhC,EAAsB,oBAAE,SAASyC,EAAKD,GAAG,MAAO,CAACxC,EAAIgC,GAAIhC,EAAY,UAAE,SAASyE,GAAG,MAAO,CAACtE,EAAG,KAAK,CAACrB,IAAI0D,EAAI,KAAOC,EAAKqD,WAAarB,GAAG,CAACzE,EAAIS,GAAGT,EAAIoC,GAAGpC,EAAImG,iBAAiB1D,EAAMgC,EAAG,YAAYtE,EAAG,KAAK,CAACrB,IAAI0D,EAAI,KAAOC,EAAKqD,WAAarB,GAAG,CAACzE,EAAIS,GAAGT,EAAIoC,GAAGpC,EAAImG,iBAAiB1D,EAAMgC,EAAG,oBAAkBtE,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAGpC,EAAIoG,gBAAgB,iBAAiBjG,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAGpC,EAAIoG,gBAAgB,kBAAkB,IAAI,KAAKjG,EAAG,MAAM,CAAC2B,YAAY,CAAC,gBAAgB,SAAS,CAAC3B,EAAG,WAAW,CAACE,YAAY,kBAAkBC,MAAM,CAAC,QAAU,WAAWe,GAAG,CAAC,MAAQrB,EAAIiE,WAAW,CAACjE,EAAIS,GAAG,0BAA0BN,EAAG,WAAW,CAACE,YAAY,kBAAkBC,MAAM,CAAC,QAAU,mBAAmBe,GAAG,CAAC,MAAQrB,EAAIkE,iBAAiB,CAAClE,EAAIS,GAAG,uBAAuB,MAAM,IAAa,IAC5iJ,EAAkB,GC8GtB,G,oBAAA,CACE,KAAF,YACE,MAAF,GAEE,WAAF,GAEE,KANF,WAOI,MAAJ,CACM,OAAN,KACM,WAAN,GACM,UAAN,KACM,cAAN,KACM,QAAN,KACM,gBAAN,GACM,WAAN,KACM,YAAN,KACM,QAAN,KACM,aAAN,EACM,eAAN,GACM,aAAN,GACM,sBAAN,GACM,iBAAN,GACM,UAAN,KAGE,QAAF,CACI,gBADJ,SACA,GACM,OAAN,gDAAQ,OAAO4F,GAAf,yBAEI,iBAJJ,SAIA,OACM,IAAN,gDACA,kDAAQ,IAAR,MACA,6GACQ,OAAR,qBACA,GACM,OAAN,GAEI,YAZJ,SAYA,SACM,IAAE,IAAR,MACQ,OAAR,2HACA,SACQ,MAAR,KAGI,qBAnBJ,WAmBM,IAAN,OAAM,OAAN,yIACA,iBACA,mGACA,gBAHA,wBAIA,sGACA,gDACA,kBACA,yBAGA,sBAVA,SAWA,IACA,+GACA,kBACA,aACA,6EAEA,kBACA,oCAIA,mBACA,0HAvBA,cAyBA,2BAzBA,UA0BA,IACA,+EACA,kBACA,cACA,sFACA,kBAEA,kBACA,yCAIA,mBACA,gIACA,oBAxCA,eA0CA,oBA1CA,UA2CA,IACA,qIACA,kBACA,cACA,6FACA,kBAEA,kBACA,kCAIA,mBACA,uIACA,oBAzDA,QA+DA,iBA/DA,+CAiEI,SApFJ,WAqFM,IAAN,wCACA,6BACA,4CACA,oCACM,EAAN,0eAaA,oCAbA,qCAaA,EAbA,qBAaA,gBAbA,qBAaA,iBAbA,0BAaA,2BAbA,uBAaA,eAbA,2BAcA,EAdA,2EAeA,EAfA,+CAkBM,EAAN,iBACM,EAAN,SAEI,eA9GJ,WA+GM,IAAN,kCACA,8BACM,EAAN,kCAEI,sBAnHJ,WAmHM,IAAN,OAAM,OAAN,sIACA,qBACA,gDACA,qBACA,0EAJA,8CAQI,iBA3HJ,WA2HM,IAAN,OAAM,OAAN,sIACA,gBACA,+CACA,6DAHA,8CAMI,oBAjIJ,WAiIM,IAAN,OAAM,OAAN,sIACA,mBACA,6CACA,mEAHA,8CAMI,iBAvIJ,SAuIA,OACM,KAAN,kBAAQ,MAAR,EAAQ,QAAR,EAAQ,QAAR,uBAAQ,OAAR,EAAQ,cAAR,IAAQ,aAAR,MAGE,SAAF,CACI,kBADJ,WACM,IAAN,OACA,KAaM,OAZA,KAAN,wCACQ,IAAR,eACQ,EAAR,MACQ,EAAR,8BACU,IAAV,QACU,EAAV,0CAAY,IAAZ,YACY,IAAZ,iHACY,IAAZ,oHAEU,EAAV,OAAY,KAAZ,EAAY,KAAZ,SAGA,GAEI,SAjBJ,WAkBM,OAAN,YAAQ,OAAR,+BAAQ,MAAO,IAAf,gBAEI,mBApBJ,WAqBM,OAAN,+CAAQ,OAAR,MAAe,EAAf,UAEI,qBAvBJ,WAuBM,IAAN,OACM,OAAN,uCACQ,IAAR,GACU,WAAV,aACU,YAAV,GACU,UAAV,EACU,UAAV,GAkBQ,OAhBA,EAAR,wCACU,IAAV,eACU,EAAV,kBACU,EAAV,8BACY,IAAZ,qCAAc,OACd,+BACA,kBACA,oCAEA,0CACA,0CACY,EAAZ,mBAAc,KAAd,EAAc,KAAd,GACY,EAAZ,aACY,EAAZ,mBAGA,OAIE,YAvNF,WAwNI,KAAJ,mBACI,KAAJ,sBACI,KAAJ,gFCzUwX,ICQpX,G,UAAY,eACd,EACA,EACA,GACA,EACA,KACA,WACA,OAIa,I,QCnBX,EAAS,WAAa,IAAIrG,EAAIP,KAASQ,EAAGD,EAAIE,eAAmBC,EAAGH,EAAII,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACA,EAAG,QAAQ,CAACE,YAAY,QAAQ,CAACF,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,OAAO,CAACH,EAAG,SAAS,CAACI,YAAYP,EAAIQ,GAAG,CAAC,CAAC1B,IAAI,SAASS,GAAG,WAAW,MAAO,CAACY,EAAG,KAAK,CAACE,YAAY,QAAQ,CAACF,EAAG,SAAS,CAACG,MAAM,CAAC,KAAO,iBAAiB,cAAc,UAAUN,EAAIS,GAAG,sCAAsC,KAAKC,OAAM,MAAS,CAACP,EAAG,cAAc,CAACA,EAAG,QAAQ,CAACA,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,MAAM,CAACH,EAAG,eAAe,CAACE,YAAY,WAAWC,MAAM,CAAC,MAAQ,WAAW,YAAY,YAAY,CAACH,EAAG,gBAAgB,CAACQ,IAAI,UAAUL,MAAM,CAAC,GAAK,UAAU,QAAUN,EAAIoB,eAAeC,GAAG,CAAC,OAAS,SAASC,GAAQtB,EAAIuB,OAAO,KAAKvB,EAAIwB,QAAQ,OAAOX,MAAM,CAAC5B,MAAOe,EAAa,UAAEc,SAAS,SAAUC,GAAMf,EAAIyB,UAAUV,GAAKE,WAAW,gBAAgB,IAAI,GAAGd,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,MAAM,CAACH,EAAG,eAAe,CAACE,YAAY,WAAWC,MAAM,CAAC,MAAQ,sBAAsB,YAAY,UAAU,CAACH,EAAG,gBAAgB,CAACQ,IAAI,QAAQL,MAAM,CAAC,GAAK,QAAQ,QAAUN,EAAI0B,WAAW,SAA0B,MAAf1B,EAAIyB,WAAgCJ,GAAG,CAAC,OAAS,SAASC,GAAQtB,EAAIwB,QAAQ,KAAKxB,EAAI2B,0BAA0Bd,MAAM,CAAC5B,MAAOe,EAAU,OAAEc,SAAS,SAAUC,GAAMf,EAAIuB,OAAOR,GAAKE,WAAW,aAAa,IAAI,GAAGd,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,MAAM,CAACH,EAAG,eAAe,CAACE,YAAY,WAAWC,MAAM,CAAC,MAAQ,uBAAuB,YAAY,WAAW,CAACH,EAAG,gBAAgB,CAACQ,IAAI,SAASL,MAAM,CAAC,GAAK,SAAS,QAAUN,EAAI4B,gBAAgB,SAAuB,MAAZ5B,EAAIuB,QAA6BF,GAAG,CAAC,OAAS,SAASC,GAAQ,OAAOtB,EAAI6B,yBAAyBhB,MAAM,CAAC5B,MAAOe,EAAW,QAAEc,SAAS,SAAUC,GAAMf,EAAIwB,QAAQT,GAAKE,WAAW,cAAc,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,GAAGd,EAAG,QAAQ,CAACA,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,OAAO,CAAEN,EAAe,YAAEG,EAAG,MAAM,CAACA,EAAG,MAAM,CAACE,YAAY,gCAAgC,CAACF,EAAG,YAAY,CAAC2B,YAAY,CAAC,MAAQ,OAAO,OAAS,QAAQxB,MAAM,CAAC,MAAQ,aAAaH,EAAG,MAAMA,EAAG,SAAS,CAACH,EAAIS,GAAG,0BAA0B,KAAKT,EAAIkB,QAAQ,GAAKlB,EAAI+B,aAA4B,MAAb/B,EAAIwB,QAAo2ExB,EAAIkB,KAAz1Ef,EAAG,QAAQ,CAACA,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,OAAO,CAACH,EAAG,QAAQ,CAACE,YAAY,kBAAkBC,MAAM,CAAC,OAAS,IAAI,YAAc,IAAI,YAAc,MAAM,CAACH,EAAG,QAAQ,CAACA,EAAG,KAAK,CAACA,EAAG,KAAK,CAACG,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAG,OAAON,EAAG,KAAK,CAACG,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAG,gBAAgBT,EAAIgC,GAAIhC,EAAsB,oBAAE,SAASyC,EAAKD,GAAG,MAAO,CAACrC,EAAG,KAAK,CAACrB,IAAI,QAAU0D,EAAElC,MAAM,CAAC,QAAU,IAAI,CAACN,EAAIS,GAAGT,EAAIoC,GAAGK,EAAKqD,mBAAkB3F,EAAG,KAAK,CAACG,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAG,aAAaN,EAAG,KAAK,CAACG,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAG,aAAaN,EAAG,KAAK,CAACG,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAG,QAAQ,GAAGN,EAAG,KAAK,CAACH,EAAIgC,GAAIhC,EAAsB,oBAAE,SAASyC,EAAKD,GAAG,MAAO,CAACrC,EAAG,KAAK,CAACrB,IAAI,SAAW0D,GAAG,CAACxC,EAAIS,GAAG,QAAQN,EAAG,KAAK,CAACrB,IAAI,SAAW0D,GAAG,CAACxC,EAAIS,GAAG,aAAY,KAAKN,EAAG,QAAQ,CAACH,EAAIgC,GAAIhC,EAAyB,uBAAE,SAAS0E,EAAIqB,GAAM,OAAO5F,EAAG,KAAK,CAACrB,IAAI4F,EAAI4B,aAAa,CAACnG,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAG2D,EAAO,MAAM5F,EAAG,KAAK,CAAC2B,YAAY,CAAC,aAAa,SAAS,CAAC9B,EAAIS,GAAGT,EAAIoC,GAAGsC,EAAI9B,eAAe5C,EAAIgC,GAAIhC,EAAsB,oBAAE,SAASyC,EAAKD,GAAG,MAAO,CAACrC,EAAG,KAAK,CAACrB,IAAI0D,EAAI,KAAOkC,EAAI9B,WAAaH,EAAKqD,YAAY,CAAC9F,EAAIS,GAAGT,EAAIoC,GAAGpC,EAAIgG,YAAYtB,EAAKjC,EAAM,YAAYtC,EAAG,KAAK,CAACrB,IAAI0D,EAAI,KAAOkC,EAAI9B,WAAaH,EAAKqD,YAAY,CAAC9F,EAAIS,GAAGT,EAAIoC,GAAGpC,EAAIgG,YAAYtB,EAAKjC,EAAM,gBAAetC,EAAG,KAAK,CAACA,EAAG,SAAS,CAACH,EAAIS,GAAGT,EAAIoC,GAAGsC,EAAIuB,gBAAgB9F,EAAG,KAAK,CAACA,EAAG,SAAS,CAACH,EAAIS,GAAGT,EAAIoC,GAAGsC,EAAIwB,gBAAgB/F,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAG2D,EAAO,OAAO,MAAK5F,EAAG,KAAK,CAAC2B,YAAY,CAAC,mBAAmB,UAAU,cAAc,SAAS,CAAC3B,EAAG,KAAK,CAACG,MAAM,CAAC,QAAU,MAAM,CAACH,EAAG,SAAS,CAACH,EAAIS,GAAG,eAAeT,EAAIgC,GAAIhC,EAAsB,oBAAE,SAASyC,EAAKD,GAAG,MAAO,CAACrC,EAAG,KAAK,CAACrB,IAAI0D,EAAI,KAAOC,EAAKqD,YAAY,CAAC9F,EAAIS,GAAGT,EAAIoC,GAAGpC,EAAIuG,qBAAqB9D,EAAKqD,YAAYrC,SAAStD,EAAG,KAAK,CAACrB,IAAI0D,EAAI,KAAOC,EAAKqD,YAAY,CAAC9F,EAAIS,GAAGT,EAAIoC,GAAGpC,EAAIuG,qBAAqB9D,EAAKqD,YAAYpC,aAAYvD,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAGpC,EAAIwG,sBAAsBC,QAAO,SAAUC,EAAKhC,GAAO,OAAOgC,EAAMhC,EAAIuB,YAAc,OAAO9F,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAGpC,EAAIwG,sBAAsBC,QAAO,SAAUC,EAAKhC,GAAO,OAAOgC,EAAMhC,EAAIwB,YAAc,OAAO/F,EAAG,OAAO,IAAI,KAAKA,EAAG,MAAM,CAAC2B,YAAY,CAAC,gBAAgB,SAAS,CAAC3B,EAAG,WAAW,CAACE,YAAY,kBAAkBC,MAAM,CAAC,QAAU,WAAWe,GAAG,CAAC,MAAQrB,EAAIiE,WAAW,CAACjE,EAAIS,GAAG,0BAA0BN,EAAG,WAAW,CAACE,YAAY,kBAAkBC,MAAM,CAAC,QAAU,mBAAmBe,GAAG,CAAC,MAAQrB,EAAIkE,iBAAiB,CAAClE,EAAIS,GAAG,uBAAuB,MAAM,IAAa,IACv0I,EAAkB,GCkGtB,GACE,KAAF,oBACE,MAAF,GAEE,WAAF,GAEE,KANF,WAOI,MAAJ,CACM,OAAN,KACM,WAAN,GACM,UAAN,KACM,cAAN,KACM,QAAN,KACM,gBAAN,GACM,WAAN,KACM,YAAN,KACM,QAAN,KACM,aAAN,EACM,eAAN,GACM,aAAN,GACM,sBAAN,GACM,iBAAN,GACM,UAAN,KAGE,QAAF,CACI,YADJ,SACA,OAAM,IAAN,UACA,gDACM,OAAN,0OAEI,qBALJ,WAKM,IAAN,OAAM,OAAN,yIACA,iBACA,mGACA,gBAHA,wBAIA,sGACA,gDACA,kBACA,yBAGA,sBAVA,SAWA,IACA,+GACA,kBACA,aACA,6EAEA,kBACA,oCAIA,mBACA,0HAvBA,cAyBA,2BAzBA,UA0BA,IACA,+EACA,kBACA,cACA,sFACA,kBAEA,kBACA,yCAIA,mBACA,gIACA,oBAxCA,eA0CA,oBA1CA,UA2CA,IACA,sIACA,kBACA,cACA,gGACA,kBAEA,kBACA,kCAIA,mBACA,0IACA,oBAzDA,QA+DA,iBA/DA,+CAiEI,SAtEJ,WAuEM,IAAN,wCACA,wCACA,4CACA,oCACM,EAAN,0eAaA,oCAbA,qCAaA,EAbA,qBAaA,gBAbA,qBAaA,iBAbA,0BAaA,2BAbA,uBAaA,eAbA,2BAcA,EAdA,2EAeA,EAfA,+CAkBM,EAAN,iBACM,EAAN,SAEI,eAhGJ,WAiGM,IAAN,kCACA,8BACM,EAAN,kCAEI,sBArGJ,WAqGM,IAAN,OAAM,OAAN,sIACA,qBACA,gDACA,qBACA,0EAJA,8CAQI,iBA7GJ,WA6GM,IAAN,OAAM,OAAN,sIACA,gBACA,+CACA,6DAHA,8CAMI,oBAnHJ,WAmHM,IAAN,OAAM,OAAN,sIACA,mBACA,6CACA,mEAHA,8CAMI,iBAzHJ,SAyHA,OACM,KAAN,kBAAQ,MAAR,EAAQ,QAAR,EAAQ,QAAR,uBAAQ,OAAR,EAAQ,cAAR,IAAQ,aAAR,MAGE,SAAF,CACI,mBADJ,WAEM,OAAN,+CAAQ,OAAR,MAAe,EAAf,UAEI,sBAJJ,WAIM,IAAN,OACM,OAAN,uCACQ,IAAR,GACU,WAAV,aACU,YAAV,cACU,YAAV,GACU,UAAV,EACU,UAAV,GAeQ,OAbA,EAAR,wCACU,IAAV,uCAAY,OACZ,+BACA,6BACA,0BAEA,0BAAY,OAAZ,6BACA,0BAAY,OAAZ,6BAEU,EAAV,2BAAY,KAAZ,EAAY,KAAZ,GACU,EAAV,aACU,EAAV,gBAEA,MAGI,qBA7BJ,WA6BM,IAAN,OACA,KASM,OARA,KAAN,wCACQ,IAAR,QACQ,EAAR,2CAAU,IAAV,IACU,IAAV,qEACU,IAAV,wEAEQ,EAAR,eAAU,KAAV,EAAU,KAAV,MAEA,IAGE,YAhMF,WAiMI,KAAJ,mBACI,KAAJ,sBACI,KAAJ,+ECtSyX,ICQrX,G,UAAY,eACd,EACA,EACA,GACA,EACA,KACA,WACA,OAIa,K,QCnBX,GAAS,WAAa,IAAIT,EAAIP,KAASQ,EAAGD,EAAIE,eAAmBC,EAAGH,EAAII,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACA,EAAG,QAAQ,CAACE,YAAY,QAAQ,CAACF,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,OAAO,CAACH,EAAG,SAAS,CAACI,YAAYP,EAAIQ,GAAG,CAAC,CAAC1B,IAAI,SAASS,GAAG,WAAW,MAAO,CAACY,EAAG,KAAK,CAACE,YAAY,QAAQ,CAACF,EAAG,SAAS,CAACG,MAAM,CAAC,KAAO,iBAAiB,cAAc,UAAUN,EAAIS,GAAG,mCAAmC,KAAKC,OAAM,GAAM,CAAC5B,IAAI,SAASS,GAAG,WAAW,MAAO,CAACY,EAAG,KAAK,CAACH,EAAIS,GAAG,oCAAoCC,OAAM,MAAS,CAACP,EAAG,cAAc,CAACA,EAAG,QAAQ,CAACA,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,MAAM,CAACH,EAAG,eAAe,CAACE,YAAY,WAAWC,MAAM,CAAC,MAAQ,sBAAsB,YAAY,UAAU,CAACH,EAAG,gBAAgB,CAACQ,IAAI,QAAQL,MAAM,CAAC,GAAK,QAAQ,QAAUN,EAAI0B,YAAYL,GAAG,CAAC,OAAS,SAASC,GAAQtB,EAAIwB,QAAQ,KAAKxB,EAAIsG,YAAY,KAAKtG,EAAI2B,0BAA0Bd,MAAM,CAAC5B,MAAOe,EAAU,OAAEc,SAAS,SAAUC,GAAMf,EAAIuB,OAAOR,GAAKE,WAAW,aAAa,IAAI,GAAGd,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,MAAM,CAACH,EAAG,eAAe,CAACE,YAAY,WAAWC,MAAM,CAAC,MAAQ,uBAAuB,YAAY,WAAW,CAACH,EAAG,gBAAgB,CAACQ,IAAI,SAASL,MAAM,CAAC,GAAK,SAAS,QAAUN,EAAI4B,gBAAgB,SAAuB,MAAZ5B,EAAIuB,QAA6BF,GAAG,CAAC,OAAS,SAASC,GAAQtB,EAAIsG,YAAY,KAAKtG,EAAI2G,yBAAyB3G,EAAI4G,6BAA6B/F,MAAM,CAAC5B,MAAOe,EAAW,QAAEc,SAAS,SAAUC,GAAMf,EAAIwB,QAAQT,GAAKE,WAAW,cAAc,IAAI,GAAGd,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,MAAM,CAACH,EAAG,eAAe,CAACE,YAAY,WAAWC,MAAM,CAAC,MAAQ,4BAA4B,YAAY,UAAU,CAACH,EAAG,gBAAgB,CAACQ,IAAI,QAAQL,MAAM,CAAC,GAAK,QAAQ,QAAUN,EAAI6G,iBAAiB,SAAwB,MAAb7G,EAAIwB,SAA8BH,GAAG,CAAC,OAAS,SAASC,GAAQ,OAAOtB,EAAI8G,qBAAqBjG,MAAM,CAAC5B,MAAOe,EAAe,YAAEc,SAAS,SAAUC,GAAMf,EAAIsG,YAAYvF,GAAKE,WAAW,kBAAkB,IAAI,IAAI,GAAqB,MAAjBjB,EAAIsG,YAAmBnG,EAAG,MAAM,CAACA,EAAG,QAAQ,CAACA,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,OAAO,CAACH,EAAG,SAAS,GAAGA,EAAG,QAAQ,CAACA,EAAG,QAAQ,CAAEH,EAAe,YAAEG,EAAG,MAAM,CAACA,EAAG,MAAM,CAACE,YAAY,gCAAgC,CAACF,EAAG,YAAY,CAAC2B,YAAY,CAAC,MAAQ,OAAO,OAAS,QAAQxB,MAAM,CAAC,MAAQ,aAAaH,EAAG,MAAMA,EAAG,SAAS,CAACH,EAAIS,GAAG,2BAA2B,KAAKN,EAAG,MAAM,CAACA,EAAG,QAAQ,CAACE,YAAY,QAAQ,CAACF,EAAG,QAAQ,CAACA,EAAG,iBAAiB,CAACQ,IAAI,QAAQL,MAAM,CAAC,QAAUN,EAAI+G,cAAc,KAAO/G,EAAIgH,2BAA2B,WAAa,uCAAuC,gBAAe,GAAMzG,YAAYP,EAAIQ,GAAG,CAAC,CAAC1B,IAAI,YAAYS,GAAG,SAAS0H,GAAO,MAAO,CAAwB,oBAAtBA,EAAMC,OAAOC,MAA6BhH,EAAG,OAAO,CAACA,EAAG,OAAO,CAACH,EAAIS,GAAGT,EAAIoC,GAAG6E,EAAMG,IAAIC,uBAAuBrH,EAAIkB,KAA4B,iBAAtB+F,EAAMC,OAAOC,MAA0BhH,EAAG,OAAO,CAACA,EAAG,OAAO,CAACA,EAAG,IAAI,CAACH,EAAIS,GAAGT,EAAIoC,GAAG6E,EAAMG,IAAIE,sBAAsBtH,EAAIkB,KAA4B,aAAtB+F,EAAMC,OAAOC,MAAsBhH,EAAG,OAAO,CAACA,EAAG,OAAO,CAACA,EAAG,IAAI,CAACH,EAAIS,GAAGT,EAAIoC,GAAG6E,EAAMG,IAAIG,kBAAkBvH,EAAIkB,SAAS,MAAK,EAAM,YAAY,CAACf,EAAG,MAAM,CAACG,MAAM,CAAC,KAAO,cAAckH,KAAK,cAAc,CAACrH,EAAG,KAAK,CAACE,YAAY,oBAAoB,CAACL,EAAIS,GAAG,gDAAgD,GAAGN,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,OAAO,CAACH,EAAG,MAAM,CAAC2B,YAAY,CAAC,gBAAgB,SAAS,CAAC3B,EAAG,WAAW,CAACE,YAAY,kBAAkBC,MAAM,CAAC,QAAU,WAAWe,GAAG,CAAC,MAAQrB,EAAIiE,WAAW,CAACjE,EAAIS,GAAG,0BAA0BN,EAAG,WAAW,CAACE,YAAY,kBAAkBC,MAAM,CAAC,QAAU,mBAAmBe,GAAG,CAAC,MAAQrB,EAAIkE,iBAAiB,CAAClE,EAAIS,GAAG,uBAAuB,MAAM,IAAI,MAAM,IAAI,GAAGT,EAAIkB,MAAM,IAAI,IAAI,IAAI,IAAI,IACv4G,GAAkB,G,yBCmFtB,IACE,KAAF,eACE,WAAF,CACI,aAAJ,SAEE,KALF,WAMI,MAAJ,CACM,OAAN,KACM,WAAN,GACM,QAAN,KACM,gBAAN,GACM,YAAN,KACM,iBAAN,GACM,iBAAN,KACM,sBAAN,GACM,cAAN,CACA,CAAQ,MAAR,aAAQ,MAAR,mBAAQ,UAAR,GACA,CAAQ,MAAR,QAAQ,MAAR,gBAAQ,UAAR,GACA,CAAQ,MAAR,YAAQ,MAAR,YAAQ,UAAR,IAGM,MAAN,GACM,aAAN,EACM,2BAAN,KAGE,QAAF,CACI,SADJ,WAEM,IAAN,wCACA,kCACA,4CACA,gCACM,EAAN,4eAaA,oCAbA,qCAaA,EAbA,qBAaA,gBAbA,qBAaA,iBAbA,0BAaA,2BAbA,2BAaA,sBAbA,2BAcA,EAdA,2EAeA,EAfA,+CAkBM,EAAN,iBACM,EAAN,SAEI,eA3BJ,WA4BM,IAAN,kCACA,8BACM,EAAN,kCAEI,oCAhCJ,SAgCA,KAAM,IAAN,OAEA,KACM,EAAN,qBACQ,IAAR,oDACA,OACU,EAAV,IACY,YAAZ,cACY,WAAZ,aACY,aAAZ,eACY,MAAZ,QACY,KAAZ,OACY,SAAZ,wBACY,QAAZ,KAGQ,IAAR,0BACA,UACU,EAAV,sBAIM,IAAN,oCACQ,IAAR,sBAAU,OAAV,+BAEQ,IAAR,4BACQ,IAAR,kCAAU,OAAV,SACA,qEACA,uBACA,KAcQ,OAbR,WAEA,EADA,KACA,+BACA,iCACA,+BACA,WAEA,gCACA,kCACA,gCACA,YAGA,CACU,YAAV,cACU,mBAAV,uDACU,kBAAV,8DACU,cAAV,MACU,UAAV,EACU,aAAV,eACU,MAAV,QACU,KAAV,OACU,SAAV,WACU,MAAV,YAEA,oBAAQ,OAAR,YAEM,OAAN,sBAAQ,OAAO,EAAf,kBAEI,iBA3FJ,WA2FM,IAAN,OAAM,OAAN,yIACA,iBACA,WACA,mGACA,oBAJA,wBAKA,yGACA,sGACA,gDACA,kBACA,yBATA,SAYA,IACA,+IACA,kBACA,cACA,+FACA,kBAEA,kBACA,yBAIA,mBACA,yIACA,oBA1BA,OA6BA,sHA7BA,QA+BA,iBA/BA,+CAiCI,yBA5HJ,WA4HM,IAAN,OAAM,OAAN,6IACA,2BADA,SAEA,IACA,oFACA,kBACA,aACA,gFAEA,kBACA,yCAIA,mBACA,qIAdA,8CAkBI,uBA9IJ,WA8IM,IAAN,OAAM,OAAN,6IACA,sBADA,SAEA,IACA,gHACA,kBACA,aACA,6EAEA,iBACA,kCACA,uEAKA,mBACA,0HAhBA,8CAmBI,sBAjKJ,WAiKM,IAAN,OAAM,OAAN,sIACA,qBACA,gDACA,qBACA,0EAJA,8CAQI,iBAzKJ,WAyKM,IAAN,OAAM,OAAN,sIACA,gBACA,+CACA,6DAHA,8CAMI,oBA/KJ,SA+KA,OACM,GAAN,qBACQ,IAAR,2CACA,kBACA,sBACQ,IAAR,2CACA,eAGI,UAxLJ,SAwLA,GACM,IAAN,2CACM,OAAN,+BAEI,YA5LJ,SA4LA,GACM,IAAN,iCACA,uDACQ,EAAR,kBAGI,cAlMJ,SAkMA,GACM,IAAN,iCACA,+EACQ,EAAR,kBAGI,mBAxMJ,SAwMA,GACM,GAAN,kBACQ,MAAR,mCAGI,iBA7MJ,SA6MA,OACM,KAAN,kBAAQ,MAAR,EAAQ,QAAR,EAAQ,QAAR,uBAAQ,OAAR,EAAQ,cAAR,IAAQ,aAAR,MAGE,YA3OF,WA4OA,2FACM,KAAN,mBACM,KAAN,8EAGM,KAAN,8BAGE,SAAF,ICxUoX,MCOhX,GAAY,eACd,GACA,GACA,IACA,EACA,KACA,KACA,MAIa,M,QClBX,GAAS,WAAa,IAAIlB,EAAIP,KAASQ,EAAGD,EAAIE,eAAmBC,EAAGH,EAAII,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACA,EAAG,QAAQ,CAACE,YAAY,QAAQ,CAACF,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,OAAO,CAACH,EAAG,SAAS,CAACI,YAAYP,EAAIQ,GAAG,CAAC,CAAC1B,IAAI,SAASS,GAAG,WAAW,MAAO,CAACY,EAAG,KAAK,CAACE,YAAY,QAAQ,CAACF,EAAG,SAAS,CAACG,MAAM,CAAC,KAAO,iBAAiB,cAAc,UAAUN,EAAIS,GAAG,sDAAsD,KAAKC,OAAM,GAAM,CAAC5B,IAAI,SAASS,GAAG,WAAW,MAAO,CAACY,EAAG,KAAK,CAACH,EAAIS,GAAG,oCAAoCC,OAAM,MAAS,CAACP,EAAG,cAAc,CAACA,EAAG,QAAQ,CAACA,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,MAAM,CAACH,EAAG,eAAe,CAACE,YAAY,WAAWC,MAAM,CAAC,MAAQ,sBAAsB,YAAY,UAAU,CAACH,EAAG,gBAAgB,CAACQ,IAAI,QAAQL,MAAM,CAAC,GAAK,QAAQ,QAAUN,EAAI0B,YAAYL,GAAG,CAAC,OAAS,SAASC,GAAQtB,EAAIwB,QAAQ,KAAKxB,EAAIsG,YAAY,KAAKtG,EAAI2B,0BAA0Bd,MAAM,CAAC5B,MAAOe,EAAU,OAAEc,SAAS,SAAUC,GAAMf,EAAIuB,OAAOR,GAAKE,WAAW,aAAa,IAAI,GAAGd,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,MAAM,CAACH,EAAG,eAAe,CAACE,YAAY,WAAWC,MAAM,CAAC,MAAQ,uBAAuB,YAAY,WAAW,CAACH,EAAG,gBAAgB,CAACQ,IAAI,SAASL,MAAM,CAAC,GAAK,SAAS,QAAUN,EAAI4B,gBAAgB,SAAuB,MAAZ5B,EAAIuB,QAA6BF,GAAG,CAAC,OAAS,SAASC,GAAQtB,EAAIsG,YAAY,KAAKtG,EAAI2G,yBAAyB3G,EAAI4G,6BAA6B/F,MAAM,CAAC5B,MAAOe,EAAW,QAAEc,SAAS,SAAUC,GAAMf,EAAIwB,QAAQT,GAAKE,WAAW,cAAc,IAAI,GAAGd,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,MAAM,CAACH,EAAG,eAAe,CAACE,YAAY,WAAWC,MAAM,CAAC,MAAQ,4BAA4B,YAAY,UAAU,CAACH,EAAG,gBAAgB,CAACQ,IAAI,QAAQL,MAAM,CAAC,GAAK,QAAQ,QAAUN,EAAI6G,iBAAiB,SAAwB,MAAb7G,EAAIwB,SAA8BH,GAAG,CAAC,OAAS,SAASC,GAAQ,OAAOtB,EAAI8G,qBAAqBjG,MAAM,CAAC5B,MAAOe,EAAe,YAAEc,SAAS,SAAUC,GAAMf,EAAIsG,YAAYvF,GAAKE,WAAW,kBAAkB,IAAI,IAAI,GAAqB,MAAjBjB,EAAIsG,YAAmBnG,EAAG,MAAM,CAACA,EAAG,QAAQ,CAACA,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,OAAO,CAACH,EAAG,SAAS,GAAGA,EAAG,QAAQ,CAACA,EAAG,QAAQ,CAAEH,EAAe,YAAEG,EAAG,MAAM,CAACA,EAAG,MAAM,CAACE,YAAY,gCAAgC,CAACF,EAAG,YAAY,CAAC2B,YAAY,CAAC,MAAQ,OAAO,OAAS,QAAQxB,MAAM,CAAC,MAAQ,aAAaH,EAAG,MAAMA,EAAG,SAAS,CAACH,EAAIS,GAAG,2BAA2B,KAAKN,EAAG,MAAM,CAACA,EAAG,QAAQ,CAACE,YAAY,QAAQ,CAACF,EAAG,QAAQ,CAACA,EAAG,iBAAiB,CAACQ,IAAI,QAAQL,MAAM,CAAC,QAAUN,EAAI+G,cAAc,KAAO/G,EAAIgH,2BAA2B,WAAa,uCAAuC,gBAAe,GAAMzG,YAAYP,EAAIQ,GAAG,CAAC,CAAC1B,IAAI,YAAYS,GAAG,SAAS0H,GAAO,MAAO,CAAwB,oBAAtBA,EAAMC,OAAOC,MAA6BhH,EAAG,OAAO,CAACA,EAAG,OAAO,CAACH,EAAIS,GAAGT,EAAIoC,GAAG6E,EAAMG,IAAIC,uBAAuBrH,EAAIkB,KAA4B,iBAAtB+F,EAAMC,OAAOC,MAA0BhH,EAAG,OAAO,CAACA,EAAG,OAAO,CAACA,EAAG,IAAI,CAACH,EAAIS,GAAGT,EAAIoC,GAAG6E,EAAMG,IAAIE,sBAAsBtH,EAAIkB,KAA4B,aAAtB+F,EAAMC,OAAOC,MAAsBhH,EAAG,OAAO,CAACA,EAAG,OAAO,CAACA,EAAG,IAAI,CAACH,EAAIS,GAAGT,EAAIoC,GAAG6E,EAAMG,IAAIG,kBAAkBvH,EAAIkB,KAA4B,gBAAtB+F,EAAMC,OAAOC,MAAyBhH,EAAG,OAAO,CAACA,EAAG,OAAO,CAACA,EAAG,IAAI,CAACH,EAAIS,GAAGT,EAAIoC,GAAG6E,EAAMG,IAAIK,qBAAqBzH,EAAIkB,SAAS,MAAK,EAAM,aAAa,CAACf,EAAG,MAAM,CAACG,MAAM,CAAC,KAAO,cAAckH,KAAK,cAAc,CAACrH,EAAG,KAAK,CAACE,YAAY,oBAAoB,CAACL,EAAIS,GAAG,gDAAgD,GAAGN,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,OAAO,CAACH,EAAG,MAAM,CAAC2B,YAAY,CAAC,gBAAgB,SAAS,CAAC3B,EAAG,WAAW,CAACE,YAAY,kBAAkBC,MAAM,CAAC,QAAU,WAAWe,GAAG,CAAC,MAAQrB,EAAIiE,WAAW,CAACjE,EAAIS,GAAG,0BAA0BN,EAAG,WAAW,CAACE,YAAY,kBAAkBC,MAAM,CAAC,QAAU,mBAAmBe,GAAG,CAAC,MAAQrB,EAAIkE,iBAAiB,CAAClE,EAAIS,GAAG,uBAAuB,MAAM,IAAI,MAAM,IAAI,GAAGT,EAAIkB,MAAM,IAAI,IAAI,IAAI,IAAI,IACthH,GAAkB,GCsFtB,IACE,KAAF,kBACE,WAAF,CACI,aAAJ,SAEE,KALF,WAMI,MAAJ,CACM,OAAN,KACM,WAAN,GACM,QAAN,KACM,gBAAN,GACM,YAAN,KACM,iBAAN,GACM,iBAAN,KACM,sBAAN,GACM,cAAN,CACA,CAAQ,MAAR,aAAQ,MAAR,mBAAQ,UAAR,GACA,CAAQ,MAAR,QAAQ,MAAR,gBAAQ,UAAR,GACA,CAAQ,MAAR,YAAQ,MAAR,YAAQ,UAAR,GACA,CAAQ,MAAR,QAAQ,MAAR,eAAQ,MAAR,KAAQ,UAAR,IAEM,MAAN,GACM,aAAN,EACM,2BAAN,KAGE,QAAF,CACI,SADJ,WAEM,IAAN,wCACA,qDACA,4CACA,qCACM,EAAN,ifAaA,oCAbA,qCAaA,EAbA,qBAaA,gBAbA,qBAaA,iBAbA,0BAaA,2BAbA,2BAaA,sBAbA,2BAcA,EAdA,2EAeA,EAfA,+CAkBM,EAAN,iBACM,EAAN,SAEI,eA3BJ,WA4BM,IAAN,kCACA,8BACM,EAAN,kCAEI,oCAhCJ,SAgCA,KAAM,IAAN,OAEA,KACM,EAAN,qBACQ,IAAR,oDACA,OACU,EAAV,IACY,YAAZ,cACY,WAAZ,aACY,aAAZ,eACY,MAAZ,QACY,KAAZ,OACY,SAAZ,wBACY,QAAZ,KAGQ,IAAR,0BACA,UACU,EAAV,sBAIM,IAAN,oCACQ,IAAR,sBAAU,OAAV,+BAEQ,IAAR,4BACQ,IAAR,kCAAU,OAAV,SACA,qEACA,uBACA,KAcQ,OAbR,WAEA,EADA,KACA,+BACA,iCACA,+BACA,WAEA,gCACA,kCACA,gCACA,YAGA,CACU,YAAV,cACU,mBAAV,uDACU,kBAAV,8DACU,cAAV,MACU,UAAV,EACU,aAAV,eACU,MAAV,QACU,KAAV,OACU,SAAV,WACU,MAAV,YAEA,oBAAQ,OAAR,YAEM,OAAN,sBAAQ,OAAO,EAAf,kBAEI,iBA3FJ,WA2FM,IAAN,OAAM,OAAN,yIACA,iBACA,WACA,mGACA,oBAJA,wBAKA,yGACA,sGACA,gDACA,kBACA,yBATA,SAYA,IACA,+IACA,kBACA,cACA,+FACA,kBAEA,kBACA,yBAIA,mBACA,yIACA,oBA1BA,OA6BA,sHA7BA,QA+BA,iBA/BA,+CAiCI,yBA5HJ,WA4HM,IAAN,OAAM,OAAN,6IACA,2BADA,SAEA,IACA,oFACA,kBACA,aACA,gFAEA,kBACA,yCAIA,mBACA,qIAdA,8CAkBI,uBA9IJ,WA8IM,IAAN,OAAM,OAAN,6IACA,sBADA,SAEA,IACA,gHACA,kBACA,aACA,6EAEA,iBACA,kCACA,uEAKA,mBACA,0HAhBA,8CAmBI,sBAjKJ,WAiKM,IAAN,OAAM,OAAN,sIACA,qBACA,gDACA,qBACA,0EAJA,8CAQI,iBAzKJ,WAyKM,IAAN,OAAM,OAAN,sIACA,gBACA,+CACA,6DAHA,8CAMI,oBA/KJ,SA+KA,OACM,GAAN,qBACQ,IAAR,2CACA,kBACA,sBACQ,IAAR,2CACA,eAGI,UAxLJ,SAwLA,GACM,IAAN,2CACM,OAAN,+BAEI,YA5LJ,SA4LA,GACM,IAAN,iCACA,uDACQ,EAAR,kBAGI,cAlMJ,SAkMA,GACM,IAAN,iCACA,+EACQ,EAAR,kBAGI,mBAxMJ,SAwMA,GACM,GAAN,kBACQ,MAAR,mCAGI,iBA7MJ,SA6MA,OACM,KAAN,kBAAQ,MAAR,EAAQ,QAAR,EAAQ,QAAR,uBAAQ,OAAR,EAAQ,cAAR,IAAQ,aAAR,MAGE,YA3OF,WA4OA,2FACM,KAAN,mBACM,KAAN,8EAGM,KAAN,8BAGE,SAAF,IC3UuX,MCOnX,GAAY,eACd,GACA,GACA,IACA,EACA,KACA,KACA,MAIa,M,QClBX,GAAS,WAAa,IAAIlB,EAAIP,KAASQ,EAAGD,EAAIE,eAAmBC,EAAGH,EAAII,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACA,EAAG,QAAQ,CAACE,YAAY,QAAQ,CAACF,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,OAAO,CAACH,EAAG,SAAS,CAACI,YAAYP,EAAIQ,GAAG,CAAC,CAAC1B,IAAI,SAASS,GAAG,WAAW,MAAO,CAACY,EAAG,KAAK,CAACE,YAAY,QAAQ,CAACF,EAAG,SAAS,CAACG,MAAM,CAAC,KAAO,iBAAiB,cAAc,UAAUN,EAAIS,GAAG,oCAAoC,KAAKC,OAAM,MAAS,CAACP,EAAG,cAAc,CAACA,EAAG,QAAQ,CAACA,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,MAAM,CAACH,EAAG,eAAe,CAACE,YAAY,WAAWC,MAAM,CAAC,MAAQ,sBAAsB,YAAY,UAAU,CAACH,EAAG,gBAAgB,CAACQ,IAAI,QAAQL,MAAM,CAAC,GAAK,QAAQ,QAAUN,EAAI0B,YAAYL,GAAG,CAAC,OAAS,SAASC,GAAQtB,EAAIwB,QAAQ,KAAKxB,EAAI2B,0BAA0Bd,MAAM,CAAC5B,MAAOe,EAAU,OAAEc,SAAS,SAAUC,GAAMf,EAAIuB,OAAOR,GAAKE,WAAW,aAAa,IAAI,GAAGd,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,MAAM,CAACH,EAAG,eAAe,CAACE,YAAY,WAAWC,MAAM,CAAC,MAAQ,uBAAuB,YAAY,WAAW,CAACH,EAAG,gBAAgB,CAACQ,IAAI,SAASL,MAAM,CAAC,GAAK,SAAS,QAAUN,EAAI4B,gBAAgB,SAAuB,MAAZ5B,EAAIuB,QAA6BF,GAAG,CAAC,OAAS,SAASC,GAAQ,OAAOtB,EAAI6B,yBAAyBhB,MAAM,CAAC5B,MAAOe,EAAW,QAAEc,SAAS,SAAUC,GAAMf,EAAIwB,QAAQT,GAAKE,WAAW,cAAc,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,GAAGd,EAAG,QAAQ,CAACA,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,OAAO,CAAEN,EAAe,YAAEG,EAAG,MAAM,CAACA,EAAG,MAAM,CAACE,YAAY,gCAAgC,CAACF,EAAG,YAAY,CAAC2B,YAAY,CAAC,MAAQ,OAAO,OAAS,QAAQxB,MAAM,CAAC,MAAQ,aAAaH,EAAG,MAAMA,EAAG,SAAS,CAACH,EAAIS,GAAG,0BAA0B,KAAKT,EAAIkB,QAAQ,GAAKlB,EAAI+B,aAA4B,MAAb/B,EAAIwB,QAAuxFxB,EAAIkB,KAA5wFf,EAAG,QAAQ,CAACA,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,OAAO,CAACH,EAAG,QAAQ,CAACE,YAAY,mBAAmBC,MAAM,CAAC,OAAS,IAAI,YAAc,IAAI,YAAc,MAAM,CAACH,EAAG,QAAQ,CAACA,EAAG,KAAK,CAACA,EAAG,KAAK,CAACH,EAAIS,GAAG,OAAON,EAAG,KAAK,CAACH,EAAIS,GAAG,gBAAgBN,EAAG,KAAK,CAACH,EAAIS,GAAG,iCAAiCN,EAAG,KAAK,CAACH,EAAIS,GAAG,aAAaN,EAAG,KAAK,CAACH,EAAIS,GAAG,OAAON,EAAG,MAAMH,EAAIS,GAAG,QAAQN,EAAG,MAAMH,EAAIS,GAAG,SAASN,EAAG,KAAK,CAACH,EAAIS,GAAG,OAAON,EAAG,MAAMH,EAAIS,GAAG,QAAQN,EAAG,MAAMH,EAAIS,GAAG,SAASN,EAAG,KAAK,CAACH,EAAIS,GAAG,OAAON,EAAG,MAAMH,EAAIS,GAAG,QAAQN,EAAG,MAAMH,EAAIS,GAAG,SAASN,EAAG,KAAK,CAACH,EAAIS,GAAG,OAAON,EAAG,MAAMH,EAAIS,GAAG,QAAQN,EAAG,MAAMH,EAAIS,GAAG,SAASN,EAAG,KAAK,CAACH,EAAIS,GAAG,OAAON,EAAG,MAAMH,EAAIS,GAAG,SAASN,EAAG,KAAK,CAACH,EAAIS,GAAG,OAAON,EAAG,MAAMH,EAAIS,GAAG,SAASN,EAAG,KAAK,CAACH,EAAIS,GAAG,YAAYN,EAAG,KAAK,CAACH,EAAIS,GAAG,WAAWN,EAAG,QAAQ,CAACH,EAAIgC,GAAIhC,EAAoB,kBAAE,SAAS0E,EAAIC,EAAOnC,GAAG,OAAOrC,EAAG,KAAK,CAACrB,IAAI6F,GAAQ,CAACxE,EAAG,KAAK,CAACE,YAAY,aAAa,CAACL,EAAIS,GAAGT,EAAIoC,GAAGI,EAAI,MAAMrC,EAAG,KAAK,CAAC2B,YAAY,CAAC,aAAa,SAAS,CAAC9B,EAAIS,GAAGT,EAAIoC,GAAGuC,MAAWxE,EAAG,KAAK,CAAC2B,YAAY,CAAC,aAAa,SAAS,CAAC9B,EAAIS,GAAGT,EAAIoC,GAAsB,KAAnBsC,EAAItB,cAAqBpD,EAAI0H,uBAAuB1H,EAAI2H,8BAA8BjD,EAAK,SAAW,QAAQvE,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAsB,KAAnBsC,EAAItB,cAAqBpD,EAAIuD,wBAAwBmB,GAAO,QAAQvE,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAsB,KAAnBsC,EAAItB,cAAqBpD,EAAI2H,8BAA8BjD,EAAK,QAAU,QAAQvE,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAsB,KAAnBsC,EAAItB,cAAqBpD,EAAI2H,8BAA8BjD,EAAK,UAAY,QAAQvE,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAsB,KAAnBsC,EAAItB,cAAqBpD,EAAI2H,8BAA8BjD,EAAK,QAAU,QAAQvE,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAsB,KAAnBsC,EAAItB,cAAqBpD,EAAI2H,8BAA8BjD,EAAK,YAAc,QAAQvE,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAsB,KAAnBsC,EAAItB,cAAqBsB,EAAIjB,KAAO,QAAQtD,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAsB,KAAnBsC,EAAItB,cAAqBsB,EAAIhB,KAAO,QAAQvD,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAsB,KAAnBsC,EAAItB,cAAqBpD,EAAI2D,YAAY3D,EAAI4D,qBAAqBe,IAAW,KAAK,IAAI3E,EAAIoC,GAAsB,KAAnBsC,EAAItB,cAAqBpD,EAAI4D,qBAAqBe,GAAU,QAAQxE,EAAG,KAAK,CAACE,YAAY,aAAa,CAACL,EAAIS,GAAGT,EAAIoC,GAAGI,EAAI,WAAUrC,EAAG,KAAK,CAAC2B,YAAY,CAAC,mBAAmB,UAAU,cAAc,SAAS,CAAC3B,EAAG,KAAK,CAACG,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAG,iBAAiBN,EAAG,MAAMA,EAAG,MAAMA,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAGpC,EAAIgF,QAAQC,SAAS9E,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAGpC,EAAIgF,QAAQE,WAAW/E,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAGpC,EAAIgF,QAAQG,SAAShF,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAGpC,EAAIgF,QAAQI,aAAajF,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAGpC,EAAIgF,QAAQvB,SAAStD,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAGpC,EAAIgF,QAAQtB,SAASvD,EAAG,MAAMH,EAAIS,GAAG,KAAKN,EAAG,SAAS,KAAKA,EAAG,MAAM,CAAC2B,YAAY,CAAC,gBAAgB,SAAS,CAAC3B,EAAG,WAAW,CAACE,YAAY,kBAAkBC,MAAM,CAAC,QAAU,WAAWe,GAAG,CAAC,MAAQrB,EAAIiE,WAAW,CAACjE,EAAIS,GAAG,0BAA0BN,EAAG,WAAW,CAACE,YAAY,kBAAkBC,MAAM,CAAC,QAAU,mBAAmBe,GAAG,CAAC,MAAQrB,EAAIkE,iBAAiB,CAAClE,EAAIS,GAAG,uBAAuB,MAAM,IAAa,IAC70I,GAAkB,GCDlB,GAAS,WAAa,IAAIT,EAAIP,KAASQ,EAAGD,EAAIE,eAAmBC,EAAGH,EAAII,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACA,EAAG,QAAQ,CAACE,YAAY,QAAQ,CAACF,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,OAAO,CAACH,EAAG,SAAS,CAACI,YAAYP,EAAIQ,GAAG,CAAC,CAAC1B,IAAI,SAASS,GAAG,WAAW,MAAO,CAACY,EAAG,KAAK,CAACE,YAAY,QAAQ,CAACF,EAAG,SAAS,CAACG,MAAM,CAAC,KAAO,iBAAiB,cAAc,UAAUN,EAAIS,GAAG,gCAAgC,KAAKC,OAAM,MAAS,CAACP,EAAG,cAAc,CAACA,EAAG,QAAQ,CAACA,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,MAAM,CAACH,EAAG,eAAe,CAACE,YAAY,WAAWC,MAAM,CAAC,MAAQ,WAAW,YAAY,YAAY,CAACH,EAAG,gBAAgB,CAACQ,IAAI,UAAUL,MAAM,CAAC,GAAK,UAAU,QAAUN,EAAIoB,eAAeC,GAAG,CAAC,OAAS,SAASC,GAAQtB,EAAIuB,OAAO,KAAKvB,EAAIwB,QAAQ,OAAOX,MAAM,CAAC5B,MAAOe,EAAa,UAAEc,SAAS,SAAUC,GAAMf,EAAIyB,UAAUV,GAAKE,WAAW,gBAAgB,IAAI,GAAGd,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,MAAM,CAACH,EAAG,eAAe,CAACE,YAAY,WAAWC,MAAM,CAAC,MAAQ,sBAAsB,YAAY,UAAU,CAACH,EAAG,gBAAgB,CAACQ,IAAI,QAAQL,MAAM,CAAC,GAAK,QAAQ,QAAUN,EAAI0B,WAAW,SAA0B,MAAf1B,EAAIyB,WAAgCJ,GAAG,CAAC,OAAS,SAASC,GAAQtB,EAAIwB,QAAQ,KAAKxB,EAAI2B,0BAA0Bd,MAAM,CAAC5B,MAAOe,EAAU,OAAEc,SAAS,SAAUC,GAAMf,EAAIuB,OAAOR,GAAKE,WAAW,aAAa,IAAI,GAAGd,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,MAAM,CAACH,EAAG,eAAe,CAACE,YAAY,WAAWC,MAAM,CAAC,MAAQ,uBAAuB,YAAY,WAAW,CAACH,EAAG,gBAAgB,CAACQ,IAAI,SAASL,MAAM,CAAC,GAAK,SAAS,QAAUN,EAAI4B,gBAAgB,SAAuB,MAAZ5B,EAAIuB,QAA6BF,GAAG,CAAC,OAAS,SAASC,GAAQ,OAAOtB,EAAI6B,yBAAyBhB,MAAM,CAAC5B,MAAOe,EAAW,QAAEc,SAAS,SAAUC,GAAMf,EAAIwB,QAAQT,GAAKE,WAAW,cAAc,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,GAAGd,EAAG,QAAQ,CAACA,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,OAAO,CAAEN,EAAe,YAAEG,EAAG,MAAM,CAACA,EAAG,MAAM,CAACE,YAAY,gCAAgC,CAACF,EAAG,YAAY,CAAC2B,YAAY,CAAC,MAAQ,OAAO,OAAS,QAAQxB,MAAM,CAAC,MAAQ,aAAaH,EAAG,MAAMA,EAAG,SAAS,CAACH,EAAIS,GAAG,0BAA0B,KAAKT,EAAIkB,QAAQ,GAAKlB,EAAI+B,aAA4B,MAAb/B,EAAIwB,QAAw1BxB,EAAIkB,KAA70Bf,EAAG,QAAQ,CAACA,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,OAAO,CAACH,EAAG,QAAQ,CAACE,YAAY,iBAAiBC,MAAM,CAAC,OAAS,IAAI,YAAc,IAAI,YAAc,MAAM,CAACH,EAAG,QAAQ,CAACA,EAAG,KAAK,CAACA,EAAG,KAAK,CAACH,EAAIS,GAAG,gBAAgBN,EAAG,KAAK,CAACH,EAAIS,GAAG,oBAAoBN,EAAG,KAAK,CAACH,EAAIS,GAAG,eAAeN,EAAG,QAAQH,EAAIgC,GAAIhC,EAAwB,sBAAE,SAAS4H,GAAM,OAAOzH,EAAG,KAAK,CAACrB,IAAI8I,EAAKhF,YAAY,CAACzC,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAGwF,EAAKhF,eAAezC,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAGwF,EAAKC,SAASC,KAAK,UAAU3H,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAGwF,EAAKG,eAAc,KAAK5H,EAAG,MAAM,CAAC2B,YAAY,CAAC,gBAAgB,SAAS,CAAC3B,EAAG,WAAW,CAACE,YAAY,kBAAkBC,MAAM,CAAC,QAAU,WAAWe,GAAG,CAAC,MAAQrB,EAAIiE,WAAW,CAACjE,EAAIS,GAAG,0BAA0BN,EAAG,WAAW,CAACE,YAAY,kBAAkBC,MAAM,CAAC,QAAU,mBAAmBe,GAAG,CAAC,MAAQrB,EAAIkE,iBAAiB,CAAClE,EAAIS,GAAG,uBAAuB,MAAM,IAAa,IACrzF,GAAkB,GCuEtB,IACE,KAAF,gBACE,MAAF,GAEE,WAAF,GAEE,KANF,WAOI,MAAJ,CACM,OAAN,KACM,WAAN,GACM,UAAN,KACM,cAAN,KACM,QAAN,KACM,gBAAN,GACM,WAAN,KACM,YAAN,KACM,QAAN,KACM,aAAN,EACM,eAAN,GACM,aAAN,GACM,sBAAN,GACM,iBAAN,GACM,UAAN,KAGE,QAAF,CACI,qBADJ,WACM,IAAN,OAAM,OAAN,yIACA,iBACA,mGACA,gBAHA,wBAIA,sGACA,gDACA,kBACA,yBAGA,sBAVA,SAWA,IACA,+GACA,kBACA,aACA,6EAEA,kBACA,oCAIA,mBACA,0HAvBA,cA4CA,oBA5CA,UA6CA,IACA,yIACA,kBACA,cACA,kGACA,kBAEA,kBACA,kCAIA,mBACA,4IACA,oBA3DA,QAiEA,iBAjEA,+CAmEI,SApEJ,WAqEM,IAAN,wCACA,kCACA,4CACA,mCACM,EAAN,0qBAoBA,oCApBA,qCAoBA,EApBA,qBAoBA,gBApBA,qBAoBA,iBApBA,0BAoBA,2BApBA,uBAoBA,eApBA,2BAqBA,EArBA,2EAsBA,EAtBA,+CAyBM,EAAN,iBACM,EAAN,SAEI,eArGJ,WAsGM,IAAN,kCACA,8BACM,EAAN,kCAEI,sBA1GJ,WA0GM,IAAN,OAAM,OAAN,sIACA,qBACA,gDACA,qBACA,0EAJA,8CAQI,iBAlHJ,WAkHM,IAAN,OAAM,OAAN,sIACA,gBACA,+CACA,6DAHA,8CAMI,oBAxHJ,WAwHM,IAAN,OAAM,OAAN,sIACA,mBACA,6CACA,mEAHA,8CAMI,UA9HJ,SA8HA,GACM,IAAN,2CACM,OAAN,+BAEI,iBAlIJ,SAkIA,OACM,KAAN,kBAAQ,MAAR,EAAQ,QAAR,EAAQ,QAAR,uBAAQ,OAAR,EAAQ,cAAR,IAAQ,aAAR,MAGE,SAAF,CACI,qBADJ,WACM,IAAN,OACM,OAAN,uCACQ,IAAR,uCAAU,OAAV,6DAEA,KACQ,EAAR,qBACU,IAAV,SACA,8BACA,6BACA,8BACA,iBACA,EACA,EACA,OACY,EAAZ,IAAc,UAAd,EAAc,gBAAd,EAAc,KAAd,iCAEU,EAAV,kBACU,EAAV,yBAGQ,IAAR,oBACA,iBAAU,IAAV,oCACA,sBACA,sDACA,EACA,EACA,mCACA,qCAEU,OAAV,EACA,CAAY,KAAZ,EAAY,SAAZ,GACA,QAEA,gBACA,qBAAU,MAAV,gDACQ,MAAR,CACU,WAAV,aACU,SAAV,EACU,MAAV,aAEA,oBAAQ,OAAR,eAGE,YA3MF,WA4MI,KAAJ,mBACI,KAAJ,sBACI,KAAJ,+ECtRqX,MCQjX,I,UAAY,eACd,GACA,GACA,IACA,EACA,KACA,WACA,OAIa,M,QCmJf,IACE,KAAF,wBACE,WAAF,GAEE,KAJF,WAKI,MAAJ,CACM,OAAN,KACM,WAAN,GACM,UAAN,EACM,cAAN,KACM,QAAN,KACM,gBAAN,GACM,WAAN,KACM,YAAN,KACM,QAAN,KACM,aAAN,EACM,SAAN,GACM,aAAN,GACM,sBAAN,GACM,iBAAN,KAGE,QAAF,CACI,uBADJ,SACA,GACM,OAAN,gCACA,KACA,kBACA,WACA,yBAEA,aAYI,YApBJ,SAoBA,GACM,IAAN,gCACA,iCACA,IACM,OAAN,cAGI,qBA3BJ,SA2BA,OAAM,IAAN,OACA,IACA,mCACA,YAAQ,OAAR,gCAEA,mDASM,OARA,OAAN,mDAAQ,IAAR,UACA,sMACA,MACA,kCAEA,sCAGA,GAEI,6BA3CJ,SA2CA,KAAM,IAAN,OACA,IACA,mCACA,YAAQ,OAAR,gCAEA,mDAWM,OAVA,OAAN,mDAAQ,IAAR,MACA,sIACQ,GAAR,EAAQ,CACA,IAAR,8CACA,MACA,6BAEA,kCAGA,GAEI,uBA7DJ,SA6DA,GAAM,IAAN,OACA,IAKM,OAJA,OAAN,mDACQ,IAAR,0CACA,0CAEA,GAEI,gBArEJ,WAqEM,IAAN,OACA,wBAUM,OATA,OAAN,mDACQ,GAAR,0CACQ,GAAR,4CACQ,GAAR,0CACQ,GAAR,8CACQ,GAAR,UACQ,GAAR,aAGA,CAAQ,KAAR,EAAQ,OAAR,EAAQ,KAAR,EAAQ,SAAR,EAAQ,KAAR,EAAQ,KAAR,IAEI,aAlFJ,SAkFA,GAGM,IAAN,iDAAQ,OAAR,cACM,QAAN,oBAAQ,OAAR,kCACA,oBAAQ,OAAR,mDAGI,oBA1FJ,SA0FA,KACM,IAAN,sBACM,OAAN,mCAEI,YA9FJ,SA8FA,SAAM,IAAN,UACA,sMAEM,OADN,cACA,oCAEI,0BAnGJ,SAmGA,OAAM,IAAN,MACA,sIACM,OAAN,yCAEI,2BAvGJ,SAuGA,GAEM,IAAN,UACA,aACA,UACM,GAAN,kDACM,IAAN,IACM,GAAN,yEACQ,GAAR,OAEU,IADA,IAAV,IACA,cAAY,IAAZ,EACA,kCACA,MACc,GAAd,EACc,KAGJ,OAAV,UACU,GAAV,EACA,gEAEU,IAAV,kBAAY,IAAZ,EACA,kCACY,GAAZ,WAEU,OAAV,+DAEA,4EACQ,GAAR,OAEU,IADA,IAAV,IACA,cAAY,IAAZ,EACA,kCACA,MACc,GAAd,EACc,KAGJ,OAAV,UACU,GAAV,EACA,gEAEU,IAAV,kBAAY,IAAZ,EACA,kCACY,GAAZ,WAEU,OAAV,+DAEA,4EAAQ,IAAR,EACA,kCACQ,OAAR,oBACA,4EAAQ,IAAR,EACA,kCACQ,OAAR,oBAGQ,IADA,IAAR,IACA,cAAU,IAAV,EACA,kCACA,MACY,GAAZ,EACY,KAGJ,GAAR,eACQ,IAAR,MACQ,OAAR,gEAGI,qBA1KJ,SA0KA,GAAM,IAAN,OACA,+BACM,IAAN,sBACM,IAAN,IAKM,OAJA,EAAN,qBACQ,GAAR,qDACQ,GAAR,gEAEA,qCAEI,8BApLJ,SAoLA,KAAM,IAAN,OACA,2BACA,IAoBM,OAnBA,EAAN,qBACQ,GAAR,kBAAQ,CACA,IAAR,4CAAU,OAAV,cACA,2CACA,iDACA,WACA,OACA,qCACA,iEACA,+DACA,qEAHA,KAKA,sCACA,mEACA,iEACA,uEAHA,SAOA,GAEI,wBA5MJ,SA4MA,GAAM,IAAN,OACA,2BACA,IACA,IASM,OARA,EAAN,qBACQ,GAAR,kBAAQ,CACA,IAAR,iDACA,WACU,GAAV,EACU,SAGV,yBAEI,gBA1NJ,SA0NA,GACM,IAAN,IAKM,OAJA,OAAN,mDACA,2BACA,8BAEA,GAEI,yBAlOJ,SAkOA,OAAM,IAAN,OACA,IAiBM,OAhBA,OAAN,mDAAQ,IAAR,QACA,+FACA,6GACA,sBACA,OACA,qCACA,iEACA,+DACA,qEAHA,KAKA,sCACA,mEACA,iEACA,uEAHA,QAMA,GAEI,mBAtPJ,SAsPA,GAAM,IAAN,OACA,IAmBM,OAlBA,OAAN,mDACQ,EAAR,2CAAU,IAAV,gCACA,+FACA,6GACA,sBACA,OACA,qCACA,iEACA,+DACA,qEAHA,KAKA,sCACA,mEACA,iEACA,uEAHA,WAOA,GAEI,YA5QJ,SA4QA,GACM,OAAN,WACA,WACA,WACA,IAEI,0BAlRJ,SAkRA,KAAM,IAAN,OACA,IAsBM,OArBA,OAAN,mCACQ,OAAR,+CACU,IAAV,8CACA,uBACA,UACA,6EACA,6EACA,sBACA,OACA,qCACA,iEACA,+DACA,qEAHA,KAKA,sCACA,mEACA,iEACA,uEAHA,WAOA,GAEI,cA3SJ,SA2SA,OAAM,IAAN,MACM,OAAN,iIAEI,gBA9SJ,SA8SA,OAAM,IAAN,IACA,mGACM,MAAN,wCAEI,oBAlTJ,SAkTA,OAAM,IAAN,IACA,uGACM,MAAN,wCAEI,aAtTJ,SAsTA,SAAM,IAAN,IACA,6GACM,OAAN,MACA,4CACA,8CACA,4CACA,iDACA,kBAEA,6CACA,+CACA,6CACA,kDACA,mBAGI,eAtUJ,SAsUA,GAEM,MAAN,sCACA,qBACA,uBACA,uBACA,0BACA,mBAEI,oBA/UJ,SA+UA,GACM,OAAN,4CACA,8CACA,4CACA,iDACA,mBAEI,qBAtVJ,WAsVM,IAAN,OAAM,OAAN,yIACA,iBACA,yCACA,2CACA,6CACA,+CACA,mGACA,gBAPA,wBAQA,sGACA,gDACA,kBACA,yBAGA,2BAdA,UAeA,IACA,+EACA,kBACA,cACA,sFACA,kBAEA,iBAEA,kCACA,qEACA,0BACA,gCAEA,qEACA,oDACA,gCAEA,qEACA,0BACA,iCAEA,4IAGA,cAFA,sCAUA,mBACA,gIACA,oBAlDA,eAoDA,cApDA,UAqDA,IACA,yIACA,kBACA,cACA,+FACA,kBAEA,kBACA,4BAIA,mBACA,yIACA,oBAnEA,QAuEA,iBAvEA,+CAyEI,SA/ZJ,WAgaM,IAAN,wCACA,4CACA,4CACA,uCACM,EAAN,q9BAsBA,oCAtBA,qCAsBA,EAtBA,qBAsBA,gBAtBA,qBAsBA,iBAtBA,0BAsBA,2BAtBA,8CAuBA,EAvBA,6EAwBA,EAxBA,mDA2BM,EAAN,iBACM,EAAN,SAEI,eAlcJ,WAmcM,IAAN,kCACA,8BACM,EAAN,wCAEI,UAvcJ,SAucA,GACM,IAAN,2CACM,OAAN,+BAEI,sBA3cJ,WA2cM,IAAN,OAAM,OAAN,sIACA,qBACA,gDACA,qBACA,0EAJA,8CAQI,iBAndJ,WAmdM,IAAN,OAAM,OAAN,sIACA,gBACA,+CACA,6DAHA,8CAMI,oBAzdJ,WAydM,IAAN,OAAM,OAAN,sIACA,mBACA,6CACA,mEAHA,8CAMI,iBA/dJ,SA+dA,OACM,KAAN,kBAAQ,MAAR,EAAQ,QAAR,EAAQ,QAAR,uBAAQ,OAAR,EAAQ,cAAR,IAAQ,aAAR,MAGE,SAAF,CACI,QADJ,WAEM,OAAN,wBAEI,iBAJJ,WAIM,IAAN,OACA,KAoCM,OAnCA,KAAN,8BACQ,IAAR,+MACA,OACU,EAAV,IAAY,cAAZ,EAAY,KAAZ,EAAY,KAAZ,EAAY,MAAZ,KAEA,gBACU,EAAV,aAAY,YAAZ,KAEA,+BACU,EAAV,4BACY,SAAZ,GACY,MAAZ,EACY,mBAAZ,EACY,WAAZ,EACY,MAAZ,CAAc,EAAd,sBAAc,EAAd,sBAAc,EAAd,sBAAc,EAAd,yBAGQ,IAAR,IAGY,EAFZ,OACA,8BACA,EAEA,aAGA,aACA,0BAEA,QAGQ,EAAR,yCACQ,EAAR,cACQ,EAAR,iBAEA,GAEI,0BA3CJ,WA4CM,IAAN,sDAAQ,OAAR,WACM,OAAN,QAEI,qBA/CJ,WA+CM,IAAN,OACA,yDAAQ,IAAR,oCACA,2CACQ,MAAR,CAAU,OAAV,EAAU,SAAV,iBAGM,EAAN,oBAAQ,OAAR,yBACM,IAAN,KACA,IACA,IACA,OAUM,OATA,EAAN,qBACA,iBACU,EAAV,EACU,EAAV,WACU,KAEF,EAAR,eAGA,GAEI,kBArEJ,WAsEM,IAAN,KAKM,OAJA,KAAN,2CAAQ,IAAR,wBACA,gBACQ,EAAR,cAEA,IAGE,YAvkBF,WAwkBI,KAAJ,mBACI,KAAJ,sBACI,KAAJ,+EChvB6X,MCQzX,I,UAAY,eACd,GACA,GACA,IACA,EACA,KACA,WACA,OAIa,M,QCnBX,GAAS,WAAa,IAAIT,EAAIP,KAASQ,EAAGD,EAAIE,eAAmBC,EAAGH,EAAII,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACA,EAAG,QAAQ,CAACE,YAAY,QAAQ,CAACF,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,OAAO,CAACH,EAAG,SAAS,CAACI,YAAYP,EAAIQ,GAAG,CAAC,CAAC1B,IAAI,SAASS,GAAG,WAAW,MAAO,CAACY,EAAG,KAAK,CAACE,YAAY,QAAQ,CAACF,EAAG,SAAS,CAACG,MAAM,CAAC,KAAO,iBAAiB,cAAc,UAAUN,EAAIS,GAAG,sCAAsC,KAAKC,OAAM,MAAS,CAACP,EAAG,cAAc,CAACA,EAAG,QAAQ,CAACA,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,MAAM,CAACH,EAAG,eAAe,CAACE,YAAY,WAAWC,MAAM,CAAC,MAAQ,WAAW,YAAY,YAAY,CAACH,EAAG,gBAAgB,CAACQ,IAAI,UAAUL,MAAM,CAAC,GAAK,UAAU,QAAUN,EAAIoB,eAAeC,GAAG,CAAC,OAAS,SAASC,GAAQtB,EAAIuB,OAAO,KAAKvB,EAAIwB,QAAQ,OAAOX,MAAM,CAAC5B,MAAOe,EAAa,UAAEc,SAAS,SAAUC,GAAMf,EAAIyB,UAAUV,GAAKE,WAAW,gBAAgB,IAAI,GAAGd,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,MAAM,CAACH,EAAG,eAAe,CAACE,YAAY,WAAWC,MAAM,CAAC,MAAQ,sBAAsB,YAAY,UAAU,CAACH,EAAG,gBAAgB,CAACQ,IAAI,QAAQL,MAAM,CAAC,GAAK,QAAQ,QAAUN,EAAI0B,WAAW,SAA0B,MAAf1B,EAAIyB,WAAgCJ,GAAG,CAAC,OAAS,SAASC,GAAQtB,EAAIwB,QAAQ,KAAKxB,EAAI2B,0BAA0Bd,MAAM,CAAC5B,MAAOe,EAAU,OAAEc,SAAS,SAAUC,GAAMf,EAAIuB,OAAOR,GAAKE,WAAW,aAAa,IAAI,GAAGd,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,MAAM,CAACH,EAAG,eAAe,CAACE,YAAY,WAAWC,MAAM,CAAC,MAAQ,uBAAuB,YAAY,WAAW,CAACH,EAAG,gBAAgB,CAACQ,IAAI,SAASL,MAAM,CAAC,GAAK,SAAS,QAAUN,EAAI4B,gBAAgB,SAAuB,MAAZ5B,EAAIuB,QAA6BF,GAAG,CAAC,OAAS,SAASC,GAAQ,OAAOtB,EAAI6B,yBAAyBhB,MAAM,CAAC5B,MAAOe,EAAW,QAAEc,SAAS,SAAUC,GAAMf,EAAIwB,QAAQT,GAAKE,WAAW,cAAc,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,GAAGd,EAAG,QAAQ,CAACA,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,OAAO,CAAEN,EAAe,YAAEG,EAAG,MAAM,CAACA,EAAG,MAAM,CAACE,YAAY,gCAAgC,CAACF,EAAG,YAAY,CAAC2B,YAAY,CAAC,MAAQ,OAAO,OAAS,QAAQxB,MAAM,CAAC,MAAQ,aAAaH,EAAG,MAAMA,EAAG,SAAS,CAACH,EAAIS,GAAG,0BAA0B,KAAKT,EAAIkB,QAAQ,GAAKlB,EAAI+B,aAA4B,MAAb/B,EAAIwB,QAAy1BxB,EAAIkB,KAA90Bf,EAAG,QAAQ,CAACA,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,OAAO,CAACH,EAAG,QAAQ,CAACE,YAAY,iBAAiBC,MAAM,CAAC,OAAS,IAAI,YAAc,IAAI,YAAc,MAAM,CAACH,EAAG,QAAQ,CAACA,EAAG,KAAK,CAACA,EAAG,KAAK,CAACH,EAAIS,GAAG,gBAAgBN,EAAG,KAAK,CAACH,EAAIS,GAAG,0BAA0BN,EAAG,KAAK,CAACH,EAAIS,GAAG,eAAeN,EAAG,QAAQH,EAAIgC,GAAIhC,EAAmB,iBAAE,SAAS4H,GAAM,OAAOzH,EAAG,KAAK,CAACrB,IAAI8I,EAAKhF,YAAY,CAACzC,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAGwF,EAAKhF,eAAezC,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAGwF,EAAKC,SAASC,KAAK,UAAU3H,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAGwF,EAAKG,eAAc,KAAK5H,EAAG,MAAM,CAAC2B,YAAY,CAAC,gBAAgB,SAAS,CAAC3B,EAAG,WAAW,CAACE,YAAY,kBAAkBC,MAAM,CAAC,QAAU,WAAWe,GAAG,CAAC,MAAQrB,EAAIiE,WAAW,CAACjE,EAAIS,GAAG,0BAA0BN,EAAG,WAAW,CAACE,YAAY,kBAAkBC,MAAM,CAAC,QAAU,mBAAmBe,GAAG,CAAC,MAAQrB,EAAIkE,iBAAiB,CAAClE,EAAIS,GAAG,uBAAuB,MAAM,IAAa,IAC5zF,GAAkB,GCuEtB,IACE,KAAF,sBACE,MAAF,GAEE,WAAF,GAEE,KANF,WAOI,MAAJ,CACM,OAAN,KACM,WAAN,GACM,UAAN,KACM,cAAN,KACM,QAAN,KACM,gBAAN,GACM,WAAN,KACM,YAAN,KACM,QAAN,KACM,aAAN,EACM,eAAN,GACM,aAAN,GACM,sBAAN,GACM,iBAAN,GACM,UAAN,KAGE,QAAF,CACI,qBADJ,WACM,IAAN,OAAM,OAAN,yIACA,iBACA,mGACA,gBAHA,wBAIA,sGACA,gDACA,kBACA,yBAGA,sBAVA,SAWA,IACA,+GACA,kBACA,aACA,6EAEA,kBACA,oCAIA,mBACA,0HAvBA,cA4CA,oBA5CA,UA6CA,IACA,yIACA,kBACA,cACA,6FACA,kBAEA,kBACA,kCAIA,mBACA,uIACA,oBA3DA,QAiEA,iBAjEA,+CAmEI,SApEJ,WAqEM,IAAN,wCACA,wCACA,4CACA,mCACM,EAAN,0qBAoBA,oCApBA,qCAoBA,EApBA,qBAoBA,gBApBA,qBAoBA,iBApBA,0BAoBA,2BApBA,uBAoBA,eApBA,2BAqBA,EArBA,2EAsBA,EAtBA,+CAyBM,EAAN,iBACM,EAAN,SAEI,eArGJ,WAsGM,IAAN,kCACA,8BACM,EAAN,kCAEI,sBA1GJ,WA0GM,IAAN,OAAM,OAAN,sIACA,qBACA,gDACA,qBACA,0EAJA,8CAQI,iBAlHJ,WAkHM,IAAN,OAAM,OAAN,sIACA,gBACA,+CACA,6DAHA,8CAMI,oBAxHJ,WAwHM,IAAN,OAAM,OAAN,sIACA,mBACA,6CACA,mEAHA,8CAMI,iBA9HJ,SA8HA,OACM,KAAN,kBAAQ,MAAR,EAAQ,QAAR,EAAQ,QAAR,uBAAQ,OAAR,EAAQ,cAAR,IAAQ,aAAR,MAGE,SAAF,CACI,gBADJ,WACM,IAAN,OACM,OAAN,uCACQ,IAAR,uCAAU,OAAV,6DACA,IACA,iBACU,IAAV,8BACA,6BACA,iBACA,EACA,EACA,iCACA,EACA,8BACA,gCAEU,OAAV,EACA,CAAY,WAAZ,aAAY,KAAZ,GACA,QAEA,gBAEA,qBAAU,MAAV,6DAEQ,MAAR,CACU,WAAV,aACU,SAAV,EACU,MAAV,aAEA,oBAAQ,OAAR,eAGE,YA3LF,WA4LI,KAAJ,mBACI,KAAJ,sBACI,KAAJ,+ECtQ2X,MCQvX,I,UAAY,eACd,GACA,GACA,IACA,EACA,KACA,WACA,OAIa,M,QCnBX,GAAS,WAAa,IAAIT,EAAIP,KAASQ,EAAGD,EAAIE,eAAmBC,EAAGH,EAAII,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACA,EAAG,QAAQ,CAACE,YAAY,QAAQ,CAACF,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,OAAO,CAACH,EAAG,SAAS,CAACI,YAAYP,EAAIQ,GAAG,CAAC,CAAC1B,IAAI,SAASS,GAAG,WAAW,MAAO,CAACY,EAAG,KAAK,CAACE,YAAY,QAAQ,CAACF,EAAG,SAAS,CAACG,MAAM,CAAC,KAAO,iBAAiB,cAAc,UAAUN,EAAIS,GAAG,qDAAqD,KAAKC,OAAM,MAAS,CAACP,EAAG,cAAc,CAACA,EAAG,QAAQ,CAACA,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,MAAM,CAACH,EAAG,eAAe,CAACE,YAAY,WAAWC,MAAM,CAAC,MAAQ,sBAAsB,YAAY,UAAU,CAACH,EAAG,gBAAgB,CAACQ,IAAI,QAAQL,MAAM,CAAC,GAAK,QAAQ,QAAUN,EAAI0B,YAAYL,GAAG,CAAC,OAAS,SAASC,GAAQtB,EAAIwB,QAAQ,KAAKxB,EAAI2B,0BAA0Bd,MAAM,CAAC5B,MAAOe,EAAU,OAAEc,SAAS,SAAUC,GAAMf,EAAIuB,OAAOR,GAAKE,WAAW,aAAa,IAAI,GAAGd,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,MAAM,CAACH,EAAG,eAAe,CAACE,YAAY,WAAWC,MAAM,CAAC,MAAQ,uBAAuB,YAAY,WAAW,CAACH,EAAG,gBAAgB,CAACQ,IAAI,SAASL,MAAM,CAAC,GAAK,SAAS,QAAUN,EAAI4B,gBAAgB,SAAuB,MAAZ5B,EAAIuB,QAA6BF,GAAG,CAAC,OAAS,SAASC,GAAQ,OAAOtB,EAAI6B,yBAAyBhB,MAAM,CAAC5B,MAAOe,EAAW,QAAEc,SAAS,SAAUC,GAAMf,EAAIwB,QAAQT,GAAKE,WAAW,cAAc,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,GAAGd,EAAG,QAAQ,CAACA,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,OAAO,CAAEN,EAAe,YAAEG,EAAG,MAAM,CAACA,EAAG,MAAM,CAACE,YAAY,gCAAgC,CAACF,EAAG,YAAY,CAAC2B,YAAY,CAAC,MAAQ,OAAO,OAAS,QAAQxB,MAAM,CAAC,MAAQ,aAAaH,EAAG,MAAMA,EAAG,SAAS,CAACH,EAAIS,GAAG,0BAA0B,KAAKT,EAAIkB,QAAQ,GAAKlB,EAAI+B,aAA4B,MAAb/B,EAAIwB,QAA2vJxB,EAAIkB,KAAhvJf,EAAG,QAAQ,CAACA,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,OAAO,CAACH,EAAG,QAAQ,CAACE,YAAY,mBAAmBC,MAAM,CAAC,OAAS,IAAI,YAAc,IAAI,YAAc,MAAM,CAACH,EAAG,QAAQ,CAACA,EAAG,KAAK,CAACA,EAAG,KAAK,CAACG,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAG,OAAON,EAAG,KAAK,CAACG,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAG,gBAAgBT,EAAIgC,GAAIhC,EAAqB,mBAAE,SAASiC,EAAMC,GAAM,MAAO,CAAC/B,EAAG,KAAK,CAACrB,IAAIoD,EAAK5B,MAAM,CAAC,QAAUN,EAAIuE,YAAYrC,KAAQ,CAAClC,EAAIS,GAAG,IAAIT,EAAIoC,GAAGF,GAAM,WAAU/B,EAAG,KAAK,CAACG,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAG,aAAaN,EAAG,KAAK,CAACG,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAG,OAAON,EAAG,MAAMH,EAAIS,GAAG,QAAQN,EAAG,MAAMH,EAAIS,GAAG,SAASN,EAAG,KAAK,CAACG,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAG,OAAON,EAAG,MAAMH,EAAIS,GAAG,QAAQN,EAAG,MAAMH,EAAIS,GAAG,SAASN,EAAG,KAAK,CAACG,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAG,OAAON,EAAG,MAAMH,EAAIS,GAAG,QAAQN,EAAG,MAAMH,EAAIS,GAAG,SAASN,EAAG,KAAK,CAACG,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAG,OAAON,EAAG,MAAMH,EAAIS,GAAG,QAAQN,EAAG,MAAMH,EAAIS,GAAG,SAASN,EAAG,KAAK,CAACG,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAG,OAAON,EAAG,MAAMH,EAAIS,GAAG,SAASN,EAAG,KAAK,CAACG,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAG,OAAON,EAAG,MAAMH,EAAIS,GAAG,SAASN,EAAG,KAAK,CAACG,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAG,YAAYN,EAAG,KAAK,CAACG,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAG,QAAQ,GAAGN,EAAG,KAAK,CAACH,EAAIgC,GAAIhC,EAAqB,mBAAE,SAASiC,EAAMC,GAAM,MAAO,CAAClC,EAAIgC,GAAG,GAAQ,SAASS,EAAKC,GAAG,MAAO,CAACvC,EAAG,KAAK,CAACrB,IAAI,QAAU2D,EAAOC,EAAEpC,MAAM,CAAC,QAAUN,EAAIwE,iBAAiBrC,OAAS,IAAI,CAACnC,EAAIS,GAAG,IAAIT,EAAIoC,GAAGK,GAAM,WAAUtC,EAAG,KAAK,CAACrB,IAAI,aAAeoD,EAAK7B,YAAY,iBAAiB,CAACL,EAAIS,GAAG,iBAAgB,GAAGN,EAAG,KAAK,CAACH,EAAIgC,GAAIhC,EAAqB,mBAAE,SAASiC,EAAMC,GAAM,MAAO,CAAClC,EAAIgC,GAAG,GAAQ,SAASS,GAAM,MAAO,CAACzC,EAAIgC,GAAIhC,EAAoB,kBAAE,SAASyE,GAAG,OAAOtE,EAAG,KAAK,CAACrB,IAAI,IAAMoD,EAAOO,EAAOgC,GAAG,CAACzE,EAAIS,GAAG,KAAKT,EAAIoC,GAAGqC,GAAG,UAAStE,EAAG,KAAK,CAACrB,IAAI,OAAS2D,EAAOP,GAAM,CAAClC,EAAIS,GAAG,YAAWN,EAAG,KAAK,CAACrB,IAAI,OAASoD,SAAW,KAAK/B,EAAG,QAAQ,CAACH,EAAIgC,GAAIhC,EAAoB,kBAAE,SAAS0E,EAAIC,EAAOnC,GAAG,OAAOrC,EAAG,KAAK,CAACrB,IAAI6F,GAAQ,CAACxE,EAAG,KAAK,CAACE,YAAY,aAAa,CAACL,EAAIS,GAAGT,EAAIoC,GAAGI,EAAI,MAAMrC,EAAG,KAAK,CAAC2B,YAAY,CAAC,aAAa,SAAS,CAAC9B,EAAIS,GAAGT,EAAIoC,GAAGuC,MAAW3E,EAAIgC,GAAIhC,EAAqB,mBAAE,SAASiC,EAAMC,GAAM,MAAO,CAAClC,EAAIgC,GAAG,GAAQ,SAASS,GAAM,MAAO,CAACzC,EAAIgC,GAAIhC,EAAoB,kBAAE,SAASyE,GAAG,OAAOtE,EAAG,KAAK,CAACrB,IAAI6F,EAASzC,EAAOO,EAAOgC,GAAG,CAACzE,EAAIS,GAAG,IAAIT,EAAIoC,GAAsB,KAAnBsC,EAAItB,cAAqBpD,EAAIgD,YAAY0B,EAAKxC,EAAMO,EAAMgC,GAAK,KAAK,UAAStE,EAAG,KAAK,CAACrB,IAAI,OAAS6F,EAASzC,EAAOO,EAAKpC,YAAY,cAAcyB,YAAY,CAAC,cAAc,OAAO,aAAa,WAAW,CAAC9B,EAAIS,GAAG,IAAIT,EAAIoC,GAAsB,KAAnBsC,EAAItB,cAAqBpD,EAAI4E,0BAA0BF,EAAKxC,EAAMO,GAAQ,KAAK,WAAUtC,EAAG,KAAK,CAACrB,IAAI,WAAa6F,EAASzC,EAAK7B,YAAY,6BAA6B,CAACL,EAAIS,GAAG,IAAIT,EAAIoC,GAAsB,KAAnBsC,EAAItB,cAAqBpD,EAAI6E,oBAAoBH,EAAKxC,GAAQ,KAAK,WAAU/B,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAsB,KAAnBsC,EAAItB,cAAqBpD,EAAIuD,wBAAwBmB,GAAO,QAAQvE,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAsB,KAAnBsC,EAAItB,cAAqBpD,EAAIwD,0BAA0BkB,EAAI/B,MAAO,QAAU,QAAQxC,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAsB,KAAnBsC,EAAItB,cAAqBpD,EAAIwD,0BAA0BkB,EAAI/B,MAAO,UAAY,QAAQxC,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAsB,KAAnBsC,EAAItB,cAAqBpD,EAAIwD,0BAA0BkB,EAAI/B,MAAO,QAAU,QAAQxC,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAsB,KAAnBsC,EAAItB,cAAqBpD,EAAIwD,0BAA0BkB,EAAI/B,MAAO,YAAc,QAAQxC,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAsB,KAAnBsC,EAAItB,cAAqBsB,EAAIjB,KAAO,QAAQtD,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAsB,KAAnBsC,EAAItB,cAAqBsB,EAAIhB,KAAO,QAAQvD,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAsB,KAAnBsC,EAAItB,cAAqBpD,EAAI2D,YAAY3D,EAAI4D,qBAAqBe,IAAW,KAAK,IAAI3E,EAAIoC,GAAsB,KAAnBsC,EAAItB,cAAqBpD,EAAI4D,qBAAqBe,GAAU,QAAQxE,EAAG,KAAK,CAACE,YAAY,aAAa,CAACL,EAAIS,GAAGT,EAAIoC,GAAGI,EAAI,OAAO,MAAKrC,EAAG,KAAK,CAAC2B,YAAY,CAAC,mBAAmB,UAAU,cAAc,SAAS,CAAC3B,EAAG,KAAK,CAACG,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAG,iBAAiBT,EAAIgC,GAAIhC,EAAqB,mBAAE,SAASiC,EAAMC,GAAM,MAAO,CAAClC,EAAIgC,GAAG,GAAQ,SAASS,GAAM,MAAO,CAACzC,EAAIgC,GAAIhC,EAAoB,kBAAE,SAASyE,GAAG,OAAOtE,EAAG,KAAK,CAACrB,IAAI,KAAOoD,EAAOO,EAAOgC,GAAG,CAACzE,EAAIS,GAAG,IAAIT,EAAIoC,GAAGpC,EAAI8E,qBAAqB5C,EAAMO,EAAMgC,IAAI,UAAStE,EAAG,KAAK,CAACrB,IAAI,KAAOoD,EAAOO,GAAM,CAACzC,EAAIS,GAAG,IAAIT,EAAIoC,GAAGpC,EAAI+E,6BAA6B7C,EAAMO,IAAO,WAAUtC,EAAG,KAAK,CAACrB,IAAI,MAAQoD,EAAK7B,YAAY,iBAAiB,CAACL,EAAIS,GAAG,IAAIT,EAAIoC,GAAGpC,EAAI8D,uBAAuB5B,IAAO,WAAU/B,EAAG,MAAMH,EAAIS,GAAG,KAAKN,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAGpC,EAAIgF,QAAQC,SAAS9E,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAGpC,EAAIgF,QAAQE,WAAW/E,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAGpC,EAAIgF,QAAQG,SAAShF,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAGpC,EAAIgF,QAAQI,aAAajF,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAGpC,EAAIgF,QAAQvB,SAAStD,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAGpC,EAAIgF,QAAQtB,SAASvD,EAAG,MAAMH,EAAIS,GAAG,KAAKN,EAAG,OAAO,IAAI,KAAKA,EAAG,MAAM,CAAC2B,YAAY,CAAC,gBAAgB,SAAS,CAAC3B,EAAG,WAAW,CAACE,YAAY,kBAAkBC,MAAM,CAAC,QAAU,WAAWe,GAAG,CAAC,MAAQrB,EAAIiE,WAAW,CAACjE,EAAIS,GAAG,0BAA0BN,EAAG,WAAW,CAACE,YAAY,kBAAkBC,MAAM,CAAC,QAAU,mBAAmBe,GAAG,CAAC,MAAQrB,EAAIkE,iBAAiB,CAAClE,EAAIS,GAAG,uBAAuB,MAAM,IAAa,IACl0M,GAAkB,GC8JtB,IACE,KAAF,sBACE,WAAF,GAEE,KAJF,WAKI,MAAJ,CACM,OAAN,KACM,WAAN,GACM,UAAN,EACM,cAAN,KACM,QAAN,KACM,gBAAN,GACM,WAAN,KACM,YAAN,KACM,QAAN,KACM,aAAN,EACM,SAAN,GACM,aAAN,GACM,sBAAN,GACM,iBAAN,KAGE,QAAF,CACI,YADJ,SACA,GACM,IAAN,gCACA,iCACA,IACM,OAAN,cAGI,qBARJ,SAQA,OAAM,IAAN,OACA,IACA,mCACA,YAAQ,OAAR,gCAEA,mDASM,OARA,OAAN,mDAAQ,IAAR,UACA,sMACA,MACA,kCAEA,sCAGA,GAEI,6BAxBJ,SAwBA,KAAM,IAAN,OACA,IACA,mCACA,YAAQ,OAAR,gCAEA,mDAWM,OAVA,OAAN,mDAAQ,IAAR,MACA,sIACQ,GAAR,EAAQ,CACA,IAAR,8CACA,MACA,6BAEA,kCAGA,GAEI,uBA1CJ,SA0CA,GAAM,IAAN,OACA,IAKM,OAJA,OAAN,mDACQ,IAAR,0CACA,0CAEA,GAEI,gBAlDJ,WAkDM,IAAN,OACA,wBAUM,OATA,OAAN,mDACQ,GAAR,4CACQ,GAAR,8CACQ,GAAR,4CACQ,GAAR,gDACQ,GAAR,UACQ,GAAR,aAGA,CAAQ,KAAR,EAAQ,OAAR,EAAQ,KAAR,EAAQ,SAAR,EAAQ,KAAR,EAAQ,KAAR,IAEI,aA/DJ,SA+DA,GAGM,IAAN,iDAAQ,OAAR,cACM,QAAN,oBAAQ,OAAR,kCACA,oBAAQ,OAAR,mDAGI,oBAvEJ,SAuEA,KACM,IAAN,sBACM,OAAN,mCAEI,YA3EJ,SA2EA,SAAM,IAAN,UACA,sMAEM,OADN,cACA,oCAEI,0BAhFJ,SAgFA,OAAM,IAAN,MACA,sIACM,OAAN,yCAEI,2BApFJ,SAoFA,GACM,IAAN,UACA,aACA,UACM,GAAN,kDACM,IAAN,IACM,GAAN,yEACQ,GAAR,OAEU,IADA,IAAV,IACA,cAAY,IAAZ,EACA,kCACA,MACc,GAAd,EACc,KAGJ,OAAV,UACU,GAAV,EACA,gEAEU,IAAV,kBAAY,IAAZ,EACA,kCACY,GAAZ,WAEU,OAAV,+DAEA,4EACQ,GAAR,OAEU,IADA,IAAV,IACA,cAAY,IAAZ,EACA,kCACA,MACc,GAAd,EACc,KAGJ,OAAV,UACU,GAAV,EACA,gEAEU,IAAV,kBAAY,IAAZ,EACA,kCACY,GAAZ,WAEU,OAAV,+DAEA,4EAAQ,IAAR,EACA,kCACQ,OAAR,oBACA,4EAAQ,IAAR,EACA,kCACQ,OAAR,oBAGQ,IADA,IAAR,IACA,cAAU,IAAV,EACA,kCACA,MACY,GAAZ,EACY,KAGJ,GAAR,eACQ,IAAR,MACQ,OAAR,gEAGI,qBAtJJ,SAsJA,GAAM,IAAN,OACA,+BACM,IAAN,sBACM,IAAN,IAKM,OAJA,EAAN,qBACQ,GAAR,qDACQ,GAAR,gEAEA,qCAEI,wBAhKJ,SAgKA,GAAM,IAAN,OACA,2BACA,IACA,IASM,OARA,EAAN,qBACQ,GAAR,kBAAQ,CACA,IAAR,iDACA,WACU,GAAV,EACU,SAGV,yBAEI,gBA9KJ,SA8KA,GACM,IAAN,IAKM,OAJA,OAAN,mDACA,2BACA,8BAEA,GAEI,yBAtLJ,SAsLA,OAAM,IAAN,OACA,IAiBM,OAhBA,OAAN,mDAAQ,IAAR,QACA,+FACA,6GACA,sBACA,OACA,qCACA,iEACA,+DACA,qEAHA,KAKA,sCACA,mEACA,iEACA,uEAHA,QAMA,GAEI,mBA1MJ,SA0MA,GAAM,IAAN,OACA,IAmBM,OAlBA,OAAN,mDACQ,EAAR,2CAAU,IAAV,gCACA,+FACA,6GACA,sBACA,OACA,qCACA,iEACA,+DACA,qEAHA,KAKA,sCACA,mEACA,iEACA,uEAHA,WAOA,GAEI,YAhOJ,SAgOA,GACM,OAAN,WACA,WACA,WACA,IAEI,0BAtOJ,SAsOA,KAAM,IAAN,OACA,IAsBM,OArBA,OAAN,mCACQ,OAAR,+CACU,IAAV,8CACA,uBACA,UACA,6EACA,6EACA,sBACA,OACA,qCACA,iEACA,+DACA,qEAHA,KAKA,sCACA,mEACA,iEACA,uEAHA,WAOA,GAEI,cA/PJ,SA+PA,OAAM,IAAN,MACM,OAAN,iIAEI,gBAlQJ,SAkQA,OAAM,IAAN,IACA,mGACM,MAAN,wCAEI,oBAtQJ,SAsQA,OAAM,IAAN,IACA,uGACM,MAAN,wCAEI,aA1QJ,SA0QA,SAAM,IAAN,IACA,6GACM,OAAN,MACA,4CACA,8CACA,4CACA,iDACA,kBAEA,6CACA,+CACA,6CACA,kDACA,mBAGI,eA1RJ,SA0RA,GAEM,OADA,QAAN,OACA,sCACA,qBACA,uBACA,uBACA,0BACA,mBAEI,oBAnSJ,SAmSA,GACM,OAAN,4CACA,8CACA,4CACA,iDACA,mBAEI,qBA1SJ,WA0SM,IAAN,OAAM,OAAN,yIACA,iBACA,yCACA,2CACA,6CACA,+CACA,mGACA,gBAPA,wBAQA,sGACA,gDACA,kBACA,yBAGA,2BAdA,UAeA,IACA,+EACA,kBACA,cACA,sFACA,kBAEA,iBAEA,kCACA,qEACA,0BACA,gCAEA,qEACA,oDACA,gCAEA,qEACA,0BACA,iCAEA,4IAGA,cAFA,sCAUA,mBACA,gIACA,oBAlDA,eAoDA,cApDA,UAqDA,IACA,yIACA,kBACA,cACA,+FACA,kBAEA,kBACA,4BAIA,mBACA,yIACA,oBAnEA,QAuEA,iBAvEA,+CAyEI,SAnXJ,WAoXM,IAAN,wCACA,qDACA,4CACA,uCACM,EAAN,y6BAsBA,oCAtBA,qCAsBA,EAtBA,qBAsBA,gBAtBA,qBAsBA,iBAtBA,0BAsBA,2BAtBA,4CAuBA,EAvBA,2EAwBA,EAxBA,+CA2BM,EAAN,iBACM,EAAN,SAEI,eAtZJ,WAuZM,IAAN,kCACA,8BACM,EAAN,wCAEI,UA3ZJ,SA2ZA,GACM,IAAN,2CACM,OAAN,+BAEI,sBA/ZJ,WA+ZM,IAAN,OAAM,OAAN,sIACA,qBACA,gDACA,qBACA,0EAJA,8CAQI,iBAvaJ,WAuaM,IAAN,OAAM,OAAN,sIACA,gBACA,+CACA,6DAHA,8CAMI,oBA7aJ,WA6aM,IAAN,OAAM,OAAN,sIACA,mBACA,6CACA,mEAHA,8CAMI,iBAnbJ,SAmbA,OACM,KAAN,kBAAQ,MAAR,EAAQ,QAAR,EAAQ,QAAR,uBAAQ,OAAR,EAAQ,cAAR,IAAQ,aAAR,MAGE,SAAF,CACI,QADJ,WAEM,OAAN,wBAEI,iBAJJ,WAIM,IAAN,OACA,KAoCM,OAnCA,KAAN,8BACQ,IAAR,+MACA,OACU,EAAV,IAAY,cAAZ,EAAY,KAAZ,EAAY,KAAZ,EAAY,MAAZ,KAEA,gBACU,EAAV,aAAY,YAAZ,KAEA,+BACU,EAAV,4BACY,SAAZ,GACY,MAAZ,EACY,mBAAZ,EACY,WAAZ,EACY,MAAZ,CAAc,EAAd,sBAAc,EAAd,sBAAc,EAAd,sBAAc,EAAd,yBAGQ,IAAR,IAGY,EAFZ,OACA,8BACA,EAEA,aAGA,aACA,0BAEA,QAGQ,EAAR,yCACQ,EAAR,cACQ,EAAR,iBAEA,GAEI,0BA3CJ,WA4CM,IAAN,sDAAQ,OAAR,WACM,OAAN,QAEI,qBA/CJ,WA+CM,IAAN,OACA,yDAAQ,IAAR,oCACA,2CACQ,MAAR,CAAU,OAAV,EAAU,SAAV,iBAGM,EAAN,oBAAQ,OAAR,yBACM,IAAN,KACA,IACA,IACA,OAUM,OATA,EAAN,qBACA,iBACU,EAAV,EACU,EAAV,WACU,KAEF,EAAR,eAGA,GAEI,kBArEJ,WAsEM,IAAN,KAKM,OAJA,KAAN,2CAAQ,IAAR,wBACA,gBACQ,EAAR,cAEA,IAGE,YA3hBF,WA4hBI,KAAJ,mBACI,KAAJ,sBACI,KAAJ,+EC7rBwX,MCQpX,I,UAAY,eACd,GACA,GACA,IACA,EACA,KACA,WACA,OAIa,M,QCnBX,GAAS,WAAa,IAAIT,EAAIP,KAASQ,EAAGD,EAAIE,eAAmBC,EAAGH,EAAII,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACA,EAAG,QAAQ,CAACE,YAAY,QAAQ,CAACF,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,OAAO,CAACH,EAAG,SAAS,CAACI,YAAYP,EAAIQ,GAAG,CAAC,CAAC1B,IAAI,SAASS,GAAG,WAAW,MAAO,CAACY,EAAG,KAAK,CAACE,YAAY,QAAQ,CAACF,EAAG,SAAS,CAACG,MAAM,CAAC,KAAO,iBAAiB,cAAc,UAAUN,EAAIS,GAAG,sCAAsC,KAAKC,OAAM,MAAS,CAACP,EAAG,cAAc,CAACA,EAAG,QAAQ,CAACA,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,MAAM,CAACH,EAAG,eAAe,CAACE,YAAY,WAAWC,MAAM,CAAC,MAAQ,sBAAsB,YAAY,UAAU,CAACH,EAAG,gBAAgB,CAACQ,IAAI,QAAQL,MAAM,CAAC,GAAK,QAAQ,QAAUN,EAAI0B,YAAYL,GAAG,CAAC,OAAS,SAASC,GAAQtB,EAAIwB,QAAQ,KAAKxB,EAAI2B,0BAA0Bd,MAAM,CAAC5B,MAAOe,EAAU,OAAEc,SAAS,SAAUC,GAAMf,EAAIuB,OAAOR,GAAKE,WAAW,aAAa,IAAI,GAAGd,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,MAAM,CAACH,EAAG,eAAe,CAACE,YAAY,WAAWC,MAAM,CAAC,MAAQ,uBAAuB,YAAY,WAAW,CAACH,EAAG,gBAAgB,CAACQ,IAAI,SAASL,MAAM,CAAC,GAAK,SAAS,QAAUN,EAAI4B,gBAAgB,SAAuB,MAAZ5B,EAAIuB,QAA6BF,GAAG,CAAC,OAAS,SAASC,GAAQ,OAAOtB,EAAI6B,yBAAyBhB,MAAM,CAAC5B,MAAOe,EAAW,QAAEc,SAAS,SAAUC,GAAMf,EAAIwB,QAAQT,GAAKE,WAAW,cAAc,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,GAAGd,EAAG,QAAQ,CAACA,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,OAAO,CAAEN,EAAe,YAAEG,EAAG,MAAM,CAACA,EAAG,MAAM,CAACE,YAAY,gCAAgC,CAACF,EAAG,YAAY,CAAC2B,YAAY,CAAC,MAAQ,OAAO,OAAS,QAAQxB,MAAM,CAAC,MAAQ,aAAaH,EAAG,MAAMA,EAAG,SAAS,CAACH,EAAIS,GAAG,0BAA0B,KAAKT,EAAIkB,QAAQ,GAAKlB,EAAI+B,aAA4B,MAAb/B,EAAIwB,QAA2vJxB,EAAIkB,KAAhvJf,EAAG,QAAQ,CAACA,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,OAAO,CAACH,EAAG,QAAQ,CAACE,YAAY,mBAAmBC,MAAM,CAAC,OAAS,IAAI,YAAc,IAAI,YAAc,MAAM,CAACH,EAAG,QAAQ,CAACA,EAAG,KAAK,CAACA,EAAG,KAAK,CAACG,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAG,OAAON,EAAG,KAAK,CAACG,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAG,gBAAgBT,EAAIgC,GAAIhC,EAAqB,mBAAE,SAASiC,EAAMC,GAAM,MAAO,CAAC/B,EAAG,KAAK,CAACrB,IAAIoD,EAAK5B,MAAM,CAAC,QAAUN,EAAIuE,YAAYrC,KAAQ,CAAClC,EAAIS,GAAG,IAAIT,EAAIoC,GAAGF,GAAM,WAAU/B,EAAG,KAAK,CAACG,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAG,aAAaN,EAAG,KAAK,CAACG,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAG,OAAON,EAAG,MAAMH,EAAIS,GAAG,QAAQN,EAAG,MAAMH,EAAIS,GAAG,SAASN,EAAG,KAAK,CAACG,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAG,OAAON,EAAG,MAAMH,EAAIS,GAAG,QAAQN,EAAG,MAAMH,EAAIS,GAAG,SAASN,EAAG,KAAK,CAACG,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAG,OAAON,EAAG,MAAMH,EAAIS,GAAG,QAAQN,EAAG,MAAMH,EAAIS,GAAG,SAASN,EAAG,KAAK,CAACG,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAG,OAAON,EAAG,MAAMH,EAAIS,GAAG,QAAQN,EAAG,MAAMH,EAAIS,GAAG,SAASN,EAAG,KAAK,CAACG,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAG,OAAON,EAAG,MAAMH,EAAIS,GAAG,SAASN,EAAG,KAAK,CAACG,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAG,OAAON,EAAG,MAAMH,EAAIS,GAAG,SAASN,EAAG,KAAK,CAACG,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAG,YAAYN,EAAG,KAAK,CAACG,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAG,QAAQ,GAAGN,EAAG,KAAK,CAACH,EAAIgC,GAAIhC,EAAqB,mBAAE,SAASiC,EAAMC,GAAM,MAAO,CAAClC,EAAIgC,GAAG,GAAQ,SAASS,EAAKC,GAAG,MAAO,CAACvC,EAAG,KAAK,CAACrB,IAAI,QAAU2D,EAAOC,EAAEpC,MAAM,CAAC,QAAUN,EAAIwE,iBAAiBrC,OAAS,IAAI,CAACnC,EAAIS,GAAG,IAAIT,EAAIoC,GAAGK,GAAM,WAAUtC,EAAG,KAAK,CAACrB,IAAI,aAAeoD,EAAK7B,YAAY,iBAAiB,CAACL,EAAIS,GAAG,iBAAgB,GAAGN,EAAG,KAAK,CAACH,EAAIgC,GAAIhC,EAAqB,mBAAE,SAASiC,EAAMC,GAAM,MAAO,CAAClC,EAAIgC,GAAG,GAAQ,SAASS,GAAM,MAAO,CAACzC,EAAIgC,GAAIhC,EAAoB,kBAAE,SAASyE,GAAG,OAAOtE,EAAG,KAAK,CAACrB,IAAI,IAAMoD,EAAOO,EAAOgC,GAAG,CAACzE,EAAIS,GAAG,KAAKT,EAAIoC,GAAGqC,GAAG,UAAStE,EAAG,KAAK,CAACrB,IAAI,OAAS2D,EAAOP,GAAM,CAAClC,EAAIS,GAAG,YAAWN,EAAG,KAAK,CAACrB,IAAI,OAASoD,SAAW,KAAK/B,EAAG,QAAQ,CAACH,EAAIgC,GAAIhC,EAAoB,kBAAE,SAAS0E,EAAIC,EAAOnC,GAAG,OAAOrC,EAAG,KAAK,CAACrB,IAAI6F,GAAQ,CAACxE,EAAG,KAAK,CAACE,YAAY,aAAa,CAACL,EAAIS,GAAGT,EAAIoC,GAAGI,EAAI,MAAMrC,EAAG,KAAK,CAAC2B,YAAY,CAAC,aAAa,SAAS,CAAC9B,EAAIS,GAAGT,EAAIoC,GAAGuC,MAAW3E,EAAIgC,GAAIhC,EAAqB,mBAAE,SAASiC,EAAMC,GAAM,MAAO,CAAClC,EAAIgC,GAAG,GAAQ,SAASS,GAAM,MAAO,CAACzC,EAAIgC,GAAIhC,EAAoB,kBAAE,SAASyE,GAAG,OAAOtE,EAAG,KAAK,CAACrB,IAAI6F,EAASzC,EAAOO,EAAOgC,GAAG,CAACzE,EAAIS,GAAG,IAAIT,EAAIoC,GAAsB,KAAnBsC,EAAItB,cAAqBpD,EAAIgD,YAAY0B,EAAKxC,EAAMO,EAAMgC,GAAK,KAAK,UAAStE,EAAG,KAAK,CAACrB,IAAI,OAAS6F,EAASzC,EAAOO,EAAKpC,YAAY,cAAcyB,YAAY,CAAC,cAAc,OAAO,aAAa,WAAW,CAAC9B,EAAIS,GAAG,IAAIT,EAAIoC,GAAsB,KAAnBsC,EAAItB,cAAqBpD,EAAI4E,0BAA0BF,EAAKxC,EAAMO,GAAQ,KAAK,WAAUtC,EAAG,KAAK,CAACrB,IAAI,WAAa6F,EAASzC,EAAK7B,YAAY,6BAA6B,CAACL,EAAIS,GAAG,IAAIT,EAAIoC,GAAsB,KAAnBsC,EAAItB,cAAqBpD,EAAI6E,oBAAoBH,EAAKxC,GAAQ,KAAK,WAAU/B,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAsB,KAAnBsC,EAAItB,cAAqBpD,EAAIuD,wBAAwBmB,GAAO,QAAQvE,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAsB,KAAnBsC,EAAItB,cAAqBpD,EAAIwD,0BAA0BkB,EAAI/B,MAAO,QAAU,QAAQxC,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAsB,KAAnBsC,EAAItB,cAAqBpD,EAAIwD,0BAA0BkB,EAAI/B,MAAO,UAAY,QAAQxC,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAsB,KAAnBsC,EAAItB,cAAqBpD,EAAIwD,0BAA0BkB,EAAI/B,MAAO,QAAU,QAAQxC,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAsB,KAAnBsC,EAAItB,cAAqBpD,EAAIwD,0BAA0BkB,EAAI/B,MAAO,YAAc,QAAQxC,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAsB,KAAnBsC,EAAItB,cAAqBsB,EAAIjB,KAAO,QAAQtD,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAsB,KAAnBsC,EAAItB,cAAqBsB,EAAIhB,KAAO,QAAQvD,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAsB,KAAnBsC,EAAItB,cAAqBpD,EAAI2D,YAAY3D,EAAI4D,qBAAqBe,IAAW,KAAK,IAAI3E,EAAIoC,GAAsB,KAAnBsC,EAAItB,cAAqBpD,EAAI4D,qBAAqBe,GAAU,QAAQxE,EAAG,KAAK,CAACE,YAAY,aAAa,CAACL,EAAIS,GAAGT,EAAIoC,GAAGI,EAAI,OAAO,MAAKrC,EAAG,KAAK,CAAC2B,YAAY,CAAC,mBAAmB,UAAU,cAAc,SAAS,CAAC3B,EAAG,KAAK,CAACG,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAG,iBAAiBT,EAAIgC,GAAIhC,EAAqB,mBAAE,SAASiC,EAAMC,GAAM,MAAO,CAAClC,EAAIgC,GAAG,GAAQ,SAASS,GAAM,MAAO,CAACzC,EAAIgC,GAAIhC,EAAoB,kBAAE,SAASyE,GAAG,OAAOtE,EAAG,KAAK,CAACrB,IAAI,KAAOoD,EAAOO,EAAOgC,GAAG,CAACzE,EAAIS,GAAG,IAAIT,EAAIoC,GAAGpC,EAAI8E,qBAAqB5C,EAAMO,EAAMgC,IAAI,UAAStE,EAAG,KAAK,CAACrB,IAAI,KAAOoD,EAAOO,GAAM,CAACzC,EAAIS,GAAG,IAAIT,EAAIoC,GAAGpC,EAAI+E,6BAA6B7C,EAAMO,IAAO,WAAUtC,EAAG,KAAK,CAACrB,IAAI,MAAQoD,EAAK7B,YAAY,iBAAiB,CAACL,EAAIS,GAAG,IAAIT,EAAIoC,GAAGpC,EAAI8D,uBAAuB5B,IAAO,WAAU/B,EAAG,MAAMH,EAAIS,GAAG,KAAKN,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAGpC,EAAIgF,QAAQC,SAAS9E,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAGpC,EAAIgF,QAAQE,WAAW/E,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAGpC,EAAIgF,QAAQG,SAAShF,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAGpC,EAAIgF,QAAQI,aAAajF,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAGpC,EAAIgF,QAAQvB,SAAStD,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAGpC,EAAIgF,QAAQtB,SAASvD,EAAG,MAAMH,EAAIS,GAAG,KAAKN,EAAG,OAAO,IAAI,KAAKA,EAAG,MAAM,CAAC2B,YAAY,CAAC,gBAAgB,SAAS,CAAC3B,EAAG,WAAW,CAACE,YAAY,kBAAkBC,MAAM,CAAC,QAAU,WAAWe,GAAG,CAAC,MAAQrB,EAAIiE,WAAW,CAACjE,EAAIS,GAAG,0BAA0BN,EAAG,WAAW,CAACE,YAAY,kBAAkBC,MAAM,CAAC,QAAU,mBAAmBe,GAAG,CAAC,MAAQrB,EAAIkE,iBAAiB,CAAClE,EAAIS,GAAG,uBAAuB,MAAM,IAAa,IACnzM,GAAkB,GC8JtB,IACE,KAAF,sBACE,WAAF,GAEE,KAJF,WAKI,MAAJ,CACM,OAAN,KACM,WAAN,GACM,UAAN,EACM,cAAN,KACM,QAAN,KACM,gBAAN,GACM,WAAN,KACM,YAAN,KACM,QAAN,KACM,aAAN,EACM,SAAN,GACM,aAAN,GACM,sBAAN,GACM,iBAAN,KAGE,QAAF,CACI,YADJ,SACA,GACM,IAAN,gCACA,iCACA,IACM,OAAN,cAGI,qBARJ,SAQA,OAAM,IAAN,OACA,IACA,mCACA,YAAQ,OAAR,gCAEA,mDASM,OARA,OAAN,mDAAQ,IAAR,UACA,sMACA,MACA,kCAEA,sCAGA,GAEI,6BAxBJ,SAwBA,KAAM,IAAN,OACA,IACA,mCACA,YAAQ,OAAR,gCAEA,mDAWM,OAVA,OAAN,mDAAQ,IAAR,MACA,sIACQ,GAAR,EAAQ,CACA,IAAR,8CACA,MACA,6BAEA,kCAGA,GAEI,uBA1CJ,SA0CA,GAAM,IAAN,OACA,IAKM,OAJA,OAAN,mDACQ,IAAR,0CACA,0CAEA,GAEI,gBAlDJ,WAkDM,IAAN,OACA,wBAUM,OATA,OAAN,mDACQ,GAAR,4CACQ,GAAR,8CACQ,GAAR,4CACQ,GAAR,gDACQ,GAAR,UACQ,GAAR,aAGA,CAAQ,KAAR,EAAQ,OAAR,EAAQ,KAAR,EAAQ,SAAR,EAAQ,KAAR,EAAQ,KAAR,IAEI,aA/DJ,SA+DA,GAGM,IAAN,iDAAQ,OAAR,cACM,QAAN,oBAAQ,OAAR,kCACA,oBAAQ,OAAR,mDAGI,oBAvEJ,SAuEA,KACM,IAAN,sBACM,OAAN,mCAEI,YA3EJ,SA2EA,SAAM,IAAN,UACA,sMAEM,OADN,cACA,oCAEI,0BAhFJ,SAgFA,OAAM,IAAN,MACA,sIACM,OAAN,yCAEI,2BApFJ,SAoFA,GACM,IAAN,UACA,aACA,UACM,GAAN,iBAEM,IADA,IAAN,IACA,cAAQ,IAAR,EACA,kCACQ,GAAR,WAEM,OAAN,cAGI,qBAjGJ,SAiGA,GAAM,IAAN,OACA,+BACM,IAAN,sBACM,IAAN,IAKM,OAJA,EAAN,qBACQ,GAAR,qDACQ,GAAR,gEAEA,qCAEI,wBA3GJ,SA2GA,GAAM,IAAN,OACA,2BACA,IACA,IASM,OARA,EAAN,qBACQ,GAAR,kBAAQ,CACA,IAAR,iDACA,WACU,GAAV,EACU,SAGV,yBAEI,gBAzHJ,SAyHA,GACM,IAAN,IAKM,OAJA,OAAN,mDACA,2BACA,8BAEA,GAEI,yBAjIJ,SAiIA,OAAM,IAAN,OACA,IAiBM,OAhBA,OAAN,mDAAQ,IAAR,QACA,+FACA,6GACA,sBACA,OACA,qCACA,iEACA,+DACA,qEAHA,KAKA,sCACA,mEACA,iEACA,uEAHA,QAMA,GAEI,mBArJJ,SAqJA,GAAM,IAAN,OACA,IAmBM,OAlBA,OAAN,mDACQ,EAAR,2CAAU,IAAV,gCACA,+FACA,6GACA,sBACA,OACA,qCACA,iEACA,+DACA,qEAHA,KAKA,sCACA,mEACA,iEACA,uEAHA,WAOA,GAEI,YA3KJ,SA2KA,GACM,OAAN,WACA,WACA,WACA,IAEI,0BAjLJ,SAiLA,KAAM,IAAN,OACA,IAmBM,OAlBA,OAAN,mCACQ,OAAR,+CACU,IAAV,8CACA,uBACA,sBACA,OACA,qCACA,iEACA,+DACA,qEAHA,KAKA,sCACA,mEACA,iEACA,uEAHA,WAOA,GAEI,cAvMJ,SAuMA,OAAM,IAAN,MACM,OAAN,iIAEI,gBA1MJ,SA0MA,OAAM,IAAN,IACA,mGACM,MAAN,wCAEI,oBA9MJ,SA8MA,OAAM,IAAN,IACA,uGACM,MAAN,wCAEI,aAlNJ,SAkNA,SAAM,IAAN,IACA,6GACM,OAAN,MACA,4CACA,8CACA,4CACA,iDACA,kBAEA,6CACA,+CACA,6CACA,kDACA,mBAGI,eAlOJ,SAkOA,GAEM,OADA,QAAN,OACA,sCACA,qBACA,uBACA,uBACA,0BACA,mBAEI,oBA3OJ,SA2OA,GACM,OAAN,4CACA,8CACA,4CACA,iDACA,mBAEI,qBAlPJ,WAkPM,IAAN,OAAM,OAAN,yIACA,iBACA,yCACA,2CACA,6CACA,+CACA,mGACA,gBAPA,wBAQA,sGACA,gDACA,kBACA,yBAGA,2BAdA,UAeA,IACA,+EACA,kBACA,cACA,sFACA,kBAEA,iBAEA,kCACA,aACA,sCAMA,mBACA,gIACA,oBAlCA,eAoCA,cApCA,UAqCA,IACA,yIACA,kBACA,cACA,+FACA,kBAEA,kBACA,4BAIA,mBACA,yIACA,oBAnDA,QAuDA,iBAvDA,+CAyDI,SA3SJ,WA4SM,IAAN,wCACA,qCACA,4CACA,uCACM,EAAN,y6BAsBA,oCAtBA,qCAsBA,EAtBA,qBAsBA,gBAtBA,qBAsBA,iBAtBA,0BAsBA,2BAtBA,4CAuBA,EAvBA,2EAwBA,EAxBA,+CA2BM,EAAN,iBACM,EAAN,SAEI,eA9UJ,WA+UM,IAAN,kCACA,8BACM,EAAN,wCAEI,UAnVJ,SAmVA,GACM,IAAN,2CACM,OAAN,+BAEI,sBAvVJ,WAuVM,IAAN,OAAM,OAAN,sIACA,qBACA,gDACA,qBACA,0EAJA,8CAQI,iBA/VJ,WA+VM,IAAN,OAAM,OAAN,sIACA,gBACA,+CACA,6DAHA,8CAMI,oBArWJ,WAqWM,IAAN,OAAM,OAAN,sIACA,mBACA,6CACA,mEAHA,8CAMI,iBA3WJ,SA2WA,OACM,KAAN,kBAAQ,MAAR,EAAQ,QAAR,EAAQ,QAAR,uBAAQ,OAAR,EAAQ,cAAR,IAAQ,aAAR,MAGE,SAAF,CACI,QADJ,WAEM,OAAN,wBAEI,iBAJJ,WAIM,IAAN,OACA,KAoCM,OAnCA,KAAN,8BACQ,IAAR,+MACA,OACU,EAAV,IAAY,cAAZ,EAAY,KAAZ,EAAY,KAAZ,EAAY,MAAZ,KAEA,gBACU,EAAV,aAAY,YAAZ,KAEA,+BACU,EAAV,4BACY,SAAZ,GACY,MAAZ,EACY,mBAAZ,EACY,WAAZ,EACY,MAAZ,CAAc,EAAd,GAAc,EAAd,GAAc,EAAd,GAAc,EAAd,MAGQ,IAAR,IAGY,EAFZ,OACA,8BACA,EAEA,aAGA,aACA,0BAEA,QAGQ,EAAR,yCACQ,EAAR,cACQ,EAAR,iBAEA,GAEI,0BA3CJ,WA4CM,IAAN,sDAAQ,OAAR,WACM,OAAN,QAEI,qBA/CJ,WA+CM,IAAN,OACA,yDAAQ,IAAR,oCACA,2CACQ,MAAR,CAAU,OAAV,EAAU,SAAV,iBAGM,EAAN,oBAAQ,OAAR,yBACM,IAAN,KACA,IACA,IACA,OAUM,OATA,EAAN,qBACA,iBACU,EAAV,EACU,EAAV,WACU,KAEF,EAAR,eAGA,GAEI,kBArEJ,WAsEM,IAAN,KAKM,OAJA,KAAN,2CAAQ,IAAR,wBACA,gBACQ,EAAR,cAEA,IAGE,YAndF,WAodI,KAAJ,mBACI,KAAJ,sBACI,KAAJ,+ECrnBgY,MCQ5X,I,UAAY,eACd,GACA,GACA,IACA,EACA,KACA,WACA,OAIa,M,QCnBX,GAAS,WAAa,IAAIT,EAAIP,KAASQ,EAAGD,EAAIE,eAAmBC,EAAGH,EAAII,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACA,EAAG,QAAQ,CAACE,YAAY,QAAQ,CAACF,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,OAAO,CAACH,EAAG,SAAS,CAACI,YAAYP,EAAIQ,GAAG,CAAC,CAAC1B,IAAI,SAASS,GAAG,WAAW,MAAO,CAACY,EAAG,KAAK,CAACE,YAAY,QAAQ,CAACF,EAAG,SAAS,CAACG,MAAM,CAAC,KAAO,iBAAiB,cAAc,UAAUN,EAAIS,GAAG,sCAAsC,KAAKC,OAAM,MAAS,CAACP,EAAG,cAAc,CAACA,EAAG,QAAQ,CAACA,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,MAAM,CAACH,EAAG,eAAe,CAACE,YAAY,WAAWC,MAAM,CAAC,MAAQ,sBAAsB,YAAY,UAAU,CAACH,EAAG,gBAAgB,CAACQ,IAAI,QAAQL,MAAM,CAAC,GAAK,QAAQ,QAAUN,EAAI0B,WAAW,SAA0B,MAAf1B,EAAIyB,WAAgCJ,GAAG,CAAC,OAAS,SAASC,GAAQtB,EAAIwB,QAAQ,KAAKxB,EAAI2B,0BAA0Bd,MAAM,CAAC5B,MAAOe,EAAU,OAAEc,SAAS,SAAUC,GAAMf,EAAIuB,OAAOR,GAAKE,WAAW,aAAa,IAAI,GAAGd,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,MAAM,CAACH,EAAG,eAAe,CAACE,YAAY,WAAWC,MAAM,CAAC,MAAQ,uBAAuB,YAAY,WAAW,CAACH,EAAG,gBAAgB,CAACQ,IAAI,SAASL,MAAM,CAAC,GAAK,SAAS,QAAUN,EAAI4B,gBAAgB,SAAuB,MAAZ5B,EAAIuB,QAA6BF,GAAG,CAAC,OAAS,SAASC,GAAQ,OAAOtB,EAAI6B,yBAAyBhB,MAAM,CAAC5B,MAAOe,EAAW,QAAEc,SAAS,SAAUC,GAAMf,EAAIwB,QAAQT,GAAKE,WAAW,cAAc,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,GAAGd,EAAG,QAAQ,CAACA,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,OAAO,CAAEN,EAAe,YAAEG,EAAG,MAAM,CAACA,EAAG,MAAM,CAACE,YAAY,gCAAgC,CAACF,EAAG,YAAY,CAAC2B,YAAY,CAAC,MAAQ,OAAO,OAAS,QAAQxB,MAAM,CAAC,MAAQ,aAAaH,EAAG,MAAMA,EAAG,SAAS,CAACH,EAAIS,GAAG,0BAA0B,KAAKT,EAAIkB,QAAQ,GAAKlB,EAAI+B,aAA4B,MAAb/B,EAAIwB,QAAuwExB,EAAIkB,KAA5vEf,EAAG,QAAQ,CAACA,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,OAAO,CAACH,EAAG,QAAQ,CAACE,YAAY,mBAAmBC,MAAM,CAAC,OAAS,IAAI,YAAc,IAAI,YAAc,MAAM,CAACH,EAAG,QAAQ,CAACA,EAAG,KAAK,CAACA,EAAG,KAAK,CAACG,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAG,OAAON,EAAG,KAAK,CAACG,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAG,gBAAgBT,EAAIgC,GAAIhC,EAAqB,mBAAE,SAASiC,EAAMC,GAAM,MAAO,CAAC/B,EAAG,KAAK,CAACrB,IAAIoD,EAAK5B,MAAM,CAAC,QAAyB,EAAf2B,EAAME,OAAa,IAAI,CAACnC,EAAIS,GAAGT,EAAIoC,GAAGF,UAAY/B,EAAG,KAAK,CAACG,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAG,SAASN,EAAG,KAAK,CAACG,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAG,UAAU,GAAGN,EAAG,KAAK,CAACH,EAAIgC,GAAIhC,EAAqB,mBAAE,SAASiC,EAAMC,GAAM,MAAO,CAAClC,EAAIgC,GAAG,GAAQ,SAASS,EAAKC,GAAG,MAAO,CAACvC,EAAG,KAAK,CAACrB,IAAI,QAAU2D,EAAOC,EAAEpC,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAGT,EAAIoC,GAAGK,UAAYtC,EAAG,KAAK,CAACrB,IAAI,aAAeoD,EAAK5B,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAG,iBAAgB,GAAGN,EAAG,KAAK,CAACH,EAAIgC,GAAIhC,EAAqB,mBAAE,SAASiC,EAAMC,GAAM,MAAO,CAAClC,EAAIgC,GAAG,GAAQ,SAASS,GAAM,MAAO,CAACtC,EAAG,KAAK,CAACrB,IAAI,KAAO2D,EAAOP,GAAM,CAAClC,EAAIS,GAAG,QAAQN,EAAG,KAAK,CAACrB,IAAI,KAAO2D,EAAOP,GAAM,CAAClC,EAAIS,GAAG,QAAQN,EAAG,KAAK,CAACrB,IAAI,KAAO2D,EAAOP,GAAM,CAAClC,EAAIS,GAAG,QAAQN,EAAG,KAAK,CAACrB,IAAI,KAAO2D,EAAOP,GAAM,CAAClC,EAAIS,GAAG,QAAQN,EAAG,KAAK,CAACrB,IAAI,OAAS2D,EAAOP,GAAM,CAAClC,EAAIS,GAAG,gBAAcN,EAAG,MAAMH,EAAIS,GAAG,KAAKN,EAAG,OAAO,KAAKA,EAAG,QAAQH,EAAIgC,GAAIhC,EAAoB,kBAAE,SAAS0E,EAAIC,EAAOnC,GAAG,OAAOrC,EAAG,KAAK,CAACrB,IAAI6F,GAAQ,CAACxE,EAAG,KAAK,CAACE,YAAY,aAAa,CAACL,EAAIS,GAAGT,EAAIoC,GAAGI,EAAI,MAAMrC,EAAG,KAAK,CAAC2B,YAAY,CAAC,aAAa,SAAS,CAAC9B,EAAIS,GAAGT,EAAIoC,GAAGuC,MAAW3E,EAAIgC,GAAIhC,EAAqB,mBAAE,SAASiC,EAAMC,GAAM,MAAO,CAAClC,EAAIgC,GAAG,GAAQ,SAASS,GAAM,MAAO,CAACzC,EAAIgC,GAAG,CAAE,EAAE,EAAE,EAAE,IAAI,SAASyC,GAAG,OAAOtE,EAAG,KAAK,CAACrB,IAAI6F,EAASzC,EAAOO,EAAOgC,GAAG,CAACzE,EAAIS,GAAG,IAAIT,EAAIoC,GAAGpC,EAAIgD,YAAY0B,EAAKxC,EAAMO,EAAMgC,IAAI,UAAStE,EAAG,KAAK,CAACrB,IAAI,OAAS6F,EAASzC,EAAOO,GAAM,CAACzC,EAAIS,GAAG,IAAIT,EAAIoC,GAAGpC,EAAI4E,0BAA0BF,EAAKxC,EAAMO,IAAO,WAAUtC,EAAG,KAAK,CAACrB,IAAI,WAAa6F,EAASzC,GAAM,CAAClC,EAAIS,GAAG,IAAIT,EAAIoC,GAAGpC,EAAI6E,oBAAoBH,EAAKxC,IAAO,WAAU/B,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAGsC,EAAIjB,SAAStD,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAGsC,EAAIhB,UAAU,MAAK,KAAKvD,EAAG,MAAM,CAAC2B,YAAY,CAAC,gBAAgB,SAAS,CAAC3B,EAAG,WAAW,CAACE,YAAY,kBAAkBC,MAAM,CAAC,QAAU,WAAWe,GAAG,CAAC,MAAQrB,EAAIiE,WAAW,CAACjE,EAAIS,GAAG,0BAA0BN,EAAG,WAAW,CAACE,YAAY,kBAAkBC,MAAM,CAAC,QAAU,mBAAmBe,GAAG,CAAC,MAAQrB,EAAIkE,iBAAiB,CAAClE,EAAIS,GAAG,uBAAuB,MAAM,IAAa,IAC72H,GAAkB,GCiHtB,IACE,KAAF,uBACE,WAAF,GAEE,KAJF,WAKI,MAAJ,CACM,OAAN,KACM,WAAN,GACM,UAAN,EACM,cAAN,KACM,QAAN,KACM,gBAAN,GACM,WAAN,KACM,YAAN,KACM,QAAN,KACM,aAAN,EACM,SAAN,GACM,aAAN,GACM,sBAAN,KAGE,QAAF,CACI,oBADJ,SACA,KACM,IAAN,sBACM,OAAN,uCAEI,YALJ,SAKA,SAAM,IAAN,UACA,sMACM,MAAN,oCAEI,0BATJ,SASA,OAAM,IAAN,MACA,sIACM,OAAN,6CAEI,2BAbJ,SAaA,GACM,IAAN,UACA,aACA,UACM,GAAN,gBAEM,IADA,IAAN,IACA,cAAQ,IAAR,EACA,kCACQ,GAAR,WAEM,OAAN,cAEI,qBAzBJ,SAyBA,GAAM,IAAN,OACA,+BACM,IAAN,sBACM,IAAN,IAIM,OAHA,EAAN,qBACQ,GAAR,gDAEA,wBAEI,wBAlCJ,SAkCA,GAAM,IAAN,OACA,yBACM,IAAN,sBACM,IAAN,IAIM,OAHA,EAAN,qBACQ,GAAR,0CAEA,wBAEI,gBA3CJ,SA2CA,GACM,IAAN,IAKM,OAJA,OAAN,mDACA,2BACA,8BAEA,GAEI,yBAnDJ,SAmDA,OAAM,IAAN,OACA,IAiBM,OAhBA,OAAN,mDAAQ,IAAR,QACA,+FACA,6GACA,sBACA,OACA,qCACA,iEACA,+DACA,qEAHA,KAKA,sCACA,mEACA,iEACA,uEAHA,QAMA,GAEI,mBAvEJ,SAuEA,GAAM,IAAN,OACA,IAmBM,OAlBA,OAAN,mDACQ,EAAR,2CAAU,IAAV,gCACA,+FACA,6GACA,sBACsB,IAAR0D,GACW,SAATC,GAAmBC,EAAO,EAA1C,qBACA,iEACA,+DACA,qEAHA,KAKyB,SAATD,GAAmBC,EAAO,EAA1C,sBACA,mEACA,iEACA,uEAHA,WAOA,GAEI,YA7FJ,SA6FA,GACM,OAAN,WACA,WACA,WACA,IAEI,0BAnGJ,SAmGA,KAAM,IAAN,OACA,IAiBM,OAhBA,KAAN,2CAAQ,IAAR,gCACA,+FACA,6GACA,sBACA,OACA,qCACA,iEACA,+DACA,qEAHA,KAKA,sCACA,mEACA,iEACA,uEAHA,QAMA,GAEI,cAvHJ,SAuHA,OAAM,IAAN,MACM,OAAN,iIAEI,gBA1HJ,SA0HA,OAAM,IAAN,IACA,mGACM,MAAN,wCAEI,oBA9HJ,SA8HA,OAAM,IAAN,IACA,uGACM,MAAN,wCAEI,aAlIJ,SAkIA,SAAM,IAAN,IACA,6GACM,OAAN,MACA,4CACA,8CACA,4CACA,iDACA,kBAEA,6CACA,+CACA,6CACA,kDACA,mBAGI,oBAlJJ,SAkJA,GACM,OAAN,4CACA,8CACA,4CACA,iDACA,mBAEI,qBAzJJ,WAyJM,IAAN,OAAM,OAAN,yIACA,iBACA,mGACA,gBAHA,wBAIA,sGACA,gDACA,kBACA,yBAGA,2BAVA,SAWA,IACA,+EACA,kBACA,cACA,sFACA,kBAEA,iBAEA,kCACA,aACA,sCAMA,mBACA,gIACA,oBA9BA,cAgCA,cAhCA,UAiCA,IACA,yIACA,kBACA,cACA,+FACA,kBAEA,kBACA,4BAIA,mBACA,yIACA,oBA/CA,QAmDA,iBAnDA,+CAqDI,SA9MJ,WA+MM,IAAN,wCACA,qCACA,4CACA,uCACM,EAAN,y6BAsBA,oCAtBA,qCAsBA,EAtBA,qBAsBA,gBAtBA,qBAsBA,iBAtBA,0BAsBA,2BAtBA,4CAuBA,EAvBA,2EAwBA,EAxBA,+CA2BM,EAAN,iBACM,EAAN,SAEI,eAjPJ,WAkPM,IAAN,kCACA,8BACM,EAAN,yCAEI,UAtPJ,SAsPA,GACM,IAAN,2CACM,OAAN,+BAEI,sBA1PJ,WA0PM,IAAN,OAAM,OAAN,sIACA,qBACA,gDACA,qBACA,0EAJA,8CAQI,iBAlQJ,WAkQM,IAAN,OAAM,OAAN,sIACA,gBACA,+CACA,6DAHA,8CAMI,oBAxQJ,WAwQM,IAAN,OAAM,OAAN,sIACA,mBACA,6CACA,mEAHA,8CAMI,iBA9QJ,SA8QA,OACM,KAAN,kBAAQ,MAAR,EAAQ,QAAR,EAAQ,QAAR,uBAAQ,OAAR,EAAQ,cAAR,IAAQ,aAAR,MAGE,SAAF,CACI,iBADJ,WACM,IAAN,OACA,KA0BM,OAzBA,KAAN,8BACQ,IAAR,2JACA,OACU,EAAV,IAAY,KAAZ,EAAY,KAAZ,EAAY,MAAZ,KAEA,gBACU,EAAV,aAAY,YAAZ,KAEA,+BACU,EAAV,4BACY,SAAZ,GACY,MAAZ,EACY,MAAZ,CAAc,EAAd,sBAAc,EAAd,sBAAc,EAAd,sBAAc,EAAd,yBAGQ,IAAR,IAEU,EADV,OACA,aAEA,QAEQ,EAAR,yCACQ,EAAR,cACQ,EAAR,iBAEA,GAMI,0BAlCJ,WAmCM,IAAN,sDAAQ,OAAR,WACM,OAAN,QAEI,qBAtCJ,WAsCM,IAAN,OACA,yDAAQ,IAAR,oCACA,2CACQ,MAAR,CAAU,OAAV,EAAU,SAAV,iBAGM,EAAN,oBAAQ,OAAR,yBACM,IAAN,KACA,IACA,IACA,OASM,OARA,EAAN,qBACA,iBACU,EAAV,EACU,EAAV,YAEQ,EAAR,YACQ,OAER,GAEI,kBA3DJ,WA4DM,IAAN,KAKM,OAJA,KAAN,2CAAQ,IAAR,wBACA,gBACQ,EAAR,cAEA,IAGE,YA3WF,WA4WI,KAAJ,mBACI,KAAJ,sBACI,KAAJ,+EChe4X,MCQxX,I,UAAY,eACd,GACA,GACA,IACA,EACA,KACA,WACA,OAIa,M,QCnBX,GAAS,WAAa,IAAIrE,EAAIP,KAASQ,EAAGD,EAAIE,eAAmBC,EAAGH,EAAII,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACA,EAAG,QAAQ,CAACE,YAAY,QAAQ,CAACF,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,OAAO,CAACH,EAAG,SAAS,CAACI,YAAYP,EAAIQ,GAAG,CAAC,CAAC1B,IAAI,SAASS,GAAG,WAAW,MAAO,CAACY,EAAG,KAAK,CAACE,YAAY,QAAQ,CAACF,EAAG,SAAS,CAACG,MAAM,CAAC,KAAO,iBAAiB,cAAc,UAAUN,EAAIS,GAAG,qDAAqD,KAAKC,OAAM,MAAS,CAACP,EAAG,cAAc,CAACA,EAAG,QAAQ,CAACA,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,MAAM,CAACH,EAAG,eAAe,CAACE,YAAY,WAAWC,MAAM,CAAC,MAAQ,sBAAsB,YAAY,UAAU,CAACH,EAAG,gBAAgB,CAACQ,IAAI,QAAQL,MAAM,CAAC,GAAK,QAAQ,QAAUN,EAAI0B,YAAYL,GAAG,CAAC,OAAS,SAASC,GAAQtB,EAAIwB,QAAQ,KAAKxB,EAAI2B,0BAA0Bd,MAAM,CAAC5B,MAAOe,EAAU,OAAEc,SAAS,SAAUC,GAAMf,EAAIuB,OAAOR,GAAKE,WAAW,aAAa,IAAI,GAAGd,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,MAAM,CAACH,EAAG,eAAe,CAACE,YAAY,WAAWC,MAAM,CAAC,MAAQ,uBAAuB,YAAY,WAAW,CAACH,EAAG,gBAAgB,CAACQ,IAAI,SAASL,MAAM,CAAC,GAAK,SAAS,QAAUN,EAAI4B,gBAAgB,SAAuB,MAAZ5B,EAAIuB,QAA6BF,GAAG,CAAC,OAAS,SAASC,GAAQ,OAAOtB,EAAI6B,yBAAyBhB,MAAM,CAAC5B,MAAOe,EAAW,QAAEc,SAAS,SAAUC,GAAMf,EAAIwB,QAAQT,GAAKE,WAAW,cAAc,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,GAAGd,EAAG,QAAQ,CAACA,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,OAAO,CAAEN,EAAe,YAAEG,EAAG,MAAM,CAACA,EAAG,MAAM,CAACE,YAAY,gCAAgC,CAACF,EAAG,YAAY,CAAC2B,YAAY,CAAC,MAAQ,OAAO,OAAS,QAAQxB,MAAM,CAAC,MAAQ,aAAaH,EAAG,MAAMA,EAAG,SAAS,CAACH,EAAIS,GAAG,0BAA0B,KAAKT,EAAIkB,QAAQ,GAAKlB,EAAI+B,aAA4B,MAAb/B,EAAIwB,QAAyyExB,EAAIkB,KAA9xEf,EAAG,QAAQ,CAACA,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,OAAO,CAACH,EAAG,QAAQ,CAACE,YAAY,mBAAmBC,MAAM,CAAC,OAAS,IAAI,YAAc,IAAI,YAAc,MAAM,CAACH,EAAG,QAAQ,CAACA,EAAG,KAAK,CAACA,EAAG,KAAK,CAACG,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAG,OAAON,EAAG,KAAK,CAACG,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAG,gBAAgBN,EAAG,KAAK,CAACG,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAG,OAAON,EAAG,MAAMH,EAAIS,GAAG,QAAQN,EAAG,MAAMH,EAAIS,GAAG,SAASN,EAAG,KAAK,CAACG,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAG,0BAA0BN,EAAG,KAAK,CAACG,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAG,aAAaN,EAAG,KAAK,CAACG,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAG,OAAON,EAAG,MAAMH,EAAIS,GAAG,SAASN,EAAG,KAAK,CAACG,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAG,OAAON,EAAG,MAAMH,EAAIS,GAAG,SAASN,EAAG,KAAK,CAACG,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAG,YAAYN,EAAG,KAAK,CAACG,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAG,WAAWN,EAAG,QAAQ,CAACH,EAAIgC,GAAIhC,EAAoB,kBAAE,SAAS0E,EAAIC,EAAOnC,GAAG,OAAOrC,EAAG,KAAK,CAACrB,IAAI6F,GAAQ,CAACxE,EAAG,KAAK,CAACE,YAAY,aAAa,CAACL,EAAIS,GAAGT,EAAIoC,GAAGI,EAAI,MAAMrC,EAAG,KAAK,CAAC2B,YAAY,CAAC,aAAa,SAAS,CAAC9B,EAAIS,GAAGT,EAAIoC,GAAGuC,MAAWxE,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAsB,KAAnBsC,EAAItB,cAAqBpD,EAAIwD,0BAA0BkB,EAAI/B,MAAO,QAAU,QAAQxC,EAAG,KAAK,CAAC2B,YAAY,CAAC,aAAa,SAAS,CAAC9B,EAAIS,GAAGT,EAAIoC,GAAsB,KAAnBsC,EAAItB,cAAqBpD,EAAIgI,kCAAkCtD,EAAI/B,MAAO,QAAU,QAAQxC,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAsB,KAAnBsC,EAAItB,cAAqBpD,EAAIuD,wBAAwBmB,GAAO,QAAQvE,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAsB,KAAnBsC,EAAItB,cAAqBsB,EAAIjB,KAAO,QAAQtD,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAsB,KAAnBsC,EAAItB,cAAqBsB,EAAIhB,KAAO,QAAQvD,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAsB,KAAnBsC,EAAItB,cAAqBpD,EAAI2D,YAAY3D,EAAI4D,qBAAqBe,IAAW,KAAK,IAAI3E,EAAIoC,GAAsB,KAAnBsC,EAAItB,cAAqBpD,EAAI4D,qBAAqBe,GAAU,QAAQxE,EAAG,KAAK,CAACE,YAAY,aAAa,CAACL,EAAIS,GAAGT,EAAIoC,GAAGI,EAAI,WAAUrC,EAAG,KAAK,CAAC2B,YAAY,CAAC,mBAAmB,UAAU,cAAc,SAAS,CAAC3B,EAAG,KAAK,CAACG,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAG,iBAAiBN,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAGpC,EAAIgF,QAAQC,SAAS9E,EAAG,MAAMA,EAAG,MAAMA,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAGpC,EAAIgF,QAAQvB,SAAStD,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAGpC,EAAIgF,QAAQtB,SAASvD,EAAG,MAAMA,EAAG,SAAS,KAAKA,EAAG,MAAM,CAAC2B,YAAY,CAAC,gBAAgB,SAAS,CAAC3B,EAAG,WAAW,CAACE,YAAY,kBAAkBC,MAAM,CAAC,QAAU,WAAWe,GAAG,CAAC,MAAQrB,EAAIiE,WAAW,CAACjE,EAAIS,GAAG,0BAA0BN,EAAG,WAAW,CAACE,YAAY,kBAAkBC,MAAM,CAAC,QAAU,mBAAmBe,GAAG,CAAC,MAAQrB,EAAIkE,iBAAiB,CAAClE,EAAIS,GAAG,uBAAuB,MAAM,IAAa,IACh3H,GAAkB,GCgKtB,IACE,KAAF,sBACE,WAAF,GAEE,KAJF,WAKI,MAAJ,CACM,OAAN,KACM,WAAN,GACM,UAAN,EACM,cAAN,KACM,QAAN,KACM,gBAAN,GACM,WAAN,KACM,YAAN,KACM,QAAN,KACM,aAAN,EACM,SAAN,GACM,aAAN,GACM,sBAAN,GACM,iBAAN,KAGE,QAAF,CACI,YADJ,SACA,GACM,IAAN,gCACA,iCACA,IACM,OAAN,cAGI,qBARJ,SAQA,OAAM,IAAN,OACA,IACA,mCACA,YAAQ,OAAR,gCAEA,mDASM,OARA,OAAN,mDAAQ,IAAR,UACA,sMACA,MACA,kCAEA,sCAGA,GAEI,6BAxBJ,SAwBA,KAAM,IAAN,OACA,IACA,mCACA,YAAQ,OAAR,gCAEA,mDAWM,OAVA,OAAN,mDAAQ,IAAR,MACA,sIACQ,GAAR,EAAQ,CACA,IAAR,8CACA,MACA,6BAEA,kCAGA,GAEI,uBA1CJ,SA0CA,GAAM,IAAN,OACA,IAKM,OAJA,OAAN,mDACQ,IAAR,0CACA,0CAEA,GAEI,gBAlDJ,WAkDM,IAAN,OACA,wBAUM,OATA,OAAN,mDACQ,GAAR,4CACQ,GAAR,8CACQ,GAAR,4CACQ,GAAR,gDACQ,GAAR,UACQ,GAAR,aAGA,CAAQ,KAAR,EAAQ,OAAR,EAAQ,KAAR,EAAQ,SAAR,EAAQ,KAAR,EAAQ,KAAR,IAEI,aA/DJ,SA+DA,GAGM,IAAN,iDAAQ,OAAR,cACM,QAAN,oBAAQ,OAAR,kCACA,oBAAQ,OAAR,mDAGI,oBAvEJ,SAuEA,KACM,IAAN,sBACM,OAAN,mCAEI,qBA3EJ,SA2EA,GAAM,IAAN,OACA,+BACM,IAAN,sBACM,IAAN,IAKM,OAJA,EAAN,qBACQ,GAAR,qDACQ,GAAR,gEAEA,qCAEI,YArFJ,SAqFA,SAAM,IAAN,UACA,sMAEM,OADN,cACA,oCAEI,0BA1FJ,SA0FA,OAAM,IAAN,MACA,sIACM,OAAN,yCAEI,2BA9FJ,SA8FA,GACM,IAAN,UACA,aACA,UACM,GAAN,kDACM,IAAN,IACM,GAAN,yEACQ,IAAR,kBAAU,IAAV,EACA,kCACU,GAAV,WAEQ,OAAR,6BACA,4EACQ,GAAR,OAEU,IADA,IAAV,IACA,cAAY,IAAZ,EACA,kCACA,MACc,GAAd,EACc,KAGJ,OAAV,UACU,GAAV,EACA,8BAEU,IAAV,kBAAY,IAAZ,EACA,kCACY,GAAZ,WAEU,OAAV,6BAEA,4EAAQ,IAAR,EACA,kCACQ,OAAR,oBACA,4EAAQ,IAAR,EACA,kCACQ,OAAR,oBAGQ,IADA,IAAR,IACA,cAAU,IAAV,EACA,kCACA,MACY,GAAZ,EACY,KAGJ,GAAR,eACQ,IAAR,MACQ,OAAR,8BAGI,wBAlJJ,SAkJA,GAAM,IAAN,OACA,2BACA,IACA,IASM,OARA,EAAN,qBACQ,GAAR,kBAAQ,CACA,IAAR,iDACA,WACU,GAAV,EACU,SAGV,yBAEI,gBAhKJ,SAgKA,GACM,IAAN,IAKM,OAJA,OAAN,mDACA,2BACA,8BAEA,GAEI,yBAxKJ,SAwKA,OAAM,IAAN,OACA,IAiBM,OAhBA,OAAN,mDAAQ,IAAR,QACA,+FACA,6GACA,sBACA,OACA,qCACA,iEACA,+DACA,qEAHA,KAKA,sCACA,mEACA,iEACA,uEAHA,QAMA,GAEI,mBA5LJ,SA4LA,GAAM,IAAN,OACA,IAmBM,OAlBA,OAAN,mDACQ,EAAR,2CAAU,IAAV,gCACA,+FACA,6GACA,sBACA,OACA,qCACA,iEACA,+DACA,qEAHA,KAKA,sCACA,mEACA,iEACA,uEAHA,WAOA,GAEI,YAlNJ,SAkNA,GACM,OAAN,WACA,WACA,WACA,IAEI,0BAxNJ,SAwNA,KAAM,IAAN,OACA,IAsBM,OArBA,OAAN,mCACQ,OAAR,+CACU,IAAV,8CACA,uBACA,UACA,6EACA,6EACA,4BACA,OACA,qCACA,iEACA,+DACA,qEAHA,KAKA,sCACA,mEACA,iEACA,uEAHA,WAOA,GAEI,kCAjPJ,SAiPA,KAAM,IAAN,OACA,KA2BM,OA1BA,OAAN,mCACQ,OAAR,+CACU,IAAV,UACA,eACA,uBACU,GAAV,4EAAU,CACA,IAAV,oJACY,IAAZ,8CACY,GAAZ,2BACA,MACA,4DAEA,6DAGU,GAAV,gBACY,IAAZ,8CACY,GAAZ,2BACA,MACA,4DAEA,qEAKA,GAEI,cA/QJ,SA+QA,OAAM,IAAN,MACM,OAAN,iIAEI,gBAlRJ,SAkRA,OAAM,IAAN,IACA,mGACM,MAAN,wCAEI,oBAtRJ,SAsRA,OAAM,IAAN,IACA,uGACM,MAAN,wCAEI,aA1RJ,SA0RA,SAAM,IAAN,IACA,6GACM,OAAN,MACA,4CACA,8CACA,4CACA,iDACA,kBAEA,6CACA,+CACA,6CACA,kDACA,mBAGI,eA1SJ,SA0SA,GAEM,OADA,QAAN,OACA,sCACA,qBACA,uBACA,uBACA,0BACA,mBAEI,oBAnTJ,SAmTA,GACM,OAAN,4CACA,8CACA,4CACA,iDACA,mBAEI,qBA1TJ,WA0TM,IAAN,OAAM,OAAN,yIACA,iBACA,yCACA,2CACA,6CACA,+CACA,mGACA,gBAPA,wBAQA,sGACA,gDACA,kBACA,yBAGA,2BAdA,UAeA,IACA,+EACA,kBACA,cACA,sFACA,kBAEA,iBAEA,kCACA,qEACA,0BACA,gCAEA,qEACA,oDACA,gCAEA,qEACA,0BACA,iCAEA,4IAGA,cAFA,sCAUA,mBACA,gIACA,oBAlDA,eAoDA,cApDA,UAqDA,IACA,yIACA,kBACA,cACA,+FACA,kBAEA,kBACA,4BAIA,mBACA,yIACA,oBAnEA,QAuEA,iBAvEA,+CAyEI,SAnYJ,WAoYM,IAAN,wCACA,oCACA,4CACA,uCACM,EAAN,y6BAsBA,oCAtBA,qCAsBA,EAtBA,qBAsBA,gBAtBA,qBAsBA,iBAtBA,0BAsBA,2BAtBA,4CAuBA,EAvBA,2EAwBA,EAxBA,+CA2BM,EAAN,iBACM,EAAN,SAEI,eAtaJ,WAuaM,IAAN,kCACA,8BACM,EAAN,wCAEI,UA3aJ,SA2aA,GACM,IAAN,2CACM,OAAN,+BAEI,sBA/aJ,WA+aM,IAAN,OAAM,OAAN,sIACA,qBACA,gDACA,qBACA,0EAJA,8CAQI,iBAvbJ,WAubM,IAAN,OAAM,OAAN,sIACA,gBACA,+CACA,6DAHA,8CAMI,oBA7bJ,WA6bM,IAAN,OAAM,OAAN,sIACA,mBACA,6CACA,mEAHA,8CAMI,iBAncJ,SAmcA,OACM,KAAN,kBAAQ,MAAR,EAAQ,QAAR,EAAQ,QAAR,uBAAQ,OAAR,EAAQ,cAAR,IAAQ,aAAR,MAGE,SAAF,CACI,QADJ,WAEM,OAAN,wBAEI,iBAJJ,WAIM,IAAN,OACA,KAqCM,OApCA,KAAN,8BACQ,IAAR,+MACA,OACU,EAAV,IAAY,cAAZ,EAAY,KAAZ,EAAY,KAAZ,EAAY,MAAZ,KAEA,gBACU,EAAV,aAAY,YAAZ,KAEA,+BACU,EAAV,4BACY,WAAZ,EACY,SAAZ,GACY,MAAZ,EACY,mBAAZ,EACY,WAAZ,EACY,MAAZ,CAAc,EAAd,sBAAc,EAAd,sBAAc,EAAd,sBAAc,EAAd,yBAGQ,IAAR,IAGY,EAFZ,OACA,8BACA,EAEA,aAGA,aACA,0BAEA,QAGQ,EAAR,yCACQ,EAAR,cACQ,EAAR,iBAEA,GAEI,0BA5CJ,WA6CM,IAAN,sDAAQ,OAAR,WACM,OAAN,QAEI,qBAhDJ,WAgDM,IAAN,OACA,yDAAQ,IAAR,oCACA,2CACQ,MAAR,CAAU,OAAV,EAAU,SAAV,iBAGM,EAAN,oBAAQ,OAAR,yBACM,IAAN,KACA,IACA,IACA,OAUM,OATA,EAAN,qBACA,iBACU,EAAV,EACU,EAAV,WACU,KAEF,EAAR,eAGA,GAEI,kBAtEJ,WAuEM,IAAN,KAKM,OAJA,KAAN,2CAAQ,IAAR,wBACA,gBACQ,EAAR,cAEA,IAGE,YA5iBF,WA6iBI,KAAJ,mBACI,KAAJ,sBACI,KAAJ,+EChtBgY,MCQ5X,I,UAAY,eACd,GACA,GACA,IACA,EACA,KACA,WACA,OAIa,M,QCnBX,GAAS,WAAa,IAAIT,EAAIP,KAASQ,EAAGD,EAAIE,eAAmBC,EAAGH,EAAII,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACA,EAAG,QAAQ,CAACE,YAAY,QAAQ,CAACF,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,OAAO,CAACH,EAAG,SAAS,CAACI,YAAYP,EAAIQ,GAAG,CAAC,CAAC1B,IAAI,SAASS,GAAG,WAAW,MAAO,CAACY,EAAG,KAAK,CAACE,YAAY,QAAQ,CAACF,EAAG,SAAS,CAACG,MAAM,CAAC,KAAO,iBAAiB,cAAc,UAAUN,EAAIS,GAAG,+CAA+C,KAAKC,OAAM,MAAS,CAACP,EAAG,cAAc,CAACA,EAAG,QAAQ,CAACA,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,MAAM,CAACH,EAAG,eAAe,CAACE,YAAY,WAAWC,MAAM,CAAC,MAAQ,sBAAsB,YAAY,UAAU,CAACH,EAAG,gBAAgB,CAACQ,IAAI,QAAQL,MAAM,CAAC,GAAK,QAAQ,QAAUN,EAAI0B,YAAYL,GAAG,CAAC,OAAS,SAASC,GAAQtB,EAAIwB,QAAQ,KAAKxB,EAAI2B,0BAA0Bd,MAAM,CAAC5B,MAAOe,EAAU,OAAEc,SAAS,SAAUC,GAAMf,EAAIuB,OAAOR,GAAKE,WAAW,aAAa,IAAI,GAAGd,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,MAAM,CAACH,EAAG,eAAe,CAACE,YAAY,WAAWC,MAAM,CAAC,MAAQ,uBAAuB,YAAY,WAAW,CAACH,EAAG,gBAAgB,CAACQ,IAAI,SAASL,MAAM,CAAC,GAAK,SAAS,QAAUN,EAAI4B,gBAAgB,SAAuB,MAAZ5B,EAAIuB,QAA6BF,GAAG,CAAC,OAAS,SAASC,GAAQ,OAAOtB,EAAI6B,yBAAyBhB,MAAM,CAAC5B,MAAOe,EAAW,QAAEc,SAAS,SAAUC,GAAMf,EAAIwB,QAAQT,GAAKE,WAAW,cAAc,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,GAAGd,EAAG,QAAQ,CAACA,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,OAAO,CAAEN,EAAe,YAAEG,EAAG,MAAM,CAACA,EAAG,MAAM,CAACE,YAAY,gCAAgC,CAACF,EAAG,YAAY,CAAC2B,YAAY,CAAC,MAAQ,OAAO,OAAS,QAAQxB,MAAM,CAAC,MAAQ,aAAaH,EAAG,MAAMA,EAAG,SAAS,CAACH,EAAIS,GAAG,0BAA0B,KAAKT,EAAIkB,QAAQ,GAAKlB,EAAI+B,aAA4B,MAAb/B,EAAIwB,QAAmvJxB,EAAIkB,KAAxuJf,EAAG,QAAQ,CAACA,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,OAAO,CAACH,EAAG,QAAQ,CAACE,YAAY,mBAAmBC,MAAM,CAAC,OAAS,IAAI,YAAc,IAAI,YAAc,MAAM,CAACH,EAAG,QAAQ,CAACA,EAAG,KAAK,CAACA,EAAG,KAAK,CAACG,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAG,OAAON,EAAG,KAAK,CAACG,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAG,gBAAgBT,EAAIgC,GAAIhC,EAAqB,mBAAE,SAASiC,EAAMC,GAAM,MAAO,CAAC/B,EAAG,KAAK,CAACrB,IAAIoD,EAAK5B,MAAM,CAAC,QAAUN,EAAIuE,YAAYrC,KAAQ,CAAClC,EAAIS,GAAG,IAAIT,EAAIoC,GAAGF,GAAM,WAAU/B,EAAG,KAAK,CAACG,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAG,aAAaN,EAAG,KAAK,CAACG,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAG,OAAON,EAAG,MAAMH,EAAIS,GAAG,QAAQN,EAAG,MAAMH,EAAIS,GAAG,SAASN,EAAG,KAAK,CAACG,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAG,OAAON,EAAG,MAAMH,EAAIS,GAAG,QAAQN,EAAG,MAAMH,EAAIS,GAAG,SAASN,EAAG,KAAK,CAACG,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAG,OAAON,EAAG,MAAMH,EAAIS,GAAG,QAAQN,EAAG,MAAMH,EAAIS,GAAG,SAASN,EAAG,KAAK,CAACG,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAG,OAAON,EAAG,MAAMH,EAAIS,GAAG,QAAQN,EAAG,MAAMH,EAAIS,GAAG,SAASN,EAAG,KAAK,CAACG,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAG,OAAON,EAAG,MAAMH,EAAIS,GAAG,SAASN,EAAG,KAAK,CAACG,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAG,OAAON,EAAG,MAAMH,EAAIS,GAAG,SAASN,EAAG,KAAK,CAACG,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAG,YAAYN,EAAG,KAAK,CAACG,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAG,QAAQ,GAAGN,EAAG,KAAK,CAACH,EAAIgC,GAAIhC,EAAqB,mBAAE,SAASiC,EAAMC,GAAM,MAAO,CAAClC,EAAIgC,GAAG,GAAQ,SAASS,EAAKC,GAAG,MAAO,CAACvC,EAAG,KAAK,CAACrB,IAAI,QAAU2D,EAAOC,EAAEpC,MAAM,CAAC,QAAUN,EAAIwE,iBAAiBrC,OAAS,IAAI,CAACnC,EAAIS,GAAG,IAAIT,EAAIoC,GAAGK,GAAM,WAAUtC,EAAG,KAAK,CAACrB,IAAI,aAAeoD,EAAK7B,YAAY,iBAAiB,CAACL,EAAIS,GAAG,iBAAgB,GAAGN,EAAG,KAAK,CAACH,EAAIgC,GAAIhC,EAAqB,mBAAE,SAASiC,EAAMC,GAAM,MAAO,CAAClC,EAAIgC,GAAG,GAAQ,SAASS,GAAM,MAAO,CAACzC,EAAIgC,GAAIhC,EAAoB,kBAAE,SAASyE,GAAG,OAAOtE,EAAG,KAAK,CAACrB,IAAI,IAAMoD,EAAOO,EAAOgC,GAAG,CAACzE,EAAIS,GAAG,KAAKT,EAAIoC,GAAGqC,GAAG,UAAStE,EAAG,KAAK,CAACrB,IAAI,OAAS2D,EAAOP,GAAM,CAAClC,EAAIS,GAAG,YAAWN,EAAG,KAAK,CAACrB,IAAI,OAASoD,SAAW,KAAK/B,EAAG,QAAQ,CAACH,EAAIgC,GAAIhC,EAAoB,kBAAE,SAAS0E,EAAIC,EAAOnC,GAAG,OAAOrC,EAAG,KAAK,CAACrB,IAAI6F,GAAQ,CAACxE,EAAG,KAAK,CAACE,YAAY,aAAa,CAACL,EAAIS,GAAGT,EAAIoC,GAAGI,EAAI,MAAMrC,EAAG,KAAK,CAAC2B,YAAY,CAAC,aAAa,SAAS,CAAC9B,EAAIS,GAAGT,EAAIoC,GAAGuC,MAAW3E,EAAIgC,GAAIhC,EAAqB,mBAAE,SAASiC,EAAMC,GAAM,MAAO,CAAClC,EAAIgC,GAAG,GAAQ,SAASS,GAAM,MAAO,CAACzC,EAAIgC,GAAIhC,EAAoB,kBAAE,SAASyE,GAAG,OAAOtE,EAAG,KAAK,CAACrB,IAAI6F,EAASzC,EAAOO,EAAOgC,GAAG,CAACzE,EAAIS,GAAG,IAAIT,EAAIoC,GAAsB,KAAnBsC,EAAItB,cAAqBpD,EAAIgD,YAAY0B,EAAKxC,EAAMO,EAAMgC,GAAK,KAAK,UAAStE,EAAG,KAAK,CAACrB,IAAI,OAAS6F,EAASzC,EAAOO,EAAKpC,YAAY,cAAcyB,YAAY,CAAC,cAAc,OAAO,aAAa,WAAW,CAAC9B,EAAIS,GAAG,IAAIT,EAAIoC,GAAsB,KAAnBsC,EAAItB,cAAqBpD,EAAI4E,0BAA0BF,EAAKxC,EAAMO,GAAQ,KAAK,WAAUtC,EAAG,KAAK,CAACrB,IAAI,WAAa6F,EAASzC,EAAK7B,YAAY,6BAA6B,CAACL,EAAIS,GAAG,IAAIT,EAAIoC,GAAsB,KAAnBsC,EAAItB,cAAqBpD,EAAI6E,oBAAoBH,EAAKxC,GAAQ,KAAK,WAAU/B,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAsB,KAAnBsC,EAAItB,cAAqBpD,EAAIuD,wBAAwBmB,GAAO,QAAQvE,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAsB,KAAnBsC,EAAItB,cAAqBpD,EAAI2H,8BAA8BjD,EAAK,QAAU,QAAQvE,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAsB,KAAnBsC,EAAItB,cAAqBpD,EAAI2H,8BAA8BjD,EAAK,UAAY,QAAQvE,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAsB,KAAnBsC,EAAItB,cAAqBpD,EAAI2H,8BAA8BjD,EAAK,QAAU,QAAQvE,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAsB,KAAnBsC,EAAItB,cAAqBpD,EAAI2H,8BAA8BjD,EAAK,YAAc,QAAQvE,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAsB,KAAnBsC,EAAItB,cAAqBsB,EAAIjB,KAAO,QAAQtD,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAsB,KAAnBsC,EAAItB,cAAqBsB,EAAIhB,KAAO,QAAQvD,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAsB,KAAnBsC,EAAItB,cAAqBpD,EAAI2D,YAAY3D,EAAI4D,qBAAqBe,IAAW,KAAK,IAAI3E,EAAIoC,GAAsB,KAAnBsC,EAAItB,cAAqBpD,EAAI4D,qBAAqBe,GAAU,QAAQxE,EAAG,KAAK,CAACE,YAAY,aAAa,CAACL,EAAIS,GAAGT,EAAIoC,GAAGI,EAAI,OAAO,MAAKrC,EAAG,KAAK,CAAC2B,YAAY,CAAC,mBAAmB,UAAU,cAAc,SAAS,CAAC3B,EAAG,KAAK,CAACG,MAAM,CAAC,QAAU,MAAM,CAACN,EAAIS,GAAG,iBAAiBT,EAAIgC,GAAIhC,EAAqB,mBAAE,SAASiC,EAAMC,GAAM,MAAO,CAAClC,EAAIgC,GAAG,GAAQ,SAASS,GAAM,MAAO,CAACzC,EAAIgC,GAAIhC,EAAoB,kBAAE,SAASyE,GAAG,OAAOtE,EAAG,KAAK,CAACrB,IAAI,KAAOoD,EAAOO,EAAOgC,GAAG,CAACzE,EAAIS,GAAG,IAAIT,EAAIoC,GAAGpC,EAAI8E,qBAAqB5C,EAAMO,EAAMgC,IAAI,UAAStE,EAAG,KAAK,CAACrB,IAAI,KAAOoD,EAAOO,GAAM,CAACzC,EAAIS,GAAG,IAAIT,EAAIoC,GAAGpC,EAAI+E,6BAA6B7C,EAAMO,IAAO,WAAUtC,EAAG,KAAK,CAACrB,IAAI,MAAQoD,EAAK7B,YAAY,iBAAiB,CAACL,EAAIS,GAAG,IAAIT,EAAIoC,GAAGpC,EAAI8D,uBAAuB5B,IAAO,WAAU/B,EAAG,MAAMH,EAAIS,GAAG,KAAKN,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAGpC,EAAIgF,QAAQC,SAAS9E,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAGpC,EAAIgF,QAAQE,WAAW/E,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAGpC,EAAIgF,QAAQG,SAAShF,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAGpC,EAAIgF,QAAQI,aAAajF,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAGpC,EAAIgF,QAAQvB,SAAStD,EAAG,KAAK,CAACH,EAAIS,GAAGT,EAAIoC,GAAGpC,EAAIgF,QAAQtB,SAASvD,EAAG,MAAMH,EAAIS,GAAG,KAAKN,EAAG,OAAO,IAAI,KAAKA,EAAG,MAAM,CAAC2B,YAAY,CAAC,gBAAgB,SAAS,CAAC3B,EAAG,WAAW,CAACE,YAAY,kBAAkBC,MAAM,CAAC,QAAU,WAAWe,GAAG,CAAC,MAAQrB,EAAIiE,WAAW,CAACjE,EAAIS,GAAG,0BAA0BN,EAAG,WAAW,CAACE,YAAY,kBAAkBC,MAAM,CAAC,QAAU,mBAAmBe,GAAG,CAAC,MAAQrB,EAAIkE,iBAAiB,CAAClE,EAAIS,GAAG,uBAAuB,MAAM,IAAa,IACpzM,GAAkB,GC8JtB,IACE,KAAF,sBACE,WAAF,GAEE,KAJF,WAKI,MAAJ,CACM,OAAN,KACM,WAAN,GACM,UAAN,EACM,cAAN,KACM,QAAN,KACM,gBAAN,GACM,WAAN,KACM,YAAN,KACM,QAAN,KACM,aAAN,EACM,SAAN,GACM,aAAN,GACM,sBAAN,GACM,iBAAN,KAGE,QAAF,CACI,YADJ,SACA,GACM,IAAN,gCACA,iCACA,IACM,OAAN,cAGI,qBARJ,SAQA,OAAM,IAAN,OACA,IACA,mCACA,YAAQ,OAAR,gCAEA,mDASM,OARA,OAAN,mDAAQ,IAAR,UACA,sMACA,MACA,kCAEA,sCAGA,GAEI,6BAxBJ,SAwBA,KAAM,IAAN,OACA,IACA,mCACA,YAAQ,OAAR,gCAEA,mDAWM,OAVA,OAAN,mDAAQ,IAAR,MACA,sIACQ,GAAR,EAAQ,CACA,IAAR,8CACA,MACA,6BAEA,kCAGA,GAEI,uBA1CJ,SA0CA,GAAM,IAAN,OACA,IAKM,OAJA,OAAN,mDACQ,IAAR,0CACA,0CAEA,GAEI,gBAlDJ,WAkDM,IAAN,OACA,wBAUM,OATA,OAAN,mDACQ,GAAR,0CACQ,GAAR,4CACQ,GAAR,0CACQ,GAAR,8CACQ,GAAR,UACQ,GAAR,aAGA,CAAQ,KAAR,EAAQ,OAAR,EAAQ,KAAR,EAAQ,SAAR,EAAQ,KAAR,EAAQ,KAAR,IAEI,aA/DJ,SA+DA,GAGM,IAAN,iDAAQ,OAAR,cACM,QAAN,oBAAQ,OAAR,kCACA,oBAAQ,OAAR,mDAGI,oBAvEJ,SAuEA,KACM,IAAN,sBACM,OAAN,mCAEI,YA3EJ,SA2EA,SAAM,IAAN,UACA,sMAEM,OADN,cACA,oCAEI,0BAhFJ,SAgFA,OAAM,IAAN,MACA,sIACM,OAAN,yCAEI,2BApFJ,SAoFA,GACM,IAAN,UACA,aACA,UACM,GAAN,kDACM,IAAN,IACM,GAAN,yEACQ,GAAR,OAEU,IADA,IAAV,IACA,cAAY,IAAZ,EACA,kCACA,MACc,GAAd,EACc,KAGJ,OAAV,UACU,GAAV,EACA,gEAEU,IAAV,kBAAY,IAAZ,EACA,kCACY,GAAZ,WAEU,OAAV,+DAEA,4EACQ,GAAR,OAEU,IADA,IAAV,IACA,cAAY,IAAZ,EACA,kCACA,MACc,GAAd,EACc,KAGJ,OAAV,UACU,GAAV,EACA,gEAEU,IAAV,kBAAY,IAAZ,EACA,kCACY,GAAZ,WAEU,OAAV,+DAEA,4EAAQ,IAAR,EACA,kCACQ,OAAR,oBACA,4EAAQ,IAAR,EACA,kCACQ,OAAR,oBAGQ,IADA,IAAR,IACA,cAAU,IAAV,EACA,kCACA,MACY,GAAZ,EACY,KAGJ,GAAR,eACQ,IAAR,MACQ,OAAR,gEAGI,qBAtJJ,SAsJA,GAAM,IAAN,OACA,+BACM,IAAN,sBACM,IAAN,IAKM,OAJA,EAAN,qBACQ,GAAR,qDACQ,GAAR,gEAEA,qCAEI,8BAhKJ,SAgKA,KAAM,IAAN,OACA,2BACA,IAoBM,OAnBA,EAAN,qBACQ,GAAR,kBAAQ,CACA,IAAR,4CAAU,OAAV,cACA,2CACA,iDACA,WACA,OACA,qCACA,iEACA,+DACA,qEAHA,KAKA,sCACA,mEACA,iEACA,uEAHA,SAOA,GAEI,wBAxLJ,SAwLA,GAAM,IAAN,OACA,2BACA,IACA,IASM,OARA,EAAN,qBACQ,GAAR,kBAAQ,CACA,IAAR,iDACA,WACU,GAAV,EACU,SAGV,yBAEI,gBAtMJ,SAsMA,GACM,IAAN,IAKM,OAJA,OAAN,mDACA,2BACA,8BAEA,GAEI,yBA9MJ,SA8MA,OAAM,IAAN,OACA,IAiBM,OAhBA,OAAN,mDAAQ,IAAR,QACA,+FACA,6GACA,sBACA,OACA,qCACA,iEACA,+DACA,qEAHA,KAKA,sCACA,mEACA,iEACA,uEAHA,QAMA,GAEI,mBAlOJ,SAkOA,GAAM,IAAN,OACA,IAmBM,OAlBA,OAAN,mDACQ,EAAR,2CAAU,IAAV,gCACA,+FACA,6GACA,sBACA,OACA,qCACA,iEACA,+DACA,qEAHA,KAKA,sCACA,mEACA,iEACA,uEAHA,WAOA,GAEI,YAxPJ,SAwPA,GACM,OAAN,WACA,WACA,WACA,IAEI,0BA9PJ,SA8PA,KAAM,IAAN,OACA,IAsBM,OArBA,OAAN,mCACQ,OAAR,+CACU,IAAV,8CACA,uBACA,UACA,6EACA,6EACA,sBACA,OACA,qCACA,iEACA,+DACA,qEAHA,KAKA,sCACA,mEACA,iEACA,uEAHA,WAOA,GAEI,cAvRJ,SAuRA,OAAM,IAAN,MACM,OAAN,iIAEI,gBA1RJ,SA0RA,OAAM,IAAN,IACA,mGACM,MAAN,wCAEI,oBA9RJ,SA8RA,OAAM,IAAN,IACA,uGACM,MAAN,wCAEI,aAlSJ,SAkSA,SAAM,IAAN,IACA,6GACM,OAAN,MACA,4CACA,8CACA,4CACA,iDACA,kBAEA,6CACA,+CACA,6CACA,kDACA,mBAGI,eAlTJ,SAkTA,GAEM,OADA,QAAN,OACA,sCACA,qBACA,uBACA,uBACA,0BACA,mBAEI,oBA3TJ,SA2TA,GACM,OAAN,4CACA,8CACA,4CACA,iDACA,mBAEI,qBAlUJ,WAkUM,IAAN,OAAM,OAAN,yIACA,iBACA,yCACA,2CACA,6CACA,+CACA,mGACA,gBAPA,wBAQA,sGACA,gDACA,kBACA,yBAGA,2BAdA,UAeA,IACA,+EACA,kBACA,cACA,sFACA,kBAEA,iBAEA,kCACA,qEACA,0BACA,gCAEA,qEACA,oDACA,gCAEA,qEACA,0BACA,iCAEA,4IAGA,cAFA,sCAUA,mBACA,gIACA,oBAlDA,eAoDA,cApDA,UAqDA,IACA,yIACA,kBACA,cACA,+FACA,kBAEA,kBACA,4BAIA,mBACA,yIACA,oBAnEA,QAuEA,iBAvEA,+CAyEI,SA3YJ,WA4YM,IAAN,wCACA,+CACA,4CACA,uCACM,EAAN,y6BAsBA,oCAtBA,qCAsBA,EAtBA,qBAsBA,gBAtBA,qBAsBA,iBAtBA,0BAsBA,2BAtBA,4CAuBA,EAvBA,2EAwBA,EAxBA,+CA2BM,EAAN,iBACM,EAAN,SAEI,eA9aJ,WA+aM,IAAN,kCACA,8BACM,EAAN,wCAEI,UAnbJ,SAmbA,GACM,IAAN,2CACM,OAAN,+BAEI,sBAvbJ,WAubM,IAAN,OAAM,OAAN,sIACA,qBACA,gDACA,qBACA,0EAJA,8CAQI,iBA/bJ,WA+bM,IAAN,OAAM,OAAN,sIACA,gBACA,+CACA,6DAHA,8CAMI,oBArcJ,WAqcM,IAAN,OAAM,OAAN,sIACA,mBACA,6CACA,mEAHA,8CAMI,iBA3cJ,SA2cA,OACM,KAAN,kBAAQ,MAAR,EAAQ,QAAR,EAAQ,QAAR,uBAAQ,OAAR,EAAQ,cAAR,IAAQ,aAAR,MAGE,SAAF,CACI,QADJ,WAEM,OAAN,wBAEI,iBAJJ,WAIM,IAAN,OACA,KAoCM,OAnCA,KAAN,8BACQ,IAAR,+MACA,OACU,EAAV,IAAY,cAAZ,EAAY,KAAZ,EAAY,KAAZ,EAAY,MAAZ,KAEA,gBACU,EAAV,aAAY,YAAZ,KAEA,+BACU,EAAV,4BACY,SAAZ,GACY,MAAZ,EACY,mBAAZ,EACY,WAAZ,EACY,MAAZ,CAAc,EAAd,sBAAc,EAAd,sBAAc,EAAd,sBAAc,EAAd,yBAGQ,IAAR,IAGY,EAFZ,OACA,8BACA,EAEA,aAGA,aACA,0BAEA,QAGQ,EAAR,yCACQ,EAAR,cACQ,EAAR,iBAEA,GAEI,0BA3CJ,WA4CM,IAAN,sDAAQ,OAAR,WACM,OAAN,QAEI,qBA/CJ,WA+CM,IAAN,OACA,yDAAQ,IAAR,oCACA,2CACQ,MAAR,CAAU,OAAV,EAAU,SAAV,iBAGM,EAAN,oBAAQ,OAAR,yBACM,IAAN,KACA,IACA,IACA,OAUM,OATA,EAAN,qBACA,iBACU,EAAV,EACU,EAAV,WACU,KAEF,EAAR,eAGA,GAEI,kBArEJ,WAsEM,IAAN,KAKM,OAJA,KAAN,2CAAQ,IAAR,wBACA,gBACQ,EAAR,cAEA,IAGE,YAnjBF,WAojBI,KAAJ,mBACI,KAAJ,sBACI,KAAJ,+ECrtB6X,MCQzX,I,UAAY,eACd,GACA,GACA,IACA,EACA,KACA,WACA,OAIa,M,QCnBX,GAAS,WAAa,IAAIT,EAAIP,KAASQ,EAAGD,EAAIE,eAAmBC,EAAGH,EAAII,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACA,EAAG,QAAQ,CAACE,YAAY,QAAQ,CAACF,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,OAAO,CAACH,EAAG,SAAS,CAACI,YAAYP,EAAIQ,GAAG,CAAC,CAAC1B,IAAI,SAASS,GAAG,WAAW,MAAO,CAACY,EAAG,KAAK,CAACE,YAAY,QAAQ,CAACF,EAAG,SAAS,CAACG,MAAM,CAAC,KAAO,iBAAiB,cAAc,UAAUN,EAAIS,GAAG,+CAA+C,KAAKC,OAAM,MAAS,CAACP,EAAG,cAAc,CAACA,EAAG,QAAQ,CAACA,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,MAAM,CAACH,EAAG,eAAe,CAACE,YAAY,WAAWC,MAAM,CAAC,MAAQ,sBAAsB,YAAY,UAAU,CAACH,EAAG,gBAAgB,CAACQ,IAAI,QAAQL,MAAM,CAAC,GAAK,QAAQ,QAAUN,EAAI0B,YAAYL,GAAG,CAAC,OAAS,SAASC,GAAQtB,EAAIwB,QAAQ,KAAKxB,EAAI2B,0BAA0Bd,MAAM,CAAC5B,MAAOe,EAAU,OAAEc,SAAS,SAAUC,GAAMf,EAAIuB,OAAOR,GAAKE,WAAW,aAAa,IAAI,GAAGd,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,MAAM,CAACH,EAAG,eAAe,CAACE,YAAY,WAAWC,MAAM,CAAC,MAAQ,uBAAuB,YAAY,WAAW,CAACH,EAAG,gBAAgB,CAACQ,IAAI,SAASL,MAAM,CAAC,GAAK,SAAS,QAAUN,EAAI4B,gBAAgB,SAAuB,MAAZ5B,EAAIuB,QAA6BF,GAAG,CAAC,OAAS,SAASC,GAAQ,OAAOtB,EAAI6B,yBAAyBhB,MAAM,CAAC5B,MAAOe,EAAW,QAAEc,SAAS,SAAUC,GAAMf,EAAIwB,QAAQT,GAAKE,WAAW,cAAc,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,GAAGd,EAAG,QAAQ,CAACA,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,OAAO,CAAEN,EAAe,YAAEG,EAAG,MAAM,CAACA,EAAG,MAAM,CAACE,YAAY,gCAAgC,CAACF,EAAG,YAAY,CAAC2B,YAAY,CAAC,MAAQ,OAAO,OAAS,QAAQxB,MAAM,CAAC,MAAQ,aAAaH,EAAG,MAAMA,EAAG,SAAS,CAACH,EAAIS,GAAG,0BAA0B,KAAKT,EAAIkB,QAAQ,GAAKlB,EAAI+B,aAA4B,MAAb/B,EAAIwB,QAAinCxB,EAAIkB,KAAtmCf,EAAG,QAAQ,CAACA,EAAG,QAAQ,CAACG,MAAM,CAAC,GAAK,OAAO,CAACH,EAAG,QAAQ,CAACE,YAAY,mBAAmBC,MAAM,CAAC,OAAS,IAAI,YAAc,IAAI,YAAc,MAAM,CAACH,EAAG,QAAQ,CAACA,EAAG,KAAK,CAACA,EAAG,KAAK,CAACH,EAAIS,GAAG,OAAON,EAAG,KAAK,CAACH,EAAIS,GAAG,gBAAgBN,EAAG,KAAK,CAACH,EAAIS,GAAG,4BAA4BN,EAAG,KAAK,CAACH,EAAIS,GAAG,WAAWN,EAAG,QAAQH,EAAIgC,GAAIhC,EAAoB,kBAAE,SAAS0E,EAAIC,EAAOnC,GAAG,OAAOrC,EAAG,KAAK,CAACrB,IAAI6F,GAAQ,CAACxE,EAAG,KAAK,CAACE,YAAY,aAAa,CAACL,EAAIS,GAAGT,EAAIoC,GAAGI,EAAI,MAAMrC,EAAG,KAAK,CAAC2B,YAAY,CAAC,aAAa,SAAS,CAAC9B,EAAIS,GAAGT,EAAIoC,GAAGuC,MAAWxE,EAAG,KAAK,CAAC2B,YAAY,CAAC,aAAa,SAAS,CAAC9B,EAAIS,GAAGT,EAAIoC,GAAsB,KAAnBsC,EAAItB,cAAqBpD,EAAI0H,uBAAuBhD,EAAIuD,aAAajI,EAAI2H,8BAA8BjD,EAAK,QAAQA,EAAI4B,aAAe,QAAQnG,EAAG,KAAK,CAACE,YAAY,aAAa,CAACL,EAAIS,GAAGT,EAAIoC,GAAGI,EAAI,WAAU,KAAKrC,EAAG,MAAM,CAAC2B,YAAY,CAAC,gBAAgB,SAAS,CAAC3B,EAAG,WAAW,CAACE,YAAY,kBAAkBC,MAAM,CAAC,QAAU,WAAWe,GAAG,CAAC,MAAQrB,EAAIiE,WAAW,CAACjE,EAAIS,GAAG,0BAA0BN,EAAG,WAAW,CAACE,YAAY,kBAAkBC,MAAM,CAAC,QAAU,mBAAmBe,GAAG,CAAC,MAAQrB,EAAIkE,iBAAiB,CAAClE,EAAIS,GAAG,uBAAuB,MAAM,IAAa,IAClrF,GAAkB,GCyKtB,IACE,KAAF,wBACE,WAAF,GAEE,KAJF,WAKI,MAAJ,CACM,OAAN,KACM,WAAN,GACM,UAAN,EACM,cAAN,KACM,QAAN,KACM,gBAAN,GACM,WAAN,KACM,YAAN,KACM,QAAN,KACM,aAAN,EACM,SAAN,GACM,aAAN,GACM,sBAAN,GACM,iBAAN,GACM,oBAAN,KAGE,QAAF,CACI,uBADJ,SACA,OACM,GAAN,SACQ,IAAR,IACA,IACA,+CAAU,OAAV,sBAKQ,OAJA,EAAR,qBACA,sBACU,OAEV,wEACA,iBACA,gBACA,KACA,mCAEA,YAGA,uCAEA,yEAcA,wEAbA,+BACA,KACA,kBAEA,UAGA,KACA,qBAEA,uBAiBA,gCACA,KACA,kBAEA,WAUQ,MAAR,uBAGI,YAlEJ,SAkEA,GACM,IAAN,gCACA,iCACA,IACM,OAAN,cAGI,qBAzEJ,SAyEA,OAAM,IAAN,OACA,IACA,mCACA,YAAQ,OAAR,gCAEA,mDASM,OARA,OAAN,mDAAQ,IAAR,UACA,sMACA,MACA,kCAEA,sCAGA,GAEI,6BAzFJ,SAyFA,KAAM,IAAN,OACA,IACA,mCACA,YAAQ,OAAR,gCAEA,mDAWM,OAVA,OAAN,mDAAQ,IAAR,MACA,sIACQ,GAAR,EAAQ,CACA,IAAR,8CACA,MACA,6BAEA,kCAGA,GAEI,uBA3GJ,SA2GA,GAAM,IAAN,OACA,IAKM,OAJA,OAAN,mDACQ,IAAR,0CACA,0CAEA,GAEI,gBAnHJ,WAmHM,IAAN,OACA,wBAUM,OATA,OAAN,mDACQ,GAAR,0CACQ,GAAR,4CACQ,GAAR,0CACQ,GAAR,8CACQ,GAAR,UACQ,GAAR,aAGA,CAAQ,KAAR,EAAQ,OAAR,EAAQ,KAAR,EAAQ,SAAR,EAAQ,KAAR,EAAQ,KAAR,IAEI,aAhIJ,SAgIA,GAGM,IAAN,iDAAQ,OAAR,cACM,QAAN,oBAAQ,OAAR,kCACA,oBAAQ,OAAR,mDAGI,oBAxIJ,SAwIA,KACM,IAAN,sBACM,OAAN,mCAEI,YA5IJ,SA4IA,SAAM,IAAN,UACA,sMAEM,OADN,cACA,oCAEI,0BAjJJ,SAiJA,OAAM,IAAN,MACA,sIACM,OAAN,yCAEI,2BArJJ,SAqJA,GACM,IAAN,UACA,aACA,UACM,GAAN,kDACM,IAAN,IACM,GAAN,yEACQ,GAAR,OAEU,IADA,IAAV,IACA,cAAY,IAAZ,EACA,kCACA,MACc,GAAd,EACc,KAGJ,OAAV,UACU,GAAV,EACA,gEAEU,IAAV,kBAAY,IAAZ,EACA,kCACY,GAAZ,WAEU,OAAV,+DAEA,4EACQ,GAAR,OAEU,IADA,IAAV,IACA,cAAY,IAAZ,EACA,kCACA,MACc,GAAd,EACc,KAGJ,OAAV,UACU,GAAV,EACA,gEAEU,IAAV,kBAAY,IAAZ,EACA,kCACY,GAAZ,WAEU,OAAV,+DAEA,4EAAQ,IAAR,EACA,kCACQ,OAAR,oBACA,4EAAQ,IAAR,EACA,kCACQ,OAAR,oBACA,4EAEQ,IADA,IACR,cAAU,IAAV,EACA,2CACA,MACY,GAAZ,GAIQ,GAAR,eACQ,IAAR,uCACQ,OAAR,+DACA,4EAEQ,IADA,IAAR,IACA,cAAU,IAAV,EACA,2CACA,MACY,GAAZ,EACY,KAGJ,GAAR,eACQ,IAAR,MACQ,OAAR,+DACA,4EAEQ,IADA,IACR,cAAU,IAAV,EACA,2CACA,MACY,GAAZ,GAIQ,GAAR,eACQ,IAAR,MACQ,OAAR,+DAGQ,IADA,IAAR,IACA,cAAU,IAAV,EACA,kCACA,MACY,GAAZ,EACY,KAGJ,GAAR,eACQ,IAAR,MACQ,OAAR,gEAGI,qBA3PJ,SA2PA,GAAM,IAAN,OACA,+BACM,IAAN,sBACM,IAAN,IAiBM,OAhBA,EAAN,qBAEQ,GAAR,qDACQ,IAAR,sBACA,gBACA,6BACA,+DACA,oCACQ,GAAR,KAQA,qCAEI,8BAjRJ,SAiRA,KAAM,IAAN,OACA,2BACA,IACA,IAqBM,OApBA,EAAN,qBACQ,GAAR,kBAAQ,CACA,IAAR,4CAAU,OAAV,cACA,2CACA,iDACA,WACU,IACV,OACA,qCACA,iEACA,+DACA,qEAHA,KAKA,sCACA,mEACA,iEACA,uEAHA,SAOA,YAEI,wBA3SJ,SA2SA,GAAM,IAAN,OACA,2BACA,IACA,IASM,OARA,EAAN,qBACQ,GAAR,kBAAQ,CACA,IAAR,iDACA,WACU,GAAV,EACU,SAGV,yBAEI,gBAzTJ,SAyTA,GACM,IAAN,IAKM,OAJA,OAAN,mDACA,2BACA,8BAEA,GAEI,yBAjUJ,SAiUA,OAAM,IAAN,OACA,IAiBM,OAhBA,OAAN,mDAAQ,IAAR,QACA,+FACA,6GACA,sBACA,OACA,qCACA,iEACA,+DACA,qEAHA,KAKA,sCACA,mEACA,iEACA,uEAHA,QAMA,GAEI,mBArVJ,SAqVA,GAAM,IAAN,OACA,IAmBM,OAlBA,OAAN,mDACQ,EAAR,2CAAU,IAAV,gCACA,+FACA,6GACA,sBACA,OACA,qCACA,iEACA,+DACA,qEAHA,KAKA,sCACA,mEACA,iEACA,uEAHA,WAOA,GAEI,YA3WJ,SA2WA,GACM,OAAN,WACA,WACA,WACA,IAEI,0BAjXJ,SAiXA,KAAM,IAAN,OACA,IAsBM,OArBA,OAAN,mCACQ,OAAR,+CACU,IAAV,8CACA,uBACA,UACA,6EACA,6EACA,sBACA,OACA,qCACA,iEACA,+DACA,qEAHA,KAKA,sCACA,mEACA,iEACA,uEAHA,WAOA,GAEI,cA1YJ,SA0YA,OAAM,IAAN,MACM,OAAN,iIAEI,gBA7YJ,SA6YA,OAAM,IAAN,IACA,mGACM,MAAN,wCAEI,oBAjZJ,SAiZA,OAAM,IAAN,IACA,uGACM,MAAN,wCAEI,aArZJ,SAqZA,SAAM,IAAN,IACA,6GACM,OAAN,MACA,4CACA,8CACA,4CACA,iDACA,kBAEA,6CACA,+CACA,6CACA,kDACA,mBAGI,eAraJ,SAqaA,GAEM,MAAN,sCACA,qBACA,uBACA,uBACA,0BACA,mBAEI,oBA9aJ,SA8aA,GACM,OAAN,4CACA,8CACA,4CACA,iDACA,mBAEI,oBArbJ,SAqbA,KACM,IAAN,6CAAQ,OAAR,iDACM,QAAN,OACQ,IAAR,gDACA,uDACA,yBACQ,MAAR,CAAU,aAAV,EAAU,KAAV,EAAU,MAAV,GAEQ,MAAR,CAAU,aAAV,GAAU,KAAV,GAAU,MAAV,KAGI,wBAhcJ,WAgcM,IAAN,OAAM,OAAN,6IACA,yBADA,SAEA,IACA,yFACA,kBACA,cACA,8EACA,kBAEA,kBACA,uCAKA,mBACA,2HAhBA,8CAmBI,qBAndJ,WAmdM,IAAN,OAAM,OAAN,yIACA,iBACA,yCACA,2CACA,6CACA,+CACA,mGACA,gBAPA,wBAQA,sGACA,gDACA,kBACA,yBAGA,2BAdA,UAeA,IACA,+EACA,kBACA,cACA,sFACA,kBAEA,iBAEA,kCACA,qEACA,0BACA,gCAEA,qEACA,oDACA,gCAEA,qEACA,0BACA,iCAEA,4IAGA,cAFA,sCAUA,mBACA,gIACA,oBAlDA,eAoDA,cApDA,UAqDA,IACA,yIACA,kBACA,cACA,+FACA,kBAEA,kBACA,4BAKA,mBACA,yIACA,oBApEA,QAwEA,iBAxEA,+CA0EI,SA7hBJ,WA8hBM,IAAN,wCACA,yCACA,4CACA,uCACM,EAAN,q9BAsBA,oCAtBA,qCAsBA,EAtBA,qBAsBA,gBAtBA,qBAsBA,iBAtBA,0BAsBA,2BAtBA,8CAuBA,EAvBA,6EAwBA,EAxBA,mDA2BM,EAAN,iBACM,EAAN,SAEI,eAhkBJ,WAikBM,IAAN,kCACA,8BACM,EAAN,wCAEI,UArkBJ,SAqkBA,GACM,IAAN,2CACM,OAAN,+BAEI,sBAzkBJ,WAykBM,IAAN,OAAM,OAAN,sIACA,qBACA,gDACA,qBACA,0EAJA,8CAQI,iBAjlBJ,WAilBM,IAAN,OAAM,OAAN,sIACA,gBACA,+CACA,6DAHA,8CAMI,oBAvlBJ,WAulBM,IAAN,OAAM,OAAN,sIACA,mBACA,6CACA,mEAHA,8CAMI,iBA7lBJ,SA6lBA,OACM,KAAN,kBAAQ,MAAR,EAAQ,QAAR,EAAQ,QAAR,uBAAQ,OAAR,EAAQ,cAAR,IAAQ,aAAR,MAGE,SAAF,CACI,QADJ,WAEM,OAAN,wBAEI,iBAJJ,WAIM,IAAN,OACA,KAuCM,OAtCA,KAAN,8BACQ,IAAR,8QACA,OACU,EAAV,IAAY,YAAZ,EAAY,aAAZ,EAAY,cAAZ,EAAY,KAAZ,EAAY,KAAZ,EAAY,MAAZ,KAEA,gBACU,EAAV,aAAY,YAAZ,KAEA,+BACU,EAAV,4BACY,YAAZ,EACY,kBAAZ,EACY,GAAZ,EACY,SAAZ,GACY,MAAZ,EACY,mBAAZ,EACY,WAAZ,EACY,MAAZ,CAAc,EAAd,sBAAc,EAAd,sBAAc,EAAd,sBAAc,EAAd,yBAGQ,IAAR,IAGY,EAFZ,OACA,8BACA,EAEA,aAGA,aACA,0BAEA,QAGQ,EAAR,yCACQ,EAAR,cACQ,EAAR,iBAEA,GAEI,0BA9CJ,WA+CM,IAAN,sDAAQ,OAAR,WACM,OAAN,QAEI,qBAlDJ,WAkDM,IAAN,OACA,yDAAQ,IAAR,oCACA,2CACQ,MAAR,CAAU,OAAV,EAAU,SAAV,iBAGM,EAAN,oBAAQ,OAAR,yBACM,IAAN,KACA,IACA,IACA,OAUM,OATA,EAAN,qBACA,iBACU,EAAV,EACU,EAAV,WACU,KAEF,EAAR,eAGA,GAEI,kBAxEJ,WAyEM,IAAN,KAKM,OAJA,KAAN,2CAAQ,IAAR,wBACA,gBACQ,EAAR,cAEA,IAGE,YAzsBF,WA0sBI,KAAJ,mBACI,KAAJ,sBACI,KAAJ,0BACI,KAAJ,+ECv3BuY,MCQnY,I,UAAY,eACd,GACA,GACA,IACA,EACA,KACA,WACA,OAIa,M,QCqHf,IACE,KAAF,eACE,WAAF,CACI,eAAJ,EACI,oBAAJ,EACI,qBAAJ,EACI,eAAJ,EACI,mBAAJ,EACI,iBAAJ,EACI,kBAAJ,GACI,aAAJ,GACI,gBAAJ,GACI,sBAAJ,GACI,oBAAJ,GACI,cAAJ,GACI,iBAAJ,GACI,yBAAJ,GACI,qBAAJ,GACI,yBAAJ,GACI,sBAAJ,GACI,gCAAJ,IAEE,KAtBF,WAuBI,MAAJ,CACM,cAAN,OAGE,QAAF,CACI,iBADJ,SACA,OACM,KAAN,kBAAQ,MAAR,EAAQ,QAAR,EAAQ,QAAR,uBAAQ,OAAR,EAAQ,cAAR,IAAQ,aAAR,MAGE,YAhCF,cCxIqW,MCOjW,GAAY,eACd,GACAV,EACAoB,GACA,EACA,KACA,KACA,MAIa,gB,2CClBf,W,oFCCe,SAAS+G,EAAmBC,GACzC,GAAIC,MAAMC,QAAQF,GAAM,OAAOG,eAAiBH,G,sECFnC,SAASI,EAAiBC,GACvC,GAAsB,qBAAXC,QAAmD,MAAzBD,EAAKC,OAAOC,WAA2C,MAAtBF,EAAK,cAAuB,OAAOJ,MAAMO,KAAKH,G,gBCDvG,SAASI,IACtB,MAAM,IAAIC,UAAU,wICGP,SAASC,EAAmBX,GACzC,OAAOY,EAAkBZ,IAAQa,EAAgBb,IAAQc,eAA2Bd,IAAQe,M,oCCL9F,W,kCCAA,W,6DCAA,W,6DCAA,W,6DCAA,W,wICAA,W,yDCAA,W,gDCOA,IAAIC,EAAW,SAAUC,GACvB,aAEA,IAEItJ,EAFAuJ,EAAKhH,OAAOiH,UACZC,EAASF,EAAGG,eAEZC,EAA4B,oBAAXhB,OAAwBA,OAAS,GAClDiB,EAAiBD,EAAQf,UAAY,aACrCiB,EAAsBF,EAAQG,eAAiB,kBAC/CC,EAAoBJ,EAAQK,aAAe,gBAE/C,SAASC,EAAOC,EAAKlL,EAAKG,GAOxB,OANAoD,OAAO4H,eAAeD,EAAKlL,EAAK,CAC9BG,MAAOA,EACPiL,YAAY,EACZC,cAAc,EACdC,UAAU,IAELJ,EAAIlL,GAEb,IAEEiL,EAAO,GAAI,IACX,MAAOlK,GACPkK,EAAS,SAASC,EAAKlL,EAAKG,GAC1B,OAAO+K,EAAIlL,GAAOG,GAItB,SAASoL,EAAKC,EAASC,EAAS/K,EAAMgL,GAEpC,IAAIC,EAAiBF,GAAWA,EAAQjB,qBAAqBoB,EAAYH,EAAUG,EAC/EC,EAAYtI,OAAOuI,OAAOH,EAAenB,WACzCuB,EAAU,IAAIC,EAAQN,GAAe,IAMzC,OAFAG,EAAUI,QAAUC,EAAiBV,EAAS9K,EAAMqL,GAE7CF,EAcT,SAASM,EAAS1L,EAAIyK,EAAKjL,GACzB,IACE,MAAO,CAAEmM,KAAM,SAAUnM,IAAKQ,EAAG4L,KAAKnB,EAAKjL,IAC3C,MAAOc,GACP,MAAO,CAAEqL,KAAM,QAASnM,IAAKc,IAhBjCuJ,EAAQiB,KAAOA,EAoBf,IAAIe,EAAyB,iBACzBC,EAAyB,iBACzBC,EAAoB,YACpBC,EAAoB,YAIpBC,EAAmB,GAMvB,SAASd,KACT,SAASe,KACT,SAASC,KAIT,IAAIC,EAAoB,GACxBA,EAAkBjC,GAAkB,WAClC,OAAOjK,MAGT,IAAImM,EAAWvJ,OAAOwJ,eAClBC,EAA0BF,GAAYA,EAASA,EAASG,EAAO,MAC/DD,GACAA,IAA4BzC,GAC5BE,EAAO4B,KAAKW,EAAyBpC,KAGvCiC,EAAoBG,GAGtB,IAAIE,EAAKN,EAA2BpC,UAClCoB,EAAUpB,UAAYjH,OAAOuI,OAAOe,GAWtC,SAASM,EAAsB3C,GAC7B,CAAC,OAAQ,QAAS,UAAU4C,SAAQ,SAASC,GAC3CpC,EAAOT,EAAW6C,GAAQ,SAASpN,GACjC,OAAOU,KAAKsL,QAAQoB,EAAQpN,SAkClC,SAASqN,EAAczB,EAAW0B,GAChC,SAASC,EAAOH,EAAQpN,EAAKL,EAASC,GACpC,IAAI4N,EAAStB,EAASN,EAAUwB,GAASxB,EAAW5L,GACpD,GAAoB,UAAhBwN,EAAOrB,KAEJ,CACL,IAAIsB,EAASD,EAAOxN,IAChBE,EAAQuN,EAAOvN,MACnB,OAAIA,GACiB,kBAAVA,GACPsK,EAAO4B,KAAKlM,EAAO,WACdoN,EAAY3N,QAAQO,EAAMwN,SAASpN,MAAK,SAASJ,GACtDqN,EAAO,OAAQrN,EAAOP,EAASC,MAC9B,SAASkB,GACVyM,EAAO,QAASzM,EAAKnB,EAASC,MAI3B0N,EAAY3N,QAAQO,GAAOI,MAAK,SAASqN,GAI9CF,EAAOvN,MAAQyN,EACfhO,EAAQ8N,MACP,SAAStN,GAGV,OAAOoN,EAAO,QAASpN,EAAOR,EAASC,MAvBzCA,EAAO4N,EAAOxN,KA4BlB,IAAI4N,EAEJ,SAASC,EAAQT,EAAQpN,GACvB,SAAS8N,IACP,OAAO,IAAIR,GAAY,SAAS3N,EAASC,GACvC2N,EAAOH,EAAQpN,EAAKL,EAASC,MAIjC,OAAOgO,EAaLA,EAAkBA,EAAgBtN,KAChCwN,EAGAA,GACEA,IAKRpN,KAAKsL,QAAU6B,EA2BjB,SAAS5B,EAAiBV,EAAS9K,EAAMqL,GACvC,IAAIiC,EAAQ1B,EAEZ,OAAO,SAAgBe,EAAQpN,GAC7B,GAAI+N,IAAUxB,EACZ,MAAM,IAAIyB,MAAM,gCAGlB,GAAID,IAAUvB,EAAmB,CAC/B,GAAe,UAAXY,EACF,MAAMpN,EAKR,OAAOiO,IAGTnC,EAAQsB,OAASA,EACjBtB,EAAQ9L,IAAMA,EAEd,MAAO,EAAM,CACX,IAAIkO,EAAWpC,EAAQoC,SACvB,GAAIA,EAAU,CACZ,IAAIC,EAAiBC,EAAoBF,EAAUpC,GACnD,GAAIqC,EAAgB,CAClB,GAAIA,IAAmB1B,EAAkB,SACzC,OAAO0B,GAIX,GAAuB,SAAnBrC,EAAQsB,OAGVtB,EAAQuC,KAAOvC,EAAQwC,MAAQxC,EAAQ9L,SAElC,GAAuB,UAAnB8L,EAAQsB,OAAoB,CACrC,GAAIW,IAAU1B,EAEZ,MADA0B,EAAQvB,EACFV,EAAQ9L,IAGhB8L,EAAQyC,kBAAkBzC,EAAQ9L,SAEN,WAAnB8L,EAAQsB,QACjBtB,EAAQ0C,OAAO,SAAU1C,EAAQ9L,KAGnC+N,EAAQxB,EAER,IAAIiB,EAAStB,EAASX,EAAS9K,EAAMqL,GACrC,GAAoB,WAAhB0B,EAAOrB,KAAmB,CAO5B,GAJA4B,EAAQjC,EAAQ1L,KACZoM,EACAF,EAEAkB,EAAOxN,MAAQyM,EACjB,SAGF,MAAO,CACLvM,MAAOsN,EAAOxN,IACdI,KAAM0L,EAAQ1L,MAGS,UAAhBoN,EAAOrB,OAChB4B,EAAQvB,EAGRV,EAAQsB,OAAS,QACjBtB,EAAQ9L,IAAMwN,EAAOxN,OAU7B,SAASoO,EAAoBF,EAAUpC,GACrC,IAAIsB,EAASc,EAASvE,SAASmC,EAAQsB,QACvC,GAAIA,IAAWrM,EAAW,CAKxB,GAFA+K,EAAQoC,SAAW,KAEI,UAAnBpC,EAAQsB,OAAoB,CAE9B,GAAIc,EAASvE,SAAS,YAGpBmC,EAAQsB,OAAS,SACjBtB,EAAQ9L,IAAMe,EACdqN,EAAoBF,EAAUpC,GAEP,UAAnBA,EAAQsB,QAGV,OAAOX,EAIXX,EAAQsB,OAAS,QACjBtB,EAAQ9L,IAAM,IAAI8J,UAChB,kDAGJ,OAAO2C,EAGT,IAAIe,EAAStB,EAASkB,EAAQc,EAASvE,SAAUmC,EAAQ9L,KAEzD,GAAoB,UAAhBwN,EAAOrB,KAIT,OAHAL,EAAQsB,OAAS,QACjBtB,EAAQ9L,IAAMwN,EAAOxN,IACrB8L,EAAQoC,SAAW,KACZzB,EAGT,IAAIxM,EAAOuN,EAAOxN,IAElB,OAAMC,EAOFA,EAAKG,MAGP0L,EAAQoC,EAASO,YAAcxO,EAAKC,MAGpC4L,EAAQ4C,KAAOR,EAASS,QAQD,WAAnB7C,EAAQsB,SACVtB,EAAQsB,OAAS,OACjBtB,EAAQ9L,IAAMe,GAUlB+K,EAAQoC,SAAW,KACZzB,GANExM,GA3BP6L,EAAQsB,OAAS,QACjBtB,EAAQ9L,IAAM,IAAI8J,UAAU,oCAC5BgC,EAAQoC,SAAW,KACZzB,GAoDX,SAASmC,EAAaC,GACpB,IAAIC,EAAQ,CAAEC,OAAQF,EAAK,IAEvB,KAAKA,IACPC,EAAME,SAAWH,EAAK,IAGpB,KAAKA,IACPC,EAAMG,WAAaJ,EAAK,GACxBC,EAAMI,SAAWL,EAAK,IAGxBnO,KAAKyO,WAAWC,KAAKN,GAGvB,SAASO,EAAcP,GACrB,IAAItB,EAASsB,EAAMQ,YAAc,GACjC9B,EAAOrB,KAAO,gBACPqB,EAAOxN,IACd8O,EAAMQ,WAAa9B,EAGrB,SAASzB,EAAQN,GAIf/K,KAAKyO,WAAa,CAAC,CAAEJ,OAAQ,SAC7BtD,EAAY0B,QAAQyB,EAAclO,MAClCA,KAAK6O,OAAM,GA8Bb,SAASvC,EAAOwC,GACd,GAAIA,EAAU,CACZ,IAAIC,EAAiBD,EAAS7E,GAC9B,GAAI8E,EACF,OAAOA,EAAerD,KAAKoD,GAG7B,GAA6B,oBAAlBA,EAASd,KAClB,OAAOc,EAGT,IAAKE,MAAMF,EAASpM,QAAS,CAC3B,IAAIK,GAAK,EAAGiL,EAAO,SAASA,IAC1B,QAASjL,EAAI+L,EAASpM,OACpB,GAAIoH,EAAO4B,KAAKoD,EAAU/L,GAGxB,OAFAiL,EAAKxO,MAAQsP,EAAS/L,GACtBiL,EAAKtO,MAAO,EACLsO,EAOX,OAHAA,EAAKxO,MAAQa,EACb2N,EAAKtO,MAAO,EAELsO,GAGT,OAAOA,EAAKA,KAAOA,GAKvB,MAAO,CAAEA,KAAMT,GAIjB,SAASA,IACP,MAAO,CAAE/N,MAAOa,EAAWX,MAAM,GA+MnC,OA5mBAsM,EAAkBnC,UAAY0C,EAAG0C,YAAchD,EAC/CA,EAA2BgD,YAAcjD,EACzCA,EAAkBkD,YAAc5E,EAC9B2B,EACA7B,EACA,qBAaFT,EAAQwF,oBAAsB,SAASC,GACrC,IAAIC,EAAyB,oBAAXD,GAAyBA,EAAOH,YAClD,QAAOI,IACHA,IAASrD,GAG2B,uBAAnCqD,EAAKH,aAAeG,EAAKC,QAIhC3F,EAAQ4F,KAAO,SAASH,GAQtB,OAPIxM,OAAO4M,eACT5M,OAAO4M,eAAeJ,EAAQnD,IAE9BmD,EAAOK,UAAYxD,EACnB3B,EAAO8E,EAAQhF,EAAmB,sBAEpCgF,EAAOvF,UAAYjH,OAAOuI,OAAOoB,GAC1B6C,GAOTzF,EAAQ+F,MAAQ,SAASpQ,GACvB,MAAO,CAAE0N,QAAS1N,IAsEpBkN,EAAsBG,EAAc9C,WACpC8C,EAAc9C,UAAUK,GAAuB,WAC7C,OAAOlK,MAET2J,EAAQgD,cAAgBA,EAKxBhD,EAAQgG,MAAQ,SAAS9E,EAASC,EAAS/K,EAAMgL,EAAa6B,QACxC,IAAhBA,IAAwBA,EAAcjN,SAE1C,IAAIoJ,EAAO,IAAI4D,EACb/B,EAAKC,EAASC,EAAS/K,EAAMgL,GAC7B6B,GAGF,OAAOjD,EAAQwF,oBAAoBrE,GAC/B/B,EACAA,EAAKiF,OAAOpO,MAAK,SAASmN,GACxB,OAAOA,EAAOrN,KAAOqN,EAAOvN,MAAQuJ,EAAKiF,WAuKjDxB,EAAsBD,GAEtBjC,EAAOiC,EAAInC,EAAmB,aAO9BmC,EAAGtC,GAAkB,WACnB,OAAOjK,MAGTuM,EAAGqD,SAAW,WACZ,MAAO,sBAkCTjG,EAAQ9G,KAAO,SAASgN,GACtB,IAAIhN,EAAO,GACX,IAAK,IAAIxD,KAAOwQ,EACdhN,EAAK6L,KAAKrP,GAMZ,OAJAwD,EAAKiN,UAIE,SAAS9B,IACd,MAAOnL,EAAKH,OAAQ,CAClB,IAAIrD,EAAMwD,EAAKkN,MACf,GAAI1Q,KAAOwQ,EAGT,OAFA7B,EAAKxO,MAAQH,EACb2O,EAAKtO,MAAO,EACLsO,EAQX,OADAA,EAAKtO,MAAO,EACLsO,IAsCXrE,EAAQ2C,OAASA,EAMjBjB,EAAQxB,UAAY,CAClBoF,YAAa5D,EAEbwD,MAAO,SAASmB,GAcd,GAbAhQ,KAAKiQ,KAAO,EACZjQ,KAAKgO,KAAO,EAGZhO,KAAK2N,KAAO3N,KAAK4N,MAAQvN,EACzBL,KAAKN,MAAO,EACZM,KAAKwN,SAAW,KAEhBxN,KAAK0M,OAAS,OACd1M,KAAKV,IAAMe,EAEXL,KAAKyO,WAAWhC,QAAQkC,IAEnBqB,EACH,IAAK,IAAIV,KAAQtP,KAEQ,MAAnBsP,EAAKY,OAAO,IACZpG,EAAO4B,KAAK1L,KAAMsP,KACjBN,OAAOM,EAAKa,MAAM,MACrBnQ,KAAKsP,GAAQjP,IAMrB+P,KAAM,WACJpQ,KAAKN,MAAO,EAEZ,IAAI2Q,EAAYrQ,KAAKyO,WAAW,GAC5B6B,EAAaD,EAAUzB,WAC3B,GAAwB,UAApB0B,EAAW7E,KACb,MAAM6E,EAAWhR,IAGnB,OAAOU,KAAKuQ,MAGd1C,kBAAmB,SAAS2C,GAC1B,GAAIxQ,KAAKN,KACP,MAAM8Q,EAGR,IAAIpF,EAAUpL,KACd,SAASyQ,EAAOC,EAAKC,GAYnB,OAXA7D,EAAOrB,KAAO,QACdqB,EAAOxN,IAAMkR,EACbpF,EAAQ4C,KAAO0C,EAEXC,IAGFvF,EAAQsB,OAAS,OACjBtB,EAAQ9L,IAAMe,KAGNsQ,EAGZ,IAAK,IAAI5N,EAAI/C,KAAKyO,WAAW/L,OAAS,EAAGK,GAAK,IAAKA,EAAG,CACpD,IAAIqL,EAAQpO,KAAKyO,WAAW1L,GACxB+J,EAASsB,EAAMQ,WAEnB,GAAqB,SAAjBR,EAAMC,OAIR,OAAOoC,EAAO,OAGhB,GAAIrC,EAAMC,QAAUrO,KAAKiQ,KAAM,CAC7B,IAAIW,EAAW9G,EAAO4B,KAAK0C,EAAO,YAC9ByC,EAAa/G,EAAO4B,KAAK0C,EAAO,cAEpC,GAAIwC,GAAYC,EAAY,CAC1B,GAAI7Q,KAAKiQ,KAAO7B,EAAME,SACpB,OAAOmC,EAAOrC,EAAME,UAAU,GACzB,GAAItO,KAAKiQ,KAAO7B,EAAMG,WAC3B,OAAOkC,EAAOrC,EAAMG,iBAGjB,GAAIqC,GACT,GAAI5Q,KAAKiQ,KAAO7B,EAAME,SACpB,OAAOmC,EAAOrC,EAAME,UAAU,OAG3B,KAAIuC,EAMT,MAAM,IAAIvD,MAAM,0CALhB,GAAItN,KAAKiQ,KAAO7B,EAAMG,WACpB,OAAOkC,EAAOrC,EAAMG,gBAU9BT,OAAQ,SAASrC,EAAMnM,GACrB,IAAK,IAAIyD,EAAI/C,KAAKyO,WAAW/L,OAAS,EAAGK,GAAK,IAAKA,EAAG,CACpD,IAAIqL,EAAQpO,KAAKyO,WAAW1L,GAC5B,GAAIqL,EAAMC,QAAUrO,KAAKiQ,MACrBnG,EAAO4B,KAAK0C,EAAO,eACnBpO,KAAKiQ,KAAO7B,EAAMG,WAAY,CAChC,IAAIuC,EAAe1C,EACnB,OAIA0C,IACU,UAATrF,GACS,aAATA,IACDqF,EAAazC,QAAU/O,GACvBA,GAAOwR,EAAavC,aAGtBuC,EAAe,MAGjB,IAAIhE,EAASgE,EAAeA,EAAalC,WAAa,GAItD,OAHA9B,EAAOrB,KAAOA,EACdqB,EAAOxN,IAAMA,EAETwR,GACF9Q,KAAK0M,OAAS,OACd1M,KAAKgO,KAAO8C,EAAavC,WAClBxC,GAGF/L,KAAK+Q,SAASjE,IAGvBiE,SAAU,SAASjE,EAAQ0B,GACzB,GAAoB,UAAhB1B,EAAOrB,KACT,MAAMqB,EAAOxN,IAcf,MAXoB,UAAhBwN,EAAOrB,MACS,aAAhBqB,EAAOrB,KACTzL,KAAKgO,KAAOlB,EAAOxN,IACM,WAAhBwN,EAAOrB,MAChBzL,KAAKuQ,KAAOvQ,KAAKV,IAAMwN,EAAOxN,IAC9BU,KAAK0M,OAAS,SACd1M,KAAKgO,KAAO,OACa,WAAhBlB,EAAOrB,MAAqB+C,IACrCxO,KAAKgO,KAAOQ,GAGPzC,GAGTiF,OAAQ,SAASzC,GACf,IAAK,IAAIxL,EAAI/C,KAAKyO,WAAW/L,OAAS,EAAGK,GAAK,IAAKA,EAAG,CACpD,IAAIqL,EAAQpO,KAAKyO,WAAW1L,GAC5B,GAAIqL,EAAMG,aAAeA,EAGvB,OAFAvO,KAAK+Q,SAAS3C,EAAMQ,WAAYR,EAAMI,UACtCG,EAAcP,GACPrC,IAKb,MAAS,SAASsC,GAChB,IAAK,IAAItL,EAAI/C,KAAKyO,WAAW/L,OAAS,EAAGK,GAAK,IAAKA,EAAG,CACpD,IAAIqL,EAAQpO,KAAKyO,WAAW1L,GAC5B,GAAIqL,EAAMC,SAAWA,EAAQ,CAC3B,IAAIvB,EAASsB,EAAMQ,WACnB,GAAoB,UAAhB9B,EAAOrB,KAAkB,CAC3B,IAAIwF,EAASnE,EAAOxN,IACpBqP,EAAcP,GAEhB,OAAO6C,GAMX,MAAM,IAAI3D,MAAM,0BAGlB4D,cAAe,SAASpC,EAAUf,EAAYE,GAa5C,OAZAjO,KAAKwN,SAAW,CACdvE,SAAUqD,EAAOwC,GACjBf,WAAYA,EACZE,QAASA,GAGS,SAAhBjO,KAAK0M,SAGP1M,KAAKV,IAAMe,GAGN0L,IAQJpC,EA7sBK,CAotBiBwH,EAAOxH,SAGtC,IACEyH,mBAAqB1H,EACrB,MAAO2H,GAUPC,SAAS,IAAK,yBAAdA,CAAwC5H,K,oCC1uB1C,W,kCCAA,W,kCCAA,W,kCCAA,W,yDCAA,W,yDCAA,W,yDCAA,W","file":"js/chunk-6aa8cf37.636a8c67.js","sourcesContent":["export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AsignaturasPerdidas.vue?vue&type=style&index=0&id=57fed324&scoped=true&lang=css&\"","function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n  try {\n    var info = gen[key](arg);\n    var value = info.value;\n  } catch (error) {\n    reject(error);\n    return;\n  }\n\n  if (info.done) {\n    resolve(value);\n  } else {\n    Promise.resolve(value).then(_next, _throw);\n  }\n}\n\nexport default function _asyncToGenerator(fn) {\n  return function () {\n    var self = this,\n        args = arguments;\n    return new Promise(function (resolve, reject) {\n      var gen = fn.apply(self, args);\n\n      function _next(value) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value);\n      }\n\n      function _throw(err) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err);\n      }\n\n      _next(undefined);\n    });\n  };\n}","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('b-row',{staticClass:\"mt-2\"},[_c('b-col',{attrs:{\"lg\":\"12\"}},[_c('b-card',{scopedSlots:_vm._u([{key:\"header\",fn:function(){return [_c('h5',{staticClass:\"mb-0\"},[_c('b-icon',{attrs:{\"icon\":\"card-checklist\",\"aria-hidden\":\"true\"}}),_vm._v(\" CONSOLIDADOS\")],1)]},proxy:true}])},[_c('b-card-text',[_c('b-row',[_c('b-col',{attrs:{\"lg\":\"12\"}},[_c('b-card',{attrs:{\"bg-variant\":\"light\",\"text-variant\":\"\"}},[_c('b-card-text',[_c('b-row',[_c('b-col',{attrs:{\"lg\":\"4\"}},[_c('h6',[_vm._v(\"Evaluaciones\")]),_c('b-form-group',{attrs:{\"label\":\"\"},scopedSlots:_vm._u([{key:\"default\",fn:function(ref){\nvar ariaDescribedby = ref.ariaDescribedby;\nreturn [_c('b-form-radio',{attrs:{\"aria-describedby\":ariaDescribedby,\"name\":\"some-radios\",\"value\":\"1\"},model:{value:(_vm.idConsolidado),callback:function ($$v) {_vm.idConsolidado=$$v},expression:\"idConsolidado\"}},[_vm._v(\"Resumen por Periodo\")]),_c('b-form-radio',{attrs:{\"aria-describedby\":ariaDescribedby,\"name\":\"some-radios\",\"value\":\"2\"},model:{value:(_vm.idConsolidado),callback:function ($$v) {_vm.idConsolidado=$$v},expression:\"idConsolidado\"}},[_vm._v(\"Consolidado Acumulado/Promedio\")]),_c('b-form-radio',{attrs:{\"aria-describedby\":ariaDescribedby,\"name\":\"some-radios\",\"value\":\"3\"},model:{value:(_vm.idConsolidado),callback:function ($$v) {_vm.idConsolidado=$$v},expression:\"idConsolidado\"}},[_vm._v(\"Consolidado Acumulado/Ponderado\")]),_c('b-form-radio',{attrs:{\"aria-describedby\":ariaDescribedby,\"name\":\"some-radios\",\"value\":\"4\"},model:{value:(_vm.idConsolidado),callback:function ($$v) {_vm.idConsolidado=$$v},expression:\"idConsolidado\"}},[_vm._v(\"Notas Faltantes por Asignatura\")]),_c('b-form-radio',{attrs:{\"aria-describedby\":ariaDescribedby,\"name\":\"some-radios\",\"value\":\"5\"},model:{value:(_vm.idConsolidado),callback:function ($$v) {_vm.idConsolidado=$$v},expression:\"idConsolidado\"}},[_vm._v(\"Notas Faltantes por rea\")])]}}])})],1),_c('b-col',{attrs:{\"lg\":\"4\"}},[_c('h6',[_vm._v(\"Ausencias\")]),_c('b-form-group',{attrs:{\"label\":\"\"},scopedSlots:_vm._u([{key:\"default\",fn:function(ref){\nvar ariaDescribedby = ref.ariaDescribedby;\nreturn [_c('b-form-radio',{attrs:{\"aria-describedby\":ariaDescribedby,\"name\":\"some-radios\",\"value\":\"10\"},model:{value:(_vm.idConsolidado),callback:function ($$v) {_vm.idConsolidado=$$v},expression:\"idConsolidado\"}},[_vm._v(\"Ausencias por Periodo\")]),_c('b-form-radio',{attrs:{\"aria-describedby\":ariaDescribedby,\"name\":\"some-radios\",\"value\":\"11\"},model:{value:(_vm.idConsolidado),callback:function ($$v) {_vm.idConsolidado=$$v},expression:\"idConsolidado\"}},[_vm._v(\"Consolidado Ausencias\")])]}}])}),_c('h6',[_vm._v(\"Perdidas\")]),_c('b-form-group',{attrs:{\"label\":\"\"},scopedSlots:_vm._u([{key:\"default\",fn:function(ref){\nvar ariaDescribedby = ref.ariaDescribedby;\nreturn [_c('b-form-radio',{attrs:{\"aria-describedby\":ariaDescribedby,\"name\":\"some-radios\",\"value\":\"20\"},model:{value:(_vm.idConsolidado),callback:function ($$v) {_vm.idConsolidado=$$v},expression:\"idConsolidado\"}},[_vm._v(\"Asignaturas Perdidas\")]),_c('b-form-radio',{attrs:{\"aria-describedby\":ariaDescribedby,\"name\":\"some-radios\",\"value\":\"21\"},model:{value:(_vm.idConsolidado),callback:function ($$v) {_vm.idConsolidado=$$v},expression:\"idConsolidado\"}},[_vm._v(\"reas Perdidas\")])]}}])})],1),_c('b-col',{attrs:{\"lg\":\"4\"}},[_c('h6',[_vm._v(\"Finales\")]),_c('b-form-group',{attrs:{\"label\":\"\"},scopedSlots:_vm._u([{key:\"default\",fn:function(ref){\nvar ariaDescribedby = ref.ariaDescribedby;\nreturn [_c('b-form-radio',{attrs:{\"aria-describedby\":ariaDescribedby,\"name\":\"some-radios\",\"value\":\"33\"},model:{value:(_vm.idConsolidado),callback:function ($$v) {_vm.idConsolidado=$$v},expression:\"idConsolidado\"}},[_vm._v(\"Consolidado Evaluaciones Finales por Asignaturas\")]),_c('b-form-radio',{attrs:{\"aria-describedby\":ariaDescribedby,\"name\":\"some-radios\",\"value\":\"35\"},model:{value:(_vm.idConsolidado),callback:function ($$v) {_vm.idConsolidado=$$v},expression:\"idConsolidado\"}},[_vm._v(\"Consolidado Evaluaciones Finales por reas\")]),_c('b-form-radio',{attrs:{\"aria-describedby\":ariaDescribedby,\"name\":\"some-radios\",\"value\":\"34\"},model:{value:(_vm.idConsolidado),callback:function ($$v) {_vm.idConsolidado=$$v},expression:\"idConsolidado\"}},[_vm._v(\"Informe de Asignaturas Perdidas\")]),_c('b-form-radio',{attrs:{\"aria-describedby\":ariaDescribedby,\"name\":\"some-radios\",\"value\":\"32\"},model:{value:(_vm.idConsolidado),callback:function ($$v) {_vm.idConsolidado=$$v},expression:\"idConsolidado\"}},[_vm._v(\"Reporte Estados sin Superacin Final (Pendientes)\")]),_c('b-form-radio',{attrs:{\"aria-describedby\":ariaDescribedby,\"name\":\"some-radios\",\"value\":\"36\"},model:{value:(_vm.idConsolidado),callback:function ($$v) {_vm.idConsolidado=$$v},expression:\"idConsolidado\"}},[_vm._v(\"Estados Finales de Promocin Escolar\")])]}}])})],1)],1)],1)],1)],1)],1),_c('b-row',[_c('b-col',{attrs:{\"lg\":\"12\"}},[(_vm.idConsolidado==1)?_c('div',[_c('ResumenPeriodo')],1):_vm._e(),(_vm.idConsolidado==2)?_c('div',[_c('ConsolidadoPromedio')],1):_vm._e(),(_vm.idConsolidado==3)?_c('div',[_c('ConsolidadoPonderado')],1):_vm._e(),(_vm.idConsolidado==4)?_c('div',[_c('NotasFaltantes')],1):_vm._e(),(_vm.idConsolidado==5)?_c('div',[_c('NotasFaltantesArea')],1):_vm._e(),(_vm.idConsolidado==10)?_c('div',[_c('AusenciasPeriodo')],1):_vm._e(),(_vm.idConsolidado==11)?_c('div',[_c('AusenciasPeriodos')],1):_vm._e(),(_vm.idConsolidado==20)?_c('div',[_c('AsignaturasPerdidas')],1):_vm._e(),(_vm.idConsolidado==21)?_c('div',[_c('AreasPerdidas')],1):_vm._e(),(_vm.idConsolidado==30)?_c('div',[_c('ResumenFinal')],1):_vm._e(),(_vm.idConsolidado==31)?_c('div',[_c('ResumenFinalHab')],1):_vm._e(),(_vm.idConsolidado==32)?_c('div',[_c('ResumenPromocionAreas')],1):_vm._e(),(_vm.idConsolidado==33)?_c('div',[_c('ConsolidadoFinal')],1):_vm._e(),(_vm.idConsolidado==34)?_c('div',[_c('ResumenFinalAsigPerdidas')],1):_vm._e(),(_vm.idConsolidado==35)?_c('div',[_c('ConsolidadoFinalAreas')],1):_vm._e(),(_vm.idConsolidado==36)?_c('div',[_c('ResumenPromocionAreasDefinitivo')],1):_vm._e()])],1)],1)],1)],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('b-row',{staticClass:\"mt-2\"},[_c('b-col',{attrs:{\"lg\":\"12\"}},[_c('b-card',{scopedSlots:_vm._u([{key:\"header\",fn:function(){return [_c('h5',{staticClass:\"mb-0\"},[_c('b-icon',{attrs:{\"icon\":\"card-checklist\",\"aria-hidden\":\"true\"}}),_vm._v(\" RESUMEN DE EVALUACIONES POR PERIODO\")],1)]},proxy:true}])},[_c('b-card-text',[_c('b-row',[_c('b-col',{attrs:{\"lg\":\"2\"}},[_c('b-form-group',{staticClass:\"etiqueta\",attrs:{\"label\":\"Periodo:\",\"label-for\":\"periodo\"}},[_c('b-form-select',{ref:\"periodo\",attrs:{\"id\":\"periodo\",\"options\":_vm.comboPeriodos},on:{\"change\":function($event){_vm.idSede=null,_vm.idCurso=null}},model:{value:(_vm.idPeriodo),callback:function ($$v) {_vm.idPeriodo=$$v},expression:\"idPeriodo\"}})],1)],1),_c('b-col',{attrs:{\"lg\":\"6\"}},[_c('b-form-group',{staticClass:\"etiqueta\",attrs:{\"label\":\"Seleccione la Sede:\",\"label-for\":\"sedes\"}},[_c('b-form-select',{ref:\"sedes\",attrs:{\"id\":\"sedes\",\"options\":_vm.comboSedes,\"disabled\":_vm.idPeriodo!=null ? false : true},on:{\"change\":function($event){_vm.idCurso=null,_vm.ocuparComboCursosSede()}},model:{value:(_vm.idSede),callback:function ($$v) {_vm.idSede=$$v},expression:\"idSede\"}})],1)],1),_c('b-col',{attrs:{\"lg\":\"4\"}},[_c('b-form-group',{staticClass:\"etiqueta\",attrs:{\"label\":\"Seleccione el Curso:\",\"label-for\":\"cursos\"}},[_c('b-form-select',{ref:\"cursos\",attrs:{\"id\":\"cursos\",\"options\":_vm.comboCursosSede,\"disabled\":_vm.idSede!=null ? false : true},on:{\"change\":function($event){return _vm.consultarEstudiantes()}},model:{value:(_vm.idCurso),callback:function ($$v) {_vm.idCurso=$$v},expression:\"idCurso\"}})],1)],1)],1)],1)],1)],1)],1),_c('b-row',[_c('b-col',{attrs:{\"lg\":\"12\"}},[(_vm.btnCargando)?_c('div',[_c('div',{staticClass:\"text-center m-5 text-primary\"},[_c('b-spinner',{staticStyle:{\"width\":\"3rem\",\"height\":\"3rem\"},attrs:{\"label\":\"Spinner\"}}),_c('br'),_c('strong',[_vm._v(\"Cargando informe...\")])],1)]):_vm._e()])],1),(!_vm.btnCargando && _vm.idCurso!=null)?_c('b-row',[_c('b-col',{attrs:{\"lg\":\"12\"}},[_c('table',{staticClass:\"table-responsive\",attrs:{\"border\":\"1\",\"cellspacing\":\"0\",\"cellpadding\":\"1\"}},[_c('thead',[_c('tr',[_c('th',{attrs:{\"rowspan\":\"2\"}},[_vm._v(\"#\")]),_c('th',{attrs:{\"rowspan\":\"2\"}},[_vm._v(\"Estudiante\")]),_vm._l((_vm.encabezadoPorArea),function(asigs,area){return _c('th',{key:'area' + area,attrs:{\"colspan\":asigs.length + 1}},[_vm._v(\" \"+_vm._s(area)+\" \")])}),_c('th',{attrs:{\"rowspan\":\"2\"}},[_vm._v(\"PRO GEN\")]),_c('th',{attrs:{\"rowspan\":\"2\"}},[_vm._v(\"Baj\")]),_c('th',{attrs:{\"rowspan\":\"2\"}},[_vm._v(\"Bas\")]),_c('th',{attrs:{\"rowspan\":\"2\"}},[_vm._v(\"Alt\")]),_c('th',{attrs:{\"rowspan\":\"2\"}},[_vm._v(\"Sup\")]),_c('th',{attrs:{\"rowspan\":\"2\"}},[_vm._v(\"AuJ\")]),_c('th',{attrs:{\"rowspan\":\"2\"}},[_vm._v(\"AuS\")]),_c('th',{attrs:{\"rowspan\":\"2\"}},[_vm._v(\"Pto\")]),_c('th',{attrs:{\"rowspan\":\"2\"}},[_vm._v(\"#\")])],2),_c('tr',[_vm._l((Object.keys(_vm.encabezadoPorArea)),function(area,i){return [_vm._l((_vm.encabezadoPorArea[area]),function(asig,k){return _c('th',{key:'Asigna-' + area + asig + k},[_vm._v(_vm._s(asig))])}),_c('th',{key:'Asi-'+area + i},[_vm._v(\"Prom\")])]})],2)]),_c('tbody',[_vm._l((_vm.estudiantesNotas),function(areas,estudiante,i){return _c('tr',{key:estudiante},[_c('td',{staticClass:\"text-left\"},[_vm._v(_vm._s(i + 1))]),_c('td',{staticStyle:{\"text-align\":\"left\"}},[_vm._v(_vm._s(estudiante))]),_vm._l((Object.keys(_vm.encabezadoPorArea)),function(area){return [_vm._l((_vm.encabezadoPorArea[area]),function(asig,j){return _c('td',{key:area + asig + j,class:[\n                _vm.obtenerColor(_vm.obtenerNota(areas, area, asig), areas, area, asig),\n                _vm.fueRecuperada(areas, area, asig) ? 'nota-recuperada' : ''\n              ],attrs:{\"title\":_vm.fueRecuperada(areas, area, asig)\n                ? (\"Recuperada desde \" + (_vm.obtenerOriginal(areas, area, asig)) + \"  \" + (_vm.obtenerRecuperacion(areas, area, asig)))\n                : (\"Nota final: \" + (_vm.obtenerNota(areas, area, asig)))}},[_vm._v(\" \"+_vm._s(areas.id_conceptual=='N' ? _vm.obtenerNota(areas, area, asig) : '-')+\" \")])}),_c('td',{key:area + i,staticStyle:{\"font-weight\":\"bold\"}},[_vm._v(\" \"+_vm._s(areas.id_conceptual=='N' ? _vm.calcularPromedioArea(areas, area) : '-')+\" \")])]}),_c('td',{class:_vm.obtenerColorGeneral(_vm.calcularPromedioGeneral(areas)),staticStyle:{\"font-weight\":\"bold\",\"text-align\":\"center\"}},[_vm._v(\" \"+_vm._s(areas.id_conceptual=='N' ? _vm.calcularPromedioGeneral(areas) : '-')+\" \")]),_c('td',{staticStyle:{\"text-align\":\"center\",\"color\":\"#b22222\"}},[_vm._v(\" \"+_vm._s(areas.id_conceptual=='N' ? _vm.contarDesempenoEstudiante(areas, 'bajo') : '-')+\" \")]),_c('td',{staticStyle:{\"text-align\":\"center\",\"color\":\"#2980b9\"}},[_vm._v(\" \"+_vm._s(areas.id_conceptual=='N' ? _vm.contarDesempenoEstudiante(areas, 'basico') : '-')+\" \")]),_c('td',{staticStyle:{\"text-align\":\"center\",\"color\":\"#e67e22\"}},[_vm._v(\" \"+_vm._s(areas.id_conceptual=='N' ? _vm.contarDesempenoEstudiante(areas, 'alto') : '-')+\" \")]),_c('td',{staticStyle:{\"text-align\":\"center\",\"color\":\"#2e7d32\"}},[_vm._v(\" \"+_vm._s(areas.id_conceptual=='N' ? _vm.contarDesempenoEstudiante(areas, 'superior') : '-')+\" \")]),_c('td',{staticStyle:{\"text-align\":\"center\"}},[_vm._v(\" \"+_vm._s(areas.id_conceptual=='N' ? areas.ausJ : '-')+\" \")]),_c('td',{staticStyle:{\"text-align\":\"center\"}},[_vm._v(\" \"+_vm._s(areas.id_conceptual=='N' ? areas.ausS : '-')+\" \")]),_c('td',{staticStyle:{\"text-align\":\"center\",\"font-weight\":\"bold\"}},[_vm._v(\" \"+_vm._s(areas.id_conceptual=='N' ? _vm.iconoPuesto(_vm.puestosPorEstudiante[estudiante]) : '-')+\" \"+_vm._s(areas.id_conceptual=='N' ? _vm.puestosPorEstudiante[estudiante] : '-')+\" \")]),_c('td',{staticClass:\"text-left\"},[_vm._v(_vm._s(i + 1))])],2)}),_c('tr',{staticStyle:{\"background-color\":\"#f0f0f0\",\"font-weight\":\"bold\"}},[_c('td',{attrs:{\"colspan\":\"2\"}},[_vm._v(\"Total Bajos\")]),_vm._l((Object.keys(_vm.encabezadoPorArea)),function(area){return [_vm._l((_vm.encabezadoPorArea[area]),function(asig){return [_c('td',{key:asig + area,staticStyle:{\"text-align\":\"center\",\"color\":\"#b22222\"}},[_vm._v(\" \"+_vm._s(_vm.contarNotasPorAsignatura(area, asig, 'bajo'))+\" \")])]}),_c('td',{key:'bja' + area},[_vm._v(\" \"+_vm._s(_vm.totalBajosPromedioArea(area))+\" \")])]}),_c('td'),_vm._v(\" \"),_c('td',[_vm._v(_vm._s(_vm.contarNotasTotales('bajo')))]),_c('td',[_vm._v(_vm._s(_vm.contarNotasTotales('basico')))]),_c('td',[_vm._v(_vm._s(_vm.contarNotasTotales('alto')))]),_c('td',[_vm._v(_vm._s(_vm.contarNotasTotales('superior')))]),_c('td',[_vm._v(_vm._s(_vm.contarAusencias('ausJ')))]),_c('td',[_vm._v(_vm._s(_vm.contarAusencias('ausS')))]),_c('td'),_vm._v(\" \"),_c('td')],2)],2)]),_c('div',{staticStyle:{\"margin-bottom\":\"1rem\"}},[_c('b-button',{staticClass:\"small mx-1 mt-3\",attrs:{\"variant\":\"primary\"},on:{\"click\":_vm.imprimir}},[_vm._v(\"Imprimir Consolidado\")]),_c('b-button',{staticClass:\"small mx-1 mt-3\",attrs:{\"variant\":\"outline-primary\"},on:{\"click\":_vm.exportarAExcel}},[_vm._v(\"Exportar a Excel\")])],1)])],1):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div>\n    <b-row class=\"mt-2\">\n      <b-col lg=\"12\">\n        <b-card>\n          <template #header>\n            <h5 class=\"mb-0\"><b-icon icon=\"card-checklist\" aria-hidden=\"true\"></b-icon> RESUMEN DE EVALUACIONES POR PERIODO</h5>\n          </template>\n          <b-card-text>\n            <b-row>\n              <b-col lg=\"2\">\n                <b-form-group label=\"Periodo:\" label-for=\"periodo\" class=\"etiqueta\">\n                  <b-form-select id=\"periodo\" ref=\"periodo\" v-model=\"idPeriodo\" :options=\"comboPeriodos\" @change=\"idSede=null,idCurso=null\"></b-form-select>\n                </b-form-group>\n              </b-col>\n              <b-col lg=\"6\">\n                <b-form-group label=\"Seleccione la Sede:\" label-for=\"sedes\" class=\"etiqueta\">\n                  <b-form-select  id=\"sedes\" ref=\"sedes\" v-model=\"idSede\" :options=\"comboSedes\" @change=\"idCurso=null,ocuparComboCursosSede()\" :disabled=\"idPeriodo!=null ? false : true\"></b-form-select>\n                </b-form-group>\n              </b-col>\n              <b-col lg=\"4\">\n                <b-form-group label=\"Seleccione el Curso:\" label-for=\"cursos\" class=\"etiqueta\">\n                  <b-form-select id=\"cursos\" ref=\"cursos\" v-model=\"idCurso\" :options=\"comboCursosSede\" @change=\"consultarEstudiantes()\" :disabled=\"idSede!=null ? false : true\"></b-form-select>\n                </b-form-group>\n              </b-col>\n            </b-row>\n          </b-card-text>\n        </b-card>\n      </b-col>\n    </b-row>\n    <b-row>\n      <b-col lg=\"12\">\n        <div v-if=\"btnCargando\">\n          <div class=\"text-center m-5 text-primary\">\n            <b-spinner style=\"width: 3rem; height: 3rem;\" label=\"Spinner\"></b-spinner>\n            <br><strong>Cargando informe...</strong>\n          </div>\n        </div>\n      </b-col>\n    </b-row>\n    <b-row v-if=\"!btnCargando && idCurso!=null\">\n      <b-col lg=\"12\">\n        <table border=\"1\" cellspacing=\"0\" cellpadding=\"1\" class=\"table-responsive\">\n          <thead>\n            <tr>\n              <th rowspan=\"2\">#</th>\n              <th rowspan=\"2\">Estudiante</th>\n              <th v-for=\"(asigs, area) in encabezadoPorArea\" :colspan=\"asigs.length + 1\" :key=\"'area' + area\">\n                {{ area }}\n              </th>\n              <th rowspan=\"2\">PRO GEN</th>\n              <th rowspan=\"2\">Baj</th>\n              <th rowspan=\"2\">Bas</th>\n              <th rowspan=\"2\">Alt</th>\n              <th rowspan=\"2\">Sup</th>\n              <th rowspan=\"2\">AuJ</th>\n              <th rowspan=\"2\">AuS</th>\n              <th rowspan=\"2\">Pto</th>\n              <th rowspan=\"2\">#</th>\n            </tr>\n            <tr>\n              <template v-for=\"(area,i) in Object.keys(encabezadoPorArea)\">\n                <th v-for=\"(asig,k) in encabezadoPorArea[area]\" :key=\"'Asigna-' + area + asig + k\">{{ asig }}</th>\n                <th :key=\"'Asi-'+area + i\">Prom</th>\n              </template>\n            </tr>\n          </thead>\n          <tbody>\n            <tr v-for=\"(areas, estudiante, i) in estudiantesNotas\" :key=\"estudiante\">\n              <td class=\"text-left\">{{ i + 1 }}</td>\n              <td style=\"text-align: left\">{{ estudiante }}</td>\n              <template v-for=\"(area) in Object.keys(encabezadoPorArea)\">\n                <td\n                  v-for=\"(asig,j) in encabezadoPorArea[area]\" :key=\"area + asig + j\"\n                  :class=\"[\n                  obtenerColor(obtenerNota(areas, area, asig), areas, area, asig),\n                  fueRecuperada(areas, area, asig) ? 'nota-recuperada' : ''\n                ]\"\n                :title=\"fueRecuperada(areas, area, asig)\n                  ? `Recuperada desde ${obtenerOriginal(areas, area, asig)}  ${obtenerRecuperacion(areas, area, asig)}`\n                  : `Nota final: ${obtenerNota(areas, area, asig)}`\">\n                  {{ areas.id_conceptual=='N' ? obtenerNota(areas, area, asig) : '-' }}\n                </td>\n                <td style=\"font-weight: bold;\" :key=\"area + i\">\n                  {{ areas.id_conceptual=='N' ? calcularPromedioArea(areas, area) : '-' }}\n                </td>\n              </template>\n              <td :class=\"obtenerColorGeneral(calcularPromedioGeneral(areas))\" style=\"font-weight: bold; text-align: center;\">\n                {{ areas.id_conceptual=='N' ? calcularPromedioGeneral(areas) : '-' }}\n              </td>\n              <td style=\"text-align: center; color: #b22222;\">\n                {{ areas.id_conceptual=='N' ? contarDesempenoEstudiante(areas, 'bajo') : '-' }}\n              </td>\n              <td style=\"text-align: center; color: #2980b9;\">\n                {{ areas.id_conceptual=='N' ? contarDesempenoEstudiante(areas, 'basico') : '-' }}\n              </td>\n              <td style=\"text-align: center; color: #e67e22;\">\n                {{ areas.id_conceptual=='N' ? contarDesempenoEstudiante(areas, 'alto') : '-' }}\n              </td>\n              <td style=\"text-align: center; color: #2e7d32;\">\n                {{ areas.id_conceptual=='N' ? contarDesempenoEstudiante(areas, 'superior') : '-' }}\n              </td>\n              <td style=\"text-align: center;\">\n                {{ areas.id_conceptual=='N' ? areas.ausJ : '-' }}\n              </td>\n              <td style=\"text-align: center;\">\n                {{ areas.id_conceptual=='N' ? areas.ausS : '-' }}\n              </td>\n              <td style=\"text-align: center; font-weight: bold;\">\n                {{ areas.id_conceptual=='N' ? iconoPuesto(puestosPorEstudiante[estudiante]) : '-' }} {{ areas.id_conceptual=='N' ? puestosPorEstudiante[estudiante] : '-' }}\n              </td>\n              <td class=\"text-left\">{{ i + 1 }}</td>\n            </tr>\n            <tr style=\"background-color: #f0f0f0; font-weight: bold;\">\n              <td colspan=\"2\">Total Bajos</td>\n              <template v-for=\"area in Object.keys(encabezadoPorArea)\">\n                <!-- Totales por asignatura -->\n                <template v-for=\"asig in encabezadoPorArea[area]\">\n                  <td style=\"text-align: center; color: #b22222;\" :key=\"asig + area\">\n                    {{ contarNotasPorAsignatura(area, asig, 'bajo') }}\n                  </td>\n                </template>\n                <!-- Celda vaca para promedio de rea\n                <td :key=\"area\"></td>\n                 -->\n                <!-- Bajos por promedio de rea -->\n                <td  :key=\"'bja' + area\">\n                  {{ totalBajosPromedioArea(area) }}\n                </td>\n              </template>\n              <td></td> <!-- Prom. General -->\n              <td>{{ contarNotasTotales('bajo') }}</td>\n              <td>{{ contarNotasTotales('basico') }}</td>\n              <td>{{ contarNotasTotales('alto') }}</td>\n              <td>{{ contarNotasTotales('superior') }}</td>\n              <td>{{ contarAusencias('ausJ') }}</td>\n              <td>{{ contarAusencias('ausS') }}</td>\n              <td></td> <!-- Puesto -->\n              <td></td>\n            </tr>\n          </tbody>\n        </table>\n        <div style=\"margin-bottom: 1rem\">\n          <b-button class=\"small mx-1 mt-3\" variant=\"primary\" @click=\"imprimir\">Imprimir Consolidado</b-button>\n          <b-button class=\"small mx-1 mt-3\" variant=\"outline-primary\" @click=\"exportarAExcel\">Exportar a Excel</b-button>\n        </div>\n      </b-col>\n    </b-row>\n  </div>\n</template>\n\n<script>\n  import axios from \"axios\"\n  import * as CONFIG from '@/assets/config.js'\n  import * as XLSX from 'xlsx'\n\n  export default {\n    name: 'resumenperiodo',\n    components: {\n    },\n    data () {\n      return {\n        idSede: null,\n        comboSedes: [],\n        idPeriodo: null,\n        comboPeriodos: null,\n        idCurso: null,\n        comboCursosSede: [],\n        nombreSede: null,\n        nombreCurso: null,\n        idNivel: null,\n        btnCargando: false,\n        datosRaw: [],\n        datosSeccion: {},\n        listaAreasAsignaturas: [],\n      }\n    },\n    methods: {\n      totalBajosPromedioArea(area) {\n        let total = 0\n        //calcularPromedioArea(areas, area)\n\n\n        Object.values(this.estudiantesNotas).forEach(est => {\n          const prom = parseFloat(this.calcularPromedioArea(est, area))\n          if (!isNaN(prom) && prom < this.datosSeccion.minBas) total++\n        })\n        return total\n      },\n      contarAusencias(tipo) {\n        let total = 0\n        Object.values(this.estudiantesNotas).forEach(est => {\n          if (tipo === 'ausJ') total += est.ausJ || 0\n          if (tipo === 'ausS') total += est.ausS || 0\n        })\n        return total\n      },\n      contarNotasPorAsignatura(area, asignatura, tipo) {\n        let contador = 0\n        Object.values(this.estudiantesNotas).forEach(est => {\n          const nota = est?.[area]?.[asignatura]?.nota\n          const meta = this.listaAreasAsignaturas.find(\n            a => a.area === area && a.asignatura === asignatura\n          )\n          const idTipoEspecialidad = meta?.idTipoEspecialidad\n          if (typeof nota !== 'number') return\n          if (idTipoEspecialidad === 1) {\n            if (tipo === 'bajo' && nota < this.datosSeccion.minBas) contador++\n            else if (tipo === 'basico' && nota >= this.datosSeccion.minBas && nota < this.datosSeccion.minAlt) contador++\n            else if (tipo === 'alto' && nota >= this.datosSeccion.minAlt && nota < this.datosSeccion.minSup) contador++\n            else if (tipo === 'superior' && nota >= this.datosSeccion.minSup && nota <= this.datosSeccion.maxSup) contador++\n          } else {\n            if (tipo === 'bajo' && nota < this.datosSeccion.minBasT) contador++\n            else if (tipo === 'basico' && nota >= this.datosSeccion.minBasT && nota < this.datosSeccion.minAltT) contador++\n            else if (tipo === 'alto' && nota >= this.datosSeccion.minAltT && nota < this.datosSeccion.minSupT) contador++\n            else if (tipo === 'superior' && nota >= this.datosSeccion.minSupT && nota <= this.datosSeccion.maxSupT) contador++\n          }\n        })\n        return contador\n      },\n      contarNotasTotales(tipo) {\n        let total = 0\n        Object.values(this.estudiantesNotas).forEach(est => {\n          this.listaAreasAsignaturas.forEach(({ area, asignatura }) => {\n            const nota = est?.[area]?.[asignatura]?.nota\n            const val = est?.[area]?.[asignatura]?.idTipoEspecialidad\n            if (typeof nota !== 'number') return\n          if (val === 1) {\n            if (tipo === 'bajo' && nota < this.datosSeccion.minBas) total++\n            else if (tipo === 'basico' && nota >= this.datosSeccion.minBas && nota < this.datosSeccion.minAlt) total++\n            else if (tipo === 'alto' && nota >= this.datosSeccion.minAlt && nota < this.datosSeccion.minSup) total++\n            else if (tipo === 'superior' && nota >= this.datosSeccion.minSup && nota <= this.datosSeccion.maxSup) total++\n          } else {\n            if (tipo === 'bajo' && nota < this.datosSeccion.minBasT) total++\n            else if (tipo === 'basico' && nota >= this.datosSeccion.minBasT && nota < this.datosSeccion.minAltT) total++\n            else if (tipo === 'alto' && nota >= this.datosSeccion.minAltT && nota < this.datosSeccion.minSupT) total++\n            else if (tipo === 'superior' && nota >= this.datosSeccion.minSupT && nota <= this.datosSeccion.maxSupT) total++\n          }\n          })\n        })\n        return total\n      },\n      iconoPuesto(puesto) {\n        if (puesto === 1) return ''\n        if (puesto === 2) return ''\n        if (puesto === 3) return ''\n        return ''\n      },\n      calcularPromedioGeneral(estAreas) {\n        const areas = [...new Set(this.listaAreasAsignaturas.map(a => a.area))]\n        let total = 0\n        let cantidad = 0\n        areas.forEach(area => {\n          if (this.datosSeccion.promCompor == 1) { // Promedia comportamiento\n            const asignsValidas = this.listaAreasAsignaturas.filter(a => a.area === area && a.orden !== 98)\n            if (!asignsValidas.length) return\n            const promedio = parseFloat(this.calcularPromedioArea(estAreas, area))\n            if (!isNaN(promedio)) {\n              total += promedio\n              cantidad++\n            }\n          } else {\n            const asignsValidas = this.listaAreasAsignaturas.filter(a => a.area === area && a.orden !== 99 && a.orden !== 98)\n            if (!asignsValidas.length) return\n            const promedio = parseFloat(this.calcularPromedioArea(estAreas, area))\n            if (!isNaN(promedio)) {\n              total += promedio\n              cantidad++\n            }\n          }\n        })\n        return cantidad > 0 ? (total / cantidad).toFixed(3) : ''\n      },\n      contarDesempenoEstudiante(estAreas, tipo) {\n        let contador = 0\n        this.listaAreasAsignaturas.forEach(({ area, asignatura }) => {\n          const nota = estAreas?.[area]?.[asignatura]?.nota\n          const val =  estAreas?.[area]?.[asignatura]?.idTipoEspecialidad\n          if (typeof nota !== 'number') return\n          if (val === 1) {\n            if (tipo === 'bajo' && nota < this.datosSeccion.minBas) contador++\n            else if (tipo === 'basico' && nota >= this.datosSeccion.minBas && nota < this.datosSeccion.minAlt) contador++\n            else if (tipo === 'alto' && nota >= this.datosSeccion.minAlt && nota < this.datosSeccion.minSup) contador++\n            else if (tipo === 'superior' && nota >= this.datosSeccion.minSup && nota <= this.datosSeccion.maxSup) contador++\n          } else {\n            if (tipo === 'bajo' && nota < this.datosSeccion.minBasT) contador++\n            else if (tipo === 'basico' && nota >= this.datosSeccion.minBasT && nota < this.datosSeccion.minAltT) contador++\n            else if (tipo === 'alto' && nota >= this.datosSeccion.minAltT && nota < this.datosSeccion.minSupT) contador++\n            else if (tipo === 'superior' && nota >= this.datosSeccion.minSupT && nota <= this.datosSeccion.maxSupT) contador++\n          }\n        })\n        return contador\n      },\n      obtenerNota(areas, area, asig) {\n        const val = areas?.[area]?.[asig]?.nota ?? ''\n        return typeof val === 'number' ? val.toFixed(1) : val\n      },\n      fueRecuperada(areas, area, asig) {\n        return areas?.[area]?.[asig]?.fueRecuperada ?? false\n      },\n      obtenerOriginal(areas, area, asig) {\n        const val = areas?.[area]?.[asig]?.original\n        return typeof val === 'number' ? val.toFixed(1) : '0.0'\n      },\n      obtenerRecuperacion(areas, area, asig) {\n        const val = areas?.[area]?.[asig]?.recuperacion\n        return typeof val === 'number' ? val.toFixed(1) : '0.0'\n      },\n      obtenerColor(nota, areas, area, asig) {\n        const val = areas?.[area]?.[asig]?.idTipoEspecialidad\n        if (nota > 0) {\n          if (val === 1) {\n            if (nota < this.datosSeccion.minBas) return 'desempeno-bajo'\n            if (nota < this.datosSeccion.minAlt) return 'desempeno-basico'\n            if (nota < this.datosSeccion.minSup) return 'desempeno-alto'\n            if (nota <= this.datosSeccion.maxSup) return 'desempeno-superior'\n          } else {\n            if (nota < this.datosSeccion.minBasT) return 'desempeno-bajo'\n            if (nota < this.datosSeccion.minAltT) return 'desempeno-basico'\n            if (nota < this.datosSeccion.minSupT) return 'desempeno-alto'\n            if (nota <= this.datosSeccion.maxSupT) return 'desempeno-superior'\n          }\n        }\n        return 'desempeno-extra'\n      },\n      obtenerColorGeneral(nota) {\n        if (nota < this.datosSeccion.minBas) return 'desempeno-bajo'\n        if (nota < this.datosSeccion.minAlt) return 'desempeno-basico'\n        if (nota < this.datosSeccion.minSup) return 'desempeno-alto'\n        if (nota <= this.datosSeccion.maxSup) return 'desempeno-superior'\n        return 'desempeno-extra'\n      },\n      calcularPromedioArea(estAreas, areaNombre) {\n        let asigns = ''\n        if (this.datosSeccion.promCompor == 1)  // Promedia comportamiento\n          asigns = this.listaAreasAsignaturas.filter(a => a.area === areaNombre && a.orden !== 98)\n        else \n          asigns = this.listaAreasAsignaturas.filter(a => a.area === areaNombre && a.orden !== 99 && a.orden !== 98)\n        if (!asigns.length) return ''\n        const tipoArea = asigns[0].idTipoArea\n        let total = 0\n        let pesoTotal = 0\n        asigns.forEach(asig => {\n          const nota = estAreas?.[areaNombre]?.[asig.asignatura]?.nota ?? 0\n          total += nota * (asig.porcentaje / 100)\n          /*\n          if (tipoArea === 1) {\n            total += nota * (asig.porcentaje / 100)\n            pesoTotal += asig.porcentaje\n          } else {\n            total += nota\n            pesoTotal++\n          }\n          */\n        })\n        //if (pesoTotal === 0) return ''\n        //const promedio = tipoArea === 1 ? total : total / pesoTotal\n        return total > 0 ? this.redondear(total).toFixed(1) : ''\n      },\n      async consultarEstudiantes() {\n        this.btnCargando = true\n        this.nombreSede = document.getElementById('sedes')[document.getElementById('sedes').selectedIndex].text\n        if (this.idCurso != null) { \n          this.nombreCurso = document.getElementById('cursos')[document.getElementById('cursos').selectedIndex].text\n          this.$store.state.datosCursos.forEach(element => {\n            if (element.id == this.idCurso) {\n              this.idNivel = element.id_nivel\n            }\n          })\n          this.listaAreasAsignaturas = []\n          await axios\n          .get(CONFIG.ROOT_PATH + 'consolidados/areasasignaturas/curso', {params: {idCurso: this.idCurso}})\n          .then(response => {\n            if (response.data.error){\n              this.mensajeEmergente('danger',CONFIG.TITULO_MSG,response.data.mensaje + ' - Lista areas-asignaturas curso')\n              this.btnCargando = false\n            } else{\n              if (response.data.datos != 0) {\n                this.listaAreasAsignaturas = response.data.datos\n              }\n            }\n          })\n          .catch(err => {\n            this.mensajeEmergente('danger',CONFIG.TITULO_MSG,'Algo salio mal y no se pudo realizar: Lista areas-asignaturas curso. Intente ms tarde.' + err)\n            this.btnCargando = false\n          })\n          this.datosRaw = []\n          await axios\n          .get(CONFIG.ROOT_PATH + 'consolidados/asignaturas/curso/periodo', {params: {idCurso: this.idCurso, periodo: this.idPeriodo, vigencia: this.$store.state.aLectivo}})\n          .then(response => {\n            if (response.data.error){\n              this.mensajeEmergente('danger',CONFIG.TITULO_MSG,response.data.mensaje + ' - Consolidados asignaturas curso periodo')\n              this.btnCargando = false\n            } else{\n              if (response.data.datos != 0) {\n                this.datosRaw = response.data.datos\n              }\n            }\n          })\n          .catch(err => {\n            this.mensajeEmergente('danger',CONFIG.TITULO_MSG,'Algo salio mal y no se pudo realizar: Consolidados asignaturas curso periodo. Intente ms tarde.' + err)\n            this.btnCargando = false\n          })\n        }\n        //console.log(JSON.stringify(this.listaAreasAsignaturas))\n        this.btnCargando = false\n      },\n      imprimir() {\n        let fecha = 'Fecha: ' + new Date().toLocaleString()\n        let tituloInforme = 'RESUMEN DE EVALUACIONES POR PERIODO'\n        const contenido = document.querySelector('table').outerHTML\n        const ventana = window.open(\"Consolidados\", \"_blank\")\n        ventana.document.write(`<html><head><title>Imprimir</title></head>\n        <style scoped>\n          table {\n            border-collapse: collapse;\n            width: 100%;\n            text-align: center;\n            font-size: 10px;\n          }\n          th {\n            background: #eee;\n          }\n          .nota-recuperada {\n            border: 2px solid #ffa500;\n            box-shadow: 0 0 5px #ffa500;\n          }\n          .desempeno-bajo { background-color: #f8d7da; color: #721c24; }\n          .desempeno-basico { background-color: #d1ecf1; color: #0c5460; }\n          .desempeno-alto { background-color: #fff3cd; color: #856404; }\n          .desempeno-superior { background-color: #d4edda; color: #155724; }\n          .desempeno-extra { background-color: #f4ecf5; color: #2f2e2e; }\n        </style>\n          <body class=\"container\">\n            <p style=\"text-align: center; font-size: 12px;\">SECRETARA DE EDUCACIN TERRITORIAL DE TUNJA<br><b>${this.$store.state.nombreInstitucion}</b><br>TUNJA - BOYAC<br>${tituloInforme}<br>Sede: ${this.nombreSede} | Curso: ${this.nombreCurso} | Ao Lectivo ${this.$store.state.aLectivo} | Periodo: ${this.idPeriodo}</p>\n            ${contenido}\n            <div style=\"text-align: right; font-size: 12px;\"><i>${fecha}</i></div>\n          </body>\n        </html>`)\n        ventana.document.close()\n        ventana.print()\n      },\n      exportarAExcel() {\n        const tabla = document.querySelector('table')\n        const wb = XLSX.utils.table_to_book(tabla)\n        XLSX.writeFile(wb, 'notas.xlsx')\n      },\n      redondear(num) {\n        var m = Number((Math.abs(num) * 10).toPrecision(15))\n        return Math.round(m) / 10 * Math.sign(num);\n      },\n      async ocuparComboCursosSede() {\n        this.comboCursosSede = []\n        this.$store.state.datosCursos.forEach(element => {\n          if (element.id_sede == this.idSede) {\n            this.comboCursosSede.push({ 'value': element.id, 'text': element.nomenclatura.toUpperCase() })\n          }\n        })\n      },\n      async ocuparComboSedes() {\n        this.comboSedes = []\n        this.$store.state.datosSedes.forEach(element => {\n          this.comboSedes.push({ 'value': element.id, 'text': element.sede.toUpperCase() })\n        })\n      },\n      async ocuparComboPeriodos() {\n        this.comboPeriodos = []\n        this.$store.state.periodos.forEach(element => {\n          this.comboPeriodos.push({ 'value': element.id, 'text': element.periodo.toUpperCase() })\n        })\n      },\n      mensajeEmergente(variante, titulo, contenido) {\n        this.$bvToast.toast(contenido, { title: titulo, variant: variante, toaster: \"b-toaster-top-center\", solid: true, autoHideDelay: 4000, appendToast: false })\n      }\n    },\n    computed: {\n      totalColumnasPromedioArea() {\n        const areasUnicas = new Set(this.listaAreasAsignaturas.map(a => a.area))\n        return areasUnicas.size\n      },\n      puestosPorEstudiante() {\n        const lista = Object.entries(this.estudiantesNotas).map(([nombre, areas]) => {\n          const promedio = parseFloat(this.calcularPromedioGeneral(areas))\n          return { nombre, promedio: isNaN(promedio) ? 0 : promedio }\n        })\n        // Ordenar de mayor a menor\n        lista.sort((a, b) => b.promedio - a.promedio)\n        const puestos = {}\n        let puestoActual = 1\n        let contador = 1\n        let ultimoPromedio = null\n        lista.forEach(est => {\n          if (est.promedio !== ultimoPromedio) {\n            puestoActual = contador\n            ultimoPromedio = est.promedio\n          }\n          puestos[est.nombre] = puestoActual\n          contador++\n        })\n        return puestos\n      },\n      encabezadoPorArea() {\n        const mapa = {}\n        this.listaAreasAsignaturas.forEach(({ area, asignatura }) => {\n          if (!mapa[area]) mapa[area] = []\n          mapa[area].push(asignatura)\n        })\n        return mapa\n      },\n      estudiantesNotas() {\n        const mapa = {}\n        this.datosRaw.forEach(row => {\n          const { estudiante, area, asignatura, definitiva, recuperacion, orden, definitivacompor, definitivapree, idTipoEspecialidad, ausJ, ausS, id_conceptual } = row\n          if (!mapa[estudiante]) mapa[estudiante] = { id_conceptual, ausJ: 0, ausS: 0 }\n          if (!mapa[estudiante][area]) mapa[estudiante][area] = {}\n          let notaFinal = 0\n          if (orden === 99) {\n            if (this.datosSeccion.tipoValComp == 1) {\n              notaFinal = definitiva\n            } else {\n              notaFinal = definitivacompor != null && definitivacompor != 0 && definitivacompor != '' ? definitivacompor : ''\n            }\n          } else {\n            if (this.idNivel == 1) {\n              notaFinal = definitivapree != null && definitivapree != 0 && definitivapree != '' ? definitivapree : ''\n            } else {\n              if (definitiva > 0)\n                notaFinal = recuperacion > definitiva ? recuperacion : definitiva\n              else\n                notaFinal = ''\n            }\n          }\n          mapa[estudiante][area][asignatura] = {\n            nota: notaFinal,\n            fueRecuperada: recuperacion > definitiva,\n            original: definitiva,\n            recuperacion,\n            idTipoEspecialidad\n          }\n          mapa[estudiante].ausJ += ausJ || 0\n          mapa[estudiante].ausS += ausS || 0\n        })\n        return mapa\n      },\n    },\n    beforeMount() {\n      this.ocuparComboSedes()\n      this.ocuparComboPeriodos()\n      this.datosSeccion = this.$store.state.datosSecciones[this.$store.state.idSeccion - 1]\n      //console.log(JSON.stringify(this.datosSeccion))\n    }\n  }\n</script>\n<style scoped>\n  table {\n    border-collapse: collapse;\n    width: 100%;\n    text-align: center;\n    font-size: 10px;\n  }\n  th {\n    background: #eee;\n  }\n  .nota-recuperada {\n    border: 2px solid #ffa500;\n    box-shadow: 0 0 5px #ffa500;\n  }\n  .desempeno-bajo { background-color: #f8d7da; color: #721c24; }\n  .desempeno-basico { background-color: #d1ecf1; color: #0c5460; }\n  .desempeno-alto { background-color: #fff3cd; color: #856404; }\n  .desempeno-superior { background-color: #d4edda; color: #155724; }\n  .desempeno-extra { background-color: #f4ecf5; color: #2f2e2e; }\n\n</style>\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ResumenPeriodo.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ResumenPeriodo.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ResumenPeriodo.vue?vue&type=template&id=516e5d7a&scoped=true&\"\nimport script from \"./ResumenPeriodo.vue?vue&type=script&lang=js&\"\nexport * from \"./ResumenPeriodo.vue?vue&type=script&lang=js&\"\nimport style0 from \"./ResumenPeriodo.vue?vue&type=style&index=0&id=516e5d7a&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"516e5d7a\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('b-row',{staticClass:\"mt-2\"},[_c('b-col',{attrs:{\"lg\":\"12\"}},[_c('b-card',{scopedSlots:_vm._u([{key:\"header\",fn:function(){return [_c('h5',{staticClass:\"mb-0\"},[_c('b-icon',{attrs:{\"icon\":\"card-checklist\",\"aria-hidden\":\"true\"}}),_vm._v(\" CONSOLIDADO EVALUACIONES ACUMULADO POR PROMEDIO\")],1)]},proxy:true}])},[_c('b-card-text',[_c('b-row',[_c('b-col',{attrs:{\"lg\":\"2\"}},[_c('b-form-group',{staticClass:\"etiqueta\",attrs:{\"label\":\"Periodo:\",\"label-for\":\"periodo\"}},[_c('b-form-select',{ref:\"periodo\",attrs:{\"id\":\"periodo\",\"options\":_vm.comboPeriodos},on:{\"change\":function($event){_vm.idSede=null,_vm.idCurso=null}},model:{value:(_vm.idPeriodo),callback:function ($$v) {_vm.idPeriodo=$$v},expression:\"idPeriodo\"}})],1)],1),_c('b-col',{attrs:{\"lg\":\"6\"}},[_c('b-form-group',{staticClass:\"etiqueta\",attrs:{\"label\":\"Seleccione la Sede:\",\"label-for\":\"sedes\"}},[_c('b-form-select',{ref:\"sedes\",attrs:{\"id\":\"sedes\",\"options\":_vm.comboSedes,\"disabled\":_vm.idPeriodo!=null ? false : true},on:{\"change\":function($event){_vm.idCurso=null,_vm.ocuparComboCursosSede()}},model:{value:(_vm.idSede),callback:function ($$v) {_vm.idSede=$$v},expression:\"idSede\"}})],1)],1),_c('b-col',{attrs:{\"lg\":\"4\"}},[_c('b-form-group',{staticClass:\"etiqueta\",attrs:{\"label\":\"Seleccione el Curso:\",\"label-for\":\"cursos\"}},[_c('b-form-select',{ref:\"cursos\",attrs:{\"id\":\"cursos\",\"options\":_vm.comboCursosSede,\"disabled\":_vm.idSede!=null ? false : true},on:{\"change\":function($event){return _vm.consultarEstudiantes()}},model:{value:(_vm.idCurso),callback:function ($$v) {_vm.idCurso=$$v},expression:\"idCurso\"}})],1)],1)],1)],1)],1)],1)],1),_c('b-row',[_c('b-col',{attrs:{\"lg\":\"12\"}},[(_vm.btnCargando)?_c('div',[_c('div',{staticClass:\"text-center m-5 text-primary\"},[_c('b-spinner',{staticStyle:{\"width\":\"3rem\",\"height\":\"3rem\"},attrs:{\"label\":\"Spinner\"}}),_c('br'),_c('strong',[_vm._v(\"Cargando informe...\")])],1)]):_vm._e()])],1),(!_vm.btnCargando && _vm.idCurso!=null)?_c('b-row',[_c('b-col',{attrs:{\"lg\":\"12\"}},[_c('table',{staticClass:\"table-responsive\",attrs:{\"border\":\"1\",\"cellspacing\":\"0\",\"cellpadding\":\"1\"}},[_c('thead',[_c('tr',[_c('th',{attrs:{\"rowspan\":\"3\"}},[_vm._v(\"#\")]),_c('th',{attrs:{\"rowspan\":\"3\"}},[_vm._v(\"Estudiante\")]),_vm._l((_vm.encabezadoPorArea),function(asigs,area){return [_c('th',{key:area,attrs:{\"colspan\":_vm.colspanArea(area)}},[_vm._v(\" \"+_vm._s(area)+\" \")])]}),_c('th',{attrs:{\"rowspan\":\"3\"}},[_vm._v(\"PRO GEN\")]),_c('th',{attrs:{\"rowspan\":\"3\"}},[_vm._v(\"Baj\")]),_c('th',{attrs:{\"rowspan\":\"3\"}},[_vm._v(\"Bas\")]),_c('th',{attrs:{\"rowspan\":\"3\"}},[_vm._v(\"Alt\")]),_c('th',{attrs:{\"rowspan\":\"3\"}},[_vm._v(\"Sup\")]),_c('th',{attrs:{\"rowspan\":\"3\"}},[_vm._v(\"AuJ\")]),_c('th',{attrs:{\"rowspan\":\"3\"}},[_vm._v(\"AuS\")]),_c('th',{attrs:{\"rowspan\":\"3\"}},[_vm._v(\"Pto\")]),_c('th',{attrs:{\"rowspan\":\"3\"}},[_vm._v(\"#\")])],2),_c('tr',[_vm._l((_vm.encabezadoPorArea),function(asigs,area){return [_vm._l((asigs),function(asig,k){return [_c('th',{key:'area-' + asig + k,attrs:{\"colspan\":_vm.periodosVisibles.length + 1}},[_vm._v(\" \"+_vm._s(asig)+\" \")])]}),_c('th',{key:'prom-area-' + area,staticClass:\"promedio-area\"},[_vm._v(\"PRO AR\")])]})],2),_c('tr',[_vm._l((_vm.encabezadoPorArea),function(asigs,area){return [_vm._l((asigs),function(asig){return [_vm._l((_vm.periodosVisibles),function(p){return _c('th',{key:'h' + area + asig + p},[_vm._v(\" P\"+_vm._s(p)+\" \")])}),_c('th',{key:'prom' + asig + area},[_vm._v(\"PR\")])]}),_c('th',{key:'prom' + area})]})],2)]),_c('tbody',[_vm._l((_vm.estudiantesNotas),function(est,nombre,i){return _c('tr',{key:nombre},[_c('td',{staticClass:\"text-left\"},[_vm._v(_vm._s(i + 1))]),_c('td',{staticStyle:{\"text-align\":\"left\"}},[_vm._v(_vm._s(nombre))]),_vm._l((_vm.encabezadoPorArea),function(asigs,area){return [_vm._l((asigs),function(asig){return [_vm._l((_vm.periodosVisibles),function(p){return _c('td',{key:nombre + area + asig + p},[_vm._v(\" \"+_vm._s(est.id_conceptual=='N' ? _vm.obtenerNota(est, area, asig, p) : '-')+\" \")])}),_c('td',{key:'prom' + nombre + area + asig,staticClass:\"bloque-area\",staticStyle:{\"font-weight\":\"bold\",\"text-align\":\"center\"}},[_vm._v(\" \"+_vm._s(est.id_conceptual=='N' ? _vm.obtenerPromedioAsignatura(est, area, asig) : '-')+\" \")])]}),_c('td',{key:'promArea' + nombre + area,staticClass:\"promedio-area bloque-area\"},[_vm._v(\" \"+_vm._s(est.id_conceptual=='N' ? _vm.obtenerPromedioArea(est, area) : '-')+\" \")])]}),_c('td',[_vm._v(_vm._s(est.id_conceptual=='N' ? _vm.calcularPromedioGeneral(est) : '-'))]),_c('td',[_vm._v(_vm._s(est.id_conceptual=='N' ? _vm.contarDesempenoEstudiante(est.areas, 'bajo') : '-'))]),_c('td',[_vm._v(_vm._s(est.id_conceptual=='N' ? _vm.contarDesempenoEstudiante(est.areas, 'basico') : '-'))]),_c('td',[_vm._v(_vm._s(est.id_conceptual=='N' ? _vm.contarDesempenoEstudiante(est.areas, 'alto') : '-'))]),_c('td',[_vm._v(_vm._s(est.id_conceptual=='N' ? _vm.contarDesempenoEstudiante(est.areas, 'superior') : '-'))]),_c('td',[_vm._v(_vm._s(est.id_conceptual=='N' ? est.ausJ : '-'))]),_c('td',[_vm._v(_vm._s(est.id_conceptual=='N' ? est.ausS : '-'))]),_c('td',[_vm._v(_vm._s(est.id_conceptual=='N' ? _vm.iconoPuesto(_vm.puestosPorEstudiante[nombre]) : '-')+\" \"+_vm._s(est.id_conceptual=='N' ? _vm.puestosPorEstudiante[nombre] : '-'))]),_c('td',{staticClass:\"text-left\"},[_vm._v(_vm._s(i + 1))])],2)}),_c('tr',{staticStyle:{\"background-color\":\"#f0f0f0\",\"font-weight\":\"bold\"}},[_c('td',{attrs:{\"colspan\":\"2\"}},[_vm._v(\"Total Bajos\")]),_vm._l((_vm.encabezadoPorArea),function(asigs,area){return [_vm._l((asigs),function(asig){return [_vm._l((_vm.periodosVisibles),function(p){return _c('td',{key:'bp' + area + asig + p},[_vm._v(\" \"+_vm._s(_vm.totalBajosPorPeriodo(area, asig, p))+\" \")])}),_c('td',{key:'bj' + area + asig},[_vm._v(\" \"+_vm._s(_vm.totalBajosPromedioAsignatura(area, asig))+\" \")])]}),_c('td',{key:'bja' + area,staticClass:\"promedio-area\"},[_vm._v(\" \"+_vm._s(_vm.totalBajosPromedioArea(area))+\" \")])]}),_c('td'),_vm._v(\" \"),_c('td',[_vm._v(_vm._s(_vm.totales.bajo))]),_c('td',[_vm._v(_vm._s(_vm.totales.basico))]),_c('td',[_vm._v(_vm._s(_vm.totales.alto))]),_c('td',[_vm._v(_vm._s(_vm.totales.superior))]),_c('td',[_vm._v(_vm._s(_vm.totales.ausJ))]),_c('td',[_vm._v(_vm._s(_vm.totales.ausS))]),_c('td'),_vm._v(\" \"),_c('td')],2)],2)]),_c('div',{staticStyle:{\"margin-bottom\":\"1rem\"}},[_c('b-button',{staticClass:\"small mx-1 mt-3\",attrs:{\"variant\":\"primary\"},on:{\"click\":_vm.imprimir}},[_vm._v(\"Imprimir Consolidado\")]),_c('b-button',{staticClass:\"small mx-1 mt-3\",attrs:{\"variant\":\"outline-primary\"},on:{\"click\":_vm.exportarAExcel}},[_vm._v(\"Exportar a Excel\")])],1)])],1):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div>\n    <b-row class=\"mt-2\">\n      <b-col lg=\"12\">\n        <b-card>\n          <template #header>\n            <h5 class=\"mb-0\"><b-icon icon=\"card-checklist\" aria-hidden=\"true\"></b-icon> CONSOLIDADO EVALUACIONES ACUMULADO POR PROMEDIO</h5>\n          </template>\n          <b-card-text>\n            <b-row>\n              <b-col lg=\"2\">\n                <b-form-group label=\"Periodo:\" label-for=\"periodo\" class=\"etiqueta\">\n                  <b-form-select id=\"periodo\" ref=\"periodo\" v-model=\"idPeriodo\" :options=\"comboPeriodos\" @change=\"idSede=null,idCurso=null\"></b-form-select>\n                </b-form-group>\n              </b-col>\n              <b-col lg=\"6\">\n                <b-form-group label=\"Seleccione la Sede:\" label-for=\"sedes\" class=\"etiqueta\">\n                  <b-form-select  id=\"sedes\" ref=\"sedes\" v-model=\"idSede\" :options=\"comboSedes\" @change=\"idCurso=null,ocuparComboCursosSede()\" :disabled=\"idPeriodo!=null ? false : true\"></b-form-select>\n                </b-form-group>\n              </b-col>\n              <b-col lg=\"4\">\n                <b-form-group label=\"Seleccione el Curso:\" label-for=\"cursos\" class=\"etiqueta\">\n                  <b-form-select id=\"cursos\" ref=\"cursos\" v-model=\"idCurso\" :options=\"comboCursosSede\" @change=\"consultarEstudiantes()\" :disabled=\"idSede!=null ? false : true\"></b-form-select>\n                </b-form-group>\n              </b-col>\n            </b-row>\n          </b-card-text>\n        </b-card>\n      </b-col>\n    </b-row>\n    <b-row>\n      <b-col lg=\"12\">\n        <div v-if=\"btnCargando\">\n          <div class=\"text-center m-5 text-primary\">\n            <b-spinner style=\"width: 3rem; height: 3rem;\" label=\"Spinner\"></b-spinner>\n            <br><strong>Cargando informe...</strong>\n          </div>\n        </div>\n      </b-col>\n    </b-row>\n    <b-row v-if=\"!btnCargando && idCurso!=null\">\n      <b-col lg=\"12\">\n        <table border=\"1\" cellspacing=\"0\" cellpadding=\"1\" class=\"table-responsive\">\n          <thead>\n            <tr>\n              <th rowspan=\"3\">#</th>\n              <th rowspan=\"3\">Estudiante</th>\n              <template v-for=\"(asigs, area) in encabezadoPorArea\">\n                <th :colspan=\"colspanArea(area)\" :key=\"area\">\n                  {{ area }}\n                </th>\n              </template>\n              <th rowspan=\"3\">PRO GEN</th>\n              <th rowspan=\"3\">Baj</th>\n              <th rowspan=\"3\">Bas</th>\n              <th rowspan=\"3\">Alt</th>\n              <th rowspan=\"3\">Sup</th>\n              <th rowspan=\"3\">AuJ</th>\n              <th rowspan=\"3\">AuS</th>\n              <th rowspan=\"3\">Pto</th>\n              <th rowspan=\"3\">#</th>\n            </tr>\n            <tr>\n              <template v-for=\"(asigs, area) in encabezadoPorArea\">\n                <template v-for=\"(asig, k) in asigs\">\n                  <th :colspan=\"periodosVisibles.length + 1\" :key=\"'area-' + asig + k\">\n                    {{ asig }}\n                  </th>\n                </template>\n                <th class=\"promedio-area\" :key=\"'prom-area-' + area\">PRO AR</th>\n              </template>\n            </tr>\n            <tr>\n              <template v-for=\"(asigs, area) in encabezadoPorArea\">\n                <template v-for=\"asig in asigs\">\n                  <th v-for=\"p in periodosVisibles\" :key=\"'h' + area + asig + p\">\n                    P{{ p }}\n                  </th>\n                  <th :key=\"'prom' + asig + area\">PR</th>\n                </template>\n                <th :key=\"'prom' + area\"></th>\n              </template>\n              <!-- columnas finales vacas -->\n            </tr>\n          </thead>\n          <tbody>\n            <tr v-for=\"(est, nombre, i) in estudiantesNotas\" :key=\"nombre\">\n              <td class=\"text-left\">{{ i + 1 }}</td>\n              <td style=\"text-align: left\">{{ nombre }}</td>\n              <template v-for=\"(asigs, area) in encabezadoPorArea\">\n                <template v-for=\"asig in asigs\">\n                  <td v-for=\"p in periodosVisibles\"  :key=\"nombre + area + asig + p\">\n                    {{ est.id_conceptual=='N' ? obtenerNota(est, area, asig, p) : '-' }}\n                  </td>\n                  <td class=\"bloque-area\" :key=\"'prom' + nombre + area + asig\" style=\"font-weight: bold; text-align: center;\">\n                    {{ est.id_conceptual=='N' ? obtenerPromedioAsignatura(est, area, asig) : '-' }}\n                  </td>\n                </template>\n                <td class=\"promedio-area bloque-area\" :key=\"'promArea' + nombre + area\">\n                  {{ est.id_conceptual=='N' ? obtenerPromedioArea(est, area) : '-' }}\n                </td>\n              </template>\n\n              <td>{{ est.id_conceptual=='N' ? calcularPromedioGeneral(est) : '-' }}</td>\n              <td>{{ est.id_conceptual=='N' ? contarDesempenoEstudiante(est.areas, 'bajo') : '-' }}</td>\n              <td>{{ est.id_conceptual=='N' ? contarDesempenoEstudiante(est.areas, 'basico') : '-' }}</td>\n              <td>{{ est.id_conceptual=='N' ? contarDesempenoEstudiante(est.areas, 'alto') : '-' }}</td>\n              <td>{{ est.id_conceptual=='N' ? contarDesempenoEstudiante(est.areas, 'superior') : '-' }}</td>\n              <td>{{ est.id_conceptual=='N' ? est.ausJ : '-' }}</td>\n              <td>{{ est.id_conceptual=='N' ? est.ausS : '-' }}</td>\n              <td>{{ est.id_conceptual=='N' ? iconoPuesto(puestosPorEstudiante[nombre]) : '-' }} {{ est.id_conceptual=='N' ? puestosPorEstudiante[nombre] : '-' }}</td>\n              <td class=\"text-left\">{{ i + 1 }}</td>\n            </tr>\n            <tr style=\"background-color: #f0f0f0; font-weight: bold;\">\n              <td colspan=\"2\">Total Bajos</td>\n              <template v-for=\"(asigs, area) in encabezadoPorArea\">\n                <template v-for=\"asig in asigs\">\n                  <!-- Bajos por periodo -->\n                  <td v-for=\"p in periodosVisibles\" :key=\"'bp' + area + asig + p\">\n                    {{ totalBajosPorPeriodo(area, asig, p) }}\n                  </td>\n                  <!-- Bajos por promedio de asignatura -->\n                  <td :key=\"'bj' + area + asig\">\n                    {{ totalBajosPromedioAsignatura(area, asig) }}\n                  </td>\n                </template>\n                <!-- Bajos por promedio de rea -->\n                <td  :key=\"'bja' + area\" class=\"promedio-area\">\n                  {{ totalBajosPromedioArea(area) }}\n                </td>\n              </template>\n              <td></td> <!-- Prom. General -->\n              <td>{{ totales.bajo }}</td>\n              <td>{{ totales.basico }}</td>\n              <td>{{ totales.alto }}</td>\n              <td>{{ totales.superior }}</td>\n              <td>{{ totales.ausJ }}</td>\n              <td>{{ totales.ausS }}</td>\n              <td></td> <!-- Puesto -->\n              <td></td>\n            </tr>\n          </tbody>\n        </table>\n        <div style=\"margin-bottom: 1rem\">\n          <b-button class=\"small mx-1 mt-3\" variant=\"primary\" @click=\"imprimir\">Imprimir Consolidado</b-button>\n          <b-button class=\"small mx-1 mt-3\" variant=\"outline-primary\" @click=\"exportarAExcel\">Exportar a Excel</b-button>\n        </div>\n      </b-col>\n    </b-row>\n  </div>\n</template>\n\n<script>\n  import axios from \"axios\"\n  import * as CONFIG from '@/assets/config.js'\n  import * as XLSX from 'xlsx'\n\n  export default {\n    name: 'consolidadopromedio',\n    components: {\n    },\n    data () {\n      return {\n        idSede: null,\n        comboSedes: [],\n        idPeriodo: null,\n        comboPeriodos: null,\n        idCurso: null,\n        comboCursosSede: [],\n        nombreSede: null,\n        nombreCurso: null,\n        idNivel: null,\n        btnCargando: false,\n        datosRaw: [],\n        datosSeccion: {},\n        listaAreasAsignaturas: [],\n        periodosVisibles: []\n      }\n    },\n    methods: {\n      colspanArea(area) {\n        const asignaturas = this.encabezadoPorArea[area] || []\n        const columnasPorAsignatura = this.periodosVisibles.length + 1\n        const extraColumnaPromArea = 1\n        return (asignaturas.length * columnasPorAsignatura) + extraColumnaPromArea\n      },\n\n      totalBajosPorPeriodo(area, asignatura, periodo) {\n        let total = 0\n        const meta = this.listaAreasAsignaturas.find(\n          a => a.area === area && a.asignatura === asignatura\n        )\n        const idTipoEspecialidad = meta?.idTipoEspecialidad\n        Object.values(this.estudiantesNotas).forEach(est => {\n          const nota = est?.areas?.[area]?.asignaturas?.[asignatura]?.periodos?.[periodo]\n          if (idTipoEspecialidad === 1) {\n            if (nota > 0 && nota < this.datosSeccion.minBas) total++\n          } else {\n            if (nota > 0 && nota < this.datosSeccion.minBasT) total++\n          }\n        })\n        return total\n      },\n      totalBajosPromedioAsignatura(area, asignatura) {\n        let total = 0\n        const meta = this.listaAreasAsignaturas.find(\n          a => a.area === area && a.asignatura === asignatura\n        )\n        const idTipoEspecialidad = meta?.idTipoEspecialidad\n        Object.values(this.estudiantesNotas).forEach(est => {\n          const asig = est?.areas?.[area]?.asignaturas?.[asignatura]\n          if (!asig) return\n          const prom = parseFloat(this.calcularPromedioAsignatura(asig))\n          if (idTipoEspecialidad === 1) {\n            if (prom < this.datosSeccion.minBas) total++\n          } else {\n            if (prom < this.datosSeccion.minBasT) total++\n          }\n        })\n        return total\n      },\n      totalBajosPromedioArea(area) {\n        let total = 0\n        Object.values(this.estudiantesNotas).forEach(est => {\n          const prom = parseFloat(this.obtenerPromedioArea(est, area))\n          if (!isNaN(prom) && prom < this.datosSeccion.minBas) total++\n        })\n        return total\n      },\n      totalesGlobales() {\n        let bajo = 0, basico = 0, alto = 0, superior = 0, ausJ = 0, ausS = 0\n        Object.values(this.estudiantesNotas).forEach(est => {\n          bajo += this.contarDesempenoEstudiante(est.areas, 'bajo')\n          basico += this.contarDesempenoEstudiante(est.areas, 'basico')\n          alto += this.contarDesempenoEstudiante(est.areas, 'alto')\n          superior += this.contarDesempenoEstudiante(est.areas, 'superior')\n          ausJ += est.ausJ || 0\n          ausS += est.ausS || 0\n        })\n\n        return { bajo, basico, alto, superior, ausJ, ausS }\n      },\n      esAreaValida(area) {\n        //const asigns = this.listaAreasAsignaturas.filter(a => a.area === area)\n        //return asigns.some(a => a.orden !== 99)\n        const asigns = this.listaAreasAsignaturas.filter(a => a.area === area)\n        if (asigns.some(a => a.orden !== 99 && a.orden !== 98)) return true\n        else if (asigns.some(a => a.orden === 99) && this.datosSeccion.promCompor == 1) return true\n        else return false\n      },\n      obtenerPromedioArea(est, area) {\n        const areaData = est.areas && est.areas[area]\n        return areaData ? this.calcularPromedioArea(areaData) : ''\n      },\n      obtenerNota(est, area, asignatura, periodo) {\n        let nota = est?.areas?.[area]?.asignaturas?.[asignatura]?.periodos?.[periodo]\n        if (nota === 0) nota = ''\n        return typeof nota === 'number' ? nota.toFixed(1) : nota\n      },\n      obtenerPromedioAsignatura(est, area, asignatura) {\n        const asig = est?.areas?.[area]?.asignaturas?.[asignatura]\n        return asig ? this.calcularPromedioAsignatura(asig) : ''\n      },\n      calcularPromedioAsignatura(asig) {\n        const pesos = asig.pesos\n        const periodos = asig.periodos\n        const orden = asig.orden\n        if (orden === 99 && this.datosSeccion.promCompor == 0) return '-'\n        let total = 0\n        let cantidad = 0 // nuevo\n        for (let p = 1; p <= 4; p++) {\n          const nota = periodos[p] ?? 0\n          if (nota > 0) {\n            total += nota\n            cantidad++\n          }\n        }\n        if (total === 0) return ''\n        const promedio = total / cantidad\n        //const promedio = total / this.idPeriodo\n        return this.redondear(promedio).toFixed(1)\n      },\n      calcularPromedioArea(areaData) {\n        const asigns = Object.values(areaData.asignaturas)\n        if (!asigns.length) return '0.00'\n        let total = 0\n        asigns.forEach(asig => {\n          if (asig.orden === 99 && this.datosSeccion.promCompor == 0) return '-'\n          total += parseFloat((this.calcularPromedioAsignatura(asig) * asig.porcentaje) / 100)\n        })\n        return total > 0 ? this.redondear(total).toFixed(1) : ''\n      },\n      calcularPromedioGeneral(est) {\n        const areas = Object.keys(est.areas || {})\n        let total = 0\n        let cantidad = 0\n        areas.forEach(area => {\n          if (!this.esAreaValida(area)) return\n          const promedio = parseFloat(this.calcularPromedioArea(est.areas[area]))\n          if (!isNaN(promedio)) {\n            total += promedio\n            cantidad++\n          }\n        })\n        return cantidad > 0 ? (total / cantidad).toFixed(3) : ''\n      },\n      contarAusencias(tipo) {\n        let total = 0\n        Object.values(this.estudiantesNotas).forEach(est => {\n          if (tipo === 'ausJ') total += est.ausJ || 0\n          if (tipo === 'ausS') total += est.ausS || 0\n        })\n        return total\n      },\n      contarNotasPorAsignatura(area, asignatura, tipo) {\n        let contador = 0\n        Object.values(this.estudiantesNotas).forEach(est => {\n          const nota = est?.[area]?.[asignatura]?.nota\n          const val = est?.[area]?.[asignatura]?.idTipoEspecialidad\n          if (typeof nota !== 'number') return\n          if (val === 1) {\n            if (tipo === 'bajo' && nota < this.datosSeccion.minBas) contador++\n            else if (tipo === 'basico' && nota >= this.datosSeccion.minBas && nota < this.datosSeccion.minAlt) contador++\n            else if (tipo === 'alto' && nota >= this.datosSeccion.minAlt && nota < this.datosSeccion.minSup) contador++\n            else if (tipo === 'superior' && nota >= this.datosSeccion.minSup && nota <= this.datosSeccion.maxSup) contador++\n          } else {\n            if (tipo === 'bajo' && nota < this.datosSeccion.minBasT) contador++\n            else if (tipo === 'basico' && nota >= this.datosSeccion.minBasT && nota < this.datosSeccion.minAltT) contador++\n            else if (tipo === 'alto' && nota >= this.datosSeccion.minAltT && nota < this.datosSeccion.minSupT) contador++\n            else if (tipo === 'superior' && nota >= this.datosSeccion.minSupT && nota <= this.datosSeccion.maxSupT) contador++\n          }\n        })\n        return contador\n      },\n      contarNotasTotales(tipo) {\n        let total = 0\n        Object.values(this.estudiantesNotas).forEach(est => {\n          this.listaAreasAsignaturas.forEach(({ area, asignatura }) => {\n            const nota = est?.[area]?.[asignatura]?.nota\n            const val = est?.[area]?.[asignatura]?.idTipoEspecialidad\n            if (typeof nota !== 'number') return\n            if (val === 1) {\n              if (tipo === 'bajo' && nota < this.datosSeccion.minBas) total++\n              else if (tipo === 'basico' && nota >= this.datosSeccion.minBas && nota < this.datosSeccion.minAlt) total++\n              else if (tipo === 'alto' && nota >= this.datosSeccion.minAlt && nota < this.datosSeccion.minSup) total++\n              else if (tipo === 'superior' && nota >= this.datosSeccion.minSup && nota <= this.datosSeccion.maxSup) total++\n            } else {\n              if (tipo === 'bajo' && nota < this.datosSeccion.minBasT) total++\n              else if (tipo === 'basico' && nota >= this.datosSeccion.minBasT && nota < this.datosSeccion.minAltT) total++\n              else if (tipo === 'alto' && nota >= this.datosSeccion.minAltT && nota < this.datosSeccion.minSupT) total++\n              else if (tipo === 'superior' && nota >= this.datosSeccion.minSupT && nota <= this.datosSeccion.maxSupT) total++\n            }\n          })\n        })\n        return total\n      },\n      iconoPuesto(puesto) {\n        if (puesto === 1) return ''\n        if (puesto === 2) return ''\n        if (puesto === 3) return ''\n        return ''\n      },\n      contarDesempenoEstudiante(areas, tipo) {\n        let contador = 0\n        Object.values(areas || {}).forEach(area => {\n          Object.values(area.asignaturas || {}).forEach(asig => {\n            const nota = parseFloat(this.calcularPromedioAsignatura(asig))\n            const val =  asig.idTipoEspecialidad\n            if (typeof nota !== 'number') return\n            if (val === 1) {\n              if (tipo === 'bajo' && nota < this.datosSeccion.minBas) contador++\n              else if (tipo === 'basico' && nota >= this.datosSeccion.minBas && nota < this.datosSeccion.minAlt) contador++\n              else if (tipo === 'alto' && nota >= this.datosSeccion.minAlt && nota < this.datosSeccion.minSup) contador++\n              else if (tipo === 'superior' && nota >= this.datosSeccion.minSup && nota <= this.datosSeccion.maxSup) contador++\n            } else {\n              if (tipo === 'bajo' && nota < this.datosSeccion.minBasT) contador++\n              else if (tipo === 'basico' && nota >= this.datosSeccion.minBasT && nota < this.datosSeccion.minAltT) contador++\n              else if (tipo === 'alto' && nota >= this.datosSeccion.minAltT && nota < this.datosSeccion.minSupT) contador++\n              else if (tipo === 'superior' && nota >= this.datosSeccion.minSupT && nota <= this.datosSeccion.maxSupT) contador++\n            }\n          })\n        })\n        return contador\n      },\n      fueRecuperada(areas, area, asig) {\n        return areas?.[area]?.[asig]?.fueRecuperada ?? false\n      },\n      obtenerOriginal(areas, area, asig) {\n        const val = areas?.[area]?.[asig]?.original\n        return typeof val === 'number' ? val.toFixed(1) : '0.0'\n      },\n      obtenerRecuperacion(areas, area, asig) {\n        const val = areas?.[area]?.[asig]?.recuperacion\n        return typeof val === 'number' ? val.toFixed(1) : '0.0'\n      },\n      obtenerColor(nota, areas, area, asig) {\n        const val = areas?.[area]?.[asig]?.idTipoEspecialidad\n        if (val === 1) {\n          if (nota < this.datosSeccion.minBas) return 'desempeno-bajo'\n          if (nota < this.datosSeccion.minAlt) return 'desempeno-basico'\n          if (nota < this.datosSeccion.minSup) return 'desempeno-alto'\n          if (nota <= this.datosSeccion.maxSup) return 'desempeno-superior'\n          return 'desempeno-extra'\n        } else {\n          if (nota < this.datosSeccion.minBasT) return 'desempeno-bajo'\n          if (nota < this.datosSeccion.minAltT) return 'desempeno-basico'\n          if (nota < this.datosSeccion.minSupT) return 'desempeno-alto'\n          if (nota <= this.datosSeccion.maxSupT) return 'desempeno-superior'\n          return 'desempeno-extra'\n        }\n      },\n      claseDesempeno(nota) {\n        console.log(nota)\n        if (typeof nota !== 'number') return 'desempeno-extra'\n        if (nota < 3) return 'desempeno-bajo'\n        if (nota < 4) return 'desempeno-basico'\n        if (nota < 4.6) return 'desempeno-alto'\n        if (nota <= 5) return 'desempeno-superior'\n        return 'desempeno-extra'\n      },\n      obtenerColorGeneral(nota) {\n        if (nota < this.datosSeccion.minBas) return 'desempeno-bajo'\n        if (nota < this.datosSeccion.minAlt) return 'desempeno-basico'\n        if (nota < this.datosSeccion.minSup) return 'desempeno-alto'\n        if (nota <= this.datosSeccion.maxSup) return 'desempeno-superior'\n        return 'desempeno-extra'\n      },\n      async consultarEstudiantes() {\n        this.btnCargando = true\n        if (this.idPeriodo == 1) this.periodosVisibles = [1]\n        if (this.idPeriodo == 2) this.periodosVisibles = [1,2]\n        if (this.idPeriodo == 3) this.periodosVisibles = [1,2,3]\n        if (this.idPeriodo == 4) this.periodosVisibles = [1,2,3,4]\n        this.nombreSede = document.getElementById('sedes')[document.getElementById('sedes').selectedIndex].text\n        if (this.idCurso != null) { \n          this.nombreCurso = document.getElementById('cursos')[document.getElementById('cursos').selectedIndex].text\n          this.$store.state.datosCursos.forEach(element => {\n            if (element.id == this.idCurso) {\n              this.idNivel = element.id_nivel\n            }\n          })\n          this.listaAreasAsignaturas = []\n          await axios\n          .get(CONFIG.ROOT_PATH + 'consolidados/areasasignaturas/curso', {params: {idCurso: this.idCurso}})\n          .then(response => {\n            if (response.data.error){\n              this.mensajeEmergente('danger',CONFIG.TITULO_MSG,response.data.mensaje + ' - Lista areas-asignaturas curso')\n              this.btnCargando = false\n            } else{\n              if (response.data.datos != 0) {\n                this.listaAreasAsignaturas = response.data.datos\n              }\n            }\n          })\n          .catch(err => {\n            this.mensajeEmergente('danger',CONFIG.TITULO_MSG,'Algo salio mal y no se pudo realizar: Lista areas-asignaturas curso. Intente ms tarde.' + err)\n            this.btnCargando = false\n          })\n          this.datosRaw = []\n          await axios\n          .get(CONFIG.ROOT_PATH + 'consolidados/asignaturas/curso/acumulado', {params: {idCurso: this.idCurso, periodo: this.idPeriodo, vigencia: this.$store.state.aLectivo}})\n          .then(response => {\n            if (response.data.error){\n              this.mensajeEmergente('danger',CONFIG.TITULO_MSG,response.data.mensaje + ' - Consolidados asignaturas curso periodo')\n              this.btnCargando = false\n            } else{\n              if (response.data.datos != 0) {\n                this.datosRaw = response.data.datos\n              }\n            }\n          })\n          .catch(err => {\n            this.mensajeEmergente('danger',CONFIG.TITULO_MSG,'Algo salio mal y no se pudo realizar: Consolidados asignaturas curso periodo. Intente ms tarde.' + err)\n            this.btnCargando = false\n          })\n        }\n        //console.log(JSON.stringify(this.listaAreasAsignaturas))\n        this.btnCargando = false\n      },\n      imprimir() {\n        let fecha = 'Fecha: ' + new Date().toLocaleString()\n        let tituloInforme = 'CONSOLIDADO EVALUACIONES ACUMULADO POR PROMEDIO'\n        const contenido = document.querySelector('table').outerHTML\n        const ventana = window.open(\"Consolidados\", \"_blank\")\n        ventana.document.write(`<html><head><title>Imprimir</title></head>\n        <style scoped>\n          table {\n            border-collapse: collapse;\n            width: 100%;\n            text-align: center;\n            font-size: 10px;\n          }\n          th {\n            background: #eee;\n          }\n          .nota-recuperada {\n            border: 2px solid #ffa500;\n            box-shadow: 0 0 5px #ffa500;\n          }\n          .desempeno-bajo { background-color: #f8d7da; color: #721c24; }\n          .desempeno-basico { background-color: #d1ecf1; color: #0c5460; }\n          .desempeno-alto { background-color: #fff3cd; color: #856404; }\n          .desempeno-superior { background-color: #d4edda; color: #155724; }\n          .desempeno-extra { background-color: #f4ecf5; color: #2f2e2e; }\n        </style>\n          <body class=\"container\">\n            <p style=\"text-align: center; font-size: 12px;\">SECRETARA DE EDUCACIN TERRITORIAL DE TUNJA<br><b>${this.$store.state.nombreInstitucion}</b><br>TUNJA - BOYAC<br>${tituloInforme}<br>Sede: ${this.nombreSede} | Curso: ${this.nombreCurso} | Ao Lectivo ${this.$store.state.aLectivo} | Periodo: ${this.idPeriodo}</p>\n            ${contenido}\n            <div style=\"text-align: right; font-size: 12px;\"><i>${fecha}</i></div>\n          </body>\n        </html>`)\n        ventana.document.close()\n        ventana.print()\n      },\n      exportarAExcel() {\n        const tabla = document.querySelector('table')\n        const wb = XLSX.utils.table_to_book(tabla)\n        XLSX.writeFile(wb, 'notas.xlsx')\n      },\n      redondear(num) {\n        var m = Number((Math.abs(num) * 10).toPrecision(15))\n        return Math.round(m) / 10 * Math.sign(num);\n      },\n      async ocuparComboCursosSede() {\n        this.comboCursosSede = []\n        this.$store.state.datosCursos.forEach(element => {\n          if (element.id_sede == this.idSede) {\n            this.comboCursosSede.push({ 'value': element.id, 'text': element.nomenclatura.toUpperCase() })\n          }\n        })\n      },\n      async ocuparComboSedes() {\n        this.comboSedes = []\n        this.$store.state.datosSedes.forEach(element => {\n          this.comboSedes.push({ 'value': element.id, 'text': element.sede.toUpperCase() })\n        })\n      },\n      async ocuparComboPeriodos() {\n        this.comboPeriodos = []\n        this.$store.state.periodos.forEach(element => {\n          this.comboPeriodos.push({ 'value': element.id, 'text': element.periodo.toUpperCase() })\n        })\n      },\n      mensajeEmergente(variante, titulo, contenido) {\n        this.$bvToast.toast(contenido, { title: titulo, variant: variante, toaster: \"b-toaster-top-center\", solid: true, autoHideDelay: 4000, appendToast: false })\n      }\n    },\n    computed: {\n      totales() {\n        return this.totalesGlobales()\n      },\n      estudiantesNotas() {\n        const mapa = {}\n        this.datosRaw.forEach(row => {\n          const { estudiante, area, asignatura, periodo, definitiva, recuperacion, orden, definitivacompor, definitivapree, idTipoEspecialidad, ausJ, ausS, porcentaje, id_conceptual } = row\n          if (!mapa[estudiante]) {\n            mapa[estudiante] = { id_conceptual, ausJ: 0, ausS: 0, areas: {} }\n          }\n          if (!mapa[estudiante].areas[area]) {\n            mapa[estudiante].areas[area] = { asignaturas: {} }\n          }\n          if (!mapa[estudiante].areas[area].asignaturas[asignatura]) {\n            mapa[estudiante].areas[area].asignaturas[asignatura] = {\n              periodos: {},\n              orden,\n              idTipoEspecialidad,\n              porcentaje,\n              pesos: { 1: 0.2, 2: 0.2, 3: 0.3, 4: 0.3 }\n            }\n          }\n          let notaFinal = 0\n          if (orden === 99) {\n            if (this.datosSeccion.tipoValComp == 1) {\n              notaFinal = definitiva\n            } else {\n              notaFinal = definitivacompor != null ? definitivacompor : ''\n            }\n          } else {\n            if (this.idNivel == 1) {\n              notaFinal = definitivapree != null && definitivapree != 0 && definitivapree != '' ? definitivapree : ''\n            } else {\n              notaFinal = recuperacion > definitiva ? recuperacion : definitiva\n            }\n          }\n          mapa[estudiante].areas[area].asignaturas[asignatura].periodos[periodo] = notaFinal\n          mapa[estudiante].ausJ += ausJ || 0\n          mapa[estudiante].ausS += ausS || 0\n        })\n        return mapa\n      },\n      totalColumnasPromedioArea() {\n        const areasUnicas = new Set(this.listaAreasAsignaturas.map(a => a.area))\n        return areasUnicas.size\n      },\n      puestosPorEstudiante() {\n        const lista = Object.entries(this.estudiantesNotas).map(([nombre, areas]) => {\n          const promedio = parseFloat(this.calcularPromedioGeneral(areas))\n          return { nombre, promedio: isNaN(promedio) ? 0 : promedio }\n        })\n        // Ordenar de mayor a menor\n        lista.sort((a, b) => b.promedio - a.promedio)\n        const puestos = {}\n        let puestoActual = 1\n        let contador = 1\n        let ultimoPromedio = null\n        lista.forEach(est => {\n          if (est.promedio !== ultimoPromedio) {\n            puestoActual = contador\n            ultimoPromedio = est.promedio\n          }\n          puestos[est.nombre] = puestoActual\n          contador++\n        })\n        return puestos\n      },\n      encabezadoPorArea() {\n        const mapa = {}\n        this.listaAreasAsignaturas.forEach(({ area, asignatura }) => {\n          if (!mapa[area]) mapa[area] = []\n          mapa[area].push(asignatura)\n        })\n        return mapa\n      },\n    },\n    beforeMount() {\n      this.ocuparComboSedes()\n      this.ocuparComboPeriodos()\n      this.datosSeccion = this.$store.state.datosSecciones[this.$store.state.idSeccion - 1]\n      //console.log(JSON.stringify(this.datosSeccion))\n    }\n  }\n</script>\n<style scoped>\n  table {\n    border-collapse: collapse;\n    width: 100%;\n    text-align: center;\n    font-size: 10px;\n  }\n  th {\n    background: #eee;\n  }\n  .nota-recuperada {\n    border: 2px solid #ffa500;\n    box-shadow: 0 0 5px #ffa500;\n  }\n  .desempeno-bajo { background-color: #f8d7da; color: #721c24; }\n  .desempeno-basico { background-color: #d1ecf1; color: #0c5460; }\n  .desempeno-alto { background-color: #fff3cd; color: #856404; }\n  .desempeno-superior { background-color: #d4edda; color: #155724; }\n  .desempeno-extra { background-color: #f4ecf5; color: #2f2e2e; }\n  .promedio-area {\n    background-color: #f2f2f2;\n    font-weight: bold;\n    text-align: center;\n  }\n  .bloque-area th,\n  .bloque-area td {\n    border-right: 3px solid #999; /* lnea divisoria entre reas */\n  }\n\n</style>\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ConsolidadoPromedio.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ConsolidadoPromedio.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ConsolidadoPromedio.vue?vue&type=template&id=44a06de5&scoped=true&\"\nimport script from \"./ConsolidadoPromedio.vue?vue&type=script&lang=js&\"\nexport * from \"./ConsolidadoPromedio.vue?vue&type=script&lang=js&\"\nimport style0 from \"./ConsolidadoPromedio.vue?vue&type=style&index=0&id=44a06de5&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"44a06de5\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('b-row',{staticClass:\"mt-2\"},[_c('b-col',{attrs:{\"lg\":\"12\"}},[_c('b-card',{scopedSlots:_vm._u([{key:\"header\",fn:function(){return [_c('h5',{staticClass:\"mb-0\"},[_c('b-icon',{attrs:{\"icon\":\"card-checklist\",\"aria-hidden\":\"true\"}}),_vm._v(\" CONSOLIDADO NOTAS FALTANTES POR ASIGNATURA\")],1)]},proxy:true}])},[_c('b-card-text',[_c('b-row',[_c('b-col',{attrs:{\"lg\":\"2\"}},[_c('b-form-group',{staticClass:\"etiqueta\",attrs:{\"label\":\"Periodo:\",\"label-for\":\"periodo\"}},[_c('b-form-select',{ref:\"periodo\",attrs:{\"id\":\"periodo\",\"options\":_vm.comboPeriodos},on:{\"change\":function($event){_vm.idSede=null,_vm.idCurso=null}},model:{value:(_vm.idPeriodo),callback:function ($$v) {_vm.idPeriodo=$$v},expression:\"idPeriodo\"}})],1)],1),_c('b-col',{attrs:{\"lg\":\"6\"}},[_c('b-form-group',{staticClass:\"etiqueta\",attrs:{\"label\":\"Seleccione la Sede:\",\"label-for\":\"sedes\"}},[_c('b-form-select',{ref:\"sedes\",attrs:{\"id\":\"sedes\",\"options\":_vm.comboSedes,\"disabled\":_vm.idPeriodo!=null ? false : true},on:{\"change\":function($event){_vm.idCurso=null,_vm.ocuparComboCursosSede()}},model:{value:(_vm.idSede),callback:function ($$v) {_vm.idSede=$$v},expression:\"idSede\"}})],1)],1),_c('b-col',{attrs:{\"lg\":\"4\"}},[_c('b-form-group',{staticClass:\"etiqueta\",attrs:{\"label\":\"Seleccione el Curso:\",\"label-for\":\"cursos\"}},[_c('b-form-select',{ref:\"cursos\",attrs:{\"id\":\"cursos\",\"options\":_vm.comboCursosSede,\"disabled\":_vm.idSede!=null ? false : true},on:{\"change\":function($event){return _vm.consultarEstudiantes()}},model:{value:(_vm.idCurso),callback:function ($$v) {_vm.idCurso=$$v},expression:\"idCurso\"}})],1)],1)],1)],1)],1)],1)],1),_c('b-row',[_c('b-col',{attrs:{\"lg\":\"12\"}},[(_vm.btnCargando)?_c('div',[_c('div',{staticClass:\"text-center m-5 text-primary\"},[_c('b-spinner',{staticStyle:{\"width\":\"3rem\",\"height\":\"3rem\"},attrs:{\"label\":\"Spinner\"}}),_c('br'),_c('strong',[_vm._v(\"Cargando informe...\")])],1)]):_vm._e()])],1),(!_vm.btnCargando && _vm.idCurso!=null)?_c('b-row',[_c('b-col',{attrs:{\"lg\":\"12\"}},[_c('table',{staticClass:\"table-responsive\",attrs:{\"border\":\"1\",\"cellspacing\":\"0\",\"cellpadding\":\"1\"}},[_c('thead',[_c('tr',[_c('th',{attrs:{\"rowspan\":\"3\"}},[_vm._v(\"#\")]),_c('th',{attrs:{\"rowspan\":\"3\"}},[_vm._v(\"Estudiante\")]),_vm._l((_vm.encabezadoPorArea),function(asigs,area){return [_c('th',{key:area,attrs:{\"colspan\":_vm.colspanArea(area)}},[_vm._v(\" \"+_vm._s(area)+\" \")])]}),_c('th',{attrs:{\"rowspan\":\"3\"}},[_vm._v(\"#\")])],2),_c('tr',[_vm._l((_vm.encabezadoPorArea),function(asigs){return [_vm._l((asigs),function(asig,k){return [_c('th',{key:'area-' + asig + k,attrs:{\"colspan\":_vm.periodosVisibles.length + 1}},[_vm._v(\" \"+_vm._s(asig)+\" \")])]})]})],2),_c('tr',[_vm._l((_vm.encabezadoPorArea),function(asigs,area){return [_vm._l((asigs),function(asig,l){return [_c('th',{key:'acum' + asig + area + l},[_vm._v(\"ACU\")]),_c('th',{key:'prom' + asig + area + l},[_vm._v(\"PRM\")]),_c('th',{key:'falta' + asig + area + l},[_vm._v(\"FALTA\")])]})]})],2)]),_c('tbody',_vm._l((_vm.estudiantesNotas),function(est,nombre,i){return _c('tr',{key:nombre},[_c('td',{staticClass:\"text-left\"},[_vm._v(_vm._s(i + 1))]),_c('td',{staticStyle:{\"text-align\":\"left\"}},[_vm._v(_vm._s(nombre))]),_vm._l((_vm.encabezadoPorArea),function(asigs,area){return [_vm._l((asigs),function(asig){return [_c('td',{key:'prom' + nombre + area + asig,staticClass:\"bloque-area\"},[_vm._v(\" \"+_vm._s(_vm.obtenerAcumulado(est, area, asig))+\" \")]),_c('td',{key:'prom' + nombre + area + asig + 1,staticClass:\"bloque-area\"},[_vm._v(\" \"+_vm._s(_vm.obtenerPromedioAsignatura(est, area, asig))+\" \")]),_c('td',{key:'prom' + nombre + area + asig + 2,staticClass:\"bloque-area\",staticStyle:{\"font-weight\":\"bold\",\"text-align\":\"center\"}},[_vm._v(\" \"+_vm._s(_vm.obtenerNotaFaltante(est, area, asig))+\" \")])]})]}),_c('td',{staticClass:\"text-left\"},[_vm._v(_vm._s(i + 1))])],2)}),0)]),_c('div',{staticStyle:{\"margin-bottom\":\"1rem\"}},[_c('b-button',{staticClass:\"small mx-1 mt-3\",attrs:{\"variant\":\"primary\"},on:{\"click\":_vm.imprimir}},[_vm._v(\"Imprimir Consolidado\")]),_c('b-button',{staticClass:\"small mx-1 mt-3\",attrs:{\"variant\":\"outline-primary\"},on:{\"click\":_vm.exportarAExcel}},[_vm._v(\"Exportar a Excel\")])],1)])],1):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div>\n    <b-row class=\"mt-2\">\n      <b-col lg=\"12\">\n        <b-card>\n          <template #header>\n            <h5 class=\"mb-0\"><b-icon icon=\"card-checklist\" aria-hidden=\"true\"></b-icon> CONSOLIDADO NOTAS FALTANTES POR ASIGNATURA</h5>\n          </template>\n          <b-card-text>\n            <b-row>\n              <b-col lg=\"2\">\n                <b-form-group label=\"Periodo:\" label-for=\"periodo\" class=\"etiqueta\">\n                  <b-form-select id=\"periodo\" ref=\"periodo\" v-model=\"idPeriodo\" :options=\"comboPeriodos\" @change=\"idSede=null,idCurso=null\"></b-form-select>\n                </b-form-group>\n              </b-col>\n              <b-col lg=\"6\">\n                <b-form-group label=\"Seleccione la Sede:\" label-for=\"sedes\" class=\"etiqueta\">\n                  <b-form-select  id=\"sedes\" ref=\"sedes\" v-model=\"idSede\" :options=\"comboSedes\" @change=\"idCurso=null,ocuparComboCursosSede()\" :disabled=\"idPeriodo!=null ? false : true\"></b-form-select>\n                </b-form-group>\n              </b-col>\n              <b-col lg=\"4\">\n                <b-form-group label=\"Seleccione el Curso:\" label-for=\"cursos\" class=\"etiqueta\">\n                  <b-form-select id=\"cursos\" ref=\"cursos\" v-model=\"idCurso\" :options=\"comboCursosSede\" @change=\"consultarEstudiantes()\" :disabled=\"idSede!=null ? false : true\"></b-form-select>\n                </b-form-group>\n              </b-col>\n            </b-row>\n          </b-card-text>\n        </b-card>\n      </b-col>\n    </b-row>\n    <b-row>\n      <b-col lg=\"12\">\n        <div v-if=\"btnCargando\">\n          <div class=\"text-center m-5 text-primary\">\n            <b-spinner style=\"width: 3rem; height: 3rem;\" label=\"Spinner\"></b-spinner>\n            <br><strong>Cargando informe...</strong>\n          </div>\n        </div>\n      </b-col>\n    </b-row>\n    <b-row v-if=\"!btnCargando && idCurso!=null\">\n      <b-col lg=\"12\">\n        <table border=\"1\" cellspacing=\"0\" cellpadding=\"1\" class=\"table-responsive\">\n          <thead>\n            <tr>\n              <th rowspan=\"3\">#</th>\n              <th rowspan=\"3\">Estudiante</th>\n              <template v-for=\"(asigs, area) in encabezadoPorArea\">\n                <th :colspan=\"colspanArea(area)\" :key=\"area\">\n                  {{ area }}\n                </th>\n              </template>\n              <th rowspan=\"3\">#</th>\n            </tr>\n            <tr>\n              <template v-for=\"(asigs) in encabezadoPorArea\">\n                <template v-for=\"(asig, k) in asigs\">\n                  <th :colspan=\"periodosVisibles.length + 1\" :key=\"'area-' + asig + k\">\n                    {{ asig }}\n                  </th>\n                </template>\n              </template>\n            </tr>\n            <tr>\n              <template v-for=\"(asigs, area) in encabezadoPorArea\">\n                <template v-for=\"(asig, l) in asigs\">\n                  <th :key=\"'acum' + asig + area + l\">ACU</th>\n                  <th :key=\"'prom' + asig + area + l\">PRM</th>\n                  <th :key=\"'falta' + asig + area + l\">FALTA</th>\n                </template>\n              </template>\n              <!-- columnas finales vacas -->\n            </tr>\n          </thead>\n          <tbody>\n            <tr v-for=\"(est, nombre, i) in estudiantesNotas\" :key=\"nombre\">\n              <td class=\"text-left\">{{ i + 1 }}</td>\n              <td style=\"text-align: left\">{{ nombre }}</td>\n              <template v-for=\"(asigs, area) in encabezadoPorArea\">\n                <template v-for=\"asig in asigs\">\n                  <td class=\"bloque-area\" :key=\"'prom' + nombre + area + asig\">\n                    {{ obtenerAcumulado(est, area, asig) }}\n                  </td>\n                  <td class=\"bloque-area\" :key=\"'prom' + nombre + area + asig + 1\">\n                    {{ obtenerPromedioAsignatura(est, area, asig) }}\n                  </td>\n                  <td class=\"bloque-area\" :key=\"'prom' + nombre + area + asig + 2\" style=\"font-weight: bold; text-align: center;\">\n                    {{ obtenerNotaFaltante(est, area, asig) }}\n                  </td>\n                </template>\n              </template>\n              <td class=\"text-left\">{{ i + 1 }}</td>\n            </tr>\n          </tbody>\n        </table>\n        <div style=\"margin-bottom: 1rem\">\n          <b-button class=\"small mx-1 mt-3\" variant=\"primary\" @click=\"imprimir\">Imprimir Consolidado</b-button>\n          <b-button class=\"small mx-1 mt-3\" variant=\"outline-primary\" @click=\"exportarAExcel\">Exportar a Excel</b-button>\n        </div>\n      </b-col>\n    </b-row>\n  </div>\n</template>\n\n<script>\n  import axios from \"axios\"\n  import * as CONFIG from '@/assets/config.js'\n  import * as XLSX from 'xlsx'\n\n  export default {\n    name: 'consolidadopromedio',\n    components: {\n    },\n    data () {\n      return {\n        idSede: null,\n        comboSedes: [],\n        idPeriodo: null,\n        comboPeriodos: null,\n        idCurso: null,\n        comboCursosSede: [],\n        nombreSede: null,\n        nombreCurso: null,\n        idNivel: null,\n        btnCargando: false,\n        datosRaw: [],\n        datosSeccion: {},\n        listaAreasAsignaturas: [],\n        periodosVisibles: []\n      }\n    },\n    methods: {\n      colspanArea(area) {\n        const asignaturas = this.encabezadoPorArea[area] || []\n        const columnasPorAsignatura = this.periodosVisibles.length + 1\n        const extraColumnaPromArea = 0\n        return (asignaturas.length * columnasPorAsignatura) + extraColumnaPromArea\n      },\n      esAreaValida(area) {\n        //const asigns = this.listaAreasAsignaturas.filter(a => a.area === area)\n        //return asigns.some(a => a.orden !== 99)\n        const asigns = this.listaAreasAsignaturas.filter(a => a.area === area)\n        if (asigns.some(a => a.orden !== 99 && a.orden !== 98)) return true\n        else if (asigns.some(a => a.orden === 99) && this.datosSeccion.promCompor == 1) return true\n        else return false\n      },\n      obtenerNota(est, area, asignatura, periodo) {\n        let nota = est?.areas?.[area]?.asignaturas?.[asignatura]?.periodos?.[periodo]\n        if (nota === 0) nota = ''\n        return typeof nota === 'number' ? nota.toFixed(1) : nota\n      },\n      obtenerNotaFaltante(est, area, asignatura) {\n        const asig = est?.areas?.[area]?.asignaturas?.[asignatura]\n        return asig ? this.calcularNotaFaltante(asig) : ''\n      },\n      calcularNotaFaltante(asig) {\n        const tipo = asig.idTipoEspecialidad\n        const periodos = asig.periodos\n        const orden = asig.orden\n        if (orden === 99 && this.datosSeccion.promCompor == 0) return '-'\n        let total = 0\n        for (let p = 1; p <= 3; p++) {\n          const nota = periodos[p] ?? 0\n          total += nota\n        }\n        if (total === 0) return ''\n        let faltante = 0\n        if (tipo === 1) {\n          faltante = (this.datosSeccion.minBas * 4) - total\n        } else {\n          faltante = (this.datosSeccion.minBasT * 4) - total\n        }\n        return faltante.toFixed(1)\n      },\n      obtenerAcumulado(est, area, asignatura) {\n        const asig = est?.areas?.[area]?.asignaturas?.[asignatura]\n        return asig ? this.calcularAcumulado(asig) : ''\n      },\n      calcularAcumulado(asig) {\n        const pesos = asig.pesos\n        const periodos = asig.periodos\n        const orden = asig.orden\n        if (orden === 99 && this.datosSeccion.promCompor == 0) return '-'\n        let total = 0\n        for (let p = 1; p <= 4; p++) {\n          const nota = periodos[p] ?? 0\n          total += nota\n        }\n        if (total === 0) return ''\n        return total.toFixed(1)\n      },\n      obtenerPromedioAsignatura(est, area, asignatura) {\n        const asig = est?.areas?.[area]?.asignaturas?.[asignatura]\n        return asig ? this.calcularPromedioAsignatura(asig) : ''\n      },\n      calcularPromedioAsignatura(asig) {\n        const pesos = asig.pesos\n        const periodos = asig.periodos\n        const orden = asig.orden\n        if (orden === 99 && this.datosSeccion.promCompor == 0) return '-'\n        let total = 0\n        for (let p = 1; p <= 4; p++) {\n          const nota = periodos[p] ?? 0\n          total += nota\n        }\n        if (total === 0) return ''\n        const promedio = total / this.idPeriodo\n        return this.redondear(promedio).toFixed(1)\n      },\n      contarAusencias(tipo) {\n        let total = 0\n        Object.values(this.estudiantesNotas).forEach(est => {\n          if (tipo === 'ausJ') total += est.ausJ || 0\n          if (tipo === 'ausS') total += est.ausS || 0\n        })\n        return total\n      },\n      contarNotasPorAsignatura(area, asignatura, tipo) {\n        let contador = 0\n        Object.values(this.estudiantesNotas).forEach(est => {\n          const nota = est?.[area]?.[asignatura]?.nota\n          const val = est?.[area]?.[asignatura]?.idTipoEspecialidad\n          if (typeof nota !== 'number') return\n          if (val === 1) {\n            if (tipo === 'bajo' && nota < this.datosSeccion.minBas) contador++\n            else if (tipo === 'basico' && nota >= this.datosSeccion.minBas && nota < this.datosSeccion.minAlt) contador++\n            else if (tipo === 'alto' && nota >= this.datosSeccion.minAlt && nota < this.datosSeccion.minSup) contador++\n            else if (tipo === 'superior' && nota >= this.datosSeccion.minSup && nota <= this.datosSeccion.maxSup) contador++\n          } else {\n            if (tipo === 'bajo' && nota < this.datosSeccion.minBasT) contador++\n            else if (tipo === 'basico' && nota >= this.datosSeccion.minBasT && nota < this.datosSeccion.minAltT) contador++\n            else if (tipo === 'alto' && nota >= this.datosSeccion.minAltT && nota < this.datosSeccion.minSupT) contador++\n            else if (tipo === 'superior' && nota >= this.datosSeccion.minSupT && nota <= this.datosSeccion.maxSupT) contador++\n          }\n        })\n        return contador\n      },\n      fueRecuperada(areas, area, asig) {\n        return areas?.[area]?.[asig]?.fueRecuperada ?? false\n      },\n      obtenerOriginal(areas, area, asig) {\n        const val = areas?.[area]?.[asig]?.original\n        return typeof val === 'number' ? val.toFixed(1) : '0.0'\n      },\n      obtenerRecuperacion(areas, area, asig) {\n        const val = areas?.[area]?.[asig]?.recuperacion\n        return typeof val === 'number' ? val.toFixed(1) : '0.0'\n      },\n      obtenerColor(nota, areas, area, asig) {\n        const val = areas?.[area]?.[asig]?.idTipoEspecialidad\n        if (val === 1) {\n          if (nota < this.datosSeccion.minBas) return 'desempeno-bajo'\n          if (nota < this.datosSeccion.minAlt) return 'desempeno-basico'\n          if (nota < this.datosSeccion.minSup) return 'desempeno-alto'\n          if (nota <= this.datosSeccion.maxSup) return 'desempeno-superior'\n          return 'desempeno-extra'\n        } else {\n          if (nota < this.datosSeccion.minBasT) return 'desempeno-bajo'\n          if (nota < this.datosSeccion.minAltT) return 'desempeno-basico'\n          if (nota < this.datosSeccion.minSupT) return 'desempeno-alto'\n          if (nota <= this.datosSeccion.maxSupT) return 'desempeno-superior'\n          return 'desempeno-extra'\n        }\n      },\n      claseDesempeno(nota) {\n        if (typeof nota !== 'number') return 'desempeno-extra'\n        if (nota < 3) return 'desempeno-bajo'\n        if (nota < 4) return 'desempeno-basico'\n        if (nota < 4.6) return 'desempeno-alto'\n        if (nota <= 5) return 'desempeno-superior'\n        return 'desempeno-extra'\n      },\n      obtenerColorGeneral(nota) {\n        if (nota < this.datosSeccion.minBas) return 'desempeno-bajo'\n        if (nota < this.datosSeccion.minAlt) return 'desempeno-basico'\n        if (nota < this.datosSeccion.minSup) return 'desempeno-alto'\n        if (nota <= this.datosSeccion.maxSup) return 'desempeno-superior'\n        return 'desempeno-extra'\n      },\n      async consultarEstudiantes() {\n        this.btnCargando = true\n        this.periodosVisibles = [1,2]\n        this.nombreSede = document.getElementById('sedes')[document.getElementById('sedes').selectedIndex].text\n        if (this.idCurso != null) { \n          this.nombreCurso = document.getElementById('cursos')[document.getElementById('cursos').selectedIndex].text\n          this.$store.state.datosCursos.forEach(element => {\n            if (element.id == this.idCurso) {\n              this.idNivel = element.id_nivel\n            }\n          })\n          this.listaAreasAsignaturas = []\n          await axios\n          .get(CONFIG.ROOT_PATH + 'consolidados/areasasignaturas/curso', {params: {idCurso: this.idCurso}})\n          .then(response => {\n            if (response.data.error){\n              this.mensajeEmergente('danger',CONFIG.TITULO_MSG,response.data.mensaje + ' - Lista areas-asignaturas curso')\n              this.btnCargando = false\n            } else{\n              if (response.data.datos != 0) {\n                this.listaAreasAsignaturas = response.data.datos\n              }\n            }\n          })\n          .catch(err => {\n            this.mensajeEmergente('danger',CONFIG.TITULO_MSG,'Algo salio mal y no se pudo realizar: Lista areas-asignaturas curso. Intente ms tarde.' + err)\n            this.btnCargando = false\n          })\n          this.datosRaw = []\n          await axios\n          .get(CONFIG.ROOT_PATH + 'consolidados/asignaturas/curso/acumulado', {params: {idCurso: this.idCurso, periodo: this.idPeriodo, vigencia: this.$store.state.aLectivo}})\n          .then(response => {\n            if (response.data.error){\n              this.mensajeEmergente('danger',CONFIG.TITULO_MSG,response.data.mensaje + ' - Consolidados asignaturas curso periodo')\n              this.btnCargando = false\n            } else{\n              if (response.data.datos != 0) {\n                this.datosRaw = response.data.datos\n              }\n            }\n          })\n          .catch(err => {\n            this.mensajeEmergente('danger',CONFIG.TITULO_MSG,'Algo salio mal y no se pudo realizar: Consolidados asignaturas curso periodo. Intente ms tarde.' + err)\n            this.btnCargando = false\n          })\n        }\n        //console.log(JSON.stringify(this.listaAreasAsignaturas))\n        this.btnCargando = false\n      },\n      imprimir() {\n        let fecha = 'Fecha: ' + new Date().toLocaleString()\n        let tituloInforme = 'CONSOLIDADO NOTAS FALTANTES POR ASIGNATURA'\n        const contenido = document.querySelector('table').outerHTML\n        const ventana = window.open(\"NotaFaltanteAsignatura\", \"_blank\")\n        ventana.document.write(`<html><head><title>NotaFaltanteAsignatura</title></head>\n        <style scoped>\n          table {\n            border-collapse: collapse;\n            width: 100%;\n            text-align: center;\n            font-size: 10px;\n          }\n          th {\n            background: #eee;\n          }\n          .nota-recuperada {\n            border: 2px solid #ffa500;\n            box-shadow: 0 0 5px #ffa500;\n          }\n          .desempeno-bajo { background-color: #f8d7da; color: #721c24; }\n          .desempeno-basico { background-color: #d1ecf1; color: #0c5460; }\n          .desempeno-alto { background-color: #fff3cd; color: #856404; }\n          .desempeno-superior { background-color: #d4edda; color: #155724; }\n          .desempeno-extra { background-color: #f4ecf5; color: #2f2e2e; }\n        </style>\n          <body class=\"container\">\n            <p style=\"text-align: center; font-size: 12px;\">SECRETARA DE EDUCACIN TERRITORIAL DE TUNJA<br><b>${this.$store.state.nombreInstitucion}</b><br>TUNJA - BOYAC<br>${tituloInforme}<br>Sede: ${this.nombreSede} | Curso: ${this.nombreCurso} | Ao Lectivo ${this.$store.state.aLectivo} | Periodo: ${this.idPeriodo}</p>\n            ${contenido}\n            <div style=\"text-align: right; font-size: 12px;\"><i>${fecha}</i></div>\n          </body>\n        </html>`)\n        ventana.document.close()\n        ventana.print()\n      },\n      exportarAExcel() {\n        const tabla = document.querySelector('table')\n        const wb = XLSX.utils.table_to_book(tabla)\n        XLSX.writeFile(wb, 'NotaFaltanteAsignatura.xlsx')\n      },\n      redondear(num) {\n        var m = Number((Math.abs(num) * 10).toPrecision(15))\n        return Math.round(m) / 10 * Math.sign(num);\n      },\n      async ocuparComboCursosSede() {\n        this.comboCursosSede = []\n        this.$store.state.datosCursos.forEach(element => {\n          if (element.id_sede == this.idSede) {\n            this.comboCursosSede.push({ 'value': element.id, 'text': element.nomenclatura.toUpperCase() })\n          }\n        })\n      },\n      async ocuparComboSedes() {\n        this.comboSedes = []\n        this.$store.state.datosSedes.forEach(element => {\n          this.comboSedes.push({ 'value': element.id, 'text': element.sede.toUpperCase() })\n        })\n      },\n      async ocuparComboPeriodos() {\n        this.comboPeriodos = []\n        this.$store.state.periodos.forEach(element => {\n          this.comboPeriodos.push({ 'value': element.id, 'text': element.periodo.toUpperCase() })\n        })\n      },\n      mensajeEmergente(variante, titulo, contenido) {\n        this.$bvToast.toast(contenido, { title: titulo, variant: variante, toaster: \"b-toaster-top-center\", solid: true, autoHideDelay: 4000, appendToast: false })\n      }\n    },\n    computed: {\n      estudiantesNotas() {\n        const mapa = {}\n        this.datosRaw.forEach(row => {\n          const { estudiante, area, asignatura, periodo, definitiva, recuperacion, orden, definitivacompor, idTipoEspecialidad, ausJ, ausS, porcentaje } = row\n          if (!mapa[estudiante]) {\n            mapa[estudiante] = { ausJ: 0, ausS: 0, areas: {} }\n          }\n          if (!mapa[estudiante].areas[area]) {\n            mapa[estudiante].areas[area] = { asignaturas: {} }\n          }\n          if (!mapa[estudiante].areas[area].asignaturas[asignatura]) {\n            mapa[estudiante].areas[area].asignaturas[asignatura] = {\n              periodos: {},\n              orden,\n              idTipoEspecialidad,\n              porcentaje,\n              pesos: { 1: 0.2, 2: 0.2, 3: 0.3, 4: 0.3 }\n            }\n          }\n          let notaFinal = 0\n          if (orden === 99) {\n            if (this.datosSeccion.tipoValComp == 1) {\n              notaFinal = definitiva\n            } else {\n              notaFinal = definitivacompor != null ? definitivacompor : ''\n            }\n          } else {\n            notaFinal = recuperacion > definitiva ? recuperacion : definitiva\n          }\n          mapa[estudiante].areas[area].asignaturas[asignatura].periodos[periodo] = notaFinal\n          mapa[estudiante].ausJ += ausJ || 0\n          mapa[estudiante].ausS += ausS || 0\n        })\n        return mapa\n      },\n      totalColumnasPromedioArea() {\n        const areasUnicas = new Set(this.listaAreasAsignaturas.map(a => a.area))\n        return areasUnicas.size\n      },\n      encabezadoPorArea() {\n        const mapa = {}\n        this.listaAreasAsignaturas.forEach(({ area, asignatura }) => {\n          if (!mapa[area]) mapa[area] = []\n          mapa[area].push(asignatura)\n        })\n        return mapa\n      },\n    },\n    beforeMount() {\n      this.ocuparComboSedes()\n      this.ocuparComboPeriodos()\n      this.datosSeccion = this.$store.state.datosSecciones[this.$store.state.idSeccion - 1]\n      //console.log(JSON.stringify(this.datosSeccion))\n    }\n  }\n</script>\n<style scoped>\n  table {\n    border-collapse: collapse;\n    width: 100%;\n    text-align: center;\n    font-size: 10px;\n  }\n  th {\n    background: #eee;\n  }\n  .nota-recuperada {\n    border: 2px solid #ffa500;\n    box-shadow: 0 0 5px #ffa500;\n  }\n  .desempeno-bajo { background-color: #f8d7da; color: #721c24; }\n  .desempeno-basico { background-color: #d1ecf1; color: #0c5460; }\n  .desempeno-alto { background-color: #fff3cd; color: #856404; }\n  .desempeno-superior { background-color: #d4edda; color: #155724; }\n  .desempeno-extra { background-color: #f4ecf5; color: #2f2e2e; }\n  .promedio-area {\n    background-color: #f2f2f2;\n    font-weight: bold;\n    text-align: center;\n  }\n  .bloque-area th,\n  .bloque-area td {\n    border-right: 3px solid #999; /* lnea divisoria entre reas */\n  }\n\n</style>\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./NotasFaltantes.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./NotasFaltantes.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./NotasFaltantes.vue?vue&type=template&id=71a8e479&scoped=true&\"\nimport script from \"./NotasFaltantes.vue?vue&type=script&lang=js&\"\nexport * from \"./NotasFaltantes.vue?vue&type=script&lang=js&\"\nimport style0 from \"./NotasFaltantes.vue?vue&type=style&index=0&id=71a8e479&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"71a8e479\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('b-row',{staticClass:\"mt-2\"},[_c('b-col',{attrs:{\"lg\":\"12\"}},[_c('b-card',{scopedSlots:_vm._u([{key:\"header\",fn:function(){return [_c('h5',{staticClass:\"mb-0\"},[_c('b-icon',{attrs:{\"icon\":\"card-checklist\",\"aria-hidden\":\"true\"}}),_vm._v(\" CONSOLIDADO NOTAS FALTANTES POR REA\")],1)]},proxy:true}])},[_c('b-card-text',[_c('b-row',[_c('b-col',{attrs:{\"lg\":\"2\"}},[_c('b-form-group',{staticClass:\"etiqueta\",attrs:{\"label\":\"Periodo:\",\"label-for\":\"periodo\"}},[_c('b-form-select',{ref:\"periodo\",attrs:{\"id\":\"periodo\",\"options\":_vm.comboPeriodos},on:{\"change\":function($event){_vm.idSede=null,_vm.idCurso=null}},model:{value:(_vm.idPeriodo),callback:function ($$v) {_vm.idPeriodo=$$v},expression:\"idPeriodo\"}})],1)],1),_c('b-col',{attrs:{\"lg\":\"6\"}},[_c('b-form-group',{staticClass:\"etiqueta\",attrs:{\"label\":\"Seleccione la Sede:\",\"label-for\":\"sedes\"}},[_c('b-form-select',{ref:\"sedes\",attrs:{\"id\":\"sedes\",\"options\":_vm.comboSedes,\"disabled\":_vm.idPeriodo!=null ? false : true},on:{\"change\":function($event){_vm.idCurso=null,_vm.ocuparComboCursosSede()}},model:{value:(_vm.idSede),callback:function ($$v) {_vm.idSede=$$v},expression:\"idSede\"}})],1)],1),_c('b-col',{attrs:{\"lg\":\"4\"}},[_c('b-form-group',{staticClass:\"etiqueta\",attrs:{\"label\":\"Seleccione el Curso:\",\"label-for\":\"cursos\"}},[_c('b-form-select',{ref:\"cursos\",attrs:{\"id\":\"cursos\",\"options\":_vm.comboCursosSede,\"disabled\":_vm.idSede!=null ? false : true},on:{\"change\":function($event){return _vm.consultarEstudiantes()}},model:{value:(_vm.idCurso),callback:function ($$v) {_vm.idCurso=$$v},expression:\"idCurso\"}})],1)],1)],1)],1)],1)],1)],1),_c('b-row',[_c('b-col',{attrs:{\"lg\":\"12\"}},[(_vm.btnCargando)?_c('div',[_c('div',{staticClass:\"text-center m-5 text-primary\"},[_c('b-spinner',{staticStyle:{\"width\":\"3rem\",\"height\":\"3rem\"},attrs:{\"label\":\"Spinner\"}}),_c('br'),_c('strong',[_vm._v(\"Cargando informe...\")])],1)]):_vm._e()])],1),(!_vm.btnCargando && _vm.idCurso!=null)?_c('b-row',[_c('b-col',{attrs:{\"lg\":\"12\"}},[_c('table',{staticClass:\"table-responsive\",attrs:{\"border\":\"1\",\"cellspacing\":\"0\",\"cellpadding\":\"1\"}},[_c('thead',[_c('tr',[_c('th',{attrs:{\"rowspan\":\"3\"}},[_vm._v(\"#\")]),_c('th',{attrs:{\"rowspan\":\"3\"}},[_vm._v(\"Estudiante\")]),_vm._l((_vm.encabezadoPorArea),function(asigs,area){return [_c('th',{key:area,attrs:{\"colspan\":_vm.colspanArea(area) + 1}},[_vm._v(\" \"+_vm._s(area)+\" \")])]}),_c('th',{attrs:{\"rowspan\":\"3\"}},[_vm._v(\"#\")])],2),_c('tr',[_vm._l((_vm.encabezadoPorArea),function(asigs,area){return [_vm._l((asigs),function(asig,k){return [_c('th',{key:'area-' + asig + k,attrs:{\"colspan\":1}},[_vm._v(\" \"+_vm._s(asig)+\" \")])]}),_c('th',{key:'prom-area-' + area,staticClass:\"promedio-area\"},[_vm._v(\"Prom\")]),_c('th',{key:'falta-' + area,staticClass:\"promedio-area\"},[_vm._v(\"Nota\")])]})],2),_c('tr',[_vm._l((_vm.encabezadoPorArea),function(asigs,area){return [_vm._l((asigs),function(asig){return [_c('th',{key:'prom' + asig + area})]}),_c('th',{key:'prom' + area},[_vm._v(\"rea\")]),_c('th',{key:'falta' + area},[_vm._v(\"Falta\")])]})],2)]),_c('tbody',_vm._l((_vm.estudiantesNotas),function(est,nombre,i){return _c('tr',{key:nombre},[_c('td',{staticClass:\"text-left\"},[_vm._v(_vm._s(i + 1))]),_c('td',{staticStyle:{\"text-align\":\"left\"}},[_vm._v(_vm._s(nombre))]),_vm._l((_vm.encabezadoPorArea),function(asigs,area){return [_vm._l((asigs),function(asig){return [_c('td',{key:'prom' + nombre + area + asig,staticClass:\"bloque-area\",staticStyle:{\"font-weight\":\"bold\",\"text-align\":\"center\"}},[_vm._v(\" \"+_vm._s(est.id_conceptual=='N' ? _vm.obtenerPromedioAsignatura(est, area, asig) : '-')+\" \")])]}),_c('td',{key:'promArea' + nombre + area},[_vm._v(\" \"+_vm._s(est.id_conceptual=='N' ? _vm.obtenerPromedioArea(est, area) : '-')+\" \")]),_c('td',{key:'faltaArea' + nombre + area,staticClass:\"promedio-area bloque-area\"},[_c('span',{style:(_vm.redondear((_vm.datosSeccion.minBas * 4) - _vm.obtenerPromedioArea(est, area) * 3).toFixed(1) > 5 ? 'color: red' : '')},[_vm._v(_vm._s(est.id_conceptual=='N' && (_vm.redondear((_vm.datosSeccion.minBas * 4) - _vm.obtenerPromedioArea(est, area) * 3).toFixed(1) < 10) ? _vm.redondear((_vm.datosSeccion.minBas * 4) - _vm.obtenerPromedioArea(est, area) * 3).toFixed(1) : '-'))])])]}),_c('td',{staticClass:\"text-left\"},[_vm._v(_vm._s(i + 1))])],2)}),0)]),_c('div',{staticStyle:{\"margin-bottom\":\"1rem\"}},[_c('b-button',{staticClass:\"small mx-1 mt-3\",attrs:{\"variant\":\"primary\"},on:{\"click\":_vm.imprimir}},[_vm._v(\"Imprimir Consolidado\")]),_c('b-button',{staticClass:\"small mx-1 mt-3\",attrs:{\"variant\":\"outline-primary\"},on:{\"click\":_vm.exportarAExcel}},[_vm._v(\"Exportar a Excel\")])],1)])],1):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div>\n    <b-row class=\"mt-2\">\n      <b-col lg=\"12\">\n        <b-card>\n          <template #header>\n            <h5 class=\"mb-0\"><b-icon icon=\"card-checklist\" aria-hidden=\"true\"></b-icon> CONSOLIDADO NOTAS FALTANTES POR REA</h5>\n          </template>\n          <b-card-text>\n            <b-row>\n              <b-col lg=\"2\">\n                <b-form-group label=\"Periodo:\" label-for=\"periodo\" class=\"etiqueta\">\n                  <b-form-select id=\"periodo\" ref=\"periodo\" v-model=\"idPeriodo\" :options=\"comboPeriodos\" @change=\"idSede=null,idCurso=null\"></b-form-select>\n                </b-form-group>\n              </b-col>\n              <b-col lg=\"6\">\n                <b-form-group label=\"Seleccione la Sede:\" label-for=\"sedes\" class=\"etiqueta\">\n                  <b-form-select  id=\"sedes\" ref=\"sedes\" v-model=\"idSede\" :options=\"comboSedes\" @change=\"idCurso=null,ocuparComboCursosSede()\" :disabled=\"idPeriodo!=null ? false : true\"></b-form-select>\n                </b-form-group>\n              </b-col>\n              <b-col lg=\"4\">\n                <b-form-group label=\"Seleccione el Curso:\" label-for=\"cursos\" class=\"etiqueta\">\n                  <b-form-select id=\"cursos\" ref=\"cursos\" v-model=\"idCurso\" :options=\"comboCursosSede\" @change=\"consultarEstudiantes()\" :disabled=\"idSede!=null ? false : true\"></b-form-select>\n                </b-form-group>\n              </b-col>\n            </b-row>\n          </b-card-text>\n        </b-card>\n      </b-col>\n    </b-row>\n    <b-row>\n      <b-col lg=\"12\">\n        <div v-if=\"btnCargando\">\n          <div class=\"text-center m-5 text-primary\">\n            <b-spinner style=\"width: 3rem; height: 3rem;\" label=\"Spinner\"></b-spinner>\n            <br><strong>Cargando informe...</strong>\n          </div>\n        </div>\n      </b-col>\n    </b-row>\n    <b-row v-if=\"!btnCargando && idCurso!=null\">\n      <b-col lg=\"12\">\n        <table border=\"1\" cellspacing=\"0\" cellpadding=\"1\" class=\"table-responsive\">\n          <thead>\n            <tr>\n              <th rowspan=\"3\">#</th>\n              <th rowspan=\"3\">Estudiante</th>\n              <template v-for=\"(asigs, area) in encabezadoPorArea\">\n                <th :colspan=\"colspanArea(area) + 1\" :key=\"area\">\n                  {{ area }}\n                </th>\n              </template>\n              <th rowspan=\"3\">#</th>\n            </tr>\n            <tr>\n              <template v-for=\"(asigs, area) in encabezadoPorArea\">\n                <template v-for=\"(asig, k) in asigs\">\n                  <th :colspan=\"1\" :key=\"'area-' + asig + k\">\n                    {{ asig }}\n                  </th>\n                </template>\n                <th class=\"promedio-area\" :key=\"'prom-area-' + area\">Prom</th>\n                <th class=\"promedio-area\" :key=\"'falta-' + area\">Nota</th>\n              </template>\n            </tr>\n            <tr>\n              <template v-for=\"(asigs, area) in encabezadoPorArea\">\n                <template v-for=\"asig in asigs\">\n                  <th :key=\"'prom' + asig + area\"></th>\n                </template>\n                <th :key=\"'prom' + area\">rea</th>\n                <th :key=\"'falta' + area\">Falta</th>\n              </template>\n              <!-- columnas finales vacas -->\n            </tr>\n          </thead>\n          <tbody>\n            <tr v-for=\"(est, nombre, i) in estudiantesNotas\" :key=\"nombre\">\n              <td class=\"text-left\">{{ i + 1 }}</td>\n              <td style=\"text-align: left\">{{ nombre }}</td>\n              <template v-for=\"(asigs, area) in encabezadoPorArea\">\n                <template v-for=\"asig in asigs\">\n                  <td class=\"bloque-area\" :key=\"'prom' + nombre + area + asig\" style=\"font-weight: bold; text-align: center;\">\n                    {{ est.id_conceptual=='N' ? obtenerPromedioAsignatura(est, area, asig) : '-' }}\n                  </td>\n                </template>\n                <td class=\"\" :key=\"'promArea' + nombre + area\">\n                  {{ est.id_conceptual=='N' ? obtenerPromedioArea(est, area) : '-' }}\n                </td>\n                <td class=\"promedio-area bloque-area\" :key=\"'faltaArea' + nombre + area\">\n                  <span :style=\"redondear((datosSeccion.minBas * 4) - obtenerPromedioArea(est, area) * 3).toFixed(1) > 5 ? 'color: red' : ''\">{{ est.id_conceptual=='N' && (redondear((datosSeccion.minBas * 4) - obtenerPromedioArea(est, area) * 3).toFixed(1) < 10) ? redondear((datosSeccion.minBas * 4) - obtenerPromedioArea(est, area) * 3).toFixed(1) : '-' }}</span>\n                </td>\n              </template>\n\n              <td class=\"text-left\">{{ i + 1 }}</td>\n            </tr>\n          </tbody>\n        </table>\n        <div style=\"margin-bottom: 1rem\">\n          <b-button class=\"small mx-1 mt-3\" variant=\"primary\" @click=\"imprimir\">Imprimir Consolidado</b-button>\n          <b-button class=\"small mx-1 mt-3\" variant=\"outline-primary\" @click=\"exportarAExcel\">Exportar a Excel</b-button>\n        </div>\n      </b-col>\n    </b-row>\n  </div>\n</template>\n\n<script>\n  import axios from \"axios\"\n  import * as CONFIG from '@/assets/config.js'\n  import * as XLSX from 'xlsx'\n\n  export default {\n    name: 'notasfaltantesarea',\n    components: {\n    },\n    data () {\n      return {\n        idSede: null,\n        comboSedes: [],\n        idPeriodo: null,\n        comboPeriodos: null,\n        idCurso: null,\n        comboCursosSede: [],\n        nombreSede: null,\n        nombreCurso: null,\n        idNivel: null,\n        btnCargando: false,\n        datosRaw: [],\n        datosSeccion: {},\n        listaAreasAsignaturas: [],\n        periodosVisibles: []\n      }\n    },\n    methods: {\n      colspanArea(area) {\n        const asignaturas = this.encabezadoPorArea[area] || []\n        const columnasPorAsignatura = 1 //this.periodosVisibles.length + 1\n        const extraColumnaPromArea = 1\n        return (asignaturas.length * columnasPorAsignatura) + extraColumnaPromArea\n      },\n\n      totalBajosPorPeriodo(area, asignatura, periodo) {\n        let total = 0\n        const meta = this.listaAreasAsignaturas.find(\n          a => a.area === area && a.asignatura === asignatura\n        )\n        const idTipoEspecialidad = meta?.idTipoEspecialidad\n        Object.values(this.estudiantesNotas).forEach(est => {\n          const nota = est?.areas?.[area]?.asignaturas?.[asignatura]?.periodos?.[periodo]\n          if (idTipoEspecialidad === 1) {\n            if (nota > 0 && nota < this.datosSeccion.minBas) total++\n          } else {\n            if (nota > 0 && nota < this.datosSeccion.minBasT) total++\n          }\n        })\n        return total\n      },\n      totalBajosPromedioAsignatura(area, asignatura) {\n        let total = 0\n        const meta = this.listaAreasAsignaturas.find(\n          a => a.area === area && a.asignatura === asignatura\n        )\n        const idTipoEspecialidad = meta?.idTipoEspecialidad\n        Object.values(this.estudiantesNotas).forEach(est => {\n          const asig = est?.areas?.[area]?.asignaturas?.[asignatura]\n          if (!asig) return\n          const prom = parseFloat(this.calcularPromedioAsignatura(asig))\n          if (idTipoEspecialidad === 1) {\n            if (prom < this.datosSeccion.minBas) total++\n          } else {\n            if (prom < this.datosSeccion.minBasT) total++\n          }\n        })\n        return total\n      },\n      totalBajosPromedioArea(area) {\n        let total = 0\n        Object.values(this.estudiantesNotas).forEach(est => {\n          const prom = parseFloat(this.obtenerPromedioArea(est, area))\n          if (!isNaN(prom) && prom < this.datosSeccion.minBas) total++\n        })\n        return total\n      },\n      totalesGlobales() {\n        let bajo = 0, basico = 0, alto = 0, superior = 0, ausJ = 0, ausS = 0\n        Object.values(this.estudiantesNotas).forEach(est => {\n          bajo += this.contarDesempenoEstudiante(est.areas, 'bajo')\n          basico += this.contarDesempenoEstudiante(est.areas, 'basico')\n          alto += this.contarDesempenoEstudiante(est.areas, 'alto')\n          superior += this.contarDesempenoEstudiante(est.areas, 'superior')\n          ausJ += est.ausJ || 0\n          ausS += est.ausS || 0\n        })\n\n        return { bajo, basico, alto, superior, ausJ, ausS }\n      },\n      esAreaValida(area) {\n        //const asigns = this.listaAreasAsignaturas.filter(a => a.area === area)\n        //return asigns.some(a => a.orden !== 99)\n        const asigns = this.listaAreasAsignaturas.filter(a => a.area === area)\n        if (asigns.some(a => a.orden !== 99 && a.orden !== 98)) return true\n        else if (asigns.some(a => a.orden === 99) && this.datosSeccion.promCompor == 1) return true\n        else return false\n      },\n      obtenerPromedioArea(est, area) {\n        const areaData = est.areas && est.areas[area]\n        return areaData ? this.calcularPromedioArea(areaData) : ''\n      },\n      obtenerNota(est, area, asignatura, periodo) {\n        let nota = est?.areas?.[area]?.asignaturas?.[asignatura]?.periodos?.[periodo]\n        if (nota === 0) nota = ''\n        return typeof nota === 'number' ? nota.toFixed(1) : nota\n      },\n      obtenerPromedioAsignatura(est, area, asignatura) {\n        const asig = est?.areas?.[area]?.asignaturas?.[asignatura]\n        return asig ? this.calcularPromedioAsignatura(asig) : ''\n      },\n      calcularPromedioAsignatura(asig) {\n        const pesos = asig.pesos\n        const periodos = asig.periodos\n        const orden = asig.orden\n        if (orden === 99 && this.datosSeccion.promCompor == 0) return '-'\n        let total = 0\n        let cantidad = 0 // nuevo\n        for (let p = 1; p <= 4; p++) {\n          const nota = periodos[p] ?? 0\n          total += nota\n          if (nota > 0) cantidad++\n        }\n        if (total === 0) return ''\n        const promedio = total / cantidad\n        //const promedio = total / this.idPeriodo\n        return this.redondear(promedio).toFixed(1)\n      },\n      calcularPromedioArea(areaData) {\n        const asigns = Object.values(areaData.asignaturas)\n        if (!asigns.length) return '0.00'\n        let total = 0\n        asigns.forEach(asig => {\n          if (asig.orden === 99 && this.datosSeccion.promCompor == 0) return '-'\n          total += parseFloat((this.calcularPromedioAsignatura(asig) * asig.porcentaje) / 100)\n        })\n        return total > 0 ?  this.redondear(total).toFixed(1) : ''\n      },\n      calcularPromedioGeneral(est) {\n        const areas = Object.keys(est.areas || {})\n        let total = 0\n        let cantidad = 0\n        areas.forEach(area => {\n          if (!this.esAreaValida(area)) return\n          const promedio = parseFloat(this.calcularPromedioArea(est.areas[area]))\n          if (!isNaN(promedio)) {\n            total += promedio\n            cantidad++\n          }\n        })\n        return cantidad > 0 ? (total / cantidad).toFixed(3) : ''\n      },\n      contarAusencias(tipo) {\n        let total = 0\n        Object.values(this.estudiantesNotas).forEach(est => {\n          if (tipo === 'ausJ') total += est.ausJ || 0\n          if (tipo === 'ausS') total += est.ausS || 0\n        })\n        return total\n      },\n      contarNotasPorAsignatura(area, asignatura, tipo) {\n        let contador = 0\n        Object.values(this.estudiantesNotas).forEach(est => {\n          const nota = est?.[area]?.[asignatura]?.nota\n          const val = est?.[area]?.[asignatura]?.idTipoEspecialidad\n          if (typeof nota !== 'number') return\n          if (val === 1) {\n            if (tipo === 'bajo' && nota < this.datosSeccion.minBas) contador++\n            else if (tipo === 'basico' && nota >= this.datosSeccion.minBas && nota < this.datosSeccion.minAlt) contador++\n            else if (tipo === 'alto' && nota >= this.datosSeccion.minAlt && nota < this.datosSeccion.minSup) contador++\n            else if (tipo === 'superior' && nota >= this.datosSeccion.minSup && nota <= this.datosSeccion.maxSup) contador++\n          } else {\n            if (tipo === 'bajo' && nota < this.datosSeccion.minBasT) contador++\n            else if (tipo === 'basico' && nota >= this.datosSeccion.minBasT && nota < this.datosSeccion.minAltT) contador++\n            else if (tipo === 'alto' && nota >= this.datosSeccion.minAltT && nota < this.datosSeccion.minSupT) contador++\n            else if (tipo === 'superior' && nota >= this.datosSeccion.minSupT && nota <= this.datosSeccion.maxSupT) contador++\n          }\n        })\n        return contador\n      },\n      contarNotasTotales(tipo) {\n        let total = 0\n        Object.values(this.estudiantesNotas).forEach(est => {\n          this.listaAreasAsignaturas.forEach(({ area, asignatura }) => {\n            const nota = est?.[area]?.[asignatura]?.nota\n            const val = est?.[area]?.[asignatura]?.idTipoEspecialidad\n            if (typeof nota !== 'number') return\n            if (val === 1) {\n              if (tipo === 'bajo' && nota < this.datosSeccion.minBas) total++\n              else if (tipo === 'basico' && nota >= this.datosSeccion.minBas && nota < this.datosSeccion.minAlt) total++\n              else if (tipo === 'alto' && nota >= this.datosSeccion.minAlt && nota < this.datosSeccion.minSup) total++\n              else if (tipo === 'superior' && nota >= this.datosSeccion.minSup && nota <= this.datosSeccion.maxSup) total++\n            } else {\n              if (tipo === 'bajo' && nota < this.datosSeccion.minBasT) total++\n              else if (tipo === 'basico' && nota >= this.datosSeccion.minBasT && nota < this.datosSeccion.minAltT) total++\n              else if (tipo === 'alto' && nota >= this.datosSeccion.minAltT && nota < this.datosSeccion.minSupT) total++\n              else if (tipo === 'superior' && nota >= this.datosSeccion.minSupT && nota <= this.datosSeccion.maxSupT) total++\n            }\n          })\n        })\n        return total\n      },\n      iconoPuesto(puesto) {\n        if (puesto === 1) return ''\n        if (puesto === 2) return ''\n        if (puesto === 3) return ''\n        return ''\n      },\n      contarDesempenoEstudiante(areas, tipo) {\n        let contador = 0\n        Object.values(areas || {}).forEach(area => {\n          Object.values(area.asignaturas || {}).forEach(asig => {\n            const nota = parseFloat(this.calcularPromedioAsignatura(asig))\n            const val =  asig.idTipoEspecialidad\n            if (typeof nota !== 'number') return\n            if (val === 1) {\n              if (tipo === 'bajo' && nota < this.datosSeccion.minBas) contador++\n              else if (tipo === 'basico' && nota >= this.datosSeccion.minBas && nota < this.datosSeccion.minAlt) contador++\n              else if (tipo === 'alto' && nota >= this.datosSeccion.minAlt && nota < this.datosSeccion.minSup) contador++\n              else if (tipo === 'superior' && nota >= this.datosSeccion.minSup && nota <= this.datosSeccion.maxSup) contador++\n            } else {\n              if (tipo === 'bajo' && nota < this.datosSeccion.minBasT) contador++\n              else if (tipo === 'basico' && nota >= this.datosSeccion.minBasT && nota < this.datosSeccion.minAltT) contador++\n              else if (tipo === 'alto' && nota >= this.datosSeccion.minAltT && nota < this.datosSeccion.minSupT) contador++\n              else if (tipo === 'superior' && nota >= this.datosSeccion.minSupT && nota <= this.datosSeccion.maxSupT) contador++\n            }\n          })\n        })\n        return contador\n      },\n      fueRecuperada(areas, area, asig) {\n        return areas?.[area]?.[asig]?.fueRecuperada ?? false\n      },\n      obtenerOriginal(areas, area, asig) {\n        const val = areas?.[area]?.[asig]?.original\n        return typeof val === 'number' ? val.toFixed(1) : '0.0'\n      },\n      obtenerRecuperacion(areas, area, asig) {\n        const val = areas?.[area]?.[asig]?.recuperacion\n        return typeof val === 'number' ? val.toFixed(1) : '0.0'\n      },\n      obtenerColor(nota, areas, area, asig) {\n        const val = areas?.[area]?.[asig]?.idTipoEspecialidad\n        if (val === 1) {\n          if (nota < this.datosSeccion.minBas) return 'desempeno-bajo'\n          if (nota < this.datosSeccion.minAlt) return 'desempeno-basico'\n          if (nota < this.datosSeccion.minSup) return 'desempeno-alto'\n          if (nota <= this.datosSeccion.maxSup) return 'desempeno-superior'\n          return 'desempeno-extra'\n        } else {\n          if (nota < this.datosSeccion.minBasT) return 'desempeno-bajo'\n          if (nota < this.datosSeccion.minAltT) return 'desempeno-basico'\n          if (nota < this.datosSeccion.minSupT) return 'desempeno-alto'\n          if (nota <= this.datosSeccion.maxSupT) return 'desempeno-superior'\n          return 'desempeno-extra'\n        }\n      },\n      claseDesempeno(nota) {\n        console.log(nota)\n        if (typeof nota !== 'number') return 'desempeno-extra'\n        if (nota < 3) return 'desempeno-bajo'\n        if (nota < 4) return 'desempeno-basico'\n        if (nota < 4.6) return 'desempeno-alto'\n        if (nota <= 5) return 'desempeno-superior'\n        return 'desempeno-extra'\n      },\n      obtenerColorGeneral(nota) {\n        if (nota < this.datosSeccion.minBas) return 'desempeno-bajo'\n        if (nota < this.datosSeccion.minAlt) return 'desempeno-basico'\n        if (nota < this.datosSeccion.minSup) return 'desempeno-alto'\n        if (nota <= this.datosSeccion.maxSup) return 'desempeno-superior'\n        return 'desempeno-extra'\n      },\n      async consultarEstudiantes() {\n        this.btnCargando = true\n        if (this.idPeriodo == 1) this.periodosVisibles = [1]\n        if (this.idPeriodo == 2) this.periodosVisibles = [1,2]\n        if (this.idPeriodo == 3) this.periodosVisibles = [1,2,3]\n        if (this.idPeriodo == 4) this.periodosVisibles = [1,2,3,4]\n        this.nombreSede = document.getElementById('sedes')[document.getElementById('sedes').selectedIndex].text\n        if (this.idCurso != null) { \n          this.nombreCurso = document.getElementById('cursos')[document.getElementById('cursos').selectedIndex].text\n          this.$store.state.datosCursos.forEach(element => {\n            if (element.id == this.idCurso) {\n              this.idNivel = element.id_nivel\n            }\n          })\n          this.listaAreasAsignaturas = []\n          await axios\n          .get(CONFIG.ROOT_PATH + 'consolidados/areasasignaturas/curso', {params: {idCurso: this.idCurso}})\n          .then(response => {\n            if (response.data.error){\n              this.mensajeEmergente('danger',CONFIG.TITULO_MSG,response.data.mensaje + ' - Lista areas-asignaturas curso')\n              this.btnCargando = false\n            } else{\n              if (response.data.datos != 0) {\n                this.listaAreasAsignaturas = response.data.datos\n              }\n            }\n          })\n          .catch(err => {\n            this.mensajeEmergente('danger',CONFIG.TITULO_MSG,'Algo salio mal y no se pudo realizar: Lista areas-asignaturas curso. Intente ms tarde.' + err)\n            this.btnCargando = false\n          })\n          this.datosRaw = []\n          await axios\n          .get(CONFIG.ROOT_PATH + 'consolidados/asignaturas/curso/acumulado', {params: {idCurso: this.idCurso, periodo: this.idPeriodo, vigencia: this.$store.state.aLectivo}})\n          .then(response => {\n            if (response.data.error){\n              this.mensajeEmergente('danger',CONFIG.TITULO_MSG,response.data.mensaje + ' - Consolidados asignaturas curso periodo')\n              this.btnCargando = false\n            } else{\n              if (response.data.datos != 0) {\n                this.datosRaw = response.data.datos\n              }\n            }\n          })\n          .catch(err => {\n            this.mensajeEmergente('danger',CONFIG.TITULO_MSG,'Algo salio mal y no se pudo realizar: Consolidados asignaturas curso periodo. Intente ms tarde.' + err)\n            this.btnCargando = false\n          })\n        }\n        //console.log(JSON.stringify(this.listaAreasAsignaturas))\n        this.btnCargando = false\n      },\n      imprimir() {\n        let fecha = 'Fecha: ' + new Date().toLocaleString()\n        let tituloInforme = 'CONSOLIDADO NOTAS FALTANTES POR REA'\n        const contenido = document.querySelector('table').outerHTML\n        const ventana = window.open(\"NotaFaltanteArea\", \"_blank\")\n        ventana.document.write(`<html><head><title>NotaFaltanteArea</title></head>\n        <style scoped>\n          table {\n            border-collapse: collapse;\n            width: 100%;\n            text-align: center;\n            font-size: 10px;\n          }\n          th {\n            background: #eee;\n          }\n          .nota-recuperada {\n            border: 2px solid #ffa500;\n            box-shadow: 0 0 5px #ffa500;\n          }\n          .desempeno-bajo { background-color: #f8d7da; color: #721c24; }\n          .desempeno-basico { background-color: #d1ecf1; color: #0c5460; }\n          .desempeno-alto { background-color: #fff3cd; color: #856404; }\n          .desempeno-superior { background-color: #d4edda; color: #155724; }\n          .desempeno-extra { background-color: #f4ecf5; color: #2f2e2e; }\n        </style>\n          <body class=\"container\">\n            <p style=\"text-align: center; font-size: 12px;\">SECRETARA DE EDUCACIN TERRITORIAL DE TUNJA<br><b>${this.$store.state.nombreInstitucion}</b><br>TUNJA - BOYAC<br>${tituloInforme}<br>Sede: ${this.nombreSede} | Curso: ${this.nombreCurso} | Ao Lectivo ${this.$store.state.aLectivo} | Periodo: ${this.idPeriodo}</p>\n            ${contenido}\n            <div style=\"text-align: right; font-size: 12px;\"><i>${fecha}</i></div>\n          </body>\n        </html>`)\n        ventana.document.close()\n        ventana.print()\n      },\n      exportarAExcel() {\n        const tabla = document.querySelector('table')\n        const wb = XLSX.utils.table_to_book(tabla)\n        XLSX.writeFile(wb, 'NotaFaltanteArea.xlsx')\n      },\n      redondear(num) {\n        var m = Number((Math.abs(num) * 10).toPrecision(15))\n        return Math.round(m) / 10 * Math.sign(num);\n      },\n      async ocuparComboCursosSede() {\n        this.comboCursosSede = []\n        this.$store.state.datosCursos.forEach(element => {\n          if (element.id_sede == this.idSede) {\n            this.comboCursosSede.push({ 'value': element.id, 'text': element.nomenclatura.toUpperCase() })\n          }\n        })\n      },\n      async ocuparComboSedes() {\n        this.comboSedes = []\n        this.$store.state.datosSedes.forEach(element => {\n          this.comboSedes.push({ 'value': element.id, 'text': element.sede.toUpperCase() })\n        })\n      },\n      async ocuparComboPeriodos() {\n        this.comboPeriodos = []\n        this.$store.state.periodos.forEach(element => {\n          this.comboPeriodos.push({ 'value': element.id, 'text': element.periodo.toUpperCase() })\n        })\n      },\n      mensajeEmergente(variante, titulo, contenido) {\n        this.$bvToast.toast(contenido, { title: titulo, variant: variante, toaster: \"b-toaster-top-center\", solid: true, autoHideDelay: 4000, appendToast: false })\n      }\n    },\n    computed: {\n      totales() {\n        return this.totalesGlobales()\n      },\n      estudiantesNotas() {\n        const mapa = {}\n        this.datosRaw.forEach(row => {\n          const { estudiante, area, asignatura, periodo, definitiva, recuperacion, orden, definitivacompor, idTipoEspecialidad, ausJ, ausS, porcentaje, id_conceptual } = row\n          if (!mapa[estudiante]) {\n            mapa[estudiante] = { id_conceptual, ausJ: 0, ausS: 0, areas: {} }\n          }\n          if (!mapa[estudiante].areas[area]) {\n            mapa[estudiante].areas[area] = { asignaturas: {} }\n          }\n          if (!mapa[estudiante].areas[area].asignaturas[asignatura]) {\n            mapa[estudiante].areas[area].asignaturas[asignatura] = {\n              periodos: {},\n              orden,\n              idTipoEspecialidad,\n              porcentaje,\n              pesos: { 1: 0.2, 2: 0.2, 3: 0.3, 4: 0.3 }\n            }\n          }\n          let notaFinal = 0\n          if (orden === 99) {\n            if (this.datosSeccion.tipoValComp == 1) {\n              notaFinal = definitiva\n            } else {\n              notaFinal = definitivacompor != null ? definitivacompor : ''\n            }\n          } else {\n            notaFinal = recuperacion > definitiva ? recuperacion : definitiva\n          }\n          mapa[estudiante].areas[area].asignaturas[asignatura].periodos[periodo] = notaFinal\n          mapa[estudiante].ausJ += ausJ || 0\n          mapa[estudiante].ausS += ausS || 0\n        })\n        return mapa\n      },\n      totalColumnasPromedioArea() {\n        const areasUnicas = new Set(this.listaAreasAsignaturas.map(a => a.area))\n        return areasUnicas.size\n      },\n      puestosPorEstudiante() {\n        const lista = Object.entries(this.estudiantesNotas).map(([nombre, areas]) => {\n          const promedio = parseFloat(this.calcularPromedioGeneral(areas))\n          return { nombre, promedio: isNaN(promedio) ? 0 : promedio }\n        })\n        // Ordenar de mayor a menor\n        lista.sort((a, b) => b.promedio - a.promedio)\n        const puestos = {}\n        let puestoActual = 1\n        let contador = 1\n        let ultimoPromedio = null\n        lista.forEach(est => {\n          if (est.promedio !== ultimoPromedio) {\n            puestoActual = contador\n            ultimoPromedio = est.promedio\n          }\n          puestos[est.nombre] = puestoActual\n          contador++\n        })\n        return puestos\n      },\n      encabezadoPorArea() {\n        const mapa = {}\n        this.listaAreasAsignaturas.forEach(({ area, asignatura }) => {\n          if (!mapa[area]) mapa[area] = []\n          mapa[area].push(asignatura)\n        })\n        return mapa\n      },\n    },\n    beforeMount() {\n      this.ocuparComboSedes()\n      this.ocuparComboPeriodos()\n      this.datosSeccion = this.$store.state.datosSecciones[this.$store.state.idSeccion - 1]\n      //console.log(JSON.stringify(this.datosSeccion))\n    }\n  }\n</script>\n<style scoped>\n  table {\n    border-collapse: collapse;\n    width: 100%;\n    text-align: center;\n    font-size: 10px;\n  }\n  th {\n    background: #eee;\n  }\n  .nota-recuperada {\n    border: 2px solid #ffa500;\n    box-shadow: 0 0 5px #ffa500;\n  }\n  .desempeno-bajo { background-color: #f8d7da; color: #721c24; }\n  .desempeno-basico { background-color: #d1ecf1; color: #0c5460; }\n  .desempeno-alto { background-color: #fff3cd; color: #856404; }\n  .desempeno-superior { background-color: #d4edda; color: #155724; }\n  .desempeno-extra { background-color: #f4ecf5; color: #2f2e2e; }\n  .promedio-area {\n    background-color: #f2f2f2;\n    font-weight: bold;\n    text-align: center;\n  }\n  .bloque-area th,\n  .bloque-area td {\n    border-right: 3px solid #999; /* lnea divisoria entre reas */\n  }\n\n</style>\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./NotasFaltantesArea.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./NotasFaltantesArea.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./NotasFaltantesArea.vue?vue&type=template&id=f8e70a2a&scoped=true&\"\nimport script from \"./NotasFaltantesArea.vue?vue&type=script&lang=js&\"\nexport * from \"./NotasFaltantesArea.vue?vue&type=script&lang=js&\"\nimport style0 from \"./NotasFaltantesArea.vue?vue&type=style&index=0&id=f8e70a2a&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"f8e70a2a\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('b-row',{staticClass:\"mt-2\"},[_c('b-col',{attrs:{\"lg\":\"12\"}},[_c('b-card',{scopedSlots:_vm._u([{key:\"header\",fn:function(){return [_c('h5',{staticClass:\"mb-0\"},[_c('b-icon',{attrs:{\"icon\":\"card-checklist\",\"aria-hidden\":\"true\"}}),_vm._v(\" CONSOLIDADO EVALUACIONES ACUMULADO PONDERADO\")],1)]},proxy:true}])},[_c('b-card-text',[_c('b-row',[_c('b-col',{attrs:{\"lg\":\"2\"}},[_c('b-form-group',{staticClass:\"etiqueta\",attrs:{\"label\":\"Periodo:\",\"label-for\":\"periodo\"}},[_c('b-form-select',{ref:\"periodo\",attrs:{\"id\":\"periodo\",\"options\":_vm.comboPeriodos},on:{\"change\":function($event){_vm.idSede=null,_vm.idCurso=null}},model:{value:(_vm.idPeriodo),callback:function ($$v) {_vm.idPeriodo=$$v},expression:\"idPeriodo\"}})],1)],1),_c('b-col',{attrs:{\"lg\":\"6\"}},[_c('b-form-group',{staticClass:\"etiqueta\",attrs:{\"label\":\"Seleccione la Sede:\",\"label-for\":\"sedes\"}},[_c('b-form-select',{ref:\"sedes\",attrs:{\"id\":\"sedes\",\"options\":_vm.comboSedes,\"disabled\":_vm.idPeriodo!=null ? false : true},on:{\"change\":function($event){_vm.idCurso=null,_vm.ocuparComboCursosSede()}},model:{value:(_vm.idSede),callback:function ($$v) {_vm.idSede=$$v},expression:\"idSede\"}})],1)],1),_c('b-col',{attrs:{\"lg\":\"4\"}},[_c('b-form-group',{staticClass:\"etiqueta\",attrs:{\"label\":\"Seleccione el Curso:\",\"label-for\":\"cursos\"}},[_c('b-form-select',{ref:\"cursos\",attrs:{\"id\":\"cursos\",\"options\":_vm.comboCursosSede,\"disabled\":_vm.idSede!=null ? false : true},on:{\"change\":function($event){return _vm.consultarEstudiantes()}},model:{value:(_vm.idCurso),callback:function ($$v) {_vm.idCurso=$$v},expression:\"idCurso\"}})],1)],1)],1)],1)],1)],1)],1),_c('b-row',[_c('b-col',{attrs:{\"lg\":\"12\"}},[(_vm.btnCargando)?_c('div',[_c('div',{staticClass:\"text-center m-5 text-primary\"},[_c('b-spinner',{staticStyle:{\"width\":\"3rem\",\"height\":\"3rem\"},attrs:{\"label\":\"Spinner\"}}),_c('br'),_c('strong',[_vm._v(\"Cargando informe...\")])],1)]):_vm._e()])],1),(!_vm.btnCargando && _vm.idCurso!=null)?_c('b-row',[_c('b-col',{attrs:{\"lg\":\"12\"}},[_c('table',{staticClass:\"table-responsive\",attrs:{\"border\":\"1\",\"cellspacing\":\"0\",\"cellpadding\":\"1\"}},[_c('thead',[_c('tr',[_c('th',{attrs:{\"rowspan\":\"3\"}},[_vm._v(\"#\")]),_c('th',{attrs:{\"rowspan\":\"3\"}},[_vm._v(\"Estudiante\")]),_vm._l((_vm.encabezadoPorArea),function(asigs,area){return [_c('th',{key:area,attrs:{\"colspan\":asigs.length * 5 + 1}},[_vm._v(_vm._s(area))])]}),_c('th',{attrs:{\"rowspan\":\"2\"}},[_vm._v(\"AuJ\")]),_c('th',{attrs:{\"rowspan\":\"2\"}},[_vm._v(\"AuS\")])],2),_c('tr',[_vm._l((_vm.encabezadoPorArea),function(asigs,area){return [_vm._l((asigs),function(asig,k){return [_c('th',{key:'area-' + asig + k,attrs:{\"colspan\":\"5\"}},[_vm._v(_vm._s(asig))])]}),_c('th',{key:'prom-area-' + area,attrs:{\"rowspan\":\"2\"}},[_vm._v(\"PRO AR\")])]})],2),_c('tr',[_vm._l((_vm.encabezadoPorArea),function(asigs,area){return [_vm._l((asigs),function(asig){return [_c('th',{key:'p1' + asig + area},[_vm._v(\"P1\")]),_c('th',{key:'p2' + asig + area},[_vm._v(\"P2\")]),_c('th',{key:'p3' + asig + area},[_vm._v(\"P3\")]),_c('th',{key:'p4' + asig + area},[_vm._v(\"P4\")]),_c('th',{key:'prom' + asig + area},[_vm._v(\"PR\")])]})]}),_c('th'),_vm._v(\" \"),_c('th')],2)]),_c('tbody',_vm._l((_vm.estudiantesNotas),function(est,nombre,i){return _c('tr',{key:nombre},[_c('td',{staticClass:\"text-left\"},[_vm._v(_vm._s(i + 1))]),_c('td',{staticStyle:{\"text-align\":\"left\"}},[_vm._v(_vm._s(nombre))]),_vm._l((_vm.encabezadoPorArea),function(asigs,area){return [_vm._l((asigs),function(asig){return [_vm._l(([1,2,3,4]),function(p){return _c('td',{key:nombre + area + asig + p},[_vm._v(\" \"+_vm._s(_vm.obtenerNota(est, area, asig, p))+\" \")])}),_c('td',{key:'prom' + nombre + area + asig},[_vm._v(\" \"+_vm._s(_vm.obtenerPromedioAsignatura(est, area, asig))+\" \")])]}),_c('td',{key:'promArea' + nombre + area},[_vm._v(\" \"+_vm._s(_vm.obtenerPromedioArea(est, area))+\" \")])]}),_c('td',[_vm._v(_vm._s(est.ausJ))]),_c('td',[_vm._v(_vm._s(est.ausS))])],2)}),0)]),_c('div',{staticStyle:{\"margin-bottom\":\"1rem\"}},[_c('b-button',{staticClass:\"small mx-1 mt-3\",attrs:{\"variant\":\"primary\"},on:{\"click\":_vm.imprimir}},[_vm._v(\"Imprimir Consolidado\")]),_c('b-button',{staticClass:\"small mx-1 mt-3\",attrs:{\"variant\":\"outline-primary\"},on:{\"click\":_vm.exportarAExcel}},[_vm._v(\"Exportar a Excel\")])],1)])],1):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div>\n    <b-row class=\"mt-2\">\n      <b-col lg=\"12\">\n        <b-card>\n          <template #header>\n            <h5 class=\"mb-0\"><b-icon icon=\"card-checklist\" aria-hidden=\"true\"></b-icon> CONSOLIDADO EVALUACIONES ACUMULADO PONDERADO</h5>\n          </template>\n          <b-card-text>\n            <b-row>\n              <b-col lg=\"2\">\n                <b-form-group label=\"Periodo:\" label-for=\"periodo\" class=\"etiqueta\">\n                  <b-form-select id=\"periodo\" ref=\"periodo\" v-model=\"idPeriodo\" :options=\"comboPeriodos\" @change=\"idSede=null,idCurso=null\"></b-form-select>\n                </b-form-group>\n              </b-col>\n              <b-col lg=\"6\">\n                <b-form-group label=\"Seleccione la Sede:\" label-for=\"sedes\" class=\"etiqueta\">\n                  <b-form-select  id=\"sedes\" ref=\"sedes\" v-model=\"idSede\" :options=\"comboSedes\" @change=\"idCurso=null,ocuparComboCursosSede()\" :disabled=\"idPeriodo!=null ? false : true\"></b-form-select>\n                </b-form-group>\n              </b-col>\n              <b-col lg=\"4\">\n                <b-form-group label=\"Seleccione el Curso:\" label-for=\"cursos\" class=\"etiqueta\">\n                  <b-form-select id=\"cursos\" ref=\"cursos\" v-model=\"idCurso\" :options=\"comboCursosSede\" @change=\"consultarEstudiantes()\" :disabled=\"idSede!=null ? false : true\"></b-form-select>\n                </b-form-group>\n              </b-col>\n            </b-row>\n          </b-card-text>\n        </b-card>\n      </b-col>\n    </b-row>\n    <b-row>\n      <b-col lg=\"12\">\n        <div v-if=\"btnCargando\">\n          <div class=\"text-center m-5 text-primary\">\n            <b-spinner style=\"width: 3rem; height: 3rem;\" label=\"Spinner\"></b-spinner>\n            <br><strong>Cargando informe...</strong>\n          </div>\n        </div>\n      </b-col>\n    </b-row>\n    <b-row v-if=\"!btnCargando && idCurso!=null\">\n      <b-col lg=\"12\">\n        <table border=\"1\" cellspacing=\"0\" cellpadding=\"1\" class=\"table-responsive\">\n          <thead>\n            <tr>\n              <th rowspan=\"3\">#</th>\n              <th rowspan=\"3\">Estudiante</th>\n              <template v-for=\"(asigs, area) in encabezadoPorArea\">\n                <th :colspan=\"asigs.length * 5 + 1\" :key=\"area\">{{ area }}</th>\n              </template>\n              <th rowspan=\"2\">AuJ</th>\n              <th rowspan=\"2\">AuS</th>\n            </tr>\n            <tr>\n              <template v-for=\"(asigs, area) in encabezadoPorArea\">\n                <template v-for=\"(asig, k) in asigs\">\n                  <th colspan=\"5\" :key=\"'area-' + asig + k\">{{ asig }}</th>\n                </template>\n                <th rowspan=\"2\" :key=\"'prom-area-' + area\">PRO AR</th>\n              </template>\n            </tr>\n            <tr>\n              <template v-for=\"(asigs, area) in encabezadoPorArea\">\n                <template v-for=\"asig in asigs\">\n                  <th :key=\"'p1' + asig + area\">P1</th>\n                  <th :key=\"'p2' + asig + area\">P2</th>\n                  <th :key=\"'p3' + asig + area\">P3</th>\n                  <th :key=\"'p4' + asig + area\">P4</th>\n                  <th :key=\"'prom' + asig + area\">PR</th>\n                </template>\n              </template>\n              <th></th> <!-- Prom. General -->\n              <th></th>\n            </tr>\n          </thead>\n          <tbody>\n            <tr v-for=\"(est, nombre, i) in estudiantesNotas\" :key=\"nombre\">\n              <td class=\"text-left\">{{ i + 1 }}</td>\n              <td style=\"text-align: left\">{{ nombre }}</td>\n              <template v-for=\"(asigs, area) in encabezadoPorArea\">\n                <template v-for=\"asig in asigs\">\n                  <td v-for=\"p in [1,2,3,4]\" :key=\"nombre + area + asig + p\">\n                    {{ obtenerNota(est, area, asig, p) }}\n                  </td>\n                  <td :key=\"'prom' + nombre + area + asig\">\n                    {{ obtenerPromedioAsignatura(est, area, asig) }}\n                  </td>\n                </template>\n                <td :key=\"'promArea' + nombre + area\">\n                  {{ obtenerPromedioArea(est, area) }}\n                </td>\n              </template>\n\n              <td>{{ est.ausJ }}</td>\n              <td>{{ est.ausS }}</td>\n            </tr>\n          </tbody>\n        </table>\n        <div style=\"margin-bottom: 1rem\">\n          <b-button class=\"small mx-1 mt-3\" variant=\"primary\" @click=\"imprimir\">Imprimir Consolidado</b-button>\n          <b-button class=\"small mx-1 mt-3\" variant=\"outline-primary\" @click=\"exportarAExcel\">Exportar a Excel</b-button>\n        </div>\n      </b-col>\n    </b-row>\n  </div>\n</template>\n\n<script>\n  import axios from \"axios\"\n  import * as CONFIG from '@/assets/config.js'\n  import * as XLSX from 'xlsx'\n\n  export default {\n    name: 'consolidadoponderado',\n    components: {\n    },\n    data () {\n      return {\n        idSede: null,\n        comboSedes: [],\n        idPeriodo: null,\n        comboPeriodos: null,\n        idCurso: null,\n        comboCursosSede: [],\n        nombreSede: null,\n        nombreCurso: null,\n        idNivel: null,\n        btnCargando: false,\n        datosRaw: [],\n        datosSeccion: {},\n        listaAreasAsignaturas: [],\n      }\n    },\n    methods: {\n      obtenerPromedioArea(est, area) {\n        const areaData = est.areas && est.areas[area]\n        return areaData ? this.calcularPromedioArea(areaData) : '0.0'\n      },\n      obtenerNota(est, area, asignatura, periodo) {\n        const nota = est?.areas?.[area]?.asignaturas?.[asignatura]?.periodos?.[periodo]\n        return typeof nota === 'number' ? nota.toFixed(1) : nota\n      },\n      obtenerPromedioAsignatura(est, area, asignatura) {\n        const asig = est?.areas?.[area]?.asignaturas?.[asignatura]\n        return asig ? this.calcularPromedioAsignatura(asig) : '0.0'\n      },\n      calcularPromedioAsignatura(asig) {\n        const pesos = asig.pesos\n        const periodos = asig.periodos\n        const orden = asig.orden\n        if (orden === 99) return ''\n        let total = 0\n        if (this.$store.state.idInstitucion == 'eb58bf60-fc83-11ec-a1d1-1dc2835404e5' && orden == 55) { // Exploracin Vocacional Inem 55\n          let cantidad = 0\n          for (let p = 1; p <= 4; p++) {\n            const nota = periodos[p] ?? 0\n            if (nota > 0) {\n              total += nota\n              cantidad++\n            }\n          }\n          if (total === 0) return ''\n          total = total / cantidad\n        } else {\n          for (let p = 1; p <= 4; p++) {\n            const nota = periodos[p] ?? 0\n            total += nota * pesos[p] / 100\n          }\n        }\n        return this.redondear(total).toFixed(1)\n      },\n      calcularPromedioArea(areaData) {\n        const asigns = Object.values(areaData.asignaturas)\n        if (!asigns.length) return '0.0'\n        let total = 0\n        asigns.forEach(asig => {\n          total += parseFloat(this.calcularPromedioAsignatura(asig))\n        })\n        return (total / asigns.length).toFixed(1)\n      },\n      calcularPromedioGeneral(est) {\n        const areas = Object.values(est.areas)\n        if (!areas.length) return '0.00'\n        let total = 0\n        areas.forEach(area => {\n          total += parseFloat(this.calcularPromedioArea(area))\n        })\n        return (total / areas.length).toFixed(1)\n      },\n      contarAusencias(tipo) {\n        let total = 0\n        Object.values(this.estudiantesNotas).forEach(est => {\n          if (tipo === 'ausJ') total += est.ausJ || 0\n          if (tipo === 'ausS') total += est.ausS || 0\n        })\n        return total\n      },\n      contarNotasPorAsignatura(area, asignatura, tipo) {\n        let contador = 0\n        Object.values(this.estudiantesNotas).forEach(est => {\n          const nota = est?.[area]?.[asignatura]?.nota\n          const val = est?.[area]?.[asignatura]?.idTipoEspecialidad\n          if (typeof nota !== 'number') return\n          if (val === 1) {\n            if (tipo === 'bajo' && nota < this.datosSeccion.minBas) contador++\n            else if (tipo === 'basico' && nota >= this.datosSeccion.minBas && nota < this.datosSeccion.minAlt) contador++\n            else if (tipo === 'alto' && nota >= this.datosSeccion.minAlt && nota < this.datosSeccion.minSup) contador++\n            else if (tipo === 'superior' && nota >= this.datosSeccion.minSup && nota <= this.datosSeccion.maxSup) contador++\n          } else {\n            if (tipo === 'bajo' && nota < this.datosSeccion.minBasT) contador++\n            else if (tipo === 'basico' && nota >= this.datosSeccion.minBasT && nota < this.datosSeccion.minAltT) contador++\n            else if (tipo === 'alto' && nota >= this.datosSeccion.minAltT && nota < this.datosSeccion.minSupT) contador++\n            else if (tipo === 'superior' && nota >= this.datosSeccion.minSupT && nota <= this.datosSeccion.maxSupT) contador++\n          }\n        })\n        return contador\n      },\n      contarNotasTotales(tipo) {\n        let total = 0\n        Object.values(this.estudiantesNotas).forEach(est => {\n          this.listaAreasAsignaturas.forEach(({ area, asignatura }) => {\n            const nota = est?.[area]?.[asignatura]?.nota\n            const val = est?.[area]?.[asignatura]?.idTipoEspecialidad\n            if (typeof nota !== 'number') return\n          if (val === 1) {\n            if (tipo === 'bajo' && nota < this.datosSeccion.minBas) total++\n            else if (tipo === 'basico' && nota >= this.datosSeccion.minBas && nota < this.datosSeccion.minAlt) total++\n            else if (tipo === 'alto' && nota >= this.datosSeccion.minAlt && nota < this.datosSeccion.minSup) total++\n            else if (tipo === 'superior' && nota >= this.datosSeccion.minSup && nota <= this.datosSeccion.maxSup) total++\n          } else {\n            if (tipo === 'bajo' && nota < this.datosSeccion.minBasT) total++\n            else if (tipo === 'basico' && nota >= this.datosSeccion.minBasT && nota < this.datosSeccion.minAltT) total++\n            else if (tipo === 'alto' && nota >= this.datosSeccion.minAltT && nota < this.datosSeccion.minSupT) total++\n            else if (tipo === 'superior' && nota >= this.datosSeccion.minSupT && nota <= this.datosSeccion.maxSupT) total++\n          }\n          })\n        })\n        return total\n      },\n      iconoPuesto(puesto) {\n        if (puesto === 1) return ''\n        if (puesto === 2) return ''\n        if (puesto === 3) return ''\n        return ''\n      },\n      contarDesempenoEstudiante(estAreas, tipo) {\n        let contador = 0\n        this.listaAreasAsignaturas.forEach(({ area, asignatura }) => {\n          const nota = estAreas?.[area]?.[asignatura]?.nota\n          const val =  estAreas?.[area]?.[asignatura]?.idTipoEspecialidad\n          if (typeof nota !== 'number') return\n          if (val === 1) {\n            if (tipo === 'bajo' && nota < this.datosSeccion.minBas) contador++\n            else if (tipo === 'basico' && nota >= this.datosSeccion.minBas && nota < this.datosSeccion.minAlt) contador++\n            else if (tipo === 'alto' && nota >= this.datosSeccion.minAlt && nota < this.datosSeccion.minSup) contador++\n            else if (tipo === 'superior' && nota >= this.datosSeccion.minSup && nota <= this.datosSeccion.maxSup) contador++\n          } else {\n            if (tipo === 'bajo' && nota < this.datosSeccion.minBasT) contador++\n            else if (tipo === 'basico' && nota >= this.datosSeccion.minBasT && nota < this.datosSeccion.minAltT) contador++\n            else if (tipo === 'alto' && nota >= this.datosSeccion.minAltT && nota < this.datosSeccion.minSupT) contador++\n            else if (tipo === 'superior' && nota >= this.datosSeccion.minSupT && nota <= this.datosSeccion.maxSupT) contador++\n          }\n        })\n        return contador\n      },\n      fueRecuperada(areas, area, asig) {\n        return areas?.[area]?.[asig]?.fueRecuperada ?? false\n      },\n      obtenerOriginal(areas, area, asig) {\n        const val = areas?.[area]?.[asig]?.original\n        return typeof val === 'number' ? val.toFixed(1) : '0.0'\n      },\n      obtenerRecuperacion(areas, area, asig) {\n        const val = areas?.[area]?.[asig]?.recuperacion\n        return typeof val === 'number' ? val.toFixed(1) : '0.0'\n      },\n      obtenerColor(nota, areas, area, asig) {\n        const val = areas?.[area]?.[asig]?.idTipoEspecialidad\n        if (val === 1) {\n          if (nota < this.datosSeccion.minBas) return 'desempeno-bajo'\n          if (nota < this.datosSeccion.minAlt) return 'desempeno-basico'\n          if (nota < this.datosSeccion.minSup) return 'desempeno-alto'\n          if (nota <= this.datosSeccion.maxSup) return 'desempeno-superior'\n          return 'desempeno-extra'\n        } else {\n          if (nota < this.datosSeccion.minBasT) return 'desempeno-bajo'\n          if (nota < this.datosSeccion.minAltT) return 'desempeno-basico'\n          if (nota < this.datosSeccion.minSupT) return 'desempeno-alto'\n          if (nota <= this.datosSeccion.maxSupT) return 'desempeno-superior'\n          return 'desempeno-extra'\n        }\n      },\n      obtenerColorGeneral(nota) {\n        if (nota < this.datosSeccion.minBas) return 'desempeno-bajo'\n        if (nota < this.datosSeccion.minAlt) return 'desempeno-basico'\n        if (nota < this.datosSeccion.minSup) return 'desempeno-alto'\n        if (nota <= this.datosSeccion.maxSup) return 'desempeno-superior'\n        return 'desempeno-extra'\n      },\n      async consultarEstudiantes() {\n        this.btnCargando = true\n        this.nombreSede = document.getElementById('sedes')[document.getElementById('sedes').selectedIndex].text\n        if (this.idCurso != null) { \n          this.nombreCurso = document.getElementById('cursos')[document.getElementById('cursos').selectedIndex].text\n          this.$store.state.datosCursos.forEach(element => {\n            if (element.id == this.idCurso) {\n              this.idNivel = element.id_nivel\n            }\n          })\n          this.listaAreasAsignaturas = []\n          await axios\n          .get(CONFIG.ROOT_PATH + 'consolidados/areasasignaturas/curso', {params: {idCurso: this.idCurso}})\n          .then(response => {\n            if (response.data.error){\n              this.mensajeEmergente('danger',CONFIG.TITULO_MSG,response.data.mensaje + ' - Lista areas-asignaturas curso')\n              this.btnCargando = false\n            } else{\n              if (response.data.datos != 0) {\n                //this.listaAreasAsignaturas = response.data.datos\n                response.data.datos.forEach(element => {\n                  if (element.orden != 90) {\n                    this.listaAreasAsignaturas.push(element)\n                  }\n                })\n              }\n            }\n          })\n          .catch(err => {\n            this.mensajeEmergente('danger',CONFIG.TITULO_MSG,'Algo salio mal y no se pudo realizar: Lista areas-asignaturas curso. Intente ms tarde.' + err)\n            this.btnCargando = false\n          })\n          this.datosRaw = []\n          await axios\n          .get(CONFIG.ROOT_PATH + 'consolidados/asignaturas/curso/acumulado', {params: {idCurso: this.idCurso, periodo: this.idPeriodo, vigencia: this.$store.state.aLectivo}})\n          .then(response => {\n            if (response.data.error){\n              this.mensajeEmergente('danger',CONFIG.TITULO_MSG,response.data.mensaje + ' - Consolidados asignaturas curso periodo')\n              this.btnCargando = false\n            } else{\n              if (response.data.datos != 0) {\n                this.datosRaw = response.data.datos\n              }\n            }\n          })\n          .catch(err => {\n            this.mensajeEmergente('danger',CONFIG.TITULO_MSG,'Algo salio mal y no se pudo realizar: Consolidados asignaturas curso periodo. Intente ms tarde.' + err)\n            this.btnCargando = false\n          })\n        }\n        //console.log(JSON.stringify(this.listaAreasAsignaturas))\n        this.btnCargando = false\n      },\n      imprimir() {\n        let fecha = 'Fecha: ' + new Date().toLocaleString()\n        let tituloInforme = 'CONSOLIDADO EVALUACIONES ACUMULADO PONDERADO'\n        const contenido = document.querySelector('table').outerHTML\n        const ventana = window.open(\"Consolidados\", \"_blank\")\n        ventana.document.write(`<html><head><title>Imprimir</title></head>\n        <style scoped>\n          table {\n            border-collapse: collapse;\n            width: 100%;\n            text-align: center;\n            font-size: 10px;\n          }\n          th {\n            background: #eee;\n          }\n          .nota-recuperada {\n            border: 2px solid #ffa500;\n            box-shadow: 0 0 5px #ffa500;\n          }\n          .desempeno-bajo { background-color: #f8d7da; color: #721c24; }\n          .desempeno-basico { background-color: #d1ecf1; color: #0c5460; }\n          .desempeno-alto { background-color: #fff3cd; color: #856404; }\n          .desempeno-superior { background-color: #d4edda; color: #155724; }\n          .desempeno-extra { background-color: #f4ecf5; color: #2f2e2e; }\n        </style>\n          <body class=\"container\">\n            <p style=\"text-align: center; font-size: 12px;\">SECRETARA DE EDUCACIN TERRITORIAL DE TUNJA<br><b>${this.$store.state.nombreInstitucion}</b><br>TUNJA - BOYAC<br>${tituloInforme}<br>Sede: ${this.nombreSede} | Curso: ${this.nombreCurso} | Ao Lectivo ${this.$store.state.aLectivo} | Periodo: ${this.idPeriodo}</p>\n            ${contenido}\n            <div style=\"text-align: right; font-size: 12px;\"><i>${fecha}</i></div>\n          </body>\n        </html>`)\n        ventana.document.close()\n        ventana.print()\n      },\n      exportarAExcel() {\n        const tabla = document.querySelector('table')\n        const wb = XLSX.utils.table_to_book(tabla)\n        XLSX.writeFile(wb, 'notas.xlsx')\n      },\n      redondear(num) {\n        var m = Number((Math.abs(num) * 10).toPrecision(15))\n        return Math.round(m) / 10 * Math.sign(num);\n      },\n      async ocuparComboCursosSede() {\n        this.comboCursosSede = []\n        this.$store.state.datosCursos.forEach(element => {\n          if (element.id_sede == this.idSede) {\n            this.comboCursosSede.push({ 'value': element.id, 'text': element.nomenclatura.toUpperCase() })\n          }\n        })\n      },\n      async ocuparComboSedes() {\n        this.comboSedes = []\n        this.$store.state.datosSedes.forEach(element => {\n          this.comboSedes.push({ 'value': element.id, 'text': element.sede.toUpperCase() })\n        })\n      },\n      async ocuparComboPeriodos() {\n        this.comboPeriodos = []\n        this.$store.state.periodos.forEach(element => {\n          this.comboPeriodos.push({ 'value': element.id, 'text': element.periodo.toUpperCase() })\n        })\n      },\n      mensajeEmergente(variante, titulo, contenido) {\n        this.$bvToast.toast(contenido, { title: titulo, variant: variante, toaster: \"b-toaster-top-center\", solid: true, autoHideDelay: 4000, appendToast: false })\n      }\n    },\n    computed: {\n      estudiantesNotas() {\n        const mapa = {}\n        this.datosRaw.forEach(row => {\n          const { estudiante, area, asignatura, periodo, definitiva, recuperacion, orden, definitivacompor, idTipoEspecialidad, ausJ, ausS } = row\n          if (!mapa[estudiante]) {\n            mapa[estudiante] = { ausJ: 0, ausS: 0, areas: {} }\n          }\n          if (!mapa[estudiante].areas[area]) {\n            mapa[estudiante].areas[area] = { asignaturas: {} }\n          }\n          if (!mapa[estudiante].areas[area].asignaturas[asignatura]) {\n            mapa[estudiante].areas[area].asignaturas[asignatura] = {\n              periodos: {},\n              orden,\n              pesos: { 1: this.datosSeccion.pesoP1, 2: this.datosSeccion.pesoP2, 3: this.datosSeccion.pesoP3, 4: this.datosSeccion.pesoP4 }\n            }\n          }\n          let notaFinal = 0\n          if (orden === 99) {\n            notaFinal = definitivacompor != null ? definitivacompor : ''\n          } else {\n            notaFinal = recuperacion > definitiva ? recuperacion : definitiva\n          }\n          mapa[estudiante].areas[area].asignaturas[asignatura].periodos[periodo] = notaFinal\n          mapa[estudiante].ausJ += ausJ || 0\n          mapa[estudiante].ausS += ausS || 0\n        })\n        return mapa\n      },\n\n\n\n\n      totalColumnasPromedioArea() {\n        const areasUnicas = new Set(this.listaAreasAsignaturas.map(a => a.area))\n        return areasUnicas.size\n      },\n      puestosPorEstudiante() {\n        const lista = Object.entries(this.estudiantesNotas).map(([nombre, areas]) => {\n          const promedio = parseFloat(this.calcularPromedioGeneral(areas))\n          return { nombre, promedio: isNaN(promedio) ? 0 : promedio }\n        })\n        // Ordenar de mayor a menor\n        lista.sort((a, b) => b.promedio - a.promedio)\n        const puestos = {}\n        let puestoActual = 1\n        let contador = 1\n        let ultimoPromedio = null\n        lista.forEach(est => {\n          if (est.promedio !== ultimoPromedio) {\n            puestoActual = contador\n            ultimoPromedio = est.promedio\n          }\n          puestos[est.nombre] = puestoActual\n          contador++\n        })\n        return puestos\n      },\n      encabezadoPorArea() {\n        const mapa = {}\n        this.listaAreasAsignaturas.forEach(({ area, asignatura }) => {\n          if (!mapa[area]) mapa[area] = []\n          mapa[area].push(asignatura)\n        })\n        return mapa\n      },\n    },\n    beforeMount() {\n      this.ocuparComboSedes()\n      this.ocuparComboPeriodos()\n      this.datosSeccion = this.$store.state.datosSecciones[this.$store.state.idSeccion - 1]\n      //console.log(JSON.stringify(this.datosSeccion))\n    }\n  }\n</script>\n<style scoped>\n  table {\n    border-collapse: collapse;\n    width: 100%;\n    text-align: center;\n    font-size: 10px;\n  }\n  th {\n    background: #eee;\n  }\n  .nota-recuperada {\n    border: 2px solid #ffa500;\n    box-shadow: 0 0 5px #ffa500;\n  }\n  .desempeno-bajo { background-color: #f8d7da; color: #721c24; }\n  .desempeno-basico { background-color: #d1ecf1; color: #0c5460; }\n  .desempeno-alto { background-color: #fff3cd; color: #856404; }\n  .desempeno-superior { background-color: #d4edda; color: #155724; }\n  .desempeno-extra { background-color: #f4ecf5; color: #2f2e2e; }\n\n</style>\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ConsolidadoPonderado.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ConsolidadoPonderado.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ConsolidadoPonderado.vue?vue&type=template&id=39e3ab4c&scoped=true&\"\nimport script from \"./ConsolidadoPonderado.vue?vue&type=script&lang=js&\"\nexport * from \"./ConsolidadoPonderado.vue?vue&type=script&lang=js&\"\nimport style0 from \"./ConsolidadoPonderado.vue?vue&type=style&index=0&id=39e3ab4c&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"39e3ab4c\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('b-row',{staticClass:\"mt-2\"},[_c('b-col',{attrs:{\"lg\":\"12\"}},[_c('b-card',{scopedSlots:_vm._u([{key:\"header\",fn:function(){return [_c('h5',{staticClass:\"mb-0\"},[_c('b-icon',{attrs:{\"icon\":\"card-checklist\",\"aria-hidden\":\"true\"}}),_vm._v(\" CONSOLIDADO AUSENCIAS\")],1)]},proxy:true}])},[_c('b-card-text',[_c('b-row',[_c('b-col',{attrs:{\"lg\":\"2\"}},[_c('b-form-group',{staticClass:\"etiqueta\",attrs:{\"label\":\"Periodo:\",\"label-for\":\"periodo\"}},[_c('b-form-select',{ref:\"periodo\",attrs:{\"id\":\"periodo\",\"options\":_vm.comboPeriodos},on:{\"change\":function($event){_vm.idSede=null,_vm.idCurso=null}},model:{value:(_vm.idPeriodo),callback:function ($$v) {_vm.idPeriodo=$$v},expression:\"idPeriodo\"}})],1)],1),_c('b-col',{attrs:{\"lg\":\"6\"}},[_c('b-form-group',{staticClass:\"etiqueta\",attrs:{\"label\":\"Seleccione la Sede:\",\"label-for\":\"sedes\"}},[_c('b-form-select',{ref:\"sedes\",attrs:{\"id\":\"sedes\",\"options\":_vm.comboSedes,\"disabled\":_vm.idPeriodo!=null ? false : true},on:{\"change\":function($event){_vm.idCurso=null,_vm.ocuparComboCursosSede()}},model:{value:(_vm.idSede),callback:function ($$v) {_vm.idSede=$$v},expression:\"idSede\"}})],1)],1),_c('b-col',{attrs:{\"lg\":\"4\"}},[_c('b-form-group',{staticClass:\"etiqueta\",attrs:{\"label\":\"Seleccione el Curso:\",\"label-for\":\"cursos\"}},[_c('b-form-select',{ref:\"cursos\",attrs:{\"id\":\"cursos\",\"options\":_vm.comboCursosSede,\"disabled\":_vm.idSede!=null ? false : true},on:{\"change\":function($event){return _vm.consultarEstudiantes()}},model:{value:(_vm.idCurso),callback:function ($$v) {_vm.idCurso=$$v},expression:\"idCurso\"}})],1)],1)],1)],1)],1)],1)],1),_c('b-row',[_c('b-col',{attrs:{\"lg\":\"12\"}},[(_vm.btnCargando)?_c('div',[_c('div',{staticClass:\"text-center m-5 text-primary\"},[_c('b-spinner',{staticStyle:{\"width\":\"3rem\",\"height\":\"3rem\"},attrs:{\"label\":\"Spinner\"}}),_c('br'),_c('strong',[_vm._v(\"Cargando informe...\")])],1)]):_vm._e()])],1),(!_vm.btnCargando && _vm.idCurso!=null)?_c('b-row',[_c('b-col',{attrs:{\"lg\":\"12\"}},[_c('table',{staticClass:\"tabla-ausencias\",attrs:{\"border\":\"1\",\"cellspacing\":\"0\",\"cellpadding\":\"1\"}},[_c('thead',[_c('tr',[_c('th',{attrs:{\"rowspan\":\"3\"}},[_vm._v(\"#\")]),_c('th',{attrs:{\"rowspan\":\"3\"}},[_vm._v(\"Estudiante\")]),_vm._l((_vm.asignaturasValidas),function(asig,i){return [_c('th',{key:'head-' + i,attrs:{\"colspan\":_vm.periodos.length * 2}},[_vm._v(_vm._s(asig.asignatura))])]}),_c('th',{attrs:{\"rowspan\":\"3\"}},[_vm._v(\"TJ\")]),_c('th',{attrs:{\"rowspan\":\"3\"}},[_vm._v(\"TS\")]),_c('th',{attrs:{\"rowspan\":\"3\"}},[_vm._v(\"#\")])],2),_c('tr',[_vm._l((_vm.asignaturasValidas),function(asig,i){return [_vm._l((_vm.periodos),function(p){return [_c('th',{key:'p-' + i + '-' + p,attrs:{\"colspan\":\"2\"}},[_vm._v(_vm._s(p))])]})]})],2),_c('tr',[_vm._l((_vm.asignaturasValidas),function(asig,i){return [_vm._l((_vm.periodos),function(p){return [_c('th',{key:'tipoJ-' + i + '-' + p},[_vm._v(\"J\")]),_c('th',{key:'tipoS-' + i + '-' + p},[_vm._v(\"S\")])]})]})],2)]),_c('tbody',[_vm._l((_vm.consolidadoAusencias),function(est,cont){return _c('tr',{key:est.estudiante},[_c('td',[_vm._v(_vm._s(cont + 1))]),_c('td',{staticStyle:{\"text-align\":\"left\"}},[_vm._v(_vm._s(est.estudiante))]),_vm._l((_vm.asignaturasValidas),function(asig,i){return [_vm._l((_vm.periodos),function(p){return [_c('td',{key:i + 'J-' + est.estudiante + asig.asignatura + p},[_vm._v(_vm._s(_vm.getAusencia(est, asig, p, 'ausJ')))]),_c('td',{key:i + 'S-' + est.estudiante + asig.asignatura + p},[_vm._v(_vm._s(_vm.getAusencia(est, asig, p, 'ausS')))])]})]}),_c('td',[_c('strong',[_vm._v(_vm._s(est.totalAusJ))])]),_c('td',[_c('strong',[_vm._v(_vm._s(est.totalAusS))])]),_c('td',[_vm._v(_vm._s(cont + 1))])],2)}),_c('tr',{staticStyle:{\"background-color\":\"#f0f0f0\",\"font-weight\":\"bold\"}},[_c('td',{attrs:{\"colspan\":\"2\"}},[_c('strong',[_vm._v(\"Totales\")])]),_vm._l((_vm.asignaturasValidas),function(asig,i){return [_vm._l((_vm.periodos),function(p){return [_c('td',{key:i + 'J-' + asig.asignatura + p},[_vm._v(_vm._s(_vm.getAusenciaTotal(asig, p, 'ausJ')))]),_c('td',{key:i + 'S-' + asig.asignatura + p},[_vm._v(_vm._s(_vm.getAusenciaTotal(asig, p, 'ausS')))])]})]}),_c('td',[_vm._v(_vm._s(_vm.getTotalGeneral('totalAusJ')))]),_c('td',[_vm._v(_vm._s(_vm.getTotalGeneral('totalAusS')))])],2)],2)]),_c('div',{staticStyle:{\"margin-bottom\":\"1rem\"}},[_c('b-button',{staticClass:\"small mx-1 mt-3\",attrs:{\"variant\":\"primary\"},on:{\"click\":_vm.imprimir}},[_vm._v(\"Imprimir Consolidado\")]),_c('b-button',{staticClass:\"small mx-1 mt-3\",attrs:{\"variant\":\"outline-primary\"},on:{\"click\":_vm.exportarAExcel}},[_vm._v(\"Exportar a Excel\")])],1)])],1):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div>\n    <b-row class=\"mt-2\">\n      <b-col lg=\"12\">\n        <b-card>\n          <template #header>\n            <h5 class=\"mb-0\"><b-icon icon=\"card-checklist\" aria-hidden=\"true\"></b-icon> CONSOLIDADO AUSENCIAS</h5>\n          </template>\n          <b-card-text>\n            <b-row>\n              <b-col lg=\"2\">\n                <b-form-group label=\"Periodo:\" label-for=\"periodo\" class=\"etiqueta\">\n                  <b-form-select id=\"periodo\" ref=\"periodo\" v-model=\"idPeriodo\" :options=\"comboPeriodos\" @change=\"idSede=null,idCurso=null\"></b-form-select>\n                </b-form-group>\n              </b-col>\n              <b-col lg=\"6\">\n                <b-form-group label=\"Seleccione la Sede:\" label-for=\"sedes\" class=\"etiqueta\">\n                  <b-form-select  id=\"sedes\" ref=\"sedes\" v-model=\"idSede\" :options=\"comboSedes\" @change=\"idCurso=null,ocuparComboCursosSede()\" :disabled=\"idPeriodo!=null ? false : true\"></b-form-select>\n                </b-form-group>\n              </b-col>\n              <b-col lg=\"4\">\n                <b-form-group label=\"Seleccione el Curso:\" label-for=\"cursos\" class=\"etiqueta\">\n                  <b-form-select id=\"cursos\" ref=\"cursos\" v-model=\"idCurso\" :options=\"comboCursosSede\" @change=\"consultarEstudiantes()\" :disabled=\"idSede!=null ? false : true\"></b-form-select>\n                </b-form-group>\n              </b-col>\n            </b-row>\n          </b-card-text>\n        </b-card>\n      </b-col>\n    </b-row>\n    <b-row>\n      <b-col lg=\"12\">\n        <div v-if=\"btnCargando\">\n          <div class=\"text-center m-5 text-primary\">\n            <b-spinner style=\"width: 3rem; height: 3rem;\" label=\"Spinner\"></b-spinner>\n            <br><strong>Cargando informe...</strong>\n          </div>\n        </div>\n      </b-col>\n    </b-row>\n    <b-row v-if=\"!btnCargando && idCurso!=null\">\n      <b-col lg=\"12\">\n        <table border=\"1\" cellspacing=\"0\" cellpadding=\"1\" class=\"tabla-ausencias\">\n          <thead>\n            <tr>\n              <th rowspan=\"3\">#</th>\n              <th rowspan=\"3\">Estudiante</th>\n              <template v-for=\"(asig,i) in asignaturasValidas\">\n                <th :colspan=\"periodos.length * 2\" :key=\"'head-' + i\">{{ asig.asignatura }}</th>\n              </template>\n              <th rowspan=\"3\">TJ</th>\n              <th rowspan=\"3\">TS</th>\n              <th rowspan=\"3\">#</th>\n            </tr>\n            <tr>\n              <template v-for=\"(asig,i) in asignaturasValidas\">\n                <template v-for=\"p in periodos\">\n                  <th colspan=\"2\" :key=\"'p-' + i + '-' + p\">{{ p }}</th>\n                </template>\n              </template>\n            </tr>\n            <tr>\n              <template v-for=\"(asig,i) in asignaturasValidas\">\n                <template v-for=\"p in periodos\">\n                  <th :key=\"'tipoJ-' + i + '-' + p\">J</th>\n                  <th :key=\"'tipoS-' + i + '-' + p\">S</th>\n                </template>\n              </template>\n            </tr>\n          </thead>\n          <tbody>\n            <tr v-for=\"(est,cont) in consolidadoAusencias\" :key=\"est.estudiante\">\n              <td>{{ cont + 1 }}</td>\n              <td style=\"text-align: left\">{{ est.estudiante }}</td>\n              <template v-for=\"(asig,i) in asignaturasValidas\">\n                <template v-for=\"p in periodos\">\n                  <td :key=\"i + 'J-' + est.estudiante + asig.asignatura + p\">{{ getAusencia(est, asig, p, 'ausJ') }}</td>\n                  <td :key=\"i + 'S-' + est.estudiante + asig.asignatura + p\">{{ getAusencia(est, asig, p, 'ausS') }}</td>\n                </template>\n              </template>\n              <td><strong>{{ est.totalAusJ }}</strong></td>\n              <td><strong>{{ est.totalAusS }}</strong></td>\n              <td>{{ cont + 1 }}</td>\n            </tr>\n            <tr style=\"background-color: #f0f0f0; font-weight: bold;\">\n              <td colspan=\"2\"><strong>Totales</strong></td>\n              <template v-for=\"(asig,i) in asignaturasValidas\">\n                <template v-for=\"p in periodos\">\n                  <td :key=\"i + 'J-' + asig.asignatura + p\">{{ getAusenciaTotal(asig, p, 'ausJ') }}</td>\n                  <td :key=\"i + 'S-' + asig.asignatura + p\">{{ getAusenciaTotal(asig, p, 'ausS') }}</td>\n                </template>\n              </template>\n              <td>{{ getTotalGeneral('totalAusJ') }}</td>\n              <td>{{ getTotalGeneral('totalAusS') }}</td>\n            </tr>\n          </tbody>\n        </table>\n        <div style=\"margin-bottom: 1rem\">\n          <b-button class=\"small mx-1 mt-3\" variant=\"primary\" @click=\"imprimir\">Imprimir Consolidado</b-button>\n          <b-button class=\"small mx-1 mt-3\" variant=\"outline-primary\" @click=\"exportarAExcel\">Exportar a Excel</b-button>\n        </div>\n      </b-col>\n    </b-row>\n  </div>\n</template>\n\n<script>\n  import axios from \"axios\"\n  import * as CONFIG from '@/assets/config.js'\n  import * as XLSX from 'xlsx'\n\n  export default {\n    name: 'ausencias',\n    props: {\n    },\n    components: {\n    },\n    data () {\n      return {\n        idSede: null,\n        comboSedes: [],\n        idPeriodo: null,\n        comboPeriodos: null,\n        idCurso: null,\n        comboCursosSede: [],\n        nombreSede: null,\n        nombreCurso: null,\n        idNivel: null,\n        btnCargando: false,\n        dataConsultada: [],\n        datosSeccion: {},\n        listaAreasAsignaturas: [],\n        listaEstudiantes: [],\n        ausencias: [],\n      }\n    },\n    methods: {\n      getTotalGeneral(tipo) {\n        return this.consolidadoAusencias.reduce((t, e) => t + (parseInt(e[tipo]) || 0), 0)\n      },\n      getAusenciaTotal(asignatura, periodo, tipo) {\n        const clave = asignatura?.asignatura || asignatura\n        const suma = this.consolidadoAusencias.reduce((total, est) => {\n          const valor = est.asignaturas?.[clave]?.[periodo]?.[tipo]\n          return total + (parseInt(valor) || 0)\n        }, 0)\n        return suma\n      },\n      getAusencia(est, asig, periodo, tipo) {\n        try {\n          return est.asignaturas?.[asig.asignatura]?.[periodo]?.[tipo] || ''\n        } catch (e) {\n          return ''\n        }\n      },\n      async consultarEstudiantes() {\n        this.btnCargando = true\n        this.nombreSede = document.getElementById('sedes')[document.getElementById('sedes').selectedIndex].text\n        if (this.idCurso != null) { \n          this.nombreCurso = document.getElementById('cursos')[document.getElementById('cursos').selectedIndex].text\n          this.$store.state.datosCursos.forEach(element => {\n            if (element.id == this.idCurso) {\n              this.idNivel = element.id_nivel\n            }\n          })\n          this.listaEstudiantes = []\n          await axios\n          .get(CONFIG.ROOT_PATH + 'consolidado/listaestudiantes/curso', { params: { idCurso: this.idCurso, vigencia: this.$store.state.aLectivo }})\n          .then(response => {\n            if (response.data.error){\n              this.mensajeEmergente('danger',CONFIG.TITULO_MSG,response.data.mensaje + ' - Consulta Lista Curso')\n            } else{\n              if (response.data.datos != 0) {\n                this.listaEstudiantes = response.data.datos\n              }\n            }\n          })\n          .catch(err => {\n            this.mensajeEmergente('danger',CONFIG.TITULO_MSG,'Algo salio mal y no se pudo realizar: Consulta Lista Curso. Intente ms tarde.' + err)\n          })\n          this.listaAreasAsignaturas = []\n          await axios\n          .get(CONFIG.ROOT_PATH + 'consolidados/areasasignaturas/curso', {params: {idCurso: this.idCurso}})\n          .then(response => {\n            if (response.data.error){\n              this.mensajeEmergente('danger',CONFIG.TITULO_MSG,response.data.mensaje + ' - Lista areas-asignaturas curso')\n              this.btnCargando = false\n            } else{\n              if (response.data.datos != 0) {\n                this.listaAreasAsignaturas = response.data.datos\n              }\n            }\n          })\n          .catch(err => {\n            this.mensajeEmergente('danger',CONFIG.TITULO_MSG,'Algo salio mal y no se pudo realizar: Lista areas-asignaturas curso. Intente ms tarde.' + err)\n            this.btnCargando = false\n          })\n          this.dataConsultada = []\n          await axios\n          .get(CONFIG.ROOT_PATH + 'consolidados/ausencias/curso/periodo', {params: {idCurso: this.idCurso, periodo: this.idPeriodo, vigencia: this.$store.state.aLectivo}})\n          .then(response => {\n            if (response.data.error){\n              this.mensajeEmergente('danger',CONFIG.TITULO_MSG,response.data.mensaje + ' - Consolidados ausencias curso periodo')\n              this.btnCargando = false\n            } else{\n              if (response.data.datos != 0) {\n                this.dataConsultada = response.data.datos\n              }\n            }\n          })\n          .catch(err => {\n            this.mensajeEmergente('danger',CONFIG.TITULO_MSG,'Algo salio mal y no se pudo realizar: Consolidados ausencias curso periodo. Intente ms tarde.' + err)\n            this.btnCargando = false\n          })\n        }\n        //console.log(JSON.stringify(this.listaEstudiantes))\n        //console.log(JSON.stringify(this.listaAreasAsignaturas))\n        //console.log(JSON.stringify(this.dataConsultada))\n        this.btnCargando = false\n      },\n      imprimir() {\n        let fecha = 'Fecha: ' + new Date().toLocaleString()\n        let tituloInforme = 'CONSOLIDADO DE AUSENCIAS'\n        const contenido = document.querySelector('table').outerHTML\n        const ventana = window.open(\"Ausencias\", \"_blank\")\n        ventana.document.write(`<html><head><title>Ausencias</title></head>\n        <style scoped>\n          .tabla-ausencias {\n              border-collapse: collapse;\n              width: 100%;\n              text-align: center;\n              font-size: 10px;\n          }\n          .tabla-ausencias th {\n            background: #eee;\n          }\n        </style>\n          <body class=\"container\">\n            <p style=\"text-align: center; font-size: 12px;\">SECRETARA DE EDUCACIN TERRITORIAL DE TUNJA<br><b>${this.$store.state.nombreInstitucion}</b><br>TUNJA - BOYAC<br>${tituloInforme}<br>Sede: ${this.nombreSede} | Curso: ${this.nombreCurso} | Ao Lectivo ${this.$store.state.aLectivo} | Periodo: ${this.idPeriodo}</p>\n            ${contenido}\n            <div style=\"text-align: right; font-size: 12px;\"><i>${fecha}</i></div>\n          </body>\n        </html>`)\n        ventana.document.close()\n        ventana.print()\n      },\n      exportarAExcel() {\n        const tabla = document.querySelector('table')\n        const wb = XLSX.utils.table_to_book(tabla)\n        XLSX.writeFile(wb, 'ausencias.xlsx')\n      },\n      async ocuparComboCursosSede() {\n        this.comboCursosSede = []\n        this.$store.state.datosCursos.forEach(element => {\n          if (element.id_sede == this.idSede) {\n            this.comboCursosSede.push({ 'value': element.id, 'text': element.nomenclatura.toUpperCase() })\n          }\n        })\n      },\n      async ocuparComboSedes() {\n        this.comboSedes = []\n        this.$store.state.datosSedes.forEach(element => {\n          this.comboSedes.push({ 'value': element.id, 'text': element.sede.toUpperCase() })\n        })\n      },\n      async ocuparComboPeriodos() {\n        this.comboPeriodos = []\n        this.$store.state.periodos.forEach(element => {\n          this.comboPeriodos.push({ 'value': element.id, 'text': element.periodo.toUpperCase() })\n        })\n      },\n      mensajeEmergente(variante, titulo, contenido) {\n        this.$bvToast.toast(contenido, { title: titulo, variant: variante, toaster: \"b-toaster-top-center\", solid: true, autoHideDelay: 4000, appendToast: false })\n      }\n    },\n    computed: {\n      totalesPorColumna() {\n        const resumen = {}\n        this.asignaturasValidas.forEach(asig => {\n          const clave = asig.asignatura\n          resumen[clave] = {}\n          this.periodos.forEach(p => {\n            let sumaJ = 0, sumaS = 0\n            this.consolidadoAusencias.forEach(est => {\n              sumaJ += est.asignaturas?.[clave]?.[p]?.ausJ || 0\n              sumaS += est.asignaturas?.[clave]?.[p]?.ausS || 0\n            })\n            resumen[clave][p] = { ausJ: sumaJ, ausS: sumaS }\n          })\n        })\n        return resumen\n      },\n      periodos() {\n        return Array.from({ length: this.idPeriodo }, (_, i) => `P${i + 1}`)\n      },\n      asignaturasValidas() {\n        return this.listaAreasAsignaturas.filter(a => a.orden !== 999)\n      },\n      consolidadoAusencias() {\n        return this.listaEstudiantes.map(est => {\n          const fila = {\n            estudiante: est.estudiante,\n            asignaturas: {},\n            totalAusJ: 0,\n            totalAusS: 0\n          }\n          this.asignaturasValidas.forEach(asig => {\n            const clave = asig.asignatura\n            fila.asignaturas[clave] = {}\n            this.periodos.forEach(p => {\n              const registro = this.dataConsultada.find(dc =>\n                dc.idMatricula === est.idMatricula &&\n                dc.asignatura === clave &&\n                dc.periodo === parseInt(p.slice(1)) // convertir 'P1'  1\n              )\n              const ausJ = registro?.ausJ || 0\n              const ausS = registro?.ausS || 0\n              fila.asignaturas[clave][p] = { ausJ, ausS }\n              fila.totalAusJ += ausJ\n              fila.totalAusS += ausS\n            })\n          })\n          return fila\n        })\n      }\n    },\n    beforeMount() {\n      this.ocuparComboSedes()\n      this.ocuparComboPeriodos()\n      this.datosSeccion = this.$store.state.datosSecciones[this.$store.state.idSeccion - 1]\n    }\n  }\n</script>\n<style scoped>\n  .tabla-ausencias {\n      border-collapse: collapse;\n      width: 100%;\n      text-align: center;\n      font-size: 10px;\n  }\n  .tabla-ausencias th {\n    background: #eee;\n  }\n</style>\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AusenciasPeriodo.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AusenciasPeriodo.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./AusenciasPeriodo.vue?vue&type=template&id=47b943f5&scoped=true&\"\nimport script from \"./AusenciasPeriodo.vue?vue&type=script&lang=js&\"\nexport * from \"./AusenciasPeriodo.vue?vue&type=script&lang=js&\"\nimport style0 from \"./AusenciasPeriodo.vue?vue&type=style&index=0&id=47b943f5&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"47b943f5\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('b-row',{staticClass:\"mt-2\"},[_c('b-col',{attrs:{\"lg\":\"12\"}},[_c('b-card',{scopedSlots:_vm._u([{key:\"header\",fn:function(){return [_c('h5',{staticClass:\"mb-0\"},[_c('b-icon',{attrs:{\"icon\":\"card-checklist\",\"aria-hidden\":\"true\"}}),_vm._v(\" CONSOLIDADO AUSENCIAS ACUMULADAS\")],1)]},proxy:true}])},[_c('b-card-text',[_c('b-row',[_c('b-col',{attrs:{\"lg\":\"2\"}},[_c('b-form-group',{staticClass:\"etiqueta\",attrs:{\"label\":\"Periodo:\",\"label-for\":\"periodo\"}},[_c('b-form-select',{ref:\"periodo\",attrs:{\"id\":\"periodo\",\"options\":_vm.comboPeriodos},on:{\"change\":function($event){_vm.idSede=null,_vm.idCurso=null}},model:{value:(_vm.idPeriodo),callback:function ($$v) {_vm.idPeriodo=$$v},expression:\"idPeriodo\"}})],1)],1),_c('b-col',{attrs:{\"lg\":\"6\"}},[_c('b-form-group',{staticClass:\"etiqueta\",attrs:{\"label\":\"Seleccione la Sede:\",\"label-for\":\"sedes\"}},[_c('b-form-select',{ref:\"sedes\",attrs:{\"id\":\"sedes\",\"options\":_vm.comboSedes,\"disabled\":_vm.idPeriodo!=null ? false : true},on:{\"change\":function($event){_vm.idCurso=null,_vm.ocuparComboCursosSede()}},model:{value:(_vm.idSede),callback:function ($$v) {_vm.idSede=$$v},expression:\"idSede\"}})],1)],1),_c('b-col',{attrs:{\"lg\":\"4\"}},[_c('b-form-group',{staticClass:\"etiqueta\",attrs:{\"label\":\"Seleccione el Curso:\",\"label-for\":\"cursos\"}},[_c('b-form-select',{ref:\"cursos\",attrs:{\"id\":\"cursos\",\"options\":_vm.comboCursosSede,\"disabled\":_vm.idSede!=null ? false : true},on:{\"change\":function($event){return _vm.consultarEstudiantes()}},model:{value:(_vm.idCurso),callback:function ($$v) {_vm.idCurso=$$v},expression:\"idCurso\"}})],1)],1)],1)],1)],1)],1)],1),_c('b-row',[_c('b-col',{attrs:{\"lg\":\"12\"}},[(_vm.btnCargando)?_c('div',[_c('div',{staticClass:\"text-center m-5 text-primary\"},[_c('b-spinner',{staticStyle:{\"width\":\"3rem\",\"height\":\"3rem\"},attrs:{\"label\":\"Spinner\"}}),_c('br'),_c('strong',[_vm._v(\"Cargando informe...\")])],1)]):_vm._e()])],1),(!_vm.btnCargando && _vm.idCurso!=null)?_c('b-row',[_c('b-col',{attrs:{\"lg\":\"12\"}},[_c('table',{staticClass:\"tabla-ausencias\",attrs:{\"border\":\"1\",\"cellspacing\":\"0\",\"cellpadding\":\"1\"}},[_c('thead',[_c('tr',[_c('th',{attrs:{\"rowspan\":\"2\"}},[_vm._v(\"#\")]),_c('th',{attrs:{\"rowspan\":\"2\"}},[_vm._v(\"Estudiante\")]),_vm._l((_vm.asignaturasValidas),function(asig,i){return [_c('th',{key:'head-' + i,attrs:{\"colspan\":2}},[_vm._v(_vm._s(asig.asignatura))])]}),_c('th',{attrs:{\"rowspan\":\"2\"}},[_vm._v(\"TotalAJ\")]),_c('th',{attrs:{\"rowspan\":\"2\"}},[_vm._v(\"TotalAS\")]),_c('th',{attrs:{\"rowspan\":\"2\"}},[_vm._v(\"#\")])],2),_c('tr',[_vm._l((_vm.asignaturasValidas),function(asig,i){return [_c('th',{key:'headJ-' + i},[_vm._v(\"AJ\")]),_c('th',{key:'headS-' + i},[_vm._v(\"AS\")])]})],2)]),_c('tbody',[_vm._l((_vm.ausenciasConsolidadas),function(est,cont){return _c('tr',{key:est.idMatricula},[_c('td',[_vm._v(_vm._s(cont + 1))]),_c('td',{staticStyle:{\"text-align\":\"left\"}},[_vm._v(_vm._s(est.estudiante))]),_vm._l((_vm.asignaturasValidas),function(asig,i){return [_c('td',{key:i + 'J-' + est.estudiante + asig.asignatura},[_vm._v(_vm._s(_vm.getAusencia(est, asig, 'ausJ')))]),_c('td',{key:i + 'S-' + est.estudiante + asig.asignatura},[_vm._v(_vm._s(_vm.getAusencia(est, asig, 'ausS')))])]}),_c('td',[_c('strong',[_vm._v(_vm._s(est.totalAusJ))])]),_c('td',[_c('strong',[_vm._v(_vm._s(est.totalAusS))])]),_c('td',[_vm._v(_vm._s(cont + 1))])],2)}),_c('tr',{staticStyle:{\"background-color\":\"#f0f0f0\",\"font-weight\":\"bold\"}},[_c('td',{attrs:{\"colspan\":\"2\"}},[_c('strong',[_vm._v(\"Totales\")])]),_vm._l((_vm.asignaturasValidas),function(asig,i){return [_c('td',{key:i + 'J-' + asig.asignatura},[_vm._v(_vm._s(_vm.totalesPorAsignatura[asig.asignatura].ausJ))]),_c('td',{key:i + 'S-' + asig.asignatura},[_vm._v(_vm._s(_vm.totalesPorAsignatura[asig.asignatura].ausS))])]}),_c('td',[_vm._v(_vm._s(_vm.ausenciasConsolidadas.reduce(function (sum, est) { return sum + est.totalAusJ; }, 0)))]),_c('td',[_vm._v(_vm._s(_vm.ausenciasConsolidadas.reduce(function (sum, est) { return sum + est.totalAusS; }, 0)))]),_c('td')],2)],2)]),_c('div',{staticStyle:{\"margin-bottom\":\"1rem\"}},[_c('b-button',{staticClass:\"small mx-1 mt-3\",attrs:{\"variant\":\"primary\"},on:{\"click\":_vm.imprimir}},[_vm._v(\"Imprimir Consolidado\")]),_c('b-button',{staticClass:\"small mx-1 mt-3\",attrs:{\"variant\":\"outline-primary\"},on:{\"click\":_vm.exportarAExcel}},[_vm._v(\"Exportar a Excel\")])],1)])],1):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div>\n    <b-row class=\"mt-2\">\n      <b-col lg=\"12\">\n        <b-card>\n          <template #header>\n            <h5 class=\"mb-0\"><b-icon icon=\"card-checklist\" aria-hidden=\"true\"></b-icon> CONSOLIDADO AUSENCIAS ACUMULADAS</h5>\n          </template>\n          <b-card-text>\n            <b-row>\n              <b-col lg=\"2\">\n                <b-form-group label=\"Periodo:\" label-for=\"periodo\" class=\"etiqueta\">\n                  <b-form-select id=\"periodo\" ref=\"periodo\" v-model=\"idPeriodo\" :options=\"comboPeriodos\" @change=\"idSede=null,idCurso=null\"></b-form-select>\n                </b-form-group>\n              </b-col>\n              <b-col lg=\"6\">\n                <b-form-group label=\"Seleccione la Sede:\" label-for=\"sedes\" class=\"etiqueta\">\n                  <b-form-select  id=\"sedes\" ref=\"sedes\" v-model=\"idSede\" :options=\"comboSedes\" @change=\"idCurso=null,ocuparComboCursosSede()\" :disabled=\"idPeriodo!=null ? false : true\"></b-form-select>\n                </b-form-group>\n              </b-col>\n              <b-col lg=\"4\">\n                <b-form-group label=\"Seleccione el Curso:\" label-for=\"cursos\" class=\"etiqueta\">\n                  <b-form-select id=\"cursos\" ref=\"cursos\" v-model=\"idCurso\" :options=\"comboCursosSede\" @change=\"consultarEstudiantes()\" :disabled=\"idSede!=null ? false : true\"></b-form-select>\n                </b-form-group>\n              </b-col>\n            </b-row>\n          </b-card-text>\n        </b-card>\n      </b-col>\n    </b-row>\n    <b-row>\n      <b-col lg=\"12\">\n        <div v-if=\"btnCargando\">\n          <div class=\"text-center m-5 text-primary\">\n            <b-spinner style=\"width: 3rem; height: 3rem;\" label=\"Spinner\"></b-spinner>\n            <br><strong>Cargando informe...</strong>\n          </div>\n        </div>\n      </b-col>\n    </b-row>\n    <b-row v-if=\"!btnCargando && idCurso!=null\">\n      <b-col lg=\"12\">\n        <table border=\"1\" cellspacing=\"0\" cellpadding=\"1\" class=\"tabla-ausencias\">\n          <thead>\n            <tr>\n              <th rowspan=\"2\">#</th>\n              <th rowspan=\"2\">Estudiante</th>\n              <template v-for=\"(asig,i) in asignaturasValidas\">\n                <th :colspan=\"2\" :key=\"'head-' + i\">{{ asig.asignatura }}</th>\n              </template>\n              <th rowspan=\"2\">TotalAJ</th>\n              <th rowspan=\"2\">TotalAS</th>\n              <th rowspan=\"2\">#</th>\n            </tr>\n            <tr>\n              <template v-for=\"(asig,i) in asignaturasValidas\">\n                <th :key=\"'headJ-' + i\">AJ</th>\n                <th :key=\"'headS-' + i\">AS</th>\n              </template>\n            </tr>\n          </thead>\n          <tbody>\n            <tr v-for=\"(est,cont) in ausenciasConsolidadas\" :key=\"est.idMatricula\">\n              <td>{{ cont + 1 }}</td>\n              <td style=\"text-align: left\">{{ est.estudiante }}</td>\n              <template v-for=\"(asig,i) in asignaturasValidas\">\n                <td :key=\"i + 'J-' + est.estudiante + asig.asignatura\">{{ getAusencia(est, asig, 'ausJ') }}</td>\n                <td :key=\"i + 'S-' + est.estudiante + asig.asignatura\">{{ getAusencia(est, asig, 'ausS') }}</td>\n              </template>\n              <td><strong>{{ est.totalAusJ }}</strong></td>\n              <td><strong>{{ est.totalAusS }}</strong></td>\n              <td>{{ cont + 1 }}</td>\n            </tr>\n            <tr style=\"background-color: #f0f0f0; font-weight: bold;\">\n              <td colspan=\"2\"><strong>Totales</strong></td>\n              <template v-for=\"(asig,i) in asignaturasValidas\">\n                <td :key=\"i + 'J-' + asig.asignatura\">{{ totalesPorAsignatura[asig.asignatura].ausJ }}</td>\n                <td :key=\"i + 'S-' + asig.asignatura\">{{ totalesPorAsignatura[asig.asignatura].ausS }}</td>\n              </template>\n              <td>{{ ausenciasConsolidadas.reduce((sum, est) => sum + est.totalAusJ, 0) }}</td>\n              <td>{{ ausenciasConsolidadas.reduce((sum, est) => sum + est.totalAusS, 0) }}</td>\n              <td></td>\n            </tr>\n          </tbody>\n        </table>\n        <div style=\"margin-bottom: 1rem\">\n          <b-button class=\"small mx-1 mt-3\" variant=\"primary\" @click=\"imprimir\">Imprimir Consolidado</b-button>\n          <b-button class=\"small mx-1 mt-3\" variant=\"outline-primary\" @click=\"exportarAExcel\">Exportar a Excel</b-button>\n        </div>\n      </b-col>\n    </b-row>\n  </div>\n</template>\n\n<script>\n  import axios from \"axios\"\n  import * as CONFIG from '@/assets/config.js'\n  import * as XLSX from 'xlsx'\n\n  export default {\n    name: 'ausenciasperiodos',\n    props: {\n    },\n    components: {\n    },\n    data () {\n      return {\n        idSede: null,\n        comboSedes: [],\n        idPeriodo: null,\n        comboPeriodos: null,\n        idCurso: null,\n        comboCursosSede: [],\n        nombreSede: null,\n        nombreCurso: null,\n        idNivel: null,\n        btnCargando: false,\n        dataConsultada: [],\n        datosSeccion: {},\n        listaAreasAsignaturas: [],\n        listaEstudiantes: [],\n        ausencias: [],\n      }\n    },\n    methods: {\n      getAusencia(est, asignatura, tipo) {\n        const clave = asignatura?.asignatura || asignatura\n        return est?.asignaturas?.[clave]?.[tipo] > 0 ? est?.asignaturas?.[clave]?.[tipo] ?? 0 : ''\n      },\n      async consultarEstudiantes() {\n        this.btnCargando = true\n        this.nombreSede = document.getElementById('sedes')[document.getElementById('sedes').selectedIndex].text\n        if (this.idCurso != null) { \n          this.nombreCurso = document.getElementById('cursos')[document.getElementById('cursos').selectedIndex].text\n          this.$store.state.datosCursos.forEach(element => {\n            if (element.id == this.idCurso) {\n              this.idNivel = element.id_nivel\n            }\n          })\n          this.listaEstudiantes = []\n          await axios\n          .get(CONFIG.ROOT_PATH + 'consolidado/listaestudiantes/curso', { params: { idCurso: this.idCurso, vigencia: this.$store.state.aLectivo }})\n          .then(response => {\n            if (response.data.error){\n              this.mensajeEmergente('danger',CONFIG.TITULO_MSG,response.data.mensaje + ' - Consulta Lista Curso')\n            } else{\n              if (response.data.datos != 0) {\n                this.listaEstudiantes = response.data.datos\n              }\n            }\n          })\n          .catch(err => {\n            this.mensajeEmergente('danger',CONFIG.TITULO_MSG,'Algo salio mal y no se pudo realizar: Consulta Lista Curso. Intente ms tarde.' + err)\n          })\n          this.listaAreasAsignaturas = []\n          await axios\n          .get(CONFIG.ROOT_PATH + 'consolidados/areasasignaturas/curso', {params: {idCurso: this.idCurso}})\n          .then(response => {\n            if (response.data.error){\n              this.mensajeEmergente('danger',CONFIG.TITULO_MSG,response.data.mensaje + ' - Lista areas-asignaturas curso')\n              this.btnCargando = false\n            } else{\n              if (response.data.datos != 0) {\n                this.listaAreasAsignaturas = response.data.datos\n              }\n            }\n          })\n          .catch(err => {\n            this.mensajeEmergente('danger',CONFIG.TITULO_MSG,'Algo salio mal y no se pudo realizar: Lista areas-asignaturas curso. Intente ms tarde.' + err)\n            this.btnCargando = false\n          })\n          this.dataConsultada = []\n          await axios\n          .get(CONFIG.ROOT_PATH + 'consolidados/ausencias/curso/periodos', {params: {idCurso: this.idCurso, periodo: this.idPeriodo, vigencia: this.$store.state.aLectivo}})\n          .then(response => {\n            if (response.data.error){\n              this.mensajeEmergente('danger',CONFIG.TITULO_MSG,response.data.mensaje + ' - Consolidados ausencias curso acumuladas')\n              this.btnCargando = false\n            } else{\n              if (response.data.datos != 0) {\n                this.dataConsultada = response.data.datos\n              }\n            }\n          })\n          .catch(err => {\n            this.mensajeEmergente('danger',CONFIG.TITULO_MSG,'Algo salio mal y no se pudo realizar: Consolidados ausencias curso acumuladas. Intente ms tarde.' + err)\n            this.btnCargando = false\n          })\n        }\n        //console.log(JSON.stringify(this.listaEstudiantes))\n        //console.log(JSON.stringify(this.listaAreasAsignaturas))\n        //console.log(JSON.stringify(this.dataConsultada))\n        this.btnCargando = false\n      },\n      imprimir() {\n        let fecha = 'Fecha: ' + new Date().toLocaleString()\n        let tituloInforme = 'CONSOLIDADO DE AUSENCIAS ACUMULADAS'\n        const contenido = document.querySelector('table').outerHTML\n        const ventana = window.open(\"Ausencias\", \"_blank\")\n        ventana.document.write(`<html><head><title>Ausencias</title></head>\n        <style scoped>\n          .tabla-ausencias {\n              border-collapse: collapse;\n              width: 100%;\n              text-align: center;\n              font-size: 10px;\n          }\n          .tabla-ausencias th {\n            background: #eee;\n          }\n        </style>\n          <body class=\"container\">\n            <p style=\"text-align: center; font-size: 12px;\">SECRETARA DE EDUCACIN TERRITORIAL DE TUNJA<br><b>${this.$store.state.nombreInstitucion}</b><br>TUNJA - BOYAC<br>${tituloInforme}<br>Sede: ${this.nombreSede} | Curso: ${this.nombreCurso} | Ao Lectivo ${this.$store.state.aLectivo} | Periodo: ${this.idPeriodo}</p>\n            ${contenido}\n            <div style=\"text-align: right; font-size: 12px;\"><i>${fecha}</i></div>\n          </body>\n        </html>`)\n        ventana.document.close()\n        ventana.print()\n      },\n      exportarAExcel() {\n        const tabla = document.querySelector('table')\n        const wb = XLSX.utils.table_to_book(tabla)\n        XLSX.writeFile(wb, 'ausencias.xlsx')\n      },\n      async ocuparComboCursosSede() {\n        this.comboCursosSede = []\n        this.$store.state.datosCursos.forEach(element => {\n          if (element.id_sede == this.idSede) {\n            this.comboCursosSede.push({ 'value': element.id, 'text': element.nomenclatura.toUpperCase() })\n          }\n        })\n      },\n      async ocuparComboSedes() {\n        this.comboSedes = []\n        this.$store.state.datosSedes.forEach(element => {\n          this.comboSedes.push({ 'value': element.id, 'text': element.sede.toUpperCase() })\n        })\n      },\n      async ocuparComboPeriodos() {\n        this.comboPeriodos = []\n        this.$store.state.periodos.forEach(element => {\n          this.comboPeriodos.push({ 'value': element.id, 'text': element.periodo.toUpperCase() })\n        })\n      },\n      mensajeEmergente(variante, titulo, contenido) {\n        this.$bvToast.toast(contenido, { title: titulo, variant: variante, toaster: \"b-toaster-top-center\", solid: true, autoHideDelay: 4000, appendToast: false })\n      }\n    },\n    computed: {\n      asignaturasValidas() {\n        return this.listaAreasAsignaturas.filter(a => a.orden !== 999)\n      },\n      ausenciasConsolidadas() {\n        return this.listaEstudiantes.map(est => {\n          const fila = {\n            estudiante: est.estudiante,\n            idMatricula: est.idMatricula,\n            asignaturas: {},\n            totalAusJ: 0,\n            totalAusS: 0\n          }\n          this.asignaturasValidas.forEach(asig => {\n            const registros = this.dataConsultada.filter(dc =>\n              dc.idMatricula === est.idMatricula &&\n              dc.asignatura === asig.asignatura &&\n              dc.periodo <= this.idPeriodo\n            )\n            const ausJ = registros.reduce((sum, r) => sum + (parseInt(r.ausJ) || 0), 0)\n            const ausS = registros.reduce((sum, r) => sum + (parseInt(r.ausS) || 0), 0)\n\n            fila.asignaturas[asig.asignatura] = { ausJ, ausS }\n            fila.totalAusJ += ausJ\n            fila.totalAusS += ausS\n          })\n          return fila\n        })\n      },\n      totalesPorAsignatura() {\n        const totales = {}\n        this.asignaturasValidas.forEach(asig => {\n          let ausJ = 0, ausS = 0\n          this.ausenciasConsolidadas.forEach(est => {\n            ausJ += est.asignaturas[asig.asignatura]?.ausJ || 0\n            ausS += est.asignaturas[asig.asignatura]?.ausS || 0\n          })\n          totales[asig.asignatura] = { ausJ, ausS }\n        })\n        return totales\n      }\n    },\n    beforeMount() {\n      this.ocuparComboSedes()\n      this.ocuparComboPeriodos()\n      this.datosSeccion = this.$store.state.datosSecciones[this.$store.state.idSeccion - 1]\n    }\n  }\n</script>\n<style scoped>\n  .tabla-ausencias {\n      border-collapse: collapse;\n      width: 100%;\n      text-align: center;\n      font-size: 10px;\n  }\n  .tabla-ausencias th {\n    background: #eee;\n  }\n</style>\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AusenciasPeriodos.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AusenciasPeriodos.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./AusenciasPeriodos.vue?vue&type=template&id=c83aa168&scoped=true&\"\nimport script from \"./AusenciasPeriodos.vue?vue&type=script&lang=js&\"\nexport * from \"./AusenciasPeriodos.vue?vue&type=script&lang=js&\"\nimport style0 from \"./AusenciasPeriodos.vue?vue&type=style&index=0&id=c83aa168&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"c83aa168\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('b-row',{staticClass:\"mt-2\"},[_c('b-col',{attrs:{\"lg\":\"12\"}},[_c('b-card',{scopedSlots:_vm._u([{key:\"header\",fn:function(){return [_c('h5',{staticClass:\"mb-0\"},[_c('b-icon',{attrs:{\"icon\":\"card-checklist\",\"aria-hidden\":\"true\"}}),_vm._v(\" RESUMEN FINAL DE EVALUACIONES\")],1)]},proxy:true},{key:\"footer\",fn:function(){return [_c('em',[_vm._v(\"Consulta desempeos finales.\")])]},proxy:true}])},[_c('b-card-text',[_c('b-row',[_c('b-col',{attrs:{\"lg\":\"3\"}},[_c('b-form-group',{staticClass:\"etiqueta\",attrs:{\"label\":\"Seleccione la Sede:\",\"label-for\":\"sedes\"}},[_c('b-form-select',{ref:\"sedes\",attrs:{\"id\":\"sedes\",\"options\":_vm.comboSedes},on:{\"change\":function($event){_vm.idCurso=null,_vm.idMatricula=null,_vm.ocuparComboCursosSede()}},model:{value:(_vm.idSede),callback:function ($$v) {_vm.idSede=$$v},expression:\"idSede\"}})],1)],1),_c('b-col',{attrs:{\"lg\":\"3\"}},[_c('b-form-group',{staticClass:\"etiqueta\",attrs:{\"label\":\"Seleccione el Curso:\",\"label-for\":\"cursos\"}},[_c('b-form-select',{ref:\"cursos\",attrs:{\"id\":\"cursos\",\"options\":_vm.comboCursosSede,\"disabled\":_vm.idSede!=null ? false : true},on:{\"change\":function($event){_vm.idMatricula=null,_vm.ocuparComboEstudiantes(),_vm.consultaAsignaturasCurso()}},model:{value:(_vm.idCurso),callback:function ($$v) {_vm.idCurso=$$v},expression:\"idCurso\"}})],1)],1),_c('b-col',{attrs:{\"lg\":\"6\"}},[_c('b-form-group',{staticClass:\"etiqueta\",attrs:{\"label\":\"Seleccione el Estudiante:\",\"label-for\":\"estud\"}},[_c('b-form-select',{ref:\"estud\",attrs:{\"id\":\"estud\",\"options\":_vm.comboEstudiantes,\"disabled\":_vm.idCurso!=null ? false : true},on:{\"change\":function($event){return _vm.estudiantesNotas()}},model:{value:(_vm.idMatricula),callback:function ($$v) {_vm.idMatricula=$$v},expression:\"idMatricula\"}})],1)],1)],1),(_vm.idMatricula!=null)?_c('div',[_c('b-row',[_c('b-col',{attrs:{\"lg\":\"12\"}},[_c('hr')])],1),_c('b-row',[_c('b-col',[(_vm.btnCargando)?_c('div',[_c('div',{staticClass:\"text-center m-5 text-primary\"},[_c('b-spinner',{staticStyle:{\"width\":\"3rem\",\"height\":\"3rem\"},attrs:{\"label\":\"Spinner\"}}),_c('br'),_c('strong',[_vm._v(\"Cargando planilla...\")])],1)]):_c('div',[_c('b-row',{staticClass:\"mt-2\"},[_c('b-col',[_c('vue-good-table',{ref:\"table\",attrs:{\"columns\":_vm.encabColumnas,\"rows\":_vm.listaNotasAsignaturasCurso,\"styleClass\":\"vgt-table condensed bordered striped\",\"line-numbers\":true},scopedSlots:_vm._u([{key:\"table-row\",fn:function(props){return [(props.column.field == 'nombreAsignatura')?_c('span',[_c('span',[_vm._v(_vm._s(props.row.nombreAsignatura))])]):_vm._e(),(props.column.field == 'promedioFinal')?_c('span',[_c('span',[_c('b',[_vm._v(_vm._s(props.row.promedioFinal))])])]):_vm._e(),(props.column.field == 'desempeno')?_c('span',[_c('span',[_c('b',[_vm._v(_vm._s(props.row.desempeno))])])]):_vm._e()]}}],null,false,312808138)},[_c('div',{attrs:{\"slot\":\"emptystate\"},slot:\"emptystate\"},[_c('h5',{staticClass:\"text-danger ml-5\"},[_vm._v(\"No existen asignaturas en la planilla\")])])])],1),_c('b-col',{attrs:{\"lg\":\"12\"}},[_c('div',{staticStyle:{\"margin-bottom\":\"1rem\"}},[_c('b-button',{staticClass:\"small mx-1 mt-3\",attrs:{\"variant\":\"primary\"},on:{\"click\":_vm.imprimir}},[_vm._v(\"Imprimir Consolidado\")]),_c('b-button',{staticClass:\"small mx-1 mt-3\",attrs:{\"variant\":\"outline-primary\"},on:{\"click\":_vm.exportarAExcel}},[_vm._v(\"Exportar a Excel\")])],1)])],1)],1)])],1)],1):_vm._e()],1)],1)],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div>\n    <b-row class=\"mt-2\">\n      <b-col lg=\"12\">\n        <b-card>\n          <template #header>\n            <h5 class=\"mb-0\"><b-icon icon=\"card-checklist\" aria-hidden=\"true\"></b-icon> RESUMEN FINAL DE EVALUACIONES</h5>\n          </template>\n          <b-card-text>\n            <b-row>\n              <b-col lg=\"3\">\n                <b-form-group label=\"Seleccione la Sede:\" label-for=\"sedes\" class=\"etiqueta\">\n                  <b-form-select  id=\"sedes\" ref=\"sedes\" v-model=\"idSede\" :options=\"comboSedes\" @change=\"idCurso=null,idMatricula=null,ocuparComboCursosSede()\"></b-form-select>\n                </b-form-group>\n              </b-col>\n              <b-col lg=\"3\">\n                <b-form-group label=\"Seleccione el Curso:\" label-for=\"cursos\" class=\"etiqueta\">\n                  <b-form-select  id=\"cursos\" ref=\"cursos\" v-model=\"idCurso\" :options=\"comboCursosSede\" @change=\"idMatricula=null,ocuparComboEstudiantes(),consultaAsignaturasCurso()\" :disabled=\"idSede!=null ? false : true\"></b-form-select>\n                </b-form-group>\n              </b-col>\n              <b-col lg=\"6\">\n                <b-form-group label=\"Seleccione el Estudiante:\" label-for=\"estud\" class=\"etiqueta\">\n                  <b-form-select  id=\"estud\" ref=\"estud\" v-model=\"idMatricula\" :options=\"comboEstudiantes\" @change=\"estudiantesNotas()\" :disabled=\"idCurso!=null ? false : true\"></b-form-select>\n                </b-form-group>\n              </b-col>\n            </b-row>\n            <div v-if=\"idMatricula!=null\">\n              <b-row><b-col lg=\"12\"><hr></b-col></b-row>\n              <b-row>\n                <b-col>\n                <div v-if=\"btnCargando\">\n                  <div class=\"text-center m-5 text-primary\">\n                    <b-spinner style=\"width: 3rem; height: 3rem;\" label=\"Spinner\"></b-spinner>\n                    <br><strong>Cargando planilla...</strong>\n                  </div>\n                </div>\n                  <div v-else>\n                    <b-row class=\"mt-2\">\n                      <b-col>\n                        <vue-good-table ref=\"table\" :columns=\"encabColumnas\" :rows=\"listaNotasAsignaturasCurso\" styleClass=\"vgt-table condensed bordered striped\" :line-numbers=\"true\">\n                          <template slot=\"table-row\" slot-scope=\"props\">\n                            <span v-if=\"props.column.field == 'nombreAsignatura'\">\n                              <span>{{props.row.nombreAsignatura}}</span>\n                            </span>\n                            <span v-if=\"props.column.field == 'promedioFinal'\">\n                              <span><b>{{props.row.promedioFinal}}</b></span>\n                            </span>\n                            <span v-if=\"props.column.field == 'desempeno'\">\n                              <span><b>{{props.row.desempeno}}</b></span>\n                            </span>\n                          </template>\n                          <div slot=\"emptystate\">\n                            <h5 class=\"text-danger ml-5\">No existen asignaturas en la planilla</h5>\n                          </div>\n                        </vue-good-table>\n                      </b-col>\n                      <b-col lg=\"12\">\n                        <div style=\"margin-bottom: 1rem\">\n                          <b-button class=\"small mx-1 mt-3\" variant=\"primary\" @click=\"imprimir\">Imprimir Consolidado</b-button>\n                          <b-button class=\"small mx-1 mt-3\" variant=\"outline-primary\" @click=\"exportarAExcel\">Exportar a Excel</b-button>\n                        </div>\n                      </b-col>\n                    </b-row>\n                  </div>\n                </b-col>\n              </b-row>\n            </div>\n          </b-card-text>\n          <template #footer>\n            <em>Consulta desempeos finales.</em>\n          </template>\n        </b-card>\n      </b-col>\n    </b-row>\n  </div>\n</template>\n\n<script>\n  import axios from \"axios\"\n  import * as CONFIG from '@/assets/config.js'\n  import 'vue-good-table/dist/vue-good-table.css'\n  import { VueGoodTable } from 'vue-good-table'\n  import * as XLSX from 'xlsx'\n\n  export default {\n    name: 'resumenfinal',\n    components: {\n      VueGoodTable,\n    },\n    data () {\n      return {\n        idSede: null,\n        comboSedes: [],\n        idCurso: null,\n        comboCursosSede: [],\n        idMatricula: null,\n        comboEstudiantes: [],\n        nombreEstudiante: null,\n        listaAsignaturasCurso: [],\n        encabColumnas: [\n          { label: 'Asignatura', field: 'nombreAsignatura', sortable: false },\n          { label: 'Final', field: 'promedioFinal', sortable: false },\n          { label: 'Desempeo', field: 'desempeno', sortable: false },\n          //{ label: 'Habil', field: 'habilitacion', width: '5%', sortable: false },\n        ],\n        notas: [],\n        btnCargando: false,\n        listaNotasAsignaturasCurso: [],\n      }\n    },\n    methods: {\n      imprimir() {\n        let fecha = 'Fecha: ' + new Date().toLocaleString()\n        let tituloInforme = 'RESUMEN FINAL DE EVALUACIONES'\n        const contenido = document.querySelector('table').outerHTML\n        const ventana = window.open(\"Final\", \"_blank\")\n        ventana.document.write(`<html><head><title>Final</title></head>\n        <style scoped>\n          .tabla-estado-final {\n              border-collapse: collapse;\n              width: 100%;\n              text-align: center;\n              font-size: 10px;\n          }\n          .tabla-estado-final th {\n            background: #eee;\n          }\n        </style>\n          <body class=\"container\">\n            <p style=\"text-align: center; font-size: 12px;\">SECRETARA DE EDUCACIN TERRITORIAL DE TUNJA<br><b>${this.$store.state.nombreInstitucion}</b><br>TUNJA - BOYAC<br>${tituloInforme}<br>Sede: ${this.nombreSede} | Curso: ${this.nombreCurso} | Ao Lectivo ${this.$store.state.aLectivo}<br>Estudiante: ${this.nombreEstudiante}</p>\n            ${contenido}\n            <div style=\"text-align: right; font-size: 12px;\"><i>${fecha}</i></div>\n          </body>\n        </html>`)\n        ventana.document.close()\n        ventana.print()\n      },\n      exportarAExcel() {\n        const tabla = document.querySelector('table')\n        const wb = XLSX.utils.table_to_book(tabla)\n        XLSX.writeFile(wb, 'Promocion.xlsx')\n      },\n      generarPromediosFinalesConDesempeno(asignaturas, notas) {\n        // Agrupar por matrcula + asignatura\n        const agrupado = {}\n        notas.forEach(nota => {\n          const key = `${nota.idMatricula}-${nota.asignatura}`\n          if (!agrupado[key]) {\n            agrupado[key] = {\n              idMatricula: nota.idMatricula,\n              asignatura: nota.asignatura,\n              habilitacion: nota.habilitacion,\n              fecha: nota.fecha,\n              acta: nota.acta,\n              vigencia: this.$store.state.aLectivo,\n              valores: []\n            }\n          }\n          const valor = parseFloat(nota.notaFinal)\n          if (!isNaN(valor)) {\n            agrupado[key].valores.push(valor)\n          }\n        })\n        // Construir array final con promedio y desempeo\n        const resultado = Object.values(agrupado).map(item => {\n          const meta = asignaturas.find(a => a.asignatura === item.asignatura)\n          //  Exclusin directa si no existe o si orden === 99\n          if (!meta || meta.orden === 99) return null\n          const suma = item.valores.reduce((a, b) => a + b, 0)\n          const promedio = item.valores.length > 0 ? this.redondear(suma / item.valores.length).toFixed(1) : null\n          const tipo = meta.idTipoEspecialidad\n          let desempeno = ''\n          if (promedio !== null) {\n            if (tipo == 1)\n              if (promedio < this.datosSeccion.minBas) desempeno = 'BAJO'\n              else if (promedio < this.datosSeccion.minAlt) desempeno = 'BSICO'\n              else if (promedio < this.datosSeccion.minSup) desempeno = 'ALTO'\n              else desempeno = 'SUPERIOR'\n            else {\n              if (promedio < this.datosSeccion.minBasT) desempeno = 'BAJO'\n              else if (promedio < this.datosSeccion.minAltT) desempeno = 'BSICO'\n              else if (promedio < this.datosSeccion.minSupT) desempeno = 'ALTO'\n              else desempeno = 'SUPERIOR'\n            }\n          }\n          return {\n            idMatricula: item.idMatricula,\n            idAsignaturaCurso: meta?.idAsignaturaCurso || null,\n            nombreAsignatura: meta?.nombreAsignatura || item.asignatura,\n            promedioFinal: promedio ? promedio : '',\n            desempeno,\n            habilitacion: item.habilitacion,\n            fecha: item.fecha,\n            acta: item.acta,\n            vigencia: item.vigencia,\n            orden: meta.orden\n          }\n        }).filter(e => e !== null) //  Filtra los excluidos\n        // Ordenar por el campo \"orden\"\n        return resultado.sort((a, b) => a.orden - b.orden)\n      },\n      async estudiantesNotas() {\n        this.btnCargando = true\n        this.notas = []\n        this.nombreSede = document.getElementById('sedes')[document.getElementById('sedes').selectedIndex].text\n        if (this.idMatricula != null) { \n          this.nombreEstudiante = document.getElementById('estud')[document.getElementById('estud').selectedIndex].text\n          this.nombreCurso = document.getElementById('cursos')[document.getElementById('cursos').selectedIndex].text\n          this.$store.state.datosCursos.forEach(element => {\n            if (element.id == this.idCurso) {\n              this.idNivel = element.id_nivel\n            }\n          })\n          await axios\n          .get(CONFIG.ROOT_PATH + 'academico/notashabilitaciones/estudiante', {params: {idCurso: this.idCurso, idMatricula: this.idMatricula, vigencia: this.$store.state.aLectivo}})\n          .then(response => {\n            if (response.data.error){\n              this.mensajeEmergente('danger',CONFIG.TITULO_MSG,response.data.mensaje + ' - Consolidados asignaturas curso periodo')\n              this.btnCargando = false\n            } else{\n              if (response.data.datos != 0) {\n                this.notas = response.data.datos\n              }\n            }\n          })\n          .catch(err => {\n            this.mensajeEmergente('danger',CONFIG.TITULO_MSG,'Algo salio mal y no se pudo realizar: Consolidados asignaturas curso periodo. Intente ms tarde.' + err)\n            this.btnCargando = false\n          })\n          //console.log(JSON.stringify(this.notas))\n          this.listaNotasAsignaturasCurso = this.notas.length ? this.generarPromediosFinalesConDesempeno(this.listaAsignaturasCurso, this.notas) : false\n        }\n        this.btnCargando = false\n      },\n      async consultaAsignaturasCurso() {\n        this.listaAsignaturasCurso = []\n        await axios\n        .get(CONFIG.ROOT_PATH + 'academico/asignacioncurso/habilitaciones', {params: {idCurso: this.idCurso}})\n        .then(response => {\n          if (response.data.error){\n            this.mensajeEmergente('danger',CONFIG.TITULO_MSG,response.data.mensaje + ' - Lista asignaturas curso')\n          } else{\n            if (response.data.datos != 0) {\n              this.listaAsignaturasCurso = response.data.datos\n            }\n          }\n        })\n        .catch(err => {\n          this.mensajeEmergente('danger',CONFIG.TITULO_MSG,'Algo salio mal y no se pudo realizar: Lista asignacin docentes curso. Intente ms tarde.' + err)\n        })\n        //console.log(JSON.stringify(this.listaAsignaturasCurso))\n      },\n      async ocuparComboEstudiantes() {\n        this.comboEstudiantes = []\n        await axios\n        .get(CONFIG.ROOT_PATH + 'academico/listacurso/habilitaciones', { params: { idCurso: this.idCurso, vigencia: this.$store.state.aLectivo }})\n        .then(response => {\n          if (response.data.error){\n            this.mensajeEmergente('danger',CONFIG.TITULO_MSG,response.data.mensaje + ' - Consulta Lista Curso')\n          } else{\n            if (response.data.datos != 0) {\n              response.data.datos.forEach(element => {\n                this.comboEstudiantes.push({ 'value': element.idMatricula, 'text': element.estudiante })\n              })\n            }\n          }\n        })\n        .catch(err => {\n          this.mensajeEmergente('danger',CONFIG.TITULO_MSG,'Algo salio mal y no se pudo realizar: Consulta Lista Curso. Intente ms tarde.' + err)\n        })\n      },\n      async ocuparComboCursosSede() {\n        this.comboCursosSede = []\n        this.$store.state.datosCursos.forEach(element => {\n          if (element.id_sede == this.idSede) {\n            this.comboCursosSede.push({ 'value': element.id, 'text': element.nomenclatura.toUpperCase() })\n          }\n        })\n      },\n      async ocuparComboSedes() {\n        this.comboSedes = []\n        this.$store.state.datosSedes.forEach(element => {\n          this.comboSedes.push({ 'value': element.id, 'text': element.sede.toUpperCase() })\n        })\n      },\n      handleKeyNavigation(event, i, col) {\n        if (event.key === \"ArrowDown\") {\n          const nextInput = this.$refs[`${col}-${i + 1}`]\n          if (nextInput) nextInput.focus()\n        } else if (event.key === \"ArrowUp\") {\n          const previousInput = this.$refs[`${col}-${i - 1}`]\n          if (previousInput) previousInput.focus()\n        }\n      },\n      redondear(num) {\n        var m = Number((Math.abs(num) * 10).toPrecision(15))\n        return Math.round(m) / 10 * Math.sign(num);\n      },\n      soloNumeros(e) {\n        let key = window.Event ? e.which : e.keyCode\n        if (!((key >= 48 && key <= 57) || (key >= 96 && key <= 105) || (key == 8) || (key == 9) || (key == 37) || (key == 39))) {\n            e.preventDefault()\n        }\n      },\n      soloDecimales(e) {\n        let key = window.Event ? e.which : e.keyCode\n        if (!((key >= 48 && key <= 57) || (key >= 96 && key <= 105) || (key == 8) || (key == 9) || (key == 37) || (key == 39) || (key == 110) || (key == 189) || (key == 190))) {\n            e.preventDefault()\n        }\n      },\n      tdClassFuncDiversa(fila) {\n        if (fila.id_diversa == 'S') {\n          return 'text-center alert alert-warning'\n        }\n      },\n      mensajeEmergente(variante, titulo, contenido) {\n        this.$bvToast.toast(contenido, { title: titulo, variant: variante, toaster: \"b-toaster-top-center\", solid: true, autoHideDelay: 4000, appendToast: false })\n      }\n    },\n    beforeMount() {\n      if(this.$store.state.idRol == 1 || this.$store.state.idRol == 12 || this.$store.state.perActNotas == 1) {\n        this.ocuparComboSedes()\n        this.datosSeccion = this.$store.state.datosSecciones[this.$store.state.idSeccion - 1]\n        //console.log(JSON.stringify(this.datosSeccion))\n      } else {\n        this.$router.push('/restringida')\n      }\n    },\n    computed: {\n    }\n  }\n</script>","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ResumenFinal.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ResumenFinal.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ResumenFinal.vue?vue&type=template&id=1da42538&\"\nimport script from \"./ResumenFinal.vue?vue&type=script&lang=js&\"\nexport * from \"./ResumenFinal.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('b-row',{staticClass:\"mt-2\"},[_c('b-col',{attrs:{\"lg\":\"12\"}},[_c('b-card',{scopedSlots:_vm._u([{key:\"header\",fn:function(){return [_c('h5',{staticClass:\"mb-0\"},[_c('b-icon',{attrs:{\"icon\":\"card-checklist\",\"aria-hidden\":\"true\"}}),_vm._v(\" RESUMEN FINAL DE EVALUACIONES CON HABILITACIONES\")],1)]},proxy:true},{key:\"footer\",fn:function(){return [_c('em',[_vm._v(\"Consulta desempeos finales.\")])]},proxy:true}])},[_c('b-card-text',[_c('b-row',[_c('b-col',{attrs:{\"lg\":\"3\"}},[_c('b-form-group',{staticClass:\"etiqueta\",attrs:{\"label\":\"Seleccione la Sede:\",\"label-for\":\"sedes\"}},[_c('b-form-select',{ref:\"sedes\",attrs:{\"id\":\"sedes\",\"options\":_vm.comboSedes},on:{\"change\":function($event){_vm.idCurso=null,_vm.idMatricula=null,_vm.ocuparComboCursosSede()}},model:{value:(_vm.idSede),callback:function ($$v) {_vm.idSede=$$v},expression:\"idSede\"}})],1)],1),_c('b-col',{attrs:{\"lg\":\"3\"}},[_c('b-form-group',{staticClass:\"etiqueta\",attrs:{\"label\":\"Seleccione el Curso:\",\"label-for\":\"cursos\"}},[_c('b-form-select',{ref:\"cursos\",attrs:{\"id\":\"cursos\",\"options\":_vm.comboCursosSede,\"disabled\":_vm.idSede!=null ? false : true},on:{\"change\":function($event){_vm.idMatricula=null,_vm.ocuparComboEstudiantes(),_vm.consultaAsignaturasCurso()}},model:{value:(_vm.idCurso),callback:function ($$v) {_vm.idCurso=$$v},expression:\"idCurso\"}})],1)],1),_c('b-col',{attrs:{\"lg\":\"6\"}},[_c('b-form-group',{staticClass:\"etiqueta\",attrs:{\"label\":\"Seleccione el Estudiante:\",\"label-for\":\"estud\"}},[_c('b-form-select',{ref:\"estud\",attrs:{\"id\":\"estud\",\"options\":_vm.comboEstudiantes,\"disabled\":_vm.idCurso!=null ? false : true},on:{\"change\":function($event){return _vm.estudiantesNotas()}},model:{value:(_vm.idMatricula),callback:function ($$v) {_vm.idMatricula=$$v},expression:\"idMatricula\"}})],1)],1)],1),(_vm.idMatricula!=null)?_c('div',[_c('b-row',[_c('b-col',{attrs:{\"lg\":\"12\"}},[_c('hr')])],1),_c('b-row',[_c('b-col',[(_vm.btnCargando)?_c('div',[_c('div',{staticClass:\"text-center m-5 text-primary\"},[_c('b-spinner',{staticStyle:{\"width\":\"3rem\",\"height\":\"3rem\"},attrs:{\"label\":\"Spinner\"}}),_c('br'),_c('strong',[_vm._v(\"Cargando planilla...\")])],1)]):_c('div',[_c('b-row',{staticClass:\"mt-2\"},[_c('b-col',[_c('vue-good-table',{ref:\"table\",attrs:{\"columns\":_vm.encabColumnas,\"rows\":_vm.listaNotasAsignaturasCurso,\"styleClass\":\"vgt-table condensed bordered striped\",\"line-numbers\":true},scopedSlots:_vm._u([{key:\"table-row\",fn:function(props){return [(props.column.field == 'nombreAsignatura')?_c('span',[_c('span',[_vm._v(_vm._s(props.row.nombreAsignatura))])]):_vm._e(),(props.column.field == 'promedioFinal')?_c('span',[_c('span',[_c('b',[_vm._v(_vm._s(props.row.promedioFinal))])])]):_vm._e(),(props.column.field == 'desempeno')?_c('span',[_c('span',[_c('b',[_vm._v(_vm._s(props.row.desempeno))])])]):_vm._e(),(props.column.field == 'habilitacion')?_c('span',[_c('span',[_c('b',[_vm._v(_vm._s(props.row.habilitacion))])])]):_vm._e()]}}],null,false,1171639959)},[_c('div',{attrs:{\"slot\":\"emptystate\"},slot:\"emptystate\"},[_c('h5',{staticClass:\"text-danger ml-5\"},[_vm._v(\"No existen asignaturas en la planilla\")])])])],1),_c('b-col',{attrs:{\"lg\":\"12\"}},[_c('div',{staticStyle:{\"margin-bottom\":\"1rem\"}},[_c('b-button',{staticClass:\"small mx-1 mt-3\",attrs:{\"variant\":\"primary\"},on:{\"click\":_vm.imprimir}},[_vm._v(\"Imprimir Consolidado\")]),_c('b-button',{staticClass:\"small mx-1 mt-3\",attrs:{\"variant\":\"outline-primary\"},on:{\"click\":_vm.exportarAExcel}},[_vm._v(\"Exportar a Excel\")])],1)])],1)],1)])],1)],1):_vm._e()],1)],1)],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div>\n    <b-row class=\"mt-2\">\n      <b-col lg=\"12\">\n        <b-card>\n          <template #header>\n            <h5 class=\"mb-0\"><b-icon icon=\"card-checklist\" aria-hidden=\"true\"></b-icon> RESUMEN FINAL DE EVALUACIONES CON HABILITACIONES</h5>\n          </template>\n          <b-card-text>\n            <b-row>\n              <b-col lg=\"3\">\n                <b-form-group label=\"Seleccione la Sede:\" label-for=\"sedes\" class=\"etiqueta\">\n                  <b-form-select  id=\"sedes\" ref=\"sedes\" v-model=\"idSede\" :options=\"comboSedes\" @change=\"idCurso=null,idMatricula=null,ocuparComboCursosSede()\"></b-form-select>\n                </b-form-group>\n              </b-col>\n              <b-col lg=\"3\">\n                <b-form-group label=\"Seleccione el Curso:\" label-for=\"cursos\" class=\"etiqueta\">\n                  <b-form-select  id=\"cursos\" ref=\"cursos\" v-model=\"idCurso\" :options=\"comboCursosSede\" @change=\"idMatricula=null,ocuparComboEstudiantes(),consultaAsignaturasCurso()\" :disabled=\"idSede!=null ? false : true\"></b-form-select>\n                </b-form-group>\n              </b-col>\n              <b-col lg=\"6\">\n                <b-form-group label=\"Seleccione el Estudiante:\" label-for=\"estud\" class=\"etiqueta\">\n                  <b-form-select  id=\"estud\" ref=\"estud\" v-model=\"idMatricula\" :options=\"comboEstudiantes\" @change=\"estudiantesNotas()\" :disabled=\"idCurso!=null ? false : true\"></b-form-select>\n                </b-form-group>\n              </b-col>\n            </b-row>\n            <div v-if=\"idMatricula!=null\">\n              <b-row><b-col lg=\"12\"><hr></b-col></b-row>\n              <b-row>\n                <b-col>\n                <div v-if=\"btnCargando\">\n                  <div class=\"text-center m-5 text-primary\">\n                    <b-spinner style=\"width: 3rem; height: 3rem;\" label=\"Spinner\"></b-spinner>\n                    <br><strong>Cargando planilla...</strong>\n                  </div>\n                </div>\n                  <div v-else>\n                    <b-row class=\"mt-2\">\n                      <b-col>\n                        <vue-good-table ref=\"table\" :columns=\"encabColumnas\" :rows=\"listaNotasAsignaturasCurso\" styleClass=\"vgt-table condensed bordered striped\" :line-numbers=\"true\">\n                          <template slot=\"table-row\" slot-scope=\"props\">\n                            <span v-if=\"props.column.field == 'nombreAsignatura'\">\n                              <span>{{props.row.nombreAsignatura}}</span>\n                            </span>\n                            <span v-if=\"props.column.field == 'promedioFinal'\">\n                              <span><b>{{props.row.promedioFinal}}</b></span>\n                            </span>\n                            <span v-if=\"props.column.field == 'desempeno'\">\n                              <span><b>{{props.row.desempeno}}</b></span>\n                            </span>\n                            <span v-if=\"props.column.field == 'habilitacion'\">\n                              <span><b>{{props.row.habilitacion}}</b></span>\n                            </span>\n                          </template>\n                          <div slot=\"emptystate\">\n                            <h5 class=\"text-danger ml-5\">No existen asignaturas en la planilla</h5>\n                          </div>\n                        </vue-good-table>\n                      </b-col>\n                      <b-col lg=\"12\">\n                        <div style=\"margin-bottom: 1rem\">\n                          <b-button class=\"small mx-1 mt-3\" variant=\"primary\" @click=\"imprimir\">Imprimir Consolidado</b-button>\n                          <b-button class=\"small mx-1 mt-3\" variant=\"outline-primary\" @click=\"exportarAExcel\">Exportar a Excel</b-button>\n                        </div>\n                      </b-col>\n                    </b-row>\n                  </div>\n                </b-col>\n              </b-row>\n            </div>\n          </b-card-text>\n          <template #footer>\n            <em>Consulta desempeos finales.</em>\n          </template>\n        </b-card>\n      </b-col>\n    </b-row>\n  </div>\n</template>\n\n<script>\n  import axios from \"axios\"\n  import * as CONFIG from '@/assets/config.js'\n  import 'vue-good-table/dist/vue-good-table.css'\n  import { VueGoodTable } from 'vue-good-table'\n  import * as XLSX from 'xlsx'\n\n  export default {\n    name: 'resumenfinalhab',\n    components: {\n      VueGoodTable,\n    },\n    data () {\n      return {\n        idSede: null,\n        comboSedes: [],\n        idCurso: null,\n        comboCursosSede: [],\n        idMatricula: null,\n        comboEstudiantes: [],\n        nombreEstudiante: null,\n        listaAsignaturasCurso: [],\n        encabColumnas: [\n          { label: 'Asignatura', field: 'nombreAsignatura', sortable: false },\n          { label: 'Final', field: 'promedioFinal', sortable: false },\n          { label: 'Desempeo', field: 'desempeno', sortable: false },\n          { label: 'Habil', field: 'habilitacion', width: '5%', sortable: false },\n        ],\n        notas: [],\n        btnCargando: false,\n        listaNotasAsignaturasCurso: [],\n      }\n    },\n    methods: {\n      imprimir() {\n        let fecha = 'Fecha: ' + new Date().toLocaleString()\n        let tituloInforme = 'RESUMEN FINAL DE EVALUACIONES CON HABILITACIONES'\n        const contenido = document.querySelector('table').outerHTML\n        const ventana = window.open(\"FinalHabil\", \"_blank\")\n        ventana.document.write(`<html><head><title>FinalHabil</title></head>\n        <style scoped>\n          .tabla-estado-final {\n              border-collapse: collapse;\n              width: 100%;\n              text-align: center;\n              font-size: 10px;\n          }\n          .tabla-estado-final th {\n            background: #eee;\n          }\n        </style>\n          <body class=\"container\">\n            <p style=\"text-align: center; font-size: 12px;\">SECRETARA DE EDUCACIN TERRITORIAL DE TUNJA<br><b>${this.$store.state.nombreInstitucion}</b><br>TUNJA - BOYAC<br>${tituloInforme}<br>Sede: ${this.nombreSede} | Curso: ${this.nombreCurso} | Ao Lectivo ${this.$store.state.aLectivo}<br>Estudiante: ${this.nombreEstudiante}</p>\n            ${contenido}\n            <div style=\"text-align: right; font-size: 12px;\"><i>${fecha}</i></div>\n          </body>\n        </html>`)\n        ventana.document.close()\n        ventana.print()\n      },\n      exportarAExcel() {\n        const tabla = document.querySelector('table')\n        const wb = XLSX.utils.table_to_book(tabla)\n        XLSX.writeFile(wb, 'Promocion.xlsx')\n      },\n      generarPromediosFinalesConDesempeno(asignaturas, notas) {\n        // Agrupar por matrcula + asignatura\n        const agrupado = {}\n        notas.forEach(nota => {\n          const key = `${nota.idMatricula}-${nota.asignatura}`\n          if (!agrupado[key]) {\n            agrupado[key] = {\n              idMatricula: nota.idMatricula,\n              asignatura: nota.asignatura,\n              habilitacion: nota.habilitacion,\n              fecha: nota.fecha,\n              acta: nota.acta,\n              vigencia: this.$store.state.aLectivo,\n              valores: []\n            }\n          }\n          const valor = parseFloat(nota.notaFinal)\n          if (!isNaN(valor)) {\n            agrupado[key].valores.push(valor)\n          }\n        })\n        // Construir array final con promedio y desempeo\n        const resultado = Object.values(agrupado).map(item => {\n          const meta = asignaturas.find(a => a.asignatura === item.asignatura)\n          //  Exclusin directa si no existe o si orden === 99\n          if (!meta || meta.orden === 99) return null\n          const suma = item.valores.reduce((a, b) => a + b, 0)\n          const promedio = item.valores.length > 0 ? this.redondear(suma / item.valores.length).toFixed(1) : null\n          const tipo = meta.idTipoEspecialidad\n          let desempeno = ''\n          if (promedio !== null) {\n            if (tipo == 1)\n              if (promedio < this.datosSeccion.minBas) desempeno = 'BAJO'\n              else if (promedio < this.datosSeccion.minAlt) desempeno = 'BSICO'\n              else if (promedio < this.datosSeccion.minSup) desempeno = 'ALTO'\n              else desempeno = 'SUPERIOR'\n            else {\n              if (promedio < this.datosSeccion.minBasT) desempeno = 'BAJO'\n              else if (promedio < this.datosSeccion.minAltT) desempeno = 'BSICO'\n              else if (promedio < this.datosSeccion.minSupT) desempeno = 'ALTO'\n              else desempeno = 'SUPERIOR'\n            }\n          }\n          return {\n            idMatricula: item.idMatricula,\n            idAsignaturaCurso: meta?.idAsignaturaCurso || null,\n            nombreAsignatura: meta?.nombreAsignatura || item.asignatura,\n            promedioFinal: promedio ? promedio : '',\n            desempeno,\n            habilitacion: item.habilitacion,\n            fecha: item.fecha,\n            acta: item.acta,\n            vigencia: item.vigencia,\n            orden: meta.orden\n          }\n        }).filter(e => e !== null) //  Filtra los excluidos\n        // Ordenar por el campo \"orden\"\n        return resultado.sort((a, b) => a.orden - b.orden)\n      },\n      async estudiantesNotas() {\n        this.btnCargando = true\n        this.notas = []\n        this.nombreSede = document.getElementById('sedes')[document.getElementById('sedes').selectedIndex].text\n        if (this.idMatricula != null) { \n          this.nombreEstudiante = document.getElementById('estud')[document.getElementById('estud').selectedIndex].text\n          this.nombreCurso = document.getElementById('cursos')[document.getElementById('cursos').selectedIndex].text\n          this.$store.state.datosCursos.forEach(element => {\n            if (element.id == this.idCurso) {\n              this.idNivel = element.id_nivel\n            }\n          })\n          await axios\n          .get(CONFIG.ROOT_PATH + 'academico/notashabilitaciones/estudiante', {params: {idCurso: this.idCurso, idMatricula: this.idMatricula, vigencia: this.$store.state.aLectivo}})\n          .then(response => {\n            if (response.data.error){\n              this.mensajeEmergente('danger',CONFIG.TITULO_MSG,response.data.mensaje + ' - Consolidados asignaturas curso periodo')\n              this.btnCargando = false\n            } else{\n              if (response.data.datos != 0) {\n                this.notas = response.data.datos\n              }\n            }\n          })\n          .catch(err => {\n            this.mensajeEmergente('danger',CONFIG.TITULO_MSG,'Algo salio mal y no se pudo realizar: Consolidados asignaturas curso periodo. Intente ms tarde.' + err)\n            this.btnCargando = false\n          })\n          //console.log(JSON.stringify(this.notas))\n          this.listaNotasAsignaturasCurso = this.notas.length ? this.generarPromediosFinalesConDesempeno(this.listaAsignaturasCurso, this.notas) : false\n        }\n        this.btnCargando = false\n      },\n      async consultaAsignaturasCurso() {\n        this.listaAsignaturasCurso = []\n        await axios\n        .get(CONFIG.ROOT_PATH + 'academico/asignacioncurso/habilitaciones', {params: {idCurso: this.idCurso}})\n        .then(response => {\n          if (response.data.error){\n            this.mensajeEmergente('danger',CONFIG.TITULO_MSG,response.data.mensaje + ' - Lista asignaturas curso')\n          } else{\n            if (response.data.datos != 0) {\n              this.listaAsignaturasCurso = response.data.datos\n            }\n          }\n        })\n        .catch(err => {\n          this.mensajeEmergente('danger',CONFIG.TITULO_MSG,'Algo salio mal y no se pudo realizar: Lista asignacin docentes curso. Intente ms tarde.' + err)\n        })\n        //console.log(JSON.stringify(this.listaAsignaturasCurso))\n      },\n      async ocuparComboEstudiantes() {\n        this.comboEstudiantes = []\n        await axios\n        .get(CONFIG.ROOT_PATH + 'academico/listacurso/habilitaciones', { params: { idCurso: this.idCurso, vigencia: this.$store.state.aLectivo }})\n        .then(response => {\n          if (response.data.error){\n            this.mensajeEmergente('danger',CONFIG.TITULO_MSG,response.data.mensaje + ' - Consulta Lista Curso')\n          } else{\n            if (response.data.datos != 0) {\n              response.data.datos.forEach(element => {\n                this.comboEstudiantes.push({ 'value': element.idMatricula, 'text': element.estudiante })\n              })\n            }\n          }\n        })\n        .catch(err => {\n          this.mensajeEmergente('danger',CONFIG.TITULO_MSG,'Algo salio mal y no se pudo realizar: Consulta Lista Curso. Intente ms tarde.' + err)\n        })\n      },\n      async ocuparComboCursosSede() {\n        this.comboCursosSede = []\n        this.$store.state.datosCursos.forEach(element => {\n          if (element.id_sede == this.idSede) {\n            this.comboCursosSede.push({ 'value': element.id, 'text': element.nomenclatura.toUpperCase() })\n          }\n        })\n      },\n      async ocuparComboSedes() {\n        this.comboSedes = []\n        this.$store.state.datosSedes.forEach(element => {\n          this.comboSedes.push({ 'value': element.id, 'text': element.sede.toUpperCase() })\n        })\n      },\n      handleKeyNavigation(event, i, col) {\n        if (event.key === \"ArrowDown\") {\n          const nextInput = this.$refs[`${col}-${i + 1}`]\n          if (nextInput) nextInput.focus()\n        } else if (event.key === \"ArrowUp\") {\n          const previousInput = this.$refs[`${col}-${i - 1}`]\n          if (previousInput) previousInput.focus()\n        }\n      },\n      redondear(num) {\n        var m = Number((Math.abs(num) * 10).toPrecision(15))\n        return Math.round(m) / 10 * Math.sign(num);\n      },\n      soloNumeros(e) {\n        let key = window.Event ? e.which : e.keyCode\n        if (!((key >= 48 && key <= 57) || (key >= 96 && key <= 105) || (key == 8) || (key == 9) || (key == 37) || (key == 39))) {\n            e.preventDefault()\n        }\n      },\n      soloDecimales(e) {\n        let key = window.Event ? e.which : e.keyCode\n        if (!((key >= 48 && key <= 57) || (key >= 96 && key <= 105) || (key == 8) || (key == 9) || (key == 37) || (key == 39) || (key == 110) || (key == 189) || (key == 190))) {\n            e.preventDefault()\n        }\n      },\n      tdClassFuncDiversa(fila) {\n        if (fila.id_diversa == 'S') {\n          return 'text-center alert alert-warning'\n        }\n      },\n      mensajeEmergente(variante, titulo, contenido) {\n        this.$bvToast.toast(contenido, { title: titulo, variant: variante, toaster: \"b-toaster-top-center\", solid: true, autoHideDelay: 4000, appendToast: false })\n      }\n    },\n    beforeMount() {\n      if(this.$store.state.idRol == 1 || this.$store.state.idRol == 12 || this.$store.state.perActNotas == 1) {\n        this.ocuparComboSedes()\n        this.datosSeccion = this.$store.state.datosSecciones[this.$store.state.idSeccion - 1]\n        //console.log(JSON.stringify(this.datosSeccion))\n      } else {\n        this.$router.push('/restringida')\n      }\n    },\n    computed: {\n    }\n  }\n</script>","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ResumenFinalHab.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ResumenFinalHab.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ResumenFinalHab.vue?vue&type=template&id=f419563c&\"\nimport script from \"./ResumenFinalHab.vue?vue&type=script&lang=js&\"\nexport * from \"./ResumenFinalHab.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('b-row',{staticClass:\"mt-2\"},[_c('b-col',{attrs:{\"lg\":\"12\"}},[_c('b-card',{scopedSlots:_vm._u([{key:\"header\",fn:function(){return [_c('h5',{staticClass:\"mb-0\"},[_c('b-icon',{attrs:{\"icon\":\"card-checklist\",\"aria-hidden\":\"true\"}}),_vm._v(\" RESUMEN DE PROMOCIN POR AREAS\")],1)]},proxy:true}])},[_c('b-card-text',[_c('b-row',[_c('b-col',{attrs:{\"lg\":\"6\"}},[_c('b-form-group',{staticClass:\"etiqueta\",attrs:{\"label\":\"Seleccione la Sede:\",\"label-for\":\"sedes\"}},[_c('b-form-select',{ref:\"sedes\",attrs:{\"id\":\"sedes\",\"options\":_vm.comboSedes},on:{\"change\":function($event){_vm.idCurso=null,_vm.ocuparComboCursosSede()}},model:{value:(_vm.idSede),callback:function ($$v) {_vm.idSede=$$v},expression:\"idSede\"}})],1)],1),_c('b-col',{attrs:{\"lg\":\"4\"}},[_c('b-form-group',{staticClass:\"etiqueta\",attrs:{\"label\":\"Seleccione el Curso:\",\"label-for\":\"cursos\"}},[_c('b-form-select',{ref:\"cursos\",attrs:{\"id\":\"cursos\",\"options\":_vm.comboCursosSede,\"disabled\":_vm.idSede!=null ? false : true},on:{\"change\":function($event){return _vm.consultarEstudiantes()}},model:{value:(_vm.idCurso),callback:function ($$v) {_vm.idCurso=$$v},expression:\"idCurso\"}})],1)],1)],1)],1)],1)],1)],1),_c('b-row',[_c('b-col',{attrs:{\"lg\":\"12\"}},[(_vm.btnCargando)?_c('div',[_c('div',{staticClass:\"text-center m-5 text-primary\"},[_c('b-spinner',{staticStyle:{\"width\":\"3rem\",\"height\":\"3rem\"},attrs:{\"label\":\"Spinner\"}}),_c('br'),_c('strong',[_vm._v(\"Cargando informe...\")])],1)]):_vm._e()])],1),(!_vm.btnCargando && _vm.idCurso!=null)?_c('b-row',[_c('b-col',{attrs:{\"lg\":\"12\"}},[_c('table',{staticClass:\"table-responsive\",attrs:{\"border\":\"1\",\"cellspacing\":\"0\",\"cellpadding\":\"1\"}},[_c('thead',[_c('tr',[_c('th',[_vm._v(\"#\")]),_c('th',[_vm._v(\"Estudiante\")]),_c('th',[_vm._v(\"Estado Sin Superacin Final\")]),_c('th',[_vm._v(\"PRO GEN\")]),_c('th',[_vm._v(\"Tot\"),_c('br'),_vm._v(\"Area\"),_c('br'),_vm._v(\"Baj\")]),_c('th',[_vm._v(\"Tot\"),_c('br'),_vm._v(\"Area\"),_c('br'),_vm._v(\"Bas\")]),_c('th',[_vm._v(\"Tot\"),_c('br'),_vm._v(\"Area\"),_c('br'),_vm._v(\"Alt\")]),_c('th',[_vm._v(\"Tot\"),_c('br'),_vm._v(\"Area\"),_c('br'),_vm._v(\"Sup\")]),_c('th',[_vm._v(\"Tot\"),_c('br'),_vm._v(\"AuJ\")]),_c('th',[_vm._v(\"Tot\"),_c('br'),_vm._v(\"AuS\")]),_c('th',[_vm._v(\"Puesto\")]),_c('th',[_vm._v(\"#\")])])]),_c('tbody',[_vm._l((_vm.estudiantesNotas),function(est,nombre,i){return _c('tr',{key:nombre},[_c('td',{staticClass:\"text-left\"},[_vm._v(_vm._s(i + 1))]),_c('td',{staticStyle:{\"text-align\":\"left\"}},[_vm._v(_vm._s(nombre))]),_c('td',{staticStyle:{\"text-align\":\"left\"}},[_vm._v(_vm._s(est.id_conceptual=='N' ? _vm.mostrarEstadoPromocion(_vm.contarDesempenoEstudianteArea(est, 'bajo')) : '-'))]),_c('td',[_vm._v(_vm._s(est.id_conceptual=='N' ? _vm.calcularPromedioGeneral(est) : '-'))]),_c('td',[_vm._v(_vm._s(est.id_conceptual=='N' ? _vm.contarDesempenoEstudianteArea(est, 'bajo') : '-'))]),_c('td',[_vm._v(_vm._s(est.id_conceptual=='N' ? _vm.contarDesempenoEstudianteArea(est, 'basico') : '-'))]),_c('td',[_vm._v(_vm._s(est.id_conceptual=='N' ? _vm.contarDesempenoEstudianteArea(est, 'alto') : '-'))]),_c('td',[_vm._v(_vm._s(est.id_conceptual=='N' ? _vm.contarDesempenoEstudianteArea(est, 'superior') : '-'))]),_c('td',[_vm._v(_vm._s(est.id_conceptual=='N' ? est.ausJ : '-'))]),_c('td',[_vm._v(_vm._s(est.id_conceptual=='N' ? est.ausS : '-'))]),_c('td',[_vm._v(_vm._s(est.id_conceptual=='N' ? _vm.iconoPuesto(_vm.puestosPorEstudiante[nombre]) : '-')+\" \"+_vm._s(est.id_conceptual=='N' ? _vm.puestosPorEstudiante[nombre] : '-'))]),_c('td',{staticClass:\"text-left\"},[_vm._v(_vm._s(i + 1))])])}),_c('tr',{staticStyle:{\"background-color\":\"#f0f0f0\",\"font-weight\":\"bold\"}},[_c('td',{attrs:{\"colspan\":\"2\"}},[_vm._v(\"Total Bajos\")]),_c('td'),_c('td'),_c('td',[_vm._v(_vm._s(_vm.totales.bajo))]),_c('td',[_vm._v(_vm._s(_vm.totales.basico))]),_c('td',[_vm._v(_vm._s(_vm.totales.alto))]),_c('td',[_vm._v(_vm._s(_vm.totales.superior))]),_c('td',[_vm._v(_vm._s(_vm.totales.ausJ))]),_c('td',[_vm._v(_vm._s(_vm.totales.ausS))]),_c('td'),_vm._v(\" \"),_c('td')])],2)]),_c('div',{staticStyle:{\"margin-bottom\":\"1rem\"}},[_c('b-button',{staticClass:\"small mx-1 mt-3\",attrs:{\"variant\":\"primary\"},on:{\"click\":_vm.imprimir}},[_vm._v(\"Imprimir Consolidado\")]),_c('b-button',{staticClass:\"small mx-1 mt-3\",attrs:{\"variant\":\"outline-primary\"},on:{\"click\":_vm.exportarAExcel}},[_vm._v(\"Exportar a Excel\")])],1)])],1):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('b-row',{staticClass:\"mt-2\"},[_c('b-col',{attrs:{\"lg\":\"12\"}},[_c('b-card',{scopedSlots:_vm._u([{key:\"header\",fn:function(){return [_c('h5',{staticClass:\"mb-0\"},[_c('b-icon',{attrs:{\"icon\":\"card-checklist\",\"aria-hidden\":\"true\"}}),_vm._v(\" CONSOLIDADO REAS PERDIDAS\")],1)]},proxy:true}])},[_c('b-card-text',[_c('b-row',[_c('b-col',{attrs:{\"lg\":\"2\"}},[_c('b-form-group',{staticClass:\"etiqueta\",attrs:{\"label\":\"Periodo:\",\"label-for\":\"periodo\"}},[_c('b-form-select',{ref:\"periodo\",attrs:{\"id\":\"periodo\",\"options\":_vm.comboPeriodos},on:{\"change\":function($event){_vm.idSede=null,_vm.idCurso=null}},model:{value:(_vm.idPeriodo),callback:function ($$v) {_vm.idPeriodo=$$v},expression:\"idPeriodo\"}})],1)],1),_c('b-col',{attrs:{\"lg\":\"6\"}},[_c('b-form-group',{staticClass:\"etiqueta\",attrs:{\"label\":\"Seleccione la Sede:\",\"label-for\":\"sedes\"}},[_c('b-form-select',{ref:\"sedes\",attrs:{\"id\":\"sedes\",\"options\":_vm.comboSedes,\"disabled\":_vm.idPeriodo!=null ? false : true},on:{\"change\":function($event){_vm.idCurso=null,_vm.ocuparComboCursosSede()}},model:{value:(_vm.idSede),callback:function ($$v) {_vm.idSede=$$v},expression:\"idSede\"}})],1)],1),_c('b-col',{attrs:{\"lg\":\"4\"}},[_c('b-form-group',{staticClass:\"etiqueta\",attrs:{\"label\":\"Seleccione el Curso:\",\"label-for\":\"cursos\"}},[_c('b-form-select',{ref:\"cursos\",attrs:{\"id\":\"cursos\",\"options\":_vm.comboCursosSede,\"disabled\":_vm.idSede!=null ? false : true},on:{\"change\":function($event){return _vm.consultarEstudiantes()}},model:{value:(_vm.idCurso),callback:function ($$v) {_vm.idCurso=$$v},expression:\"idCurso\"}})],1)],1)],1)],1)],1)],1)],1),_c('b-row',[_c('b-col',{attrs:{\"lg\":\"12\"}},[(_vm.btnCargando)?_c('div',[_c('div',{staticClass:\"text-center m-5 text-primary\"},[_c('b-spinner',{staticStyle:{\"width\":\"3rem\",\"height\":\"3rem\"},attrs:{\"label\":\"Spinner\"}}),_c('br'),_c('strong',[_vm._v(\"Cargando informe...\")])],1)]):_vm._e()])],1),(!_vm.btnCargando && _vm.idCurso!=null)?_c('b-row',[_c('b-col',{attrs:{\"lg\":\"12\"}},[_c('table',{staticClass:\"tabla-perdidas\",attrs:{\"border\":\"1\",\"cellspacing\":\"0\",\"cellpadding\":\"1\"}},[_c('thead',[_c('tr',[_c('th',[_vm._v(\"Estudiante\")]),_c('th',[_vm._v(\"reas Perdidas\")]),_c('th',[_vm._v(\"Total\")])])]),_c('tbody',_vm._l((_vm.informeAreasPerdidas),function(fila){return _c('tr',{key:fila.estudiante},[_c('td',[_vm._v(_vm._s(fila.estudiante))]),_c('td',[_vm._v(_vm._s(fila.perdidas.join(', ')))]),_c('td',[_vm._v(_vm._s(fila.total))])])}),0)]),_c('div',{staticStyle:{\"margin-bottom\":\"1rem\"}},[_c('b-button',{staticClass:\"small mx-1 mt-3\",attrs:{\"variant\":\"primary\"},on:{\"click\":_vm.imprimir}},[_vm._v(\"Imprimir Consolidado\")]),_c('b-button',{staticClass:\"small mx-1 mt-3\",attrs:{\"variant\":\"outline-primary\"},on:{\"click\":_vm.exportarAExcel}},[_vm._v(\"Exportar a Excel\")])],1)])],1):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div>\n    <b-row class=\"mt-2\">\n      <b-col lg=\"12\">\n        <b-card>\n          <template #header>\n            <h5 class=\"mb-0\"><b-icon icon=\"card-checklist\" aria-hidden=\"true\"></b-icon> CONSOLIDADO REAS PERDIDAS</h5>\n          </template>\n          <b-card-text>\n            <b-row>\n              <b-col lg=\"2\">\n                <b-form-group label=\"Periodo:\" label-for=\"periodo\" class=\"etiqueta\">\n                  <b-form-select id=\"periodo\" ref=\"periodo\" v-model=\"idPeriodo\" :options=\"comboPeriodos\" @change=\"idSede=null,idCurso=null\"></b-form-select>\n                </b-form-group>\n              </b-col>\n              <b-col lg=\"6\">\n                <b-form-group label=\"Seleccione la Sede:\" label-for=\"sedes\" class=\"etiqueta\">\n                  <b-form-select  id=\"sedes\" ref=\"sedes\" v-model=\"idSede\" :options=\"comboSedes\" @change=\"idCurso=null,ocuparComboCursosSede()\" :disabled=\"idPeriodo!=null ? false : true\"></b-form-select>\n                </b-form-group>\n              </b-col>\n              <b-col lg=\"4\">\n                <b-form-group label=\"Seleccione el Curso:\" label-for=\"cursos\" class=\"etiqueta\">\n                  <b-form-select id=\"cursos\" ref=\"cursos\" v-model=\"idCurso\" :options=\"comboCursosSede\" @change=\"consultarEstudiantes()\" :disabled=\"idSede!=null ? false : true\"></b-form-select>\n                </b-form-group>\n              </b-col>\n            </b-row>\n          </b-card-text>\n        </b-card>\n      </b-col>\n    </b-row>\n    <b-row>\n      <b-col lg=\"12\">\n        <div v-if=\"btnCargando\">\n          <div class=\"text-center m-5 text-primary\">\n            <b-spinner style=\"width: 3rem; height: 3rem;\" label=\"Spinner\"></b-spinner>\n            <br><strong>Cargando informe...</strong>\n          </div>\n        </div>\n      </b-col>\n    </b-row>\n    <b-row v-if=\"!btnCargando && idCurso!=null\">\n      <b-col lg=\"12\">\n        <table border=\"1\" cellspacing=\"0\" cellpadding=\"1\" class=\"tabla-perdidas\">\n          <thead>\n            <tr>\n              <th>Estudiante</th>\n              <th>reas Perdidas</th>\n              <th>Total</th>\n            </tr>\n          </thead>\n          <tbody>\n            <tr v-for=\"fila in informeAreasPerdidas\" :key=\"fila.estudiante\">\n              <td>{{ fila.estudiante }}</td>\n              <td>{{ fila.perdidas.join(', ') }}</td>\n              <td>{{ fila.total }}</td>\n            </tr>\n          </tbody>\n        </table>\n        <div style=\"margin-bottom: 1rem\">\n          <b-button class=\"small mx-1 mt-3\" variant=\"primary\" @click=\"imprimir\">Imprimir Consolidado</b-button>\n          <b-button class=\"small mx-1 mt-3\" variant=\"outline-primary\" @click=\"exportarAExcel\">Exportar a Excel</b-button>\n        </div>\n      </b-col>\n    </b-row>\n  </div>\n</template>\n\n<script>\n  import axios from \"axios\"\n  import * as CONFIG from '@/assets/config.js'\n  import * as XLSX from 'xlsx'\n\n  export default {\n    name: 'areasperdidas',\n    props: {\n    },\n    components: {\n    },\n    data () {\n      return {\n        idSede: null,\n        comboSedes: [],\n        idPeriodo: null,\n        comboPeriodos: null,\n        idCurso: null,\n        comboCursosSede: [],\n        nombreSede: null,\n        nombreCurso: null,\n        idNivel: null,\n        btnCargando: false,\n        dataConsultada: [],\n        datosSeccion: {},\n        listaAreasAsignaturas: [],\n        listaEstudiantes: [],\n        ausencias: [],\n      }\n    },\n    methods: {\n      async consultarEstudiantes() {\n        this.btnCargando = true\n        this.nombreSede = document.getElementById('sedes')[document.getElementById('sedes').selectedIndex].text\n        if (this.idCurso != null) { \n          this.nombreCurso = document.getElementById('cursos')[document.getElementById('cursos').selectedIndex].text\n          this.$store.state.datosCursos.forEach(element => {\n            if (element.id == this.idCurso) {\n              this.idNivel = element.id_nivel\n            }\n          })\n          this.listaEstudiantes = []\n          await axios\n          .get(CONFIG.ROOT_PATH + 'consolidado/listaestudiantes/curso', { params: { idCurso: this.idCurso, vigencia: this.$store.state.aLectivo }})\n          .then(response => {\n            if (response.data.error){\n              this.mensajeEmergente('danger',CONFIG.TITULO_MSG,response.data.mensaje + ' - Consulta Lista Curso')\n            } else{\n              if (response.data.datos != 0) {\n                this.listaEstudiantes = response.data.datos\n              }\n            }\n          })\n          .catch(err => {\n            this.mensajeEmergente('danger',CONFIG.TITULO_MSG,'Algo salio mal y no se pudo realizar: Consulta Lista Curso. Intente ms tarde.' + err)\n          })\n          /*\n          this.listaAreasAsignaturas = []\n          await axios\n          .get(CONFIG.ROOT_PATH + 'consolidados/areasasignaturas/curso', {params: {idCurso: this.idCurso}})\n          .then(response => {\n            if (response.data.error){\n              this.mensajeEmergente('danger',CONFIG.TITULO_MSG,response.data.mensaje + ' - Lista areas-asignaturas curso')\n              this.btnCargando = false\n            } else{\n              if (response.data.datos != 0) {\n                this.listaAreasAsignaturas = response.data.datos\n              }\n            }\n          })\n          .catch(err => {\n            this.mensajeEmergente('danger',CONFIG.TITULO_MSG,'Algo salio mal y no se pudo realizar: Lista areas-asignaturas curso. Intente ms tarde.' + err)\n            this.btnCargando = false\n          })\n          */\n          this.dataConsultada = []\n          await axios\n          .get(CONFIG.ROOT_PATH + 'consolidados/notasperdidas/curso/periodo', {params: {idCurso: this.idCurso, periodo: this.idPeriodo, vigencia: this.$store.state.aLectivo}})\n          .then(response => {\n            if (response.data.error){\n              this.mensajeEmergente('danger',CONFIG.TITULO_MSG,response.data.mensaje + ' - Consolidados areas perdidas curso periodo')\n              this.btnCargando = false\n            } else{\n              if (response.data.datos != 0) {\n                this.dataConsultada = response.data.datos\n              }\n            }\n          })\n          .catch(err => {\n            this.mensajeEmergente('danger',CONFIG.TITULO_MSG,'Algo salio mal y no se pudo realizar: Consolidados areas perdidas curso periodo. Intente ms tarde.' + err)\n            this.btnCargando = false\n          })\n        }\n        //console.log(JSON.stringify(this.listaEstudiantes))\n        //console.log(JSON.stringify(this.listaAreasAsignaturas))\n        //console.log(JSON.stringify(this.dataConsultada))\n        this.btnCargando = false\n      },\n      imprimir() {\n        let fecha = 'Fecha: ' + new Date().toLocaleString()\n        let tituloInforme = 'CONSOLIDADO DE REAS PERDIDAS'\n        const contenido = document.querySelector('table').outerHTML\n        const ventana = window.open(\"Perdidas\", \"_blank\")\n        ventana.document.write(`<html><head><title>Perdidas</title></head>\n        <style scoped>\n          .tabla-perdidas {\n            width: 100%;\n            border-collapse: collapse;\n            font-size: 13px;\n          }\n          .tabla-perdidas th, .tabla-perdidas td {\n            border: 1px solid #ccc;\n            padding: 1px;\n          }\n          .tabla-perdidas th {\n            background-color: #f2f8ff;\n            text-align: center;\n          }\n          .tabla-perdidas td {\n            vertical-align: top;\n          }\n        </style>\n          <body class=\"container\">\n            <p style=\"text-align: center; font-size: 12px;\">SECRETARA DE EDUCACIN TERRITORIAL DE TUNJA<br><b>${this.$store.state.nombreInstitucion}</b><br>TUNJA - BOYAC<br>${tituloInforme}<br>Sede: ${this.nombreSede} | Curso: ${this.nombreCurso} | Ao Lectivo ${this.$store.state.aLectivo} | Periodo: ${this.idPeriodo}</p>\n            ${contenido}\n            <div style=\"text-align: right; font-size: 12px;\"><i>${fecha}</i></div>\n          </body>\n        </html>`)\n        ventana.document.close()\n        ventana.print()\n      },\n      exportarAExcel() {\n        const tabla = document.querySelector('table')\n        const wb = XLSX.utils.table_to_book(tabla)\n        XLSX.writeFile(wb, 'ausencias.xlsx')\n      },\n      async ocuparComboCursosSede() {\n        this.comboCursosSede = []\n        this.$store.state.datosCursos.forEach(element => {\n          if (element.id_sede == this.idSede) {\n            this.comboCursosSede.push({ 'value': element.id, 'text': element.nomenclatura.toUpperCase() })\n          }\n        })\n      },\n      async ocuparComboSedes() {\n        this.comboSedes = []\n        this.$store.state.datosSedes.forEach(element => {\n          this.comboSedes.push({ 'value': element.id, 'text': element.sede.toUpperCase() })\n        })\n      },\n      async ocuparComboPeriodos() {\n        this.comboPeriodos = []\n        this.$store.state.periodos.forEach(element => {\n          this.comboPeriodos.push({ 'value': element.id, 'text': element.periodo.toUpperCase() })\n        })\n      },\n      redondear(num) {\n        var m = Number((Math.abs(num) * 10).toPrecision(15))\n        return Math.round(m) / 10 * Math.sign(num);\n      },\n      mensajeEmergente(variante, titulo, contenido) {\n        this.$bvToast.toast(contenido, { title: titulo, variant: variante, toaster: \"b-toaster-top-center\", solid: true, autoHideDelay: 4000, appendToast: false })\n      }\n    },\n    computed: {\n      informeAreasPerdidas() {\n        return this.listaEstudiantes.map(est => {\n          const registros = this.dataConsultada.filter(dc => dc.idMatricula === est.idMatricula && dc.orden !== 98 && dc.orden !== 99)\n          // Agrupamos por rea\n          const areas = {}\n          registros.forEach(dc => {\n            const area = dc.area\n            const definitiva = parseFloat(dc.definitiva) || 0\n            const recuperacion = parseFloat(dc.recuperacion)\n            const porcentaje = parseFloat(dc.porcentaje) || 0\n            const notaFinal = (!isNaN(recuperacion) && recuperacion > definitiva)\n              ? recuperacion\n              : definitiva\n            if (!areas[area]) {\n              areas[area] = { acumulado: 0, totalPorcentaje: 0, tipo: parseInt(dc.idTipoEspecialidad) }\n            }\n            areas[area].acumulado += notaFinal * porcentaje\n            areas[area].totalPorcentaje += porcentaje\n          })\n          // Calculamos promedio ponderado y evaluamos si es prdida\n          const perdidas = Object.entries(areas)\n            .map(([area, datos]) => {\n              const promedio = datos.totalPorcentaje > 0\n                ? this.redondear(datos.acumulado / datos.totalPorcentaje).toFixed(1)\n                : 0\n              const esPerdida =\n                datos.tipo === 1 ? promedio < this.datosSeccion.minBas :\n                datos.tipo === 2 ? promedio < this.datosSeccion.minBasT :\n                false\n              return esPerdida\n                ? { area, promedio: promedio }\n                : null\n            })\n            .filter(Boolean)\n          const resumen = perdidas.map(p => `${p.area}(${p.promedio})`)\n          return {\n            estudiante: est.estudiante,\n            perdidas: resumen,\n            total: resumen.length\n          }\n        }).filter(e => e.total > 0)\n      }\n    },\n    beforeMount() {\n      this.ocuparComboSedes()\n      this.ocuparComboPeriodos()\n      this.datosSeccion = this.$store.state.datosSecciones[this.$store.state.idSeccion - 1]\n    }\n  }\n</script>\n<style scoped>\n  .tabla-perdidas {\n    width: 100%;\n    border-collapse: collapse;\n    font-size: 13px;\n  }\n  .tabla-perdidas th, .tabla-perdidas td {\n    border: 1px solid #ccc;\n    padding: 6px;\n  }\n  .tabla-perdidas th {\n    background-color: #f2f8ff;\n    text-align: center;\n  }\n  .tabla-perdidas td {\n    vertical-align: top;\n  }\n</style>\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AreasPerdidas.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AreasPerdidas.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./AreasPerdidas.vue?vue&type=template&id=98a0c286&scoped=true&\"\nimport script from \"./AreasPerdidas.vue?vue&type=script&lang=js&\"\nexport * from \"./AreasPerdidas.vue?vue&type=script&lang=js&\"\nimport style0 from \"./AreasPerdidas.vue?vue&type=style&index=0&id=98a0c286&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"98a0c286\",\n  null\n  \n)\n\nexport default component.exports","<template>\n  <div>\n    <b-row class=\"mt-2\">\n      <b-col lg=\"12\">\n        <b-card>\n          <template #header>\n            <h5 class=\"mb-0\"><b-icon icon=\"card-checklist\" aria-hidden=\"true\"></b-icon> RESUMEN DE PROMOCIN POR AREAS</h5>\n          </template>\n          <b-card-text>\n            <b-row>\n              <!--\n              <b-col lg=\"2\">\n                <b-form-group label=\"Periodo:\" label-for=\"periodo\" class=\"etiqueta\">\n                  <b-form-select id=\"periodo\" ref=\"periodo\" v-model=\"idPeriodo\" :options=\"comboPeriodos\" @change=\"idSede=null,idCurso=null\"></b-form-select>\n                </b-form-group>\n              </b-col>\n              -->\n              <b-col lg=\"6\">\n                <b-form-group label=\"Seleccione la Sede:\" label-for=\"sedes\" class=\"etiqueta\">\n                  <b-form-select  id=\"sedes\" ref=\"sedes\" v-model=\"idSede\" :options=\"comboSedes\" @change=\"idCurso=null,ocuparComboCursosSede()\"></b-form-select>\n                </b-form-group>\n              </b-col>\n              <b-col lg=\"4\">\n                <b-form-group label=\"Seleccione el Curso:\" label-for=\"cursos\" class=\"etiqueta\">\n                  <b-form-select id=\"cursos\" ref=\"cursos\" v-model=\"idCurso\" :options=\"comboCursosSede\" @change=\"consultarEstudiantes()\" :disabled=\"idSede!=null ? false : true\"></b-form-select>\n                </b-form-group>\n              </b-col>\n            </b-row>\n          </b-card-text>\n        </b-card>\n      </b-col>\n    </b-row>\n    <b-row>\n      <b-col lg=\"12\">\n        <div v-if=\"btnCargando\">\n          <div class=\"text-center m-5 text-primary\">\n            <b-spinner style=\"width: 3rem; height: 3rem;\" label=\"Spinner\"></b-spinner>\n            <br><strong>Cargando informe...</strong>\n          </div>\n        </div>\n      </b-col>\n    </b-row>\n    <b-row v-if=\"!btnCargando && idCurso!=null\">\n      <b-col lg=\"12\">\n        <table border=\"1\" cellspacing=\"0\" cellpadding=\"1\" class=\"table-responsive\">\n          <thead>\n            <tr>\n              <th>#</th>\n              <th>Estudiante</th>\n              <!--\n              <template v-for=\"(asigs, area) in encabezadoPorArea\">\n                <th :colspan=\"colspanArea(area)\" :key=\"area\">\n                  {{ area }}\n                </th>\n              </template>\n              -->\n              <th>Estado Sin Superacin Final</th>\n              <th>PRO GEN</th>\n              <th>Tot<br>Area<br>Baj</th>\n              <th>Tot<br>Area<br>Bas</th>\n              <th>Tot<br>Area<br>Alt</th>\n              <th>Tot<br>Area<br>Sup</th>\n              <th>Tot<br>AuJ</th>\n              <th>Tot<br>AuS</th>\n              <th>Puesto</th>\n              <th>#</th>\n            </tr>\n            <!--\n            <tr>\n              <template v-for=\"(asigs, area) in encabezadoPorArea\">\n                <template v-for=\"(asig, k) in asigs\">\n                  <th :colspan=\"periodosVisibles.length + 1\" :key=\"'area-' + asig + k\">\n                    {{ asig }}\n                  </th>\n                </template>\n                <th class=\"promedio-area\" :key=\"'prom-area-' + area\">PRO AR</th>\n              </template>\n            </tr>\n            <tr>\n              <template v-for=\"(asigs, area) in encabezadoPorArea\">\n                <template v-for=\"asig in asigs\">\n                  <th v-for=\"p in periodosVisibles\" :key=\"'h' + area + asig + p\">\n                    P{{ p }}\n                  </th>\n                  <th :key=\"'prom' + asig + area\">PR</th>\n                </template>\n                <th :key=\"'prom' + area\"></th>\n              </template>\n            </tr>\n            -->\n          </thead>\n          <tbody>\n            <tr v-for=\"(est, nombre, i) in estudiantesNotas\" :key=\"nombre\">\n              <td class=\"text-left\">{{ i + 1 }}</td>\n              <td style=\"text-align: left\">{{ nombre }}</td>\n              <!--\n              <template v-for=\"(asigs, area) in encabezadoPorArea\">\n                <template v-for=\"asig in asigs\">\n                  <td v-for=\"p in periodosVisibles\"  :key=\"nombre + area + asig + p\">\n                    {{ est.id_conceptual=='N' ? obtenerNota(est, area, asig, p) : '-' }}\n                  </td>\n                  <td class=\"bloque-area\" :key=\"'prom' + nombre + area + asig\" style=\"font-weight: bold; text-align: center;\">\n                    {{ est.id_conceptual=='N' ? obtenerPromedioAsignatura(est, area, asig) : '-' }}\n                  </td>\n                </template>\n                <td class=\"promedio-area bloque-area\" :key=\"'promArea' + nombre + area\">\n                  {{ est.id_conceptual=='N' ? obtenerPromedioArea(est, area) : '-' }}\n                </td>\n              </template>\n              -->\n              <td style=\"text-align: left\">{{ est.id_conceptual=='N' ? mostrarEstadoPromocion(contarDesempenoEstudianteArea(est, 'bajo')) : '-' }}</td>\n              <td>{{ est.id_conceptual=='N' ? calcularPromedioGeneral(est) : '-' }}</td>\n              <td>{{ est.id_conceptual=='N' ? contarDesempenoEstudianteArea(est, 'bajo') : '-' }}</td>\n              <td>{{ est.id_conceptual=='N' ? contarDesempenoEstudianteArea(est, 'basico') : '-' }}</td>\n              <td>{{ est.id_conceptual=='N' ? contarDesempenoEstudianteArea(est, 'alto') : '-' }}</td>\n              <td>{{ est.id_conceptual=='N' ? contarDesempenoEstudianteArea(est, 'superior') : '-' }}</td>\n              <td>{{ est.id_conceptual=='N' ? est.ausJ : '-' }}</td>\n              <td>{{ est.id_conceptual=='N' ? est.ausS : '-' }}</td>\n              <td>{{ est.id_conceptual=='N' ? iconoPuesto(puestosPorEstudiante[nombre]) : '-' }} {{ est.id_conceptual=='N' ? puestosPorEstudiante[nombre] : '-' }}</td>\n              <td class=\"text-left\">{{ i + 1 }}</td>\n            </tr>\n            <tr style=\"background-color: #f0f0f0; font-weight: bold;\">\n              <td colspan=\"2\">Total Bajos</td>\n              <!--\n              <template v-for=\"(asigs, area) in encabezadoPorArea\">\n                <template v-for=\"asig in asigs\">\n                  <td v-for=\"p in periodosVisibles\" :key=\"'bp' + area + asig + p\">\n                    {{ totalBajosPorPeriodo(area, asig, p) }}\n                  </td>\n                  <td :key=\"'bj' + area + asig\">\n                    {{ totalBajosPromedioAsignatura(area, asig) }}\n                  </td>\n                </template>\n                <td  :key=\"'bja' + area\" class=\"promedio-area\">\n                  {{ totalBajosPromedioArea(area) }}\n                </td>\n              </template>\n              -->\n              <td></td>\n              <td></td>\n              <td>{{ totales.bajo }}</td>\n              <td>{{ totales.basico }}</td>\n              <td>{{ totales.alto }}</td>\n              <td>{{ totales.superior }}</td>\n              <td>{{ totales.ausJ }}</td>\n              <td>{{ totales.ausS }}</td>\n              <td></td> <!-- Puesto -->\n              <td></td>\n            </tr>\n          </tbody>\n        </table>\n        <div style=\"margin-bottom: 1rem\">\n          <b-button class=\"small mx-1 mt-3\" variant=\"primary\" @click=\"imprimir\">Imprimir Consolidado</b-button>\n          <b-button class=\"small mx-1 mt-3\" variant=\"outline-primary\" @click=\"exportarAExcel\">Exportar a Excel</b-button>\n        </div>\n      </b-col>\n    </b-row>\n  </div>\n</template>\n\n<script>\n  import axios from \"axios\"\n  import * as CONFIG from '@/assets/config.js'\n  import * as XLSX from 'xlsx'\nimport AreasPerdidasVue from './AreasPerdidas.vue'\n\n  export default {\n    name: 'resumenpromocionareas',\n    components: {\n    },\n    data () {\n      return {\n        idSede: null,\n        comboSedes: [],\n        idPeriodo: 5,\n        comboPeriodos: null,\n        idCurso: null,\n        comboCursosSede: [],\n        nombreSede: null,\n        nombreCurso: null,\n        idNivel: null,\n        btnCargando: false,\n        datosRaw: [],\n        datosSeccion: {},\n        listaAreasAsignaturas: [],\n        periodosVisibles: []\n      }\n    },\n    methods: {\n      mostrarEstadoPromocion(areasPerdidas) {\n        if ( this.$store.state.idInstitucion == 'f0491770-fca8-11ec-8267-536b07c743c4') { // Gonzalo\n          if (areasPerdidas == 0) {\n            return 'APROB EL GRADO'\n          } else if (areasPerdidas >= 1 && areasPerdidas <= 2) {\n            return 'PENDIENTE DE PROMOCIN'\n          } else {\n            return 'REPROBADO'\n          }\n        } else {\n          if (areasPerdidas == 0) {\n            return 'APROB EL GRADO'\n          } else if (areasPerdidas >= 1 && areasPerdidas <= 2) {\n            return 'PENDIENTE DE PROMOCIN'\n          } else {\n            return 'REPROBADO'\n          }\n        }\n      },\n      colspanArea(area) {\n        const asignaturas = this.encabezadoPorArea[area] || []\n        const columnasPorAsignatura = this.periodosVisibles.length + 1\n        const extraColumnaPromArea = 1\n        return (asignaturas.length * columnasPorAsignatura) + extraColumnaPromArea\n      },\n\n      totalBajosPorPeriodo(area, asignatura, periodo) {\n        let total = 0\n        const meta = this.listaAreasAsignaturas.find(\n          a => a.area === area && a.asignatura === asignatura\n        )\n        const idTipoEspecialidad = meta?.idTipoEspecialidad\n        Object.values(this.estudiantesNotas).forEach(est => {\n          const nota = est?.areas?.[area]?.asignaturas?.[asignatura]?.periodos?.[periodo]\n          if (idTipoEspecialidad === 1) {\n            if (nota > 0 && nota < this.datosSeccion.minBas) total++\n          } else {\n            if (nota > 0 && nota < this.datosSeccion.minBasT) total++\n          }\n        })\n        return total\n      },\n      totalBajosPromedioAsignatura(area, asignatura) {\n        let total = 0\n        const meta = this.listaAreasAsignaturas.find(\n          a => a.area === area && a.asignatura === asignatura\n        )\n        const idTipoEspecialidad = meta?.idTipoEspecialidad\n        Object.values(this.estudiantesNotas).forEach(est => {\n          const asig = est?.areas?.[area]?.asignaturas?.[asignatura]\n          if (!asig) return\n          const prom = parseFloat(this.calcularPromedioAsignatura(asig))\n          if (idTipoEspecialidad === 1) {\n            if (prom < this.datosSeccion.minBas) total++\n          } else {\n            if (prom < this.datosSeccion.minBasT) total++\n          }\n        })\n        return total\n      },\n      totalBajosPromedioArea(area) {\n        let total = 0\n        Object.values(this.estudiantesNotas).forEach(est => {\n          const prom = parseFloat(this.obtenerPromedioArea(est, area))\n          if (!isNaN(prom) && prom < this.datosSeccion.minBas) total++\n        })\n        return total\n      },\n      totalesGlobales() {\n        let bajo = 0, basico = 0, alto = 0, superior = 0, ausJ = 0, ausS = 0\n        Object.values(this.estudiantesNotas).forEach(est => {\n          bajo += this.contarDesempenoEstudianteArea(est, 'bajo')\n          basico += this.contarDesempenoEstudianteArea(est, 'basico')\n          alto += this.contarDesempenoEstudianteArea(est, 'alto')\n          superior += this.contarDesempenoEstudianteArea(est, 'superior')\n          ausJ += est.ausJ || 0\n          ausS += est.ausS || 0\n        })\n\n        return { bajo, basico, alto, superior, ausJ, ausS }\n      },\n      esAreaValida(area) {\n        //const asigns = this.listaAreasAsignaturas.filter(a => a.area === area)\n        //return asigns.some(a => a.orden !== 99)\n        const asigns = this.listaAreasAsignaturas.filter(a => a.area === area)\n        if (asigns.some(a => a.orden !== 99 && a.orden !== 98)) return true\n        else if (asigns.some(a => a.orden === 99) && this.datosSeccion.promCompor == 1) return true\n        else return false\n      },\n      obtenerPromedioArea(est, area) {\n        const areaData = est.areas && est.areas[area]\n        return areaData ? this.calcularPromedioArea(areaData) : ''\n      },\n      obtenerNota(est, area, asignatura, periodo) {\n        let nota = est?.areas?.[area]?.asignaturas?.[asignatura]?.periodos?.[periodo]\n        if (nota === 0) nota = ''\n        return typeof nota === 'number' ? nota.toFixed(1) : nota\n      },\n      obtenerPromedioAsignatura(est, area, asignatura) {\n        const asig = est?.areas?.[area]?.asignaturas?.[asignatura]\n        return asig ? this.calcularPromedioAsignatura(asig) : ''\n      },\n      calcularPromedioAsignatura(asig) {\n        //console.log(asig)\n        const pesos = asig.pesos\n        const periodos = asig.periodos\n        const orden = asig.orden\n        if (orden === 99 && this.datosSeccion.promCompor == 0) return '-'\n        let total = 0\n        if (this.$store.state.idInstitucion == 'acaa36d0-fcb1-11ec-8267-536b07c743c4') { // Emiliani\n          if( orden == 12) {\n            let cantidad = 0 \n            for (let p = 1; p <= 4; p++) {\n              const nota = periodos[p] ?? 0\n              if (nota > 0) {\n                total += nota\n                cantidad++\n              }\n            }\n            if (total === 0) return ''\n            total = total / cantidad\n            return this.redondear(total).toFixed(1) > 0 ? this.redondear(total).toFixed(1) : ''\n          } else {\n            for (let p = 1; p <= 4; p++) {\n              const nota = periodos[p] ?? 0\n              total += nota * pesos[p] / 100\n            }\n            return this.redondear(total).toFixed(1) > 0 ? this.redondear(total).toFixed(1) : ''\n          }\n        } else if (this.$store.state.idInstitucion == 'eb58bf60-fc83-11ec-a1d1-1dc2835404e5') { // Inem\n          if (orden == 55) {\n            let cantidad = 0 // nuevo\n            for (let p = 1; p <= 4; p++) {\n              const nota = periodos[p] ?? 0\n              if (nota > 0) {\n                total += nota\n                cantidad++\n              }\n            }\n            if (total === 0) return ''\n            total = total / cantidad\n            return this.redondear(total).toFixed(1) > 0 ? this.redondear(total).toFixed(1) : ''\n          } else {\n            for (let p = 1; p <= 4; p++) {\n              const nota = periodos[p] ?? 0\n              total += nota * pesos[p] / 100\n            }\n            return this.redondear(total).toFixed(1) > 0 ? this.redondear(total).toFixed(1) : ''\n          }\n        } else if (this.$store.state.idInstitucion == 'c50f3d80-fca0-11ec-8267-536b07c743c4') { // Silvino\n          const nota = periodos[5] ?? 0\n          return nota > 0 ? nota.toFixed(1) : ''\n        } else if (this.$store.state.idInstitucion == '8a1bd1e0-fcb2-11ec-8267-536b07c743c4') { // Libertador\n          const nota = periodos[5] ?? 0\n          return nota > 0 ? nota.toFixed(1) : ''\n        } else {\n          let cantidad = 0 \n          for (let p = 1; p <= 4; p++) {\n            const nota = periodos[p] ?? 0\n            if (nota > 0) {\n              total += nota\n              cantidad++\n            }\n          }\n          if (total === 0) return ''\n          const promedio = total / cantidad\n          return this.redondear(promedio).toFixed(1) > 0 ? this.redondear(promedio).toFixed(1) : ''\n        }\n      },\n      calcularPromedioArea(areaData) {\n        const asigns = Object.values(areaData.asignaturas)\n        if (!asigns.length) return '0.00'\n        let total = 0\n        asigns.forEach(asig => {\n          if (asig.orden === 99 && this.datosSeccion.promCompor == 0) return '-'\n          total += parseFloat((this.calcularPromedioAsignatura(asig) * asig.porcentaje) / 100)\n        })\n        return total > 0 ? this.redondear(total).toFixed(1) : ''\n      },\n      contarDesempenoEstudianteArea(est, tipo) {\n        const areas = Object.keys(est.areas || {})\n        let contador = 0\n        areas.forEach(area => {\n          if (!this.esAreaValida(area)) return\n          const meta = this.listaAreasAsignaturas.find( a => a.area === area)\n          const idTipoEspecialidadArea = meta?.idTipoArea\n          const promedio = parseFloat(this.calcularPromedioArea(est.areas[area]))\n          if (!isNaN(promedio)) {\n            if (idTipoEspecialidadArea === 1) {\n              if (tipo === 'bajo' && promedio < this.datosSeccion.minBas) contador++\n              else if (tipo === 'basico' && promedio >= this.datosSeccion.minBas && promedio < this.datosSeccion.minAlt) contador++\n              else if (tipo === 'alto' && promedio >= this.datosSeccion.minAlt && promedio < this.datosSeccion.minSup) contador++\n              else if (tipo === 'superior' && promedio >= this.datosSeccion.minSup && promedio <= this.datosSeccion.maxSup) contador++\n            } else {\n              if (tipo === 'bajo' && promedio < this.datosSeccion.minBasT) contador++\n              else if (tipo === 'basico' && promedio >= this.datosSeccion.minBasT && promedio < this.datosSeccion.minAltT) contador++\n              else if (tipo === 'alto' && promedio >= this.datosSeccion.minAltT && promedio < this.datosSeccion.minSupT) contador++\n              else if (tipo === 'superior' && promedio >= this.datosSeccion.minSupT && promedio <= this.datosSeccion.maxSupT) contador++\n            }\n          }\n        })\n        return contador\n      },\n      calcularPromedioGeneral(est) {\n        const areas = Object.keys(est.areas || {})\n        let total = 0\n        let cantidad = 0\n        areas.forEach(area => {\n          if (!this.esAreaValida(area)) return\n          const promedio = parseFloat(this.calcularPromedioArea(est.areas[area]))\n          if (!isNaN(promedio)) {\n            total += promedio\n            cantidad++\n          }\n        })\n        return cantidad > 0 ? (total / cantidad).toFixed(3) : ''\n      },\n      contarAusencias(tipo) {\n        let total = 0\n        Object.values(this.estudiantesNotas).forEach(est => {\n          if (tipo === 'ausJ') total += est.ausJ || 0\n          if (tipo === 'ausS') total += est.ausS || 0\n        })\n        return total\n      },\n      contarNotasPorAsignatura(area, asignatura, tipo) {\n        let contador = 0\n        Object.values(this.estudiantesNotas).forEach(est => {\n          const nota = est?.[area]?.[asignatura]?.nota\n          const val = est?.[area]?.[asignatura]?.idTipoEspecialidad\n          if (typeof nota !== 'number') return\n          if (val === 1) {\n            if (tipo === 'bajo' && nota < this.datosSeccion.minBas) contador++\n            else if (tipo === 'basico' && nota >= this.datosSeccion.minBas && nota < this.datosSeccion.minAlt) contador++\n            else if (tipo === 'alto' && nota >= this.datosSeccion.minAlt && nota < this.datosSeccion.minSup) contador++\n            else if (tipo === 'superior' && nota >= this.datosSeccion.minSup && nota <= this.datosSeccion.maxSup) contador++\n          } else {\n            if (tipo === 'bajo' && nota < this.datosSeccion.minBasT) contador++\n            else if (tipo === 'basico' && nota >= this.datosSeccion.minBasT && nota < this.datosSeccion.minAltT) contador++\n            else if (tipo === 'alto' && nota >= this.datosSeccion.minAltT && nota < this.datosSeccion.minSupT) contador++\n            else if (tipo === 'superior' && nota >= this.datosSeccion.minSupT && nota <= this.datosSeccion.maxSupT) contador++\n          }\n        })\n        return contador\n      },\n      contarNotasTotales(tipo) {\n        let total = 0\n        Object.values(this.estudiantesNotas).forEach(est => {\n          this.listaAreasAsignaturas.forEach(({ area, asignatura }) => {\n            const nota = est?.[area]?.[asignatura]?.nota\n            const val = est?.[area]?.[asignatura]?.idTipoEspecialidad\n            if (typeof nota !== 'number') return\n            if (val === 1) {\n              if (tipo === 'bajo' && nota < this.datosSeccion.minBas) total++\n              else if (tipo === 'basico' && nota >= this.datosSeccion.minBas && nota < this.datosSeccion.minAlt) total++\n              else if (tipo === 'alto' && nota >= this.datosSeccion.minAlt && nota < this.datosSeccion.minSup) total++\n              else if (tipo === 'superior' && nota >= this.datosSeccion.minSup && nota <= this.datosSeccion.maxSup) total++\n            } else {\n              if (tipo === 'bajo' && nota < this.datosSeccion.minBasT) total++\n              else if (tipo === 'basico' && nota >= this.datosSeccion.minBasT && nota < this.datosSeccion.minAltT) total++\n              else if (tipo === 'alto' && nota >= this.datosSeccion.minAltT && nota < this.datosSeccion.minSupT) total++\n              else if (tipo === 'superior' && nota >= this.datosSeccion.minSupT && nota <= this.datosSeccion.maxSupT) total++\n            }\n          })\n        })\n        return total\n      },\n      iconoPuesto(puesto) {\n        if (puesto === 1) return ''\n        if (puesto === 2) return ''\n        if (puesto === 3) return ''\n        return ''\n      },\n      contarDesempenoEstudiante(areas, tipo) {\n        let contador = 0\n        Object.values(areas || {}).forEach(area => {\n          Object.values(area.asignaturas || {}).forEach(asig => {\n            const nota = parseFloat(this.calcularPromedioAsignatura(asig))\n            const val =  asig.idTipoEspecialidad\n            const orden =  asig.orden\n            if (this.$store.state.idInstitucion == 'eb58bf60-fc83-11ec-a1d1-1dc2835404e5' && orden == 90) return // No se tiene en cuenta el area de Inem Exploracion vocacional - Complementaria\n            if (this.$store.state.idInstitucion == '097b7b10-fcaa-11ec-8267-536b07c743c4' && orden == 98) return // No se tiene en cuenta el area de Rural Proyectos Profundizacion\n            if (typeof nota !== 'number') return\n            if (val === 1) {\n              if (tipo === 'bajo' && nota < this.datosSeccion.minBas) contador++\n              else if (tipo === 'basico' && nota >= this.datosSeccion.minBas && nota < this.datosSeccion.minAlt) contador++\n              else if (tipo === 'alto' && nota >= this.datosSeccion.minAlt && nota < this.datosSeccion.minSup) contador++\n              else if (tipo === 'superior' && nota >= this.datosSeccion.minSup && nota <= this.datosSeccion.maxSup) contador++\n            } else {\n              if (tipo === 'bajo' && nota < this.datosSeccion.minBasT) contador++\n              else if (tipo === 'basico' && nota >= this.datosSeccion.minBasT && nota < this.datosSeccion.minAltT) contador++\n              else if (tipo === 'alto' && nota >= this.datosSeccion.minAltT && nota < this.datosSeccion.minSupT) contador++\n              else if (tipo === 'superior' && nota >= this.datosSeccion.minSupT && nota <= this.datosSeccion.maxSupT) contador++\n            }\n          })\n        })\n        return contador\n      },\n      fueRecuperada(areas, area, asig) {\n        return areas?.[area]?.[asig]?.fueRecuperada ?? false\n      },\n      obtenerOriginal(areas, area, asig) {\n        const val = areas?.[area]?.[asig]?.original\n        return typeof val === 'number' ? val.toFixed(1) : '0.0'\n      },\n      obtenerRecuperacion(areas, area, asig) {\n        const val = areas?.[area]?.[asig]?.recuperacion\n        return typeof val === 'number' ? val.toFixed(1) : '0.0'\n      },\n      obtenerColor(nota, areas, area, asig) {\n        const val = areas?.[area]?.[asig]?.idTipoEspecialidad\n        if (val === 1) {\n          if (nota < this.datosSeccion.minBas) return 'desempeno-bajo'\n          if (nota < this.datosSeccion.minAlt) return 'desempeno-basico'\n          if (nota < this.datosSeccion.minSup) return 'desempeno-alto'\n          if (nota <= this.datosSeccion.maxSup) return 'desempeno-superior'\n          return 'desempeno-extra'\n        } else {\n          if (nota < this.datosSeccion.minBasT) return 'desempeno-bajo'\n          if (nota < this.datosSeccion.minAltT) return 'desempeno-basico'\n          if (nota < this.datosSeccion.minSupT) return 'desempeno-alto'\n          if (nota <= this.datosSeccion.maxSupT) return 'desempeno-superior'\n          return 'desempeno-extra'\n        }\n      },\n      claseDesempeno(nota) {\n        //console.log(nota)\n        if (typeof nota !== 'number') return 'desempeno-extra'\n        if (nota < 3) return 'desempeno-bajo'\n        if (nota < 4) return 'desempeno-basico'\n        if (nota < 4.6) return 'desempeno-alto'\n        if (nota <= 5) return 'desempeno-superior'\n        return 'desempeno-extra'\n      },\n      obtenerColorGeneral(nota) {\n        if (nota < this.datosSeccion.minBas) return 'desempeno-bajo'\n        if (nota < this.datosSeccion.minAlt) return 'desempeno-basico'\n        if (nota < this.datosSeccion.minSup) return 'desempeno-alto'\n        if (nota <= this.datosSeccion.maxSup) return 'desempeno-superior'\n        return 'desempeno-extra'\n      },\n      async consultarEstudiantes() {\n        this.btnCargando = true\n        if (this.idPeriodo == 1) this.periodosVisibles = [1]\n        if (this.idPeriodo == 2) this.periodosVisibles = [1,2]\n        if (this.idPeriodo == 3) this.periodosVisibles = [1,2,3]\n        if (this.idPeriodo == 4) this.periodosVisibles = [1,2,3,4]\n        this.nombreSede = document.getElementById('sedes')[document.getElementById('sedes').selectedIndex].text\n        if (this.idCurso != null) { \n          this.nombreCurso = document.getElementById('cursos')[document.getElementById('cursos').selectedIndex].text\n          this.$store.state.datosCursos.forEach(element => {\n            if (element.id == this.idCurso) {\n              this.idNivel = element.id_nivel\n            }\n          })\n          this.listaAreasAsignaturas = []\n          await axios\n          .get(CONFIG.ROOT_PATH + 'consolidados/areasasignaturas/curso', {params: {idCurso: this.idCurso}})\n          .then(response => {\n            if (response.data.error){\n              this.mensajeEmergente('danger',CONFIG.TITULO_MSG,response.data.mensaje + ' - Lista areas-asignaturas curso')\n              this.btnCargando = false\n            } else{\n              if (response.data.datos != 0) {\n                //this.listaAreasAsignaturas = response.data.datos\n                response.data.datos.forEach(element => {\n                  if ( this.$store.state.idInstitucion == 'eb58bf60-fc83-11ec-a1d1-1dc2835404e5' ) { //Inem\n                    if (element.orden != 99 && element.orden != 90) {\n                      this.listaAreasAsignaturas.push(element)\n                    }\n                  } else if ( this.$store.state.idInstitucion == 'f5529ba0-fcb3-11ec-8267-536b07c743c4' ) { // Gustavo Rojas\n                    if (element.orden != 99 && element.orden != 15 && element.orden != 16 && element.orden != 98) {\n                      this.listaAreasAsignaturas.push(element)\n                    }\n                  } else if ( this.$store.state.idInstitucion == '097b7b10-fcaa-11ec-8267-536b07c743c4' ) { // Rural\n                    if (element.orden != 99 && element.orden != 98) {\n                      this.listaAreasAsignaturas.push(element)\n                    }\n                  } else if ( this.$store.state.idInstitucion == '54fd7440-fc81-11ec-a1d1-1dc2835404e5' || this.$store.state.idInstitucion == '7c63ed50-fcb0-11ec-8267-536b07c743c4' ) { // Antonio Jose Sandoval, Normal Santiago, \n                    this.listaAreasAsignaturas.push(element)\n                  } else {\n                    if (element.orden != 99) {\n                      this.listaAreasAsignaturas.push(element)\n                    }\n                  }\n                })\n              }\n            }\n          })\n          .catch(err => {\n            this.mensajeEmergente('danger',CONFIG.TITULO_MSG,'Algo salio mal y no se pudo realizar: Lista areas-asignaturas curso. Intente ms tarde.' + err)\n            this.btnCargando = false\n          })\n          this.datosRaw = []\n          await axios\n          .get(CONFIG.ROOT_PATH + 'consolidados/asignaturas/curso/acumulado', {params: {idCurso: this.idCurso, periodo: this.idPeriodo, vigencia: this.$store.state.aLectivo}})\n          .then(response => {\n            if (response.data.error){\n              this.mensajeEmergente('danger',CONFIG.TITULO_MSG,response.data.mensaje + ' - Consolidados asignaturas curso periodo')\n              this.btnCargando = false\n            } else{\n              if (response.data.datos != 0) {\n                this.datosRaw = response.data.datos\n              }\n            }\n          })\n          .catch(err => {\n            this.mensajeEmergente('danger',CONFIG.TITULO_MSG,'Algo salio mal y no se pudo realizar: Consolidados asignaturas curso periodo. Intente ms tarde.' + err)\n            this.btnCargando = false\n          })\n        }\n        //console.log(JSON.stringify(this.listaAreasAsignaturas))\n        this.btnCargando = false\n      },\n      imprimir() {\n        let fecha = 'Fecha: ' + new Date().toLocaleString()\n        let tituloInforme = 'REPORTE DE ESTADOS SIN SUPERACIN FINAL'\n        const contenido = document.querySelector('table').outerHTML\n        const ventana = window.open(\"Consolidados\", \"_blank\")\n        ventana.document.write(`<html><head><title>Imprimir</title></head>\n        <style scoped>\n          table {\n            border-collapse: collapse;\n            width: 100%;\n            text-align: center;\n            font-size: 10px;\n          }\n          th {\n            background: #eee;\n          }\n          .nota-recuperada {\n            border: 2px solid #ffa500;\n            box-shadow: 0 0 5px #ffa500;\n          }\n          .desempeno-bajo { background-color: #f8d7da; color: #721c24; }\n          .desempeno-basico { background-color: #d1ecf1; color: #0c5460; }\n          .desempeno-alto { background-color: #fff3cd; color: #856404; }\n          .desempeno-superior { background-color: #d4edda; color: #155724; }\n          .desempeno-extra { background-color: #f4ecf5; color: #2f2e2e; }\n        </style>\n          <body class=\"container\">\n            <p style=\"text-align: center; font-size: 12px;\">SECRETARA DE EDUCACIN TERRITORIAL DE TUNJA<br><b>${this.$store.state.nombreInstitucion}</b><br>TUNJA - BOYAC<br>${tituloInforme}<br>Sede: ${this.nombreSede} | Curso: ${this.nombreCurso} | Ao Lectivo ${this.$store.state.aLectivo} | Periodo: FINAL</p>\n            ${contenido}\n            <div style=\"text-align: right; font-size: 12px;\"><i>${fecha}</i></div>\n          </body>\n        </html>`)\n        ventana.document.close()\n        ventana.print()\n      },\n      exportarAExcel() {\n        const tabla = document.querySelector('table')\n        const wb = XLSX.utils.table_to_book(tabla)\n        XLSX.writeFile(wb, 'ConsoldidaFinal.xlsx')\n      },\n      redondear(num) {\n        var m = Number((Math.abs(num) * 10).toPrecision(15))\n        return Math.round(m) / 10 * Math.sign(num);\n      },\n      async ocuparComboCursosSede() {\n        this.comboCursosSede = []\n        this.$store.state.datosCursos.forEach(element => {\n          if (element.id_sede == this.idSede) {\n            this.comboCursosSede.push({ 'value': element.id, 'text': element.nomenclatura.toUpperCase() })\n          }\n        })\n      },\n      async ocuparComboSedes() {\n        this.comboSedes = []\n        this.$store.state.datosSedes.forEach(element => {\n          this.comboSedes.push({ 'value': element.id, 'text': element.sede.toUpperCase() })\n        })\n      },\n      async ocuparComboPeriodos() {\n        this.comboPeriodos = []\n        this.$store.state.periodos.forEach(element => {\n          this.comboPeriodos.push({ 'value': element.id, 'text': element.periodo.toUpperCase() })\n        })\n      },\n      mensajeEmergente(variante, titulo, contenido) {\n        this.$bvToast.toast(contenido, { title: titulo, variant: variante, toaster: \"b-toaster-top-center\", solid: true, autoHideDelay: 4000, appendToast: false })\n      }\n    },\n    computed: {\n      totales() {\n        return this.totalesGlobales()\n      },\n      estudiantesNotas() {\n        const mapa = {}\n        this.datosRaw.forEach(row => {\n          const { estudiante, area, asignatura, periodo, definitiva, recuperacion, orden, definitivacompor, definitivapree, idTipoEspecialidad, ausJ, ausS, porcentaje, id_conceptual } = row\n          if (!mapa[estudiante]) {\n            mapa[estudiante] = { id_conceptual, ausJ: 0, ausS: 0, areas: {} }\n          }\n          if (!mapa[estudiante].areas[area]) {\n            mapa[estudiante].areas[area] = { asignaturas: {} }\n          }\n          if (!mapa[estudiante].areas[area].asignaturas[asignatura]) {\n            mapa[estudiante].areas[area].asignaturas[asignatura] = {\n              periodos: {},\n              orden,\n              idTipoEspecialidad,\n              porcentaje,\n              pesos: { 1: this.datosSeccion.pesoP1, 2: this.datosSeccion.pesoP2, 3: this.datosSeccion.pesoP3, 4: this.datosSeccion.pesoP4 }\n            }\n          }\n          let notaFinal = 0\n          if (orden === 99) {\n            if (this.datosSeccion.tipoValComp == 1) {\n              notaFinal = definitiva\n            } else {\n              notaFinal = definitivacompor != null ? definitivacompor : ''\n            }\n          } else {\n            if (this.idNivel == 1) {\n              notaFinal = definitivapree != null && definitivapree != 0 && definitivapree != '' ? definitivapree : ''\n            } else {\n              notaFinal = recuperacion > definitiva ? recuperacion : definitiva\n            }\n          }\n          mapa[estudiante].areas[area].asignaturas[asignatura].periodos[periodo] = notaFinal\n          mapa[estudiante].ausJ += ausJ || 0\n          mapa[estudiante].ausS += ausS || 0\n        })\n        return mapa\n      },\n      totalColumnasPromedioArea() {\n        const areasUnicas = new Set(this.listaAreasAsignaturas.map(a => a.area))\n        return areasUnicas.size\n      },\n      puestosPorEstudiante() {\n        const lista = Object.entries(this.estudiantesNotas).map(([nombre, areas]) => {\n          const promedio = parseFloat(this.calcularPromedioGeneral(areas))\n          return { nombre, promedio: isNaN(promedio) ? 0 : promedio }\n        })\n        // Ordenar de mayor a menor\n        lista.sort((a, b) => b.promedio - a.promedio)\n        const puestos = {}\n        let puestoActual = 1\n        let contador = 1\n        let ultimoPromedio = null\n        lista.forEach(est => {\n          if (est.promedio !== ultimoPromedio) {\n            puestoActual = contador\n            ultimoPromedio = est.promedio\n            contador++\n          }\n          puestos[est.nombre] = puestoActual\n          //contador++\n        })\n        return puestos\n      },\n      encabezadoPorArea() {\n        const mapa = {}\n        this.listaAreasAsignaturas.forEach(({ area, asignatura }) => {\n          if (!mapa[area]) mapa[area] = []\n          mapa[area].push(asignatura)\n        })\n        return mapa\n      },\n    },\n    beforeMount() {\n      this.ocuparComboSedes()\n      this.ocuparComboPeriodos()\n      this.datosSeccion = this.$store.state.datosSecciones[this.$store.state.idSeccion - 1]\n      //console.log(JSON.stringify(this.datosSeccion))\n    }\n  }\n</script>\n<style scoped>\n  table {\n    border-collapse: collapse;\n    width: 100%;\n    text-align: center;\n    font-size: 10px;\n  }\n  th {\n    background: #eee;\n  }\n  .nota-recuperada {\n    border: 2px solid #ffa500;\n    box-shadow: 0 0 5px #ffa500;\n  }\n  .desempeno-bajo { background-color: #f8d7da; color: #721c24; }\n  .desempeno-basico { background-color: #d1ecf1; color: #0c5460; }\n  .desempeno-alto { background-color: #fff3cd; color: #856404; }\n  .desempeno-superior { background-color: #d4edda; color: #155724; }\n  .desempeno-extra { background-color: #f4ecf5; color: #2f2e2e; }\n  .promedio-area {\n    background-color: #f2f2f2;\n    font-weight: bold;\n    text-align: center;\n  }\n  .bloque-area th,\n  .bloque-area td {\n    border-right: 3px solid #999; /* lnea divisoria entre reas */\n  }\n\n</style>\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ResumenPromocionAreas.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ResumenPromocionAreas.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ResumenPromocionAreas.vue?vue&type=template&id=f56f20da&scoped=true&\"\nimport script from \"./ResumenPromocionAreas.vue?vue&type=script&lang=js&\"\nexport * from \"./ResumenPromocionAreas.vue?vue&type=script&lang=js&\"\nimport style0 from \"./ResumenPromocionAreas.vue?vue&type=style&index=0&id=f56f20da&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"f56f20da\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('b-row',{staticClass:\"mt-2\"},[_c('b-col',{attrs:{\"lg\":\"12\"}},[_c('b-card',{scopedSlots:_vm._u([{key:\"header\",fn:function(){return [_c('h5',{staticClass:\"mb-0\"},[_c('b-icon',{attrs:{\"icon\":\"card-checklist\",\"aria-hidden\":\"true\"}}),_vm._v(\" CONSOLIDADO ASIGNATURAS PERDIDAS\")],1)]},proxy:true}])},[_c('b-card-text',[_c('b-row',[_c('b-col',{attrs:{\"lg\":\"2\"}},[_c('b-form-group',{staticClass:\"etiqueta\",attrs:{\"label\":\"Periodo:\",\"label-for\":\"periodo\"}},[_c('b-form-select',{ref:\"periodo\",attrs:{\"id\":\"periodo\",\"options\":_vm.comboPeriodos},on:{\"change\":function($event){_vm.idSede=null,_vm.idCurso=null}},model:{value:(_vm.idPeriodo),callback:function ($$v) {_vm.idPeriodo=$$v},expression:\"idPeriodo\"}})],1)],1),_c('b-col',{attrs:{\"lg\":\"6\"}},[_c('b-form-group',{staticClass:\"etiqueta\",attrs:{\"label\":\"Seleccione la Sede:\",\"label-for\":\"sedes\"}},[_c('b-form-select',{ref:\"sedes\",attrs:{\"id\":\"sedes\",\"options\":_vm.comboSedes,\"disabled\":_vm.idPeriodo!=null ? false : true},on:{\"change\":function($event){_vm.idCurso=null,_vm.ocuparComboCursosSede()}},model:{value:(_vm.idSede),callback:function ($$v) {_vm.idSede=$$v},expression:\"idSede\"}})],1)],1),_c('b-col',{attrs:{\"lg\":\"4\"}},[_c('b-form-group',{staticClass:\"etiqueta\",attrs:{\"label\":\"Seleccione el Curso:\",\"label-for\":\"cursos\"}},[_c('b-form-select',{ref:\"cursos\",attrs:{\"id\":\"cursos\",\"options\":_vm.comboCursosSede,\"disabled\":_vm.idSede!=null ? false : true},on:{\"change\":function($event){return _vm.consultarEstudiantes()}},model:{value:(_vm.idCurso),callback:function ($$v) {_vm.idCurso=$$v},expression:\"idCurso\"}})],1)],1)],1)],1)],1)],1)],1),_c('b-row',[_c('b-col',{attrs:{\"lg\":\"12\"}},[(_vm.btnCargando)?_c('div',[_c('div',{staticClass:\"text-center m-5 text-primary\"},[_c('b-spinner',{staticStyle:{\"width\":\"3rem\",\"height\":\"3rem\"},attrs:{\"label\":\"Spinner\"}}),_c('br'),_c('strong',[_vm._v(\"Cargando informe...\")])],1)]):_vm._e()])],1),(!_vm.btnCargando && _vm.idCurso!=null)?_c('b-row',[_c('b-col',{attrs:{\"lg\":\"12\"}},[_c('table',{staticClass:\"tabla-perdidas\",attrs:{\"border\":\"1\",\"cellspacing\":\"0\",\"cellpadding\":\"1\"}},[_c('thead',[_c('tr',[_c('th',[_vm._v(\"Estudiante\")]),_c('th',[_vm._v(\"Asignaturas Perdidas\")]),_c('th',[_vm._v(\"Total\")])])]),_c('tbody',_vm._l((_vm.informePerdidas),function(fila){return _c('tr',{key:fila.estudiante},[_c('td',[_vm._v(_vm._s(fila.estudiante))]),_c('td',[_vm._v(_vm._s(fila.perdidas.join(', ')))]),_c('td',[_vm._v(_vm._s(fila.total))])])}),0)]),_c('div',{staticStyle:{\"margin-bottom\":\"1rem\"}},[_c('b-button',{staticClass:\"small mx-1 mt-3\",attrs:{\"variant\":\"primary\"},on:{\"click\":_vm.imprimir}},[_vm._v(\"Imprimir Consolidado\")]),_c('b-button',{staticClass:\"small mx-1 mt-3\",attrs:{\"variant\":\"outline-primary\"},on:{\"click\":_vm.exportarAExcel}},[_vm._v(\"Exportar a Excel\")])],1)])],1):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div>\n    <b-row class=\"mt-2\">\n      <b-col lg=\"12\">\n        <b-card>\n          <template #header>\n            <h5 class=\"mb-0\"><b-icon icon=\"card-checklist\" aria-hidden=\"true\"></b-icon> CONSOLIDADO ASIGNATURAS PERDIDAS</h5>\n          </template>\n          <b-card-text>\n            <b-row>\n              <b-col lg=\"2\">\n                <b-form-group label=\"Periodo:\" label-for=\"periodo\" class=\"etiqueta\">\n                  <b-form-select id=\"periodo\" ref=\"periodo\" v-model=\"idPeriodo\" :options=\"comboPeriodos\" @change=\"idSede=null,idCurso=null\"></b-form-select>\n                </b-form-group>\n              </b-col>\n              <b-col lg=\"6\">\n                <b-form-group label=\"Seleccione la Sede:\" label-for=\"sedes\" class=\"etiqueta\">\n                  <b-form-select  id=\"sedes\" ref=\"sedes\" v-model=\"idSede\" :options=\"comboSedes\" @change=\"idCurso=null,ocuparComboCursosSede()\" :disabled=\"idPeriodo!=null ? false : true\"></b-form-select>\n                </b-form-group>\n              </b-col>\n              <b-col lg=\"4\">\n                <b-form-group label=\"Seleccione el Curso:\" label-for=\"cursos\" class=\"etiqueta\">\n                  <b-form-select id=\"cursos\" ref=\"cursos\" v-model=\"idCurso\" :options=\"comboCursosSede\" @change=\"consultarEstudiantes()\" :disabled=\"idSede!=null ? false : true\"></b-form-select>\n                </b-form-group>\n              </b-col>\n            </b-row>\n          </b-card-text>\n        </b-card>\n      </b-col>\n    </b-row>\n    <b-row>\n      <b-col lg=\"12\">\n        <div v-if=\"btnCargando\">\n          <div class=\"text-center m-5 text-primary\">\n            <b-spinner style=\"width: 3rem; height: 3rem;\" label=\"Spinner\"></b-spinner>\n            <br><strong>Cargando informe...</strong>\n          </div>\n        </div>\n      </b-col>\n    </b-row>\n    <b-row v-if=\"!btnCargando && idCurso!=null\">\n      <b-col lg=\"12\">\n        <table border=\"1\" cellspacing=\"0\" cellpadding=\"1\" class=\"tabla-perdidas\">\n          <thead>\n            <tr>\n              <th>Estudiante</th>\n              <th>Asignaturas Perdidas</th>\n              <th>Total</th>\n            </tr>\n          </thead>\n          <tbody>\n            <tr v-for=\"fila in informePerdidas\" :key=\"fila.estudiante\">\n              <td>{{ fila.estudiante }}</td>\n              <td>{{ fila.perdidas.join(', ') }}</td>\n              <td>{{ fila.total }}</td>\n            </tr>\n          </tbody>\n        </table>\n        <div style=\"margin-bottom: 1rem\">\n          <b-button class=\"small mx-1 mt-3\" variant=\"primary\" @click=\"imprimir\">Imprimir Consolidado</b-button>\n          <b-button class=\"small mx-1 mt-3\" variant=\"outline-primary\" @click=\"exportarAExcel\">Exportar a Excel</b-button>\n        </div>\n      </b-col>\n    </b-row>\n  </div>\n</template>\n\n<script>\n  import axios from \"axios\"\n  import * as CONFIG from '@/assets/config.js'\n  import * as XLSX from 'xlsx'\n\n  export default {\n    name: 'asignaturasperdidas',\n    props: {\n    },\n    components: {\n    },\n    data () {\n      return {\n        idSede: null,\n        comboSedes: [],\n        idPeriodo: null,\n        comboPeriodos: null,\n        idCurso: null,\n        comboCursosSede: [],\n        nombreSede: null,\n        nombreCurso: null,\n        idNivel: null,\n        btnCargando: false,\n        dataConsultada: [],\n        datosSeccion: {},\n        listaAreasAsignaturas: [],\n        listaEstudiantes: [],\n        ausencias: [],\n      }\n    },\n    methods: {\n      async consultarEstudiantes() {\n        this.btnCargando = true\n        this.nombreSede = document.getElementById('sedes')[document.getElementById('sedes').selectedIndex].text\n        if (this.idCurso != null) { \n          this.nombreCurso = document.getElementById('cursos')[document.getElementById('cursos').selectedIndex].text\n          this.$store.state.datosCursos.forEach(element => {\n            if (element.id == this.idCurso) {\n              this.idNivel = element.id_nivel\n            }\n          })\n          this.listaEstudiantes = []\n          await axios\n          .get(CONFIG.ROOT_PATH + 'consolidado/listaestudiantes/curso', { params: { idCurso: this.idCurso, vigencia: this.$store.state.aLectivo }})\n          .then(response => {\n            if (response.data.error){\n              this.mensajeEmergente('danger',CONFIG.TITULO_MSG,response.data.mensaje + ' - Consulta Lista Curso')\n            } else{\n              if (response.data.datos != 0) {\n                this.listaEstudiantes = response.data.datos\n              }\n            }\n          })\n          .catch(err => {\n            this.mensajeEmergente('danger',CONFIG.TITULO_MSG,'Algo salio mal y no se pudo realizar: Consulta Lista Curso. Intente ms tarde.' + err)\n          })\n          /*\n          this.listaAreasAsignaturas = []\n          await axios\n          .get(CONFIG.ROOT_PATH + 'consolidados/areasasignaturas/curso', {params: {idCurso: this.idCurso}})\n          .then(response => {\n            if (response.data.error){\n              this.mensajeEmergente('danger',CONFIG.TITULO_MSG,response.data.mensaje + ' - Lista areas-asignaturas curso')\n              this.btnCargando = false\n            } else{\n              if (response.data.datos != 0) {\n                this.listaAreasAsignaturas = response.data.datos\n              }\n            }\n          })\n          .catch(err => {\n            this.mensajeEmergente('danger',CONFIG.TITULO_MSG,'Algo salio mal y no se pudo realizar: Lista areas-asignaturas curso. Intente ms tarde.' + err)\n            this.btnCargando = false\n          })\n          */\n          this.dataConsultada = []\n          await axios\n          .get(CONFIG.ROOT_PATH + 'consolidados/notasperdidas/curso/periodo', {params: {idCurso: this.idCurso, periodo: this.idPeriodo, vigencia: this.$store.state.aLectivo}})\n          .then(response => {\n            if (response.data.error){\n              this.mensajeEmergente('danger',CONFIG.TITULO_MSG,response.data.mensaje + ' - Consolidados ausencias curso periodo')\n              this.btnCargando = false\n            } else{\n              if (response.data.datos != 0) {\n                this.dataConsultada = response.data.datos\n              }\n            }\n          })\n          .catch(err => {\n            this.mensajeEmergente('danger',CONFIG.TITULO_MSG,'Algo salio mal y no se pudo realizar: Consolidados ausencias curso periodo. Intente ms tarde.' + err)\n            this.btnCargando = false\n          })\n        }\n        //console.log(JSON.stringify(this.listaEstudiantes))\n        //console.log(JSON.stringify(this.listaAreasAsignaturas))\n        //console.log(JSON.stringify(this.dataConsultada))\n        this.btnCargando = false\n      },\n      imprimir() {\n        let fecha = 'Fecha: ' + new Date().toLocaleString()\n        let tituloInforme = 'CONSOLIDADO DE ASIGNATURAS PERDIDAS'\n        const contenido = document.querySelector('table').outerHTML\n        const ventana = window.open(\"Perdidas\", \"_blank\")\n        ventana.document.write(`<html><head><title>Perdidas</title></head>\n        <style scoped>\n          .tabla-perdidas {\n            width: 100%;\n            border-collapse: collapse;\n            font-size: 13px;\n          }\n          .tabla-perdidas th, .tabla-perdidas td {\n            border: 1px solid #ccc;\n            padding: 1px;\n          }\n          .tabla-perdidas th {\n            background-color: #f2f8ff;\n            text-align: center;\n          }\n          .tabla-perdidas td {\n            vertical-align: top;\n          }\n        </style>\n          <body class=\"container\">\n            <p style=\"text-align: center; font-size: 12px;\">SECRETARA DE EDUCACIN TERRITORIAL DE TUNJA<br><b>${this.$store.state.nombreInstitucion}</b><br>TUNJA - BOYAC<br>${tituloInforme}<br>Sede: ${this.nombreSede} | Curso: ${this.nombreCurso} | Ao Lectivo ${this.$store.state.aLectivo} | Periodo: ${this.idPeriodo}</p>\n            ${contenido}\n            <div style=\"text-align: right; font-size: 12px;\"><i>${fecha}</i></div>\n          </body>\n        </html>`)\n        ventana.document.close()\n        ventana.print()\n      },\n      exportarAExcel() {\n        const tabla = document.querySelector('table')\n        const wb = XLSX.utils.table_to_book(tabla)\n        XLSX.writeFile(wb, 'ausencias.xlsx')\n      },\n      async ocuparComboCursosSede() {\n        this.comboCursosSede = []\n        this.$store.state.datosCursos.forEach(element => {\n          if (element.id_sede == this.idSede) {\n            this.comboCursosSede.push({ 'value': element.id, 'text': element.nomenclatura.toUpperCase() })\n          }\n        })\n      },\n      async ocuparComboSedes() {\n        this.comboSedes = []\n        this.$store.state.datosSedes.forEach(element => {\n          this.comboSedes.push({ 'value': element.id, 'text': element.sede.toUpperCase() })\n        })\n      },\n      async ocuparComboPeriodos() {\n        this.comboPeriodos = []\n        this.$store.state.periodos.forEach(element => {\n          this.comboPeriodos.push({ 'value': element.id, 'text': element.periodo.toUpperCase() })\n        })\n      },\n      mensajeEmergente(variante, titulo, contenido) {\n        this.$bvToast.toast(contenido, { title: titulo, variant: variante, toaster: \"b-toaster-top-center\", solid: true, autoHideDelay: 4000, appendToast: false })\n      }\n    },\n    computed: {\n      informePerdidas() {\n        return this.listaEstudiantes.map(est => {\n          const registros = this.dataConsultada.filter(dc => dc.idMatricula === est.idMatricula && dc.orden !== 98 && dc.orden !== 99)\n          const asignaturasPerdidas = registros\n            .map(dc => {\n              const definitiva = parseFloat(dc.definitiva) || 0\n              const recuperacion = parseFloat(dc.recuperacion)\n              const notaFinal = (!isNaN(recuperacion) && recuperacion > definitiva)\n                ? recuperacion\n                : definitiva\n              const tipo = parseInt(dc.idTipoEspecialidad)\n              const esPerdida =\n                tipo === 1 ? notaFinal < this.datosSeccion.minBas :\n                tipo === 2 ? notaFinal < this.datosSeccion.minBasT :\n                false // otros tipos no se consideran\n              return esPerdida\n                ? { asignatura: dc.asignatura, nota: notaFinal }\n                : null\n            })\n            .filter(Boolean)\n\n          const resumen = asignaturasPerdidas.map(a => `${a.asignatura}(${a.nota.toFixed(1)})`)\n\n          return {\n            estudiante: est.estudiante,\n            perdidas: resumen,\n            total: resumen.length\n          }\n        }).filter(e => e.total > 0) // solo estudiantes con prdidas\n      }\n    },\n    beforeMount() {\n      this.ocuparComboSedes()\n      this.ocuparComboPeriodos()\n      this.datosSeccion = this.$store.state.datosSecciones[this.$store.state.idSeccion - 1]\n    }\n  }\n</script>\n<style scoped>\n  .tabla-perdidas {\n    width: 100%;\n    border-collapse: collapse;\n    font-size: 13px;\n  }\n  .tabla-perdidas th, .tabla-perdidas td {\n    border: 1px solid #ccc;\n    padding: 6px;\n  }\n  .tabla-perdidas th {\n    background-color: #f2f8ff;\n    text-align: center;\n  }\n  .tabla-perdidas td {\n    vertical-align: top;\n  }\n</style>\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AsignaturasPerdidas.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AsignaturasPerdidas.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./AsignaturasPerdidas.vue?vue&type=template&id=57fed324&scoped=true&\"\nimport script from \"./AsignaturasPerdidas.vue?vue&type=script&lang=js&\"\nexport * from \"./AsignaturasPerdidas.vue?vue&type=script&lang=js&\"\nimport style0 from \"./AsignaturasPerdidas.vue?vue&type=style&index=0&id=57fed324&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"57fed324\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('b-row',{staticClass:\"mt-2\"},[_c('b-col',{attrs:{\"lg\":\"12\"}},[_c('b-card',{scopedSlots:_vm._u([{key:\"header\",fn:function(){return [_c('h5',{staticClass:\"mb-0\"},[_c('b-icon',{attrs:{\"icon\":\"card-checklist\",\"aria-hidden\":\"true\"}}),_vm._v(\" CONSOLIDADO EVALUACIONES FINALES DE ASIGNATURAS\")],1)]},proxy:true}])},[_c('b-card-text',[_c('b-row',[_c('b-col',{attrs:{\"lg\":\"6\"}},[_c('b-form-group',{staticClass:\"etiqueta\",attrs:{\"label\":\"Seleccione la Sede:\",\"label-for\":\"sedes\"}},[_c('b-form-select',{ref:\"sedes\",attrs:{\"id\":\"sedes\",\"options\":_vm.comboSedes},on:{\"change\":function($event){_vm.idCurso=null,_vm.ocuparComboCursosSede()}},model:{value:(_vm.idSede),callback:function ($$v) {_vm.idSede=$$v},expression:\"idSede\"}})],1)],1),_c('b-col',{attrs:{\"lg\":\"4\"}},[_c('b-form-group',{staticClass:\"etiqueta\",attrs:{\"label\":\"Seleccione el Curso:\",\"label-for\":\"cursos\"}},[_c('b-form-select',{ref:\"cursos\",attrs:{\"id\":\"cursos\",\"options\":_vm.comboCursosSede,\"disabled\":_vm.idSede!=null ? false : true},on:{\"change\":function($event){return _vm.consultarEstudiantes()}},model:{value:(_vm.idCurso),callback:function ($$v) {_vm.idCurso=$$v},expression:\"idCurso\"}})],1)],1)],1)],1)],1)],1)],1),_c('b-row',[_c('b-col',{attrs:{\"lg\":\"12\"}},[(_vm.btnCargando)?_c('div',[_c('div',{staticClass:\"text-center m-5 text-primary\"},[_c('b-spinner',{staticStyle:{\"width\":\"3rem\",\"height\":\"3rem\"},attrs:{\"label\":\"Spinner\"}}),_c('br'),_c('strong',[_vm._v(\"Cargando informe...\")])],1)]):_vm._e()])],1),(!_vm.btnCargando && _vm.idCurso!=null)?_c('b-row',[_c('b-col',{attrs:{\"lg\":\"12\"}},[_c('table',{staticClass:\"table-responsive\",attrs:{\"border\":\"1\",\"cellspacing\":\"0\",\"cellpadding\":\"1\"}},[_c('thead',[_c('tr',[_c('th',{attrs:{\"rowspan\":\"3\"}},[_vm._v(\"#\")]),_c('th',{attrs:{\"rowspan\":\"3\"}},[_vm._v(\"Estudiante\")]),_vm._l((_vm.encabezadoPorArea),function(asigs,area){return [_c('th',{key:area,attrs:{\"colspan\":_vm.colspanArea(area)}},[_vm._v(\" \"+_vm._s(area)+\" \")])]}),_c('th',{attrs:{\"rowspan\":\"3\"}},[_vm._v(\"PRO GEN\")]),_c('th',{attrs:{\"rowspan\":\"3\"}},[_vm._v(\"Tot\"),_c('br'),_vm._v(\"Asig\"),_c('br'),_vm._v(\"Baj\")]),_c('th',{attrs:{\"rowspan\":\"3\"}},[_vm._v(\"Tot\"),_c('br'),_vm._v(\"Asig\"),_c('br'),_vm._v(\"Bas\")]),_c('th',{attrs:{\"rowspan\":\"3\"}},[_vm._v(\"Tot\"),_c('br'),_vm._v(\"Asig\"),_c('br'),_vm._v(\"Alt\")]),_c('th',{attrs:{\"rowspan\":\"3\"}},[_vm._v(\"Tot\"),_c('br'),_vm._v(\"Asig\"),_c('br'),_vm._v(\"Sup\")]),_c('th',{attrs:{\"rowspan\":\"3\"}},[_vm._v(\"Tot\"),_c('br'),_vm._v(\"AuJ\")]),_c('th',{attrs:{\"rowspan\":\"3\"}},[_vm._v(\"Tot\"),_c('br'),_vm._v(\"AuS\")]),_c('th',{attrs:{\"rowspan\":\"3\"}},[_vm._v(\"Puesto\")]),_c('th',{attrs:{\"rowspan\":\"3\"}},[_vm._v(\"#\")])],2),_c('tr',[_vm._l((_vm.encabezadoPorArea),function(asigs,area){return [_vm._l((asigs),function(asig,k){return [_c('th',{key:'area-' + asig + k,attrs:{\"colspan\":_vm.periodosVisibles.length + 1}},[_vm._v(\" \"+_vm._s(asig)+\" \")])]}),_c('th',{key:'prom-area-' + area,staticClass:\"promedio-area\"},[_vm._v(\"PRO AR\")])]})],2),_c('tr',[_vm._l((_vm.encabezadoPorArea),function(asigs,area){return [_vm._l((asigs),function(asig){return [_vm._l((_vm.periodosVisibles),function(p){return _c('th',{key:'h' + area + asig + p},[_vm._v(\" P\"+_vm._s(p)+\" \")])}),_c('th',{key:'prom' + asig + area},[_vm._v(\"PR\")])]}),_c('th',{key:'prom' + area})]})],2)]),_c('tbody',[_vm._l((_vm.estudiantesNotas),function(est,nombre,i){return _c('tr',{key:nombre},[_c('td',{staticClass:\"text-left\"},[_vm._v(_vm._s(i + 1))]),_c('td',{staticStyle:{\"text-align\":\"left\"}},[_vm._v(_vm._s(nombre))]),_vm._l((_vm.encabezadoPorArea),function(asigs,area){return [_vm._l((asigs),function(asig){return [_vm._l((_vm.periodosVisibles),function(p){return _c('td',{key:nombre + area + asig + p},[_vm._v(\" \"+_vm._s(est.id_conceptual=='N' ? _vm.obtenerNota(est, area, asig, p) : '-')+\" \")])}),_c('td',{key:'prom' + nombre + area + asig,staticClass:\"bloque-area\",staticStyle:{\"font-weight\":\"bold\",\"text-align\":\"center\"}},[_vm._v(\" \"+_vm._s(est.id_conceptual=='N' ? _vm.obtenerPromedioAsignatura(est, area, asig) : '-')+\" \")])]}),_c('td',{key:'promArea' + nombre + area,staticClass:\"promedio-area bloque-area\"},[_vm._v(\" \"+_vm._s(est.id_conceptual=='N' ? _vm.obtenerPromedioArea(est, area) : '-')+\" \")])]}),_c('td',[_vm._v(_vm._s(est.id_conceptual=='N' ? _vm.calcularPromedioGeneral(est) : '-'))]),_c('td',[_vm._v(_vm._s(est.id_conceptual=='N' ? _vm.contarDesempenoEstudiante(est.areas, 'bajo') : '-'))]),_c('td',[_vm._v(_vm._s(est.id_conceptual=='N' ? _vm.contarDesempenoEstudiante(est.areas, 'basico') : '-'))]),_c('td',[_vm._v(_vm._s(est.id_conceptual=='N' ? _vm.contarDesempenoEstudiante(est.areas, 'alto') : '-'))]),_c('td',[_vm._v(_vm._s(est.id_conceptual=='N' ? _vm.contarDesempenoEstudiante(est.areas, 'superior') : '-'))]),_c('td',[_vm._v(_vm._s(est.id_conceptual=='N' ? est.ausJ : '-'))]),_c('td',[_vm._v(_vm._s(est.id_conceptual=='N' ? est.ausS : '-'))]),_c('td',[_vm._v(_vm._s(est.id_conceptual=='N' ? _vm.iconoPuesto(_vm.puestosPorEstudiante[nombre]) : '-')+\" \"+_vm._s(est.id_conceptual=='N' ? _vm.puestosPorEstudiante[nombre] : '-'))]),_c('td',{staticClass:\"text-left\"},[_vm._v(_vm._s(i + 1))])],2)}),_c('tr',{staticStyle:{\"background-color\":\"#f0f0f0\",\"font-weight\":\"bold\"}},[_c('td',{attrs:{\"colspan\":\"2\"}},[_vm._v(\"Total Bajos\")]),_vm._l((_vm.encabezadoPorArea),function(asigs,area){return [_vm._l((asigs),function(asig){return [_vm._l((_vm.periodosVisibles),function(p){return _c('td',{key:'bp' + area + asig + p},[_vm._v(\" \"+_vm._s(_vm.totalBajosPorPeriodo(area, asig, p))+\" \")])}),_c('td',{key:'bj' + area + asig},[_vm._v(\" \"+_vm._s(_vm.totalBajosPromedioAsignatura(area, asig))+\" \")])]}),_c('td',{key:'bja' + area,staticClass:\"promedio-area\"},[_vm._v(\" \"+_vm._s(_vm.totalBajosPromedioArea(area))+\" \")])]}),_c('td'),_vm._v(\" \"),_c('td',[_vm._v(_vm._s(_vm.totales.bajo))]),_c('td',[_vm._v(_vm._s(_vm.totales.basico))]),_c('td',[_vm._v(_vm._s(_vm.totales.alto))]),_c('td',[_vm._v(_vm._s(_vm.totales.superior))]),_c('td',[_vm._v(_vm._s(_vm.totales.ausJ))]),_c('td',[_vm._v(_vm._s(_vm.totales.ausS))]),_c('td'),_vm._v(\" \"),_c('td')],2)],2)]),_c('div',{staticStyle:{\"margin-bottom\":\"1rem\"}},[_c('b-button',{staticClass:\"small mx-1 mt-3\",attrs:{\"variant\":\"primary\"},on:{\"click\":_vm.imprimir}},[_vm._v(\"Imprimir Consolidado\")]),_c('b-button',{staticClass:\"small mx-1 mt-3\",attrs:{\"variant\":\"outline-primary\"},on:{\"click\":_vm.exportarAExcel}},[_vm._v(\"Exportar a Excel\")])],1)])],1):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div>\n    <b-row class=\"mt-2\">\n      <b-col lg=\"12\">\n        <b-card>\n          <template #header>\n            <h5 class=\"mb-0\"><b-icon icon=\"card-checklist\" aria-hidden=\"true\"></b-icon> CONSOLIDADO EVALUACIONES FINALES DE ASIGNATURAS</h5>\n          </template>\n          <b-card-text>\n            <b-row>\n              <!--\n              <b-col lg=\"2\">\n                <b-form-group label=\"Periodo:\" label-for=\"periodo\" class=\"etiqueta\">\n                  <b-form-select id=\"periodo\" ref=\"periodo\" v-model=\"idPeriodo\" :options=\"comboPeriodos\" @change=\"idSede=null,idCurso=null\"></b-form-select>\n                </b-form-group>\n              </b-col>\n              -->\n              <b-col lg=\"6\">\n                <b-form-group label=\"Seleccione la Sede:\" label-for=\"sedes\" class=\"etiqueta\">\n                  <b-form-select  id=\"sedes\" ref=\"sedes\" v-model=\"idSede\" :options=\"comboSedes\" @change=\"idCurso=null,ocuparComboCursosSede()\"></b-form-select>\n                </b-form-group>\n              </b-col>\n              <b-col lg=\"4\">\n                <b-form-group label=\"Seleccione el Curso:\" label-for=\"cursos\" class=\"etiqueta\">\n                  <b-form-select id=\"cursos\" ref=\"cursos\" v-model=\"idCurso\" :options=\"comboCursosSede\" @change=\"consultarEstudiantes()\" :disabled=\"idSede!=null ? false : true\"></b-form-select>\n                </b-form-group>\n              </b-col>\n            </b-row>\n          </b-card-text>\n        </b-card>\n      </b-col>\n    </b-row>\n    <b-row>\n      <b-col lg=\"12\">\n        <div v-if=\"btnCargando\">\n          <div class=\"text-center m-5 text-primary\">\n            <b-spinner style=\"width: 3rem; height: 3rem;\" label=\"Spinner\"></b-spinner>\n            <br><strong>Cargando informe...</strong>\n          </div>\n        </div>\n      </b-col>\n    </b-row>\n    <b-row v-if=\"!btnCargando && idCurso!=null\">\n      <b-col lg=\"12\">\n        <table border=\"1\" cellspacing=\"0\" cellpadding=\"1\" class=\"table-responsive\">\n          <thead>\n            <tr>\n              <th rowspan=\"3\">#</th>\n              <th rowspan=\"3\">Estudiante</th>\n              <template v-for=\"(asigs, area) in encabezadoPorArea\">\n                <th :colspan=\"colspanArea(area)\" :key=\"area\">\n                  {{ area }}\n                </th>\n              </template>\n              <th rowspan=\"3\">PRO GEN</th>\n              <th rowspan=\"3\">Tot<br>Asig<br>Baj</th>\n              <th rowspan=\"3\">Tot<br>Asig<br>Bas</th>\n              <th rowspan=\"3\">Tot<br>Asig<br>Alt</th>\n              <th rowspan=\"3\">Tot<br>Asig<br>Sup</th>\n              <th rowspan=\"3\">Tot<br>AuJ</th>\n              <th rowspan=\"3\">Tot<br>AuS</th>\n              <th rowspan=\"3\">Puesto</th>\n              <th rowspan=\"3\">#</th>\n            </tr>\n            <tr>\n              <template v-for=\"(asigs, area) in encabezadoPorArea\">\n                <template v-for=\"(asig, k) in asigs\">\n                  <th :colspan=\"periodosVisibles.length + 1\" :key=\"'area-' + asig + k\">\n                    {{ asig }}\n                  </th>\n                </template>\n                <th class=\"promedio-area\" :key=\"'prom-area-' + area\">PRO AR</th>\n              </template>\n            </tr>\n            <tr>\n              <template v-for=\"(asigs, area) in encabezadoPorArea\">\n                <template v-for=\"asig in asigs\">\n                  <th v-for=\"p in periodosVisibles\" :key=\"'h' + area + asig + p\">\n                    P{{ p }}\n                  </th>\n                  <th :key=\"'prom' + asig + area\">PR</th>\n                </template>\n                <th :key=\"'prom' + area\"></th>\n              </template>\n              <!-- columnas finales vacas -->\n            </tr>\n          </thead>\n          <tbody>\n            <tr v-for=\"(est, nombre, i) in estudiantesNotas\" :key=\"nombre\">\n              <td class=\"text-left\">{{ i + 1 }}</td>\n              <td style=\"text-align: left\">{{ nombre }}</td>\n              <template v-for=\"(asigs, area) in encabezadoPorArea\">\n                <template v-for=\"asig in asigs\">\n                  <td v-for=\"p in periodosVisibles\"  :key=\"nombre + area + asig + p\">\n                    {{ est.id_conceptual=='N' ? obtenerNota(est, area, asig, p) : '-' }}\n                  </td>\n                  <td class=\"bloque-area\" :key=\"'prom' + nombre + area + asig\" style=\"font-weight: bold; text-align: center;\">\n                    {{ est.id_conceptual=='N' ? obtenerPromedioAsignatura(est, area, asig) : '-' }}\n                  </td>\n                </template>\n                <td class=\"promedio-area bloque-area\" :key=\"'promArea' + nombre + area\">\n                  {{ est.id_conceptual=='N' ? obtenerPromedioArea(est, area) : '-' }}\n                </td>\n              </template>\n\n              <td>{{ est.id_conceptual=='N' ? calcularPromedioGeneral(est) : '-' }}</td>\n              <td>{{ est.id_conceptual=='N' ? contarDesempenoEstudiante(est.areas, 'bajo') : '-' }}</td>\n              <td>{{ est.id_conceptual=='N' ? contarDesempenoEstudiante(est.areas, 'basico') : '-' }}</td>\n              <td>{{ est.id_conceptual=='N' ? contarDesempenoEstudiante(est.areas, 'alto') : '-' }}</td>\n              <td>{{ est.id_conceptual=='N' ? contarDesempenoEstudiante(est.areas, 'superior') : '-' }}</td>\n              <td>{{ est.id_conceptual=='N' ? est.ausJ : '-' }}</td>\n              <td>{{ est.id_conceptual=='N' ? est.ausS : '-' }}</td>\n              <td>{{ est.id_conceptual=='N' ? iconoPuesto(puestosPorEstudiante[nombre]) : '-' }} {{ est.id_conceptual=='N' ? puestosPorEstudiante[nombre] : '-' }}</td>\n              <td class=\"text-left\">{{ i + 1 }}</td>\n            </tr>\n            <tr style=\"background-color: #f0f0f0; font-weight: bold;\">\n              <td colspan=\"2\">Total Bajos</td>\n              <template v-for=\"(asigs, area) in encabezadoPorArea\">\n                <template v-for=\"asig in asigs\">\n                  <!-- Bajos por periodo -->\n                  <td v-for=\"p in periodosVisibles\" :key=\"'bp' + area + asig + p\">\n                    {{ totalBajosPorPeriodo(area, asig, p) }}\n                  </td>\n                  <!-- Bajos por promedio de asignatura -->\n                  <td :key=\"'bj' + area + asig\">\n                    {{ totalBajosPromedioAsignatura(area, asig) }}\n                  </td>\n                </template>\n                <!-- Bajos por promedio de rea -->\n                <td  :key=\"'bja' + area\" class=\"promedio-area\">\n                  {{ totalBajosPromedioArea(area) }}\n                </td>\n              </template>\n              <td></td> <!-- Prom. General -->\n              <td>{{ totales.bajo }}</td>\n              <td>{{ totales.basico }}</td>\n              <td>{{ totales.alto }}</td>\n              <td>{{ totales.superior }}</td>\n              <td>{{ totales.ausJ }}</td>\n              <td>{{ totales.ausS }}</td>\n              <td></td> <!-- Puesto -->\n              <td></td>\n            </tr>\n          </tbody>\n        </table>\n        <div style=\"margin-bottom: 1rem\">\n          <b-button class=\"small mx-1 mt-3\" variant=\"primary\" @click=\"imprimir\">Imprimir Consolidado</b-button>\n          <b-button class=\"small mx-1 mt-3\" variant=\"outline-primary\" @click=\"exportarAExcel\">Exportar a Excel</b-button>\n        </div>\n      </b-col>\n    </b-row>\n  </div>\n</template>\n\n<script>\n  import axios from \"axios\"\n  import * as CONFIG from '@/assets/config.js'\n  import * as XLSX from 'xlsx'\n\n  export default {\n    name: 'consolidadopromedio',\n    components: {\n    },\n    data () {\n      return {\n        idSede: null,\n        comboSedes: [],\n        idPeriodo: 5,\n        comboPeriodos: null,\n        idCurso: null,\n        comboCursosSede: [],\n        nombreSede: null,\n        nombreCurso: null,\n        idNivel: null,\n        btnCargando: false,\n        datosRaw: [],\n        datosSeccion: {},\n        listaAreasAsignaturas: [],\n        periodosVisibles: []\n      }\n    },\n    methods: {\n      colspanArea(area) {\n        const asignaturas = this.encabezadoPorArea[area] || []\n        const columnasPorAsignatura = this.periodosVisibles.length + 1\n        const extraColumnaPromArea = 1\n        return (asignaturas.length * columnasPorAsignatura) + extraColumnaPromArea\n      },\n\n      totalBajosPorPeriodo(area, asignatura, periodo) {\n        let total = 0\n        const meta = this.listaAreasAsignaturas.find(\n          a => a.area === area && a.asignatura === asignatura\n        )\n        const idTipoEspecialidad = meta?.idTipoEspecialidad\n        Object.values(this.estudiantesNotas).forEach(est => {\n          const nota = est?.areas?.[area]?.asignaturas?.[asignatura]?.periodos?.[periodo]\n          if (idTipoEspecialidad === 1) {\n            if (nota > 0 && nota < this.datosSeccion.minBas) total++\n          } else {\n            if (nota > 0 && nota < this.datosSeccion.minBasT) total++\n          }\n        })\n        return total\n      },\n      totalBajosPromedioAsignatura(area, asignatura) {\n        let total = 0\n        const meta = this.listaAreasAsignaturas.find(\n          a => a.area === area && a.asignatura === asignatura\n        )\n        const idTipoEspecialidad = meta?.idTipoEspecialidad\n        Object.values(this.estudiantesNotas).forEach(est => {\n          const asig = est?.areas?.[area]?.asignaturas?.[asignatura]\n          if (!asig) return\n          const prom = parseFloat(this.calcularPromedioAsignatura(asig))\n          if (idTipoEspecialidad === 1) {\n            if (prom < this.datosSeccion.minBas) total++\n          } else {\n            if (prom < this.datosSeccion.minBasT) total++\n          }\n        })\n        return total\n      },\n      totalBajosPromedioArea(area) {\n        let total = 0\n        Object.values(this.estudiantesNotas).forEach(est => {\n          const prom = parseFloat(this.obtenerPromedioArea(est, area))\n          if (!isNaN(prom) && prom < this.datosSeccion.minBas) total++\n        })\n        return total\n      },\n      totalesGlobales() {\n        let bajo = 0, basico = 0, alto = 0, superior = 0, ausJ = 0, ausS = 0\n        Object.values(this.estudiantesNotas).forEach(est => {\n          bajo += this.contarDesempenoEstudiante(est.areas, 'bajo')\n          basico += this.contarDesempenoEstudiante(est.areas, 'basico')\n          alto += this.contarDesempenoEstudiante(est.areas, 'alto')\n          superior += this.contarDesempenoEstudiante(est.areas, 'superior')\n          ausJ += est.ausJ || 0\n          ausS += est.ausS || 0\n        })\n\n        return { bajo, basico, alto, superior, ausJ, ausS }\n      },\n      esAreaValida(area) {\n        //const asigns = this.listaAreasAsignaturas.filter(a => a.area === area)\n        //return asigns.some(a => a.orden !== 99)\n        const asigns = this.listaAreasAsignaturas.filter(a => a.area === area)\n        if (asigns.some(a => a.orden !== 99 && a.orden !== 98)) return true\n        else if (asigns.some(a => a.orden === 99) && this.datosSeccion.promCompor == 1) return true\n        else return false\n      },\n      obtenerPromedioArea(est, area) {\n        const areaData = est.areas && est.areas[area]\n        return areaData ? this.calcularPromedioArea(areaData) : ''\n      },\n      obtenerNota(est, area, asignatura, periodo) {\n        let nota = est?.areas?.[area]?.asignaturas?.[asignatura]?.periodos?.[periodo]\n        if (nota === 0) nota = ''\n        return typeof nota === 'number' ? nota.toFixed(1) : nota\n      },\n      obtenerPromedioAsignatura(est, area, asignatura) {\n        const asig = est?.areas?.[area]?.asignaturas?.[asignatura]\n        return asig ? this.calcularPromedioAsignatura(asig) : ''\n      },\n      calcularPromedioAsignatura(asig) {\n        const pesos = asig.pesos\n        const periodos = asig.periodos\n        const orden = asig.orden\n        if (orden === 99 && this.datosSeccion.promCompor == 0) return '-'\n        let total = 0\n        if (this.$store.state.idInstitucion == 'acaa36d0-fcb1-11ec-8267-536b07c743c4') { // Emiliani\n          if( orden == 12) {\n            let cantidad = 0 \n            for (let p = 1; p <= 4; p++) {\n              const nota = periodos[p] ?? 0\n              if (nota > 0) {\n                total += nota\n                cantidad++\n              }\n            }\n            if (total === 0) return ''\n            total = total / cantidad\n            return this.redondear(total).toFixed(1) > 0 ? this.redondear(total).toFixed(1) : ''\n          } else {\n            for (let p = 1; p <= 4; p++) {\n              const nota = periodos[p] ?? 0\n              total += nota * pesos[p] / 100\n            }\n            return this.redondear(total).toFixed(1) > 0 ? this.redondear(total).toFixed(1) : ''\n          }\n        } else if (this.$store.state.idInstitucion == 'eb58bf60-fc83-11ec-a1d1-1dc2835404e5') { // Inem\n          if (orden == 55) {\n            let cantidad = 0 // nuevo\n            for (let p = 1; p <= 4; p++) {\n              const nota = periodos[p] ?? 0\n              if (nota > 0) {\n                total += nota\n                cantidad++\n              }\n            }\n            if (total === 0) return ''\n            total = total / cantidad\n            return this.redondear(total).toFixed(1) > 0 ? this.redondear(total).toFixed(1) : ''\n          } else {\n            for (let p = 1; p <= 4; p++) {\n              const nota = periodos[p] ?? 0\n              total += nota * pesos[p] / 100\n            }\n            return this.redondear(total).toFixed(1) > 0 ? this.redondear(total).toFixed(1) : ''\n          }\n        } else if (this.$store.state.idInstitucion == 'c50f3d80-fca0-11ec-8267-536b07c743c4') { // Silvino\n          const nota = periodos[5] ?? 0\n          return nota > 0 ? nota.toFixed(1) : ''\n        } else if (this.$store.state.idInstitucion == '8a1bd1e0-fcb2-11ec-8267-536b07c743c4') { // Libertador\n          const nota = periodos[5] ?? 0\n          return nota > 0 ? nota.toFixed(1) : ''\n        } else {\n          let cantidad = 0 \n          for (let p = 1; p <= 4; p++) {\n            const nota = periodos[p] ?? 0\n            if (nota > 0) {\n              total += nota\n              cantidad++\n            }\n          }\n          if (total === 0) return ''\n          const promedio = total / cantidad\n          return this.redondear(promedio).toFixed(1) > 0 ? this.redondear(promedio).toFixed(1) : ''\n        }\n      },\n      calcularPromedioArea(areaData) {\n        const asigns = Object.values(areaData.asignaturas)\n        if (!asigns.length) return '0.00'\n        let total = 0\n        asigns.forEach(asig => {\n          if (asig.orden === 99 && this.datosSeccion.promCompor == 0) return '-'\n          total += parseFloat((this.calcularPromedioAsignatura(asig) * asig.porcentaje) / 100)\n        })\n        return total > 0 ? this.redondear(total).toFixed(1) : ''\n      },\n      calcularPromedioGeneral(est) {\n        const areas = Object.keys(est.areas || {})\n        let total = 0\n        let cantidad = 0\n        areas.forEach(area => {\n          if (!this.esAreaValida(area)) return\n          const promedio = parseFloat(this.calcularPromedioArea(est.areas[area]))\n          if (!isNaN(promedio)) {\n            total += promedio\n            cantidad++\n          }\n        })\n        return cantidad > 0 ? (total / cantidad).toFixed(3) : ''\n      },\n      contarAusencias(tipo) {\n        let total = 0\n        Object.values(this.estudiantesNotas).forEach(est => {\n          if (tipo === 'ausJ') total += est.ausJ || 0\n          if (tipo === 'ausS') total += est.ausS || 0\n        })\n        return total\n      },\n      contarNotasPorAsignatura(area, asignatura, tipo) {\n        let contador = 0\n        Object.values(this.estudiantesNotas).forEach(est => {\n          const nota = est?.[area]?.[asignatura]?.nota\n          const val = est?.[area]?.[asignatura]?.idTipoEspecialidad\n          if (typeof nota !== 'number') return\n          if (val === 1) {\n            if (tipo === 'bajo' && nota < this.datosSeccion.minBas) contador++\n            else if (tipo === 'basico' && nota >= this.datosSeccion.minBas && nota < this.datosSeccion.minAlt) contador++\n            else if (tipo === 'alto' && nota >= this.datosSeccion.minAlt && nota < this.datosSeccion.minSup) contador++\n            else if (tipo === 'superior' && nota >= this.datosSeccion.minSup && nota <= this.datosSeccion.maxSup) contador++\n          } else {\n            if (tipo === 'bajo' && nota < this.datosSeccion.minBasT) contador++\n            else if (tipo === 'basico' && nota >= this.datosSeccion.minBasT && nota < this.datosSeccion.minAltT) contador++\n            else if (tipo === 'alto' && nota >= this.datosSeccion.minAltT && nota < this.datosSeccion.minSupT) contador++\n            else if (tipo === 'superior' && nota >= this.datosSeccion.minSupT && nota <= this.datosSeccion.maxSupT) contador++\n          }\n        })\n        return contador\n      },\n      contarNotasTotales(tipo) {\n        let total = 0\n        Object.values(this.estudiantesNotas).forEach(est => {\n          this.listaAreasAsignaturas.forEach(({ area, asignatura }) => {\n            const nota = est?.[area]?.[asignatura]?.nota\n            const val = est?.[area]?.[asignatura]?.idTipoEspecialidad\n            if (typeof nota !== 'number') return\n            if (val === 1) {\n              if (tipo === 'bajo' && nota < this.datosSeccion.minBas) total++\n              else if (tipo === 'basico' && nota >= this.datosSeccion.minBas && nota < this.datosSeccion.minAlt) total++\n              else if (tipo === 'alto' && nota >= this.datosSeccion.minAlt && nota < this.datosSeccion.minSup) total++\n              else if (tipo === 'superior' && nota >= this.datosSeccion.minSup && nota <= this.datosSeccion.maxSup) total++\n            } else {\n              if (tipo === 'bajo' && nota < this.datosSeccion.minBasT) total++\n              else if (tipo === 'basico' && nota >= this.datosSeccion.minBasT && nota < this.datosSeccion.minAltT) total++\n              else if (tipo === 'alto' && nota >= this.datosSeccion.minAltT && nota < this.datosSeccion.minSupT) total++\n              else if (tipo === 'superior' && nota >= this.datosSeccion.minSupT && nota <= this.datosSeccion.maxSupT) total++\n            }\n          })\n        })\n        return total\n      },\n      iconoPuesto(puesto) {\n        if (puesto === 1) return ''\n        if (puesto === 2) return ''\n        if (puesto === 3) return ''\n        return ''\n      },\n      contarDesempenoEstudiante(areas, tipo) {\n        let contador = 0\n        Object.values(areas || {}).forEach(area => {\n          Object.values(area.asignaturas || {}).forEach(asig => {\n            const nota = parseFloat(this.calcularPromedioAsignatura(asig))\n            const val =  asig.idTipoEspecialidad\n            const orden =  asig.orden\n            if (this.$store.state.idInstitucion == 'eb58bf60-fc83-11ec-a1d1-1dc2835404e5' && orden == 90) return // No se tiene en cuenta el area de Inem Exploracion vocacional - Complementaria\n            if (this.$store.state.idInstitucion == '097b7b10-fcaa-11ec-8267-536b07c743c4' && orden == 98) return // No se tiene en cuenta el area de Rural Proyectos Profundizacion\n            if (typeof nota !== 'number') return\n            if (val === 1) {\n              if (tipo === 'bajo' && nota < this.datosSeccion.minBas) contador++\n              else if (tipo === 'basico' && nota >= this.datosSeccion.minBas && nota < this.datosSeccion.minAlt) contador++\n              else if (tipo === 'alto' && nota >= this.datosSeccion.minAlt && nota < this.datosSeccion.minSup) contador++\n              else if (tipo === 'superior' && nota >= this.datosSeccion.minSup && nota <= this.datosSeccion.maxSup) contador++\n            } else {\n              if (tipo === 'bajo' && nota < this.datosSeccion.minBasT) contador++\n              else if (tipo === 'basico' && nota >= this.datosSeccion.minBasT && nota < this.datosSeccion.minAltT) contador++\n              else if (tipo === 'alto' && nota >= this.datosSeccion.minAltT && nota < this.datosSeccion.minSupT) contador++\n              else if (tipo === 'superior' && nota >= this.datosSeccion.minSupT && nota <= this.datosSeccion.maxSupT) contador++\n            }\n          })\n        })\n        return contador\n      },\n      fueRecuperada(areas, area, asig) {\n        return areas?.[area]?.[asig]?.fueRecuperada ?? false\n      },\n      obtenerOriginal(areas, area, asig) {\n        const val = areas?.[area]?.[asig]?.original\n        return typeof val === 'number' ? val.toFixed(1) : '0.0'\n      },\n      obtenerRecuperacion(areas, area, asig) {\n        const val = areas?.[area]?.[asig]?.recuperacion\n        return typeof val === 'number' ? val.toFixed(1) : '0.0'\n      },\n      obtenerColor(nota, areas, area, asig) {\n        const val = areas?.[area]?.[asig]?.idTipoEspecialidad\n        if (val === 1) {\n          if (nota < this.datosSeccion.minBas) return 'desempeno-bajo'\n          if (nota < this.datosSeccion.minAlt) return 'desempeno-basico'\n          if (nota < this.datosSeccion.minSup) return 'desempeno-alto'\n          if (nota <= this.datosSeccion.maxSup) return 'desempeno-superior'\n          return 'desempeno-extra'\n        } else {\n          if (nota < this.datosSeccion.minBasT) return 'desempeno-bajo'\n          if (nota < this.datosSeccion.minAltT) return 'desempeno-basico'\n          if (nota < this.datosSeccion.minSupT) return 'desempeno-alto'\n          if (nota <= this.datosSeccion.maxSupT) return 'desempeno-superior'\n          return 'desempeno-extra'\n        }\n      },\n      claseDesempeno(nota) {\n        console.log(nota)\n        if (typeof nota !== 'number') return 'desempeno-extra'\n        if (nota < 3) return 'desempeno-bajo'\n        if (nota < 4) return 'desempeno-basico'\n        if (nota < 4.6) return 'desempeno-alto'\n        if (nota <= 5) return 'desempeno-superior'\n        return 'desempeno-extra'\n      },\n      obtenerColorGeneral(nota) {\n        if (nota < this.datosSeccion.minBas) return 'desempeno-bajo'\n        if (nota < this.datosSeccion.minAlt) return 'desempeno-basico'\n        if (nota < this.datosSeccion.minSup) return 'desempeno-alto'\n        if (nota <= this.datosSeccion.maxSup) return 'desempeno-superior'\n        return 'desempeno-extra'\n      },\n      async consultarEstudiantes() {\n        this.btnCargando = true\n        if (this.idPeriodo == 1) this.periodosVisibles = [1]\n        if (this.idPeriodo == 2) this.periodosVisibles = [1,2]\n        if (this.idPeriodo == 3) this.periodosVisibles = [1,2,3]\n        if (this.idPeriodo == 4) this.periodosVisibles = [1,2,3,4]\n        this.nombreSede = document.getElementById('sedes')[document.getElementById('sedes').selectedIndex].text\n        if (this.idCurso != null) { \n          this.nombreCurso = document.getElementById('cursos')[document.getElementById('cursos').selectedIndex].text\n          this.$store.state.datosCursos.forEach(element => {\n            if (element.id == this.idCurso) {\n              this.idNivel = element.id_nivel\n            }\n          })\n          this.listaAreasAsignaturas = []\n          await axios\n          .get(CONFIG.ROOT_PATH + 'consolidados/areasasignaturas/curso', {params: {idCurso: this.idCurso}})\n          .then(response => {\n            if (response.data.error){\n              this.mensajeEmergente('danger',CONFIG.TITULO_MSG,response.data.mensaje + ' - Lista areas-asignaturas curso')\n              this.btnCargando = false\n            } else{\n              if (response.data.datos != 0) {\n                //this.listaAreasAsignaturas = response.data.datos\n                response.data.datos.forEach(element => {\n                  if ( this.$store.state.idInstitucion == 'eb58bf60-fc83-11ec-a1d1-1dc2835404e5' ) { //Inem\n                    if (element.orden != 99 && element.orden != 90) {\n                      this.listaAreasAsignaturas.push(element)\n                    }\n                  } else if ( this.$store.state.idInstitucion == 'f5529ba0-fcb3-11ec-8267-536b07c743c4' ) { // Gustavo Rojas\n                    if (element.orden != 99 && element.orden != 15 && element.orden != 16 && element.orden != 98) {\n                      this.listaAreasAsignaturas.push(element)\n                    }\n                  } else if ( this.$store.state.idInstitucion == '097b7b10-fcaa-11ec-8267-536b07c743c4' ) { // Rural\n                    if (element.orden != 99 && element.orden != 98) {\n                      this.listaAreasAsignaturas.push(element)\n                    }\n                  } else if ( this.$store.state.idInstitucion == '54fd7440-fc81-11ec-a1d1-1dc2835404e5' || this.$store.state.idInstitucion == '7c63ed50-fcb0-11ec-8267-536b07c743c4' ) { // Antonio Jose Sandoval, Normal Santiago, \n                    this.listaAreasAsignaturas.push(element)\n                  } else {\n                    if (element.orden != 99) {\n                      this.listaAreasAsignaturas.push(element)\n                    }\n                  }\n                })\n              }\n            }\n          })\n          .catch(err => {\n            this.mensajeEmergente('danger',CONFIG.TITULO_MSG,'Algo salio mal y no se pudo realizar: Lista areas-asignaturas curso. Intente ms tarde.' + err)\n            this.btnCargando = false\n          })\n          this.datosRaw = []\n          await axios\n          .get(CONFIG.ROOT_PATH + 'consolidados/asignaturas/curso/acumulado', {params: {idCurso: this.idCurso, periodo: this.idPeriodo, vigencia: this.$store.state.aLectivo}})\n          .then(response => {\n            if (response.data.error){\n              this.mensajeEmergente('danger',CONFIG.TITULO_MSG,response.data.mensaje + ' - Consolidados asignaturas curso periodo')\n              this.btnCargando = false\n            } else{\n              if (response.data.datos != 0) {\n                this.datosRaw = response.data.datos\n              }\n            }\n          })\n          .catch(err => {\n            this.mensajeEmergente('danger',CONFIG.TITULO_MSG,'Algo salio mal y no se pudo realizar: Consolidados asignaturas curso periodo. Intente ms tarde.' + err)\n            this.btnCargando = false\n          })\n        }\n        //console.log(JSON.stringify(this.listaAreasAsignaturas))\n        this.btnCargando = false\n      },\n      imprimir() {\n        let fecha = 'Fecha: ' + new Date().toLocaleString()\n        let tituloInforme = 'CONSOLIDADO EVALUACIONES FINALES POR ASIGNATURAS'\n        const contenido = document.querySelector('table').outerHTML\n        const ventana = window.open(\"Consolidados\", \"_blank\")\n        ventana.document.write(`<html><head><title>Imprimir</title></head>\n        <style scoped>\n          table {\n            border-collapse: collapse;\n            width: 100%;\n            text-align: center;\n            font-size: 10px;\n          }\n          th {\n            background: #eee;\n          }\n          .nota-recuperada {\n            border: 2px solid #ffa500;\n            box-shadow: 0 0 5px #ffa500;\n          }\n          .desempeno-bajo { background-color: #f8d7da; color: #721c24; }\n          .desempeno-basico { background-color: #d1ecf1; color: #0c5460; }\n          .desempeno-alto { background-color: #fff3cd; color: #856404; }\n          .desempeno-superior { background-color: #d4edda; color: #155724; }\n          .desempeno-extra { background-color: #f4ecf5; color: #2f2e2e; }\n        </style>\n          <body class=\"container\">\n            <p style=\"text-align: center; font-size: 12px;\">SECRETARA DE EDUCACIN TERRITORIAL DE TUNJA<br><b>${this.$store.state.nombreInstitucion}</b><br>TUNJA - BOYAC<br>${tituloInforme}<br>Sede: ${this.nombreSede} | Curso: ${this.nombreCurso} | Ao Lectivo ${this.$store.state.aLectivo} | Periodo: FINAL</p>\n            ${contenido}\n            <div style=\"text-align: right; font-size: 12px;\"><i>${fecha}</i></div>\n          </body>\n        </html>`)\n        ventana.document.close()\n        ventana.print()\n      },\n      exportarAExcel() {\n        const tabla = document.querySelector('table')\n        const wb = XLSX.utils.table_to_book(tabla)\n        XLSX.writeFile(wb, 'ConsoldidaFinal.xlsx')\n      },\n      redondear(num) {\n        var m = Number((Math.abs(num) * 10).toPrecision(15))\n        return Math.round(m) / 10 * Math.sign(num);\n      },\n      async ocuparComboCursosSede() {\n        this.comboCursosSede = []\n        this.$store.state.datosCursos.forEach(element => {\n          if (element.id_sede == this.idSede) {\n            this.comboCursosSede.push({ 'value': element.id, 'text': element.nomenclatura.toUpperCase() })\n          }\n        })\n      },\n      async ocuparComboSedes() {\n        this.comboSedes = []\n        this.$store.state.datosSedes.forEach(element => {\n          this.comboSedes.push({ 'value': element.id, 'text': element.sede.toUpperCase() })\n        })\n      },\n      async ocuparComboPeriodos() {\n        this.comboPeriodos = []\n        this.$store.state.periodos.forEach(element => {\n          this.comboPeriodos.push({ 'value': element.id, 'text': element.periodo.toUpperCase() })\n        })\n      },\n      mensajeEmergente(variante, titulo, contenido) {\n        this.$bvToast.toast(contenido, { title: titulo, variant: variante, toaster: \"b-toaster-top-center\", solid: true, autoHideDelay: 4000, appendToast: false })\n      }\n    },\n    computed: {\n      totales() {\n        return this.totalesGlobales()\n      },\n      estudiantesNotas() {\n        const mapa = {}\n        this.datosRaw.forEach(row => {\n          const { estudiante, area, asignatura, periodo, definitiva, recuperacion, orden, definitivacompor, definitivapree, idTipoEspecialidad, ausJ, ausS, porcentaje, id_conceptual } = row\n          if (!mapa[estudiante]) {\n            mapa[estudiante] = { id_conceptual, ausJ: 0, ausS: 0, areas: {} }\n          }\n          if (!mapa[estudiante].areas[area]) {\n            mapa[estudiante].areas[area] = { asignaturas: {} }\n          }\n          if (!mapa[estudiante].areas[area].asignaturas[asignatura]) {\n            mapa[estudiante].areas[area].asignaturas[asignatura] = {\n              periodos: {},\n              orden,\n              idTipoEspecialidad,\n              porcentaje,\n              pesos: { 1: this.datosSeccion.pesoP1, 2: this.datosSeccion.pesoP2, 3: this.datosSeccion.pesoP3, 4: this.datosSeccion.pesoP4 }\n            }\n          }\n          let notaFinal = 0\n          if (orden === 99) {\n            if (this.datosSeccion.tipoValComp == 1) {\n              notaFinal = definitiva\n            } else {\n              notaFinal = definitivacompor != null ? definitivacompor : ''\n            }\n          } else {\n            if (this.idNivel == 1) {\n              notaFinal = definitivapree != null && definitivapree != 0 && definitivapree != '' ? definitivapree : ''\n            } else {\n              notaFinal = recuperacion > definitiva ? recuperacion : definitiva\n            }\n          }\n          mapa[estudiante].areas[area].asignaturas[asignatura].periodos[periodo] = notaFinal\n          mapa[estudiante].ausJ += ausJ || 0\n          mapa[estudiante].ausS += ausS || 0\n        })\n        return mapa\n      },\n      totalColumnasPromedioArea() {\n        const areasUnicas = new Set(this.listaAreasAsignaturas.map(a => a.area))\n        return areasUnicas.size\n      },\n      puestosPorEstudiante() {\n        const lista = Object.entries(this.estudiantesNotas).map(([nombre, areas]) => {\n          const promedio = parseFloat(this.calcularPromedioGeneral(areas))\n          return { nombre, promedio: isNaN(promedio) ? 0 : promedio }\n        })\n        // Ordenar de mayor a menor\n        lista.sort((a, b) => b.promedio - a.promedio)\n        const puestos = {}\n        let puestoActual = 1\n        let contador = 1\n        let ultimoPromedio = null\n        lista.forEach(est => {\n          if (est.promedio !== ultimoPromedio) {\n            puestoActual = contador\n            ultimoPromedio = est.promedio\n            contador++\n          }\n          puestos[est.nombre] = puestoActual\n          //contador++\n        })\n        return puestos\n      },\n      encabezadoPorArea() {\n        const mapa = {}\n        this.listaAreasAsignaturas.forEach(({ area, asignatura }) => {\n          if (!mapa[area]) mapa[area] = []\n          mapa[area].push(asignatura)\n        })\n        return mapa\n      },\n    },\n    beforeMount() {\n      this.ocuparComboSedes()\n      this.ocuparComboPeriodos()\n      this.datosSeccion = this.$store.state.datosSecciones[this.$store.state.idSeccion - 1]\n      //console.log(JSON.stringify(this.datosSeccion))\n    }\n  }\n</script>\n<style scoped>\n  table {\n    border-collapse: collapse;\n    width: 100%;\n    text-align: center;\n    font-size: 10px;\n  }\n  th {\n    background: #eee;\n  }\n  .nota-recuperada {\n    border: 2px solid #ffa500;\n    box-shadow: 0 0 5px #ffa500;\n  }\n  .desempeno-bajo { background-color: #f8d7da; color: #721c24; }\n  .desempeno-basico { background-color: #d1ecf1; color: #0c5460; }\n  .desempeno-alto { background-color: #fff3cd; color: #856404; }\n  .desempeno-superior { background-color: #d4edda; color: #155724; }\n  .desempeno-extra { background-color: #f4ecf5; color: #2f2e2e; }\n  .promedio-area {\n    background-color: #f2f2f2;\n    font-weight: bold;\n    text-align: center;\n  }\n  .bloque-area th,\n  .bloque-area td {\n    border-right: 3px solid #999; /* lnea divisoria entre reas */\n  }\n\n</style>\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ConsolidadoFinal.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ConsolidadoFinal.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ConsolidadoFinal.vue?vue&type=template&id=ae2d58f6&scoped=true&\"\nimport script from \"./ConsolidadoFinal.vue?vue&type=script&lang=js&\"\nexport * from \"./ConsolidadoFinal.vue?vue&type=script&lang=js&\"\nimport style0 from \"./ConsolidadoFinal.vue?vue&type=style&index=0&id=ae2d58f6&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"ae2d58f6\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('b-row',{staticClass:\"mt-2\"},[_c('b-col',{attrs:{\"lg\":\"12\"}},[_c('b-card',{scopedSlots:_vm._u([{key:\"header\",fn:function(){return [_c('h5',{staticClass:\"mb-0\"},[_c('b-icon',{attrs:{\"icon\":\"card-checklist\",\"aria-hidden\":\"true\"}}),_vm._v(\" CONSOLIDADO EVALUACIONES FINALES\")],1)]},proxy:true}])},[_c('b-card-text',[_c('b-row',[_c('b-col',{attrs:{\"lg\":\"6\"}},[_c('b-form-group',{staticClass:\"etiqueta\",attrs:{\"label\":\"Seleccione la Sede:\",\"label-for\":\"sedes\"}},[_c('b-form-select',{ref:\"sedes\",attrs:{\"id\":\"sedes\",\"options\":_vm.comboSedes},on:{\"change\":function($event){_vm.idCurso=null,_vm.ocuparComboCursosSede()}},model:{value:(_vm.idSede),callback:function ($$v) {_vm.idSede=$$v},expression:\"idSede\"}})],1)],1),_c('b-col',{attrs:{\"lg\":\"4\"}},[_c('b-form-group',{staticClass:\"etiqueta\",attrs:{\"label\":\"Seleccione el Curso:\",\"label-for\":\"cursos\"}},[_c('b-form-select',{ref:\"cursos\",attrs:{\"id\":\"cursos\",\"options\":_vm.comboCursosSede,\"disabled\":_vm.idSede!=null ? false : true},on:{\"change\":function($event){return _vm.consultarEstudiantes()}},model:{value:(_vm.idCurso),callback:function ($$v) {_vm.idCurso=$$v},expression:\"idCurso\"}})],1)],1)],1)],1)],1)],1)],1),_c('b-row',[_c('b-col',{attrs:{\"lg\":\"12\"}},[(_vm.btnCargando)?_c('div',[_c('div',{staticClass:\"text-center m-5 text-primary\"},[_c('b-spinner',{staticStyle:{\"width\":\"3rem\",\"height\":\"3rem\"},attrs:{\"label\":\"Spinner\"}}),_c('br'),_c('strong',[_vm._v(\"Cargando informe...\")])],1)]):_vm._e()])],1),(!_vm.btnCargando && _vm.idCurso!=null)?_c('b-row',[_c('b-col',{attrs:{\"lg\":\"12\"}},[_c('table',{staticClass:\"table-responsive\",attrs:{\"border\":\"1\",\"cellspacing\":\"0\",\"cellpadding\":\"1\"}},[_c('thead',[_c('tr',[_c('th',{attrs:{\"rowspan\":\"3\"}},[_vm._v(\"#\")]),_c('th',{attrs:{\"rowspan\":\"3\"}},[_vm._v(\"Estudiante\")]),_vm._l((_vm.encabezadoPorArea),function(asigs,area){return [_c('th',{key:area,attrs:{\"colspan\":_vm.colspanArea(area)}},[_vm._v(\" \"+_vm._s(area)+\" \")])]}),_c('th',{attrs:{\"rowspan\":\"3\"}},[_vm._v(\"PRO GEN\")]),_c('th',{attrs:{\"rowspan\":\"3\"}},[_vm._v(\"Tot\"),_c('br'),_vm._v(\"Asig\"),_c('br'),_vm._v(\"Baj\")]),_c('th',{attrs:{\"rowspan\":\"3\"}},[_vm._v(\"Tot\"),_c('br'),_vm._v(\"Asig\"),_c('br'),_vm._v(\"Bas\")]),_c('th',{attrs:{\"rowspan\":\"3\"}},[_vm._v(\"Tot\"),_c('br'),_vm._v(\"Asig\"),_c('br'),_vm._v(\"Alt\")]),_c('th',{attrs:{\"rowspan\":\"3\"}},[_vm._v(\"Tot\"),_c('br'),_vm._v(\"Asig\"),_c('br'),_vm._v(\"Sup\")]),_c('th',{attrs:{\"rowspan\":\"3\"}},[_vm._v(\"Tot\"),_c('br'),_vm._v(\"AuJ\")]),_c('th',{attrs:{\"rowspan\":\"3\"}},[_vm._v(\"Tot\"),_c('br'),_vm._v(\"AuS\")]),_c('th',{attrs:{\"rowspan\":\"3\"}},[_vm._v(\"Puesto\")]),_c('th',{attrs:{\"rowspan\":\"3\"}},[_vm._v(\"#\")])],2),_c('tr',[_vm._l((_vm.encabezadoPorArea),function(asigs,area){return [_vm._l((asigs),function(asig,k){return [_c('th',{key:'area-' + asig + k,attrs:{\"colspan\":_vm.periodosVisibles.length + 1}},[_vm._v(\" \"+_vm._s(asig)+\" \")])]}),_c('th',{key:'prom-area-' + area,staticClass:\"promedio-area\"},[_vm._v(\"PRO AR\")])]})],2),_c('tr',[_vm._l((_vm.encabezadoPorArea),function(asigs,area){return [_vm._l((asigs),function(asig){return [_vm._l((_vm.periodosVisibles),function(p){return _c('th',{key:'h' + area + asig + p},[_vm._v(\" P\"+_vm._s(p)+\" \")])}),_c('th',{key:'prom' + asig + area},[_vm._v(\"PR\")])]}),_c('th',{key:'prom' + area})]})],2)]),_c('tbody',[_vm._l((_vm.estudiantesNotas),function(est,nombre,i){return _c('tr',{key:nombre},[_c('td',{staticClass:\"text-left\"},[_vm._v(_vm._s(i + 1))]),_c('td',{staticStyle:{\"text-align\":\"left\"}},[_vm._v(_vm._s(nombre))]),_vm._l((_vm.encabezadoPorArea),function(asigs,area){return [_vm._l((asigs),function(asig){return [_vm._l((_vm.periodosVisibles),function(p){return _c('td',{key:nombre + area + asig + p},[_vm._v(\" \"+_vm._s(est.id_conceptual=='N' ? _vm.obtenerNota(est, area, asig, p) : '-')+\" \")])}),_c('td',{key:'prom' + nombre + area + asig,staticClass:\"bloque-area\",staticStyle:{\"font-weight\":\"bold\",\"text-align\":\"center\"}},[_vm._v(\" \"+_vm._s(est.id_conceptual=='N' ? _vm.obtenerPromedioAsignatura(est, area, asig) : '-')+\" \")])]}),_c('td',{key:'promArea' + nombre + area,staticClass:\"promedio-area bloque-area\"},[_vm._v(\" \"+_vm._s(est.id_conceptual=='N' ? _vm.obtenerPromedioArea(est, area) : '-')+\" \")])]}),_c('td',[_vm._v(_vm._s(est.id_conceptual=='N' ? _vm.calcularPromedioGeneral(est) : '-'))]),_c('td',[_vm._v(_vm._s(est.id_conceptual=='N' ? _vm.contarDesempenoEstudiante(est.areas, 'bajo') : '-'))]),_c('td',[_vm._v(_vm._s(est.id_conceptual=='N' ? _vm.contarDesempenoEstudiante(est.areas, 'basico') : '-'))]),_c('td',[_vm._v(_vm._s(est.id_conceptual=='N' ? _vm.contarDesempenoEstudiante(est.areas, 'alto') : '-'))]),_c('td',[_vm._v(_vm._s(est.id_conceptual=='N' ? _vm.contarDesempenoEstudiante(est.areas, 'superior') : '-'))]),_c('td',[_vm._v(_vm._s(est.id_conceptual=='N' ? est.ausJ : '-'))]),_c('td',[_vm._v(_vm._s(est.id_conceptual=='N' ? est.ausS : '-'))]),_c('td',[_vm._v(_vm._s(est.id_conceptual=='N' ? _vm.iconoPuesto(_vm.puestosPorEstudiante[nombre]) : '-')+\" \"+_vm._s(est.id_conceptual=='N' ? _vm.puestosPorEstudiante[nombre] : '-'))]),_c('td',{staticClass:\"text-left\"},[_vm._v(_vm._s(i + 1))])],2)}),_c('tr',{staticStyle:{\"background-color\":\"#f0f0f0\",\"font-weight\":\"bold\"}},[_c('td',{attrs:{\"colspan\":\"2\"}},[_vm._v(\"Total Bajos\")]),_vm._l((_vm.encabezadoPorArea),function(asigs,area){return [_vm._l((asigs),function(asig){return [_vm._l((_vm.periodosVisibles),function(p){return _c('td',{key:'bp' + area + asig + p},[_vm._v(\" \"+_vm._s(_vm.totalBajosPorPeriodo(area, asig, p))+\" \")])}),_c('td',{key:'bj' + area + asig},[_vm._v(\" \"+_vm._s(_vm.totalBajosPromedioAsignatura(area, asig))+\" \")])]}),_c('td',{key:'bja' + area,staticClass:\"promedio-area\"},[_vm._v(\" \"+_vm._s(_vm.totalBajosPromedioArea(area))+\" \")])]}),_c('td'),_vm._v(\" \"),_c('td',[_vm._v(_vm._s(_vm.totales.bajo))]),_c('td',[_vm._v(_vm._s(_vm.totales.basico))]),_c('td',[_vm._v(_vm._s(_vm.totales.alto))]),_c('td',[_vm._v(_vm._s(_vm.totales.superior))]),_c('td',[_vm._v(_vm._s(_vm.totales.ausJ))]),_c('td',[_vm._v(_vm._s(_vm.totales.ausS))]),_c('td'),_vm._v(\" \"),_c('td')],2)],2)]),_c('div',{staticStyle:{\"margin-bottom\":\"1rem\"}},[_c('b-button',{staticClass:\"small mx-1 mt-3\",attrs:{\"variant\":\"primary\"},on:{\"click\":_vm.imprimir}},[_vm._v(\"Imprimir Consolidado\")]),_c('b-button',{staticClass:\"small mx-1 mt-3\",attrs:{\"variant\":\"outline-primary\"},on:{\"click\":_vm.exportarAExcel}},[_vm._v(\"Exportar a Excel\")])],1)])],1):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div>\n    <b-row class=\"mt-2\">\n      <b-col lg=\"12\">\n        <b-card>\n          <template #header>\n            <h5 class=\"mb-0\"><b-icon icon=\"card-checklist\" aria-hidden=\"true\"></b-icon> CONSOLIDADO EVALUACIONES FINALES</h5>\n          </template>\n          <b-card-text>\n            <b-row>\n              <!--\n              <b-col lg=\"2\">\n                <b-form-group label=\"Periodo:\" label-for=\"periodo\" class=\"etiqueta\">\n                  <b-form-select id=\"periodo\" ref=\"periodo\" v-model=\"idPeriodo\" :options=\"comboPeriodos\" @change=\"idSede=null,idCurso=null\"></b-form-select>\n                </b-form-group>\n              </b-col>\n              -->\n              <b-col lg=\"6\">\n                <b-form-group label=\"Seleccione la Sede:\" label-for=\"sedes\" class=\"etiqueta\">\n                  <b-form-select  id=\"sedes\" ref=\"sedes\" v-model=\"idSede\" :options=\"comboSedes\" @change=\"idCurso=null,ocuparComboCursosSede()\"></b-form-select>\n                </b-form-group>\n              </b-col>\n              <b-col lg=\"4\">\n                <b-form-group label=\"Seleccione el Curso:\" label-for=\"cursos\" class=\"etiqueta\">\n                  <b-form-select id=\"cursos\" ref=\"cursos\" v-model=\"idCurso\" :options=\"comboCursosSede\" @change=\"consultarEstudiantes()\" :disabled=\"idSede!=null ? false : true\"></b-form-select>\n                </b-form-group>\n              </b-col>\n            </b-row>\n          </b-card-text>\n        </b-card>\n      </b-col>\n    </b-row>\n    <b-row>\n      <b-col lg=\"12\">\n        <div v-if=\"btnCargando\">\n          <div class=\"text-center m-5 text-primary\">\n            <b-spinner style=\"width: 3rem; height: 3rem;\" label=\"Spinner\"></b-spinner>\n            <br><strong>Cargando informe...</strong>\n          </div>\n        </div>\n      </b-col>\n    </b-row>\n    <b-row v-if=\"!btnCargando && idCurso!=null\">\n      <b-col lg=\"12\">\n        <table border=\"1\" cellspacing=\"0\" cellpadding=\"1\" class=\"table-responsive\">\n          <thead>\n            <tr>\n              <th rowspan=\"3\">#</th>\n              <th rowspan=\"3\">Estudiante</th>\n              <template v-for=\"(asigs, area) in encabezadoPorArea\">\n                <th :colspan=\"colspanArea(area)\" :key=\"area\">\n                  {{ area }}\n                </th>\n              </template>\n              <th rowspan=\"3\">PRO GEN</th>\n              <th rowspan=\"3\">Tot<br>Asig<br>Baj</th>\n              <th rowspan=\"3\">Tot<br>Asig<br>Bas</th>\n              <th rowspan=\"3\">Tot<br>Asig<br>Alt</th>\n              <th rowspan=\"3\">Tot<br>Asig<br>Sup</th>\n              <th rowspan=\"3\">Tot<br>AuJ</th>\n              <th rowspan=\"3\">Tot<br>AuS</th>\n              <th rowspan=\"3\">Puesto</th>\n              <th rowspan=\"3\">#</th>\n            </tr>\n            <tr>\n              <template v-for=\"(asigs, area) in encabezadoPorArea\">\n                <template v-for=\"(asig, k) in asigs\">\n                  <th :colspan=\"periodosVisibles.length + 1\" :key=\"'area-' + asig + k\">\n                    {{ asig }}\n                  </th>\n                </template>\n                <th class=\"promedio-area\" :key=\"'prom-area-' + area\">PRO AR</th>\n              </template>\n            </tr>\n            <tr>\n              <template v-for=\"(asigs, area) in encabezadoPorArea\">\n                <template v-for=\"asig in asigs\">\n                  <th v-for=\"p in periodosVisibles\" :key=\"'h' + area + asig + p\">\n                    P{{ p }}\n                  </th>\n                  <th :key=\"'prom' + asig + area\">PR</th>\n                </template>\n                <th :key=\"'prom' + area\"></th>\n              </template>\n              <!-- columnas finales vacas -->\n            </tr>\n          </thead>\n          <tbody>\n            <tr v-for=\"(est, nombre, i) in estudiantesNotas\" :key=\"nombre\">\n              <td class=\"text-left\">{{ i + 1 }}</td>\n              <td style=\"text-align: left\">{{ nombre }}</td>\n              <template v-for=\"(asigs, area) in encabezadoPorArea\">\n                <template v-for=\"asig in asigs\">\n                  <td v-for=\"p in periodosVisibles\"  :key=\"nombre + area + asig + p\">\n                    {{ est.id_conceptual=='N' ? obtenerNota(est, area, asig, p) : '-' }}\n                  </td>\n                  <td class=\"bloque-area\" :key=\"'prom' + nombre + area + asig\" style=\"font-weight: bold; text-align: center;\">\n                    {{ est.id_conceptual=='N' ? obtenerPromedioAsignatura(est, area, asig) : '-' }}\n                  </td>\n                </template>\n                <td class=\"promedio-area bloque-area\" :key=\"'promArea' + nombre + area\">\n                  {{ est.id_conceptual=='N' ? obtenerPromedioArea(est, area) : '-' }}\n                </td>\n              </template>\n\n              <td>{{ est.id_conceptual=='N' ? calcularPromedioGeneral(est) : '-' }}</td>\n              <td>{{ est.id_conceptual=='N' ? contarDesempenoEstudiante(est.areas, 'bajo') : '-' }}</td>\n              <td>{{ est.id_conceptual=='N' ? contarDesempenoEstudiante(est.areas, 'basico') : '-' }}</td>\n              <td>{{ est.id_conceptual=='N' ? contarDesempenoEstudiante(est.areas, 'alto') : '-' }}</td>\n              <td>{{ est.id_conceptual=='N' ? contarDesempenoEstudiante(est.areas, 'superior') : '-' }}</td>\n              <td>{{ est.id_conceptual=='N' ? est.ausJ : '-' }}</td>\n              <td>{{ est.id_conceptual=='N' ? est.ausS : '-' }}</td>\n              <td>{{ est.id_conceptual=='N' ? iconoPuesto(puestosPorEstudiante[nombre]) : '-' }} {{ est.id_conceptual=='N' ? puestosPorEstudiante[nombre] : '-' }}</td>\n              <td class=\"text-left\">{{ i + 1 }}</td>\n            </tr>\n            <tr style=\"background-color: #f0f0f0; font-weight: bold;\">\n              <td colspan=\"2\">Total Bajos</td>\n              <template v-for=\"(asigs, area) in encabezadoPorArea\">\n                <template v-for=\"asig in asigs\">\n                  <!-- Bajos por periodo -->\n                  <td v-for=\"p in periodosVisibles\" :key=\"'bp' + area + asig + p\">\n                    {{ totalBajosPorPeriodo(area, asig, p) }}\n                  </td>\n                  <!-- Bajos por promedio de asignatura -->\n                  <td :key=\"'bj' + area + asig\">\n                    {{ totalBajosPromedioAsignatura(area, asig) }}\n                  </td>\n                </template>\n                <!-- Bajos por promedio de rea -->\n                <td  :key=\"'bja' + area\" class=\"promedio-area\">\n                  {{ totalBajosPromedioArea(area) }}\n                </td>\n              </template>\n              <td></td> <!-- Prom. General -->\n              <td>{{ totales.bajo }}</td>\n              <td>{{ totales.basico }}</td>\n              <td>{{ totales.alto }}</td>\n              <td>{{ totales.superior }}</td>\n              <td>{{ totales.ausJ }}</td>\n              <td>{{ totales.ausS }}</td>\n              <td></td> <!-- Puesto -->\n              <td></td>\n            </tr>\n          </tbody>\n        </table>\n        <div style=\"margin-bottom: 1rem\">\n          <b-button class=\"small mx-1 mt-3\" variant=\"primary\" @click=\"imprimir\">Imprimir Consolidado</b-button>\n          <b-button class=\"small mx-1 mt-3\" variant=\"outline-primary\" @click=\"exportarAExcel\">Exportar a Excel</b-button>\n        </div>\n      </b-col>\n    </b-row>\n  </div>\n</template>\n\n<script>\n  import axios from \"axios\"\n  import * as CONFIG from '@/assets/config.js'\n  import * as XLSX from 'xlsx'\n\n  export default {\n    name: 'consolidadopromedio',\n    components: {\n    },\n    data () {\n      return {\n        idSede: null,\n        comboSedes: [],\n        idPeriodo: 5,\n        comboPeriodos: null,\n        idCurso: null,\n        comboCursosSede: [],\n        nombreSede: null,\n        nombreCurso: null,\n        idNivel: null,\n        btnCargando: false,\n        datosRaw: [],\n        datosSeccion: {},\n        listaAreasAsignaturas: [],\n        periodosVisibles: []\n      }\n    },\n    methods: {\n      colspanArea(area) {\n        const asignaturas = this.encabezadoPorArea[area] || []\n        const columnasPorAsignatura = this.periodosVisibles.length + 1\n        const extraColumnaPromArea = 1\n        return (asignaturas.length * columnasPorAsignatura) + extraColumnaPromArea\n      },\n\n      totalBajosPorPeriodo(area, asignatura, periodo) {\n        let total = 0\n        const meta = this.listaAreasAsignaturas.find(\n          a => a.area === area && a.asignatura === asignatura\n        )\n        const idTipoEspecialidad = meta?.idTipoEspecialidad\n        Object.values(this.estudiantesNotas).forEach(est => {\n          const nota = est?.areas?.[area]?.asignaturas?.[asignatura]?.periodos?.[periodo]\n          if (idTipoEspecialidad === 1) {\n            if (nota > 0 && nota < this.datosSeccion.minBas) total++\n          } else {\n            if (nota > 0 && nota < this.datosSeccion.minBasT) total++\n          }\n        })\n        return total\n      },\n      totalBajosPromedioAsignatura(area, asignatura) {\n        let total = 0\n        const meta = this.listaAreasAsignaturas.find(\n          a => a.area === area && a.asignatura === asignatura\n        )\n        const idTipoEspecialidad = meta?.idTipoEspecialidad\n        Object.values(this.estudiantesNotas).forEach(est => {\n          const asig = est?.areas?.[area]?.asignaturas?.[asignatura]\n          if (!asig) return\n          const prom = parseFloat(this.calcularPromedioAsignatura(asig))\n          if (idTipoEspecialidad === 1) {\n            if (prom < this.datosSeccion.minBas) total++\n          } else {\n            if (prom < this.datosSeccion.minBasT) total++\n          }\n        })\n        return total\n      },\n      totalBajosPromedioArea(area) {\n        let total = 0\n        Object.values(this.estudiantesNotas).forEach(est => {\n          const prom = parseFloat(this.obtenerPromedioArea(est, area))\n          if (!isNaN(prom) && prom < this.datosSeccion.minBas) total++\n        })\n        return total\n      },\n      totalesGlobales() {\n        let bajo = 0, basico = 0, alto = 0, superior = 0, ausJ = 0, ausS = 0\n        Object.values(this.estudiantesNotas).forEach(est => {\n          bajo += this.contarDesempenoEstudiante(est.areas, 'bajo')\n          basico += this.contarDesempenoEstudiante(est.areas, 'basico')\n          alto += this.contarDesempenoEstudiante(est.areas, 'alto')\n          superior += this.contarDesempenoEstudiante(est.areas, 'superior')\n          ausJ += est.ausJ || 0\n          ausS += est.ausS || 0\n        })\n\n        return { bajo, basico, alto, superior, ausJ, ausS }\n      },\n      esAreaValida(area) {\n        //const asigns = this.listaAreasAsignaturas.filter(a => a.area === area)\n        //return asigns.some(a => a.orden !== 99)\n        const asigns = this.listaAreasAsignaturas.filter(a => a.area === area)\n        if (asigns.some(a => a.orden !== 99 && a.orden !== 98)) return true\n        else if (asigns.some(a => a.orden === 99) && this.datosSeccion.promCompor == 1) return true\n        else return false\n      },\n      obtenerPromedioArea(est, area) {\n        const areaData = est.areas && est.areas[area]\n        return areaData ? this.calcularPromedioArea(areaData) : ''\n      },\n      obtenerNota(est, area, asignatura, periodo) {\n        let nota = est?.areas?.[area]?.asignaturas?.[asignatura]?.periodos?.[periodo]\n        if (nota === 0) nota = ''\n        return typeof nota === 'number' ? nota.toFixed(1) : nota\n      },\n      obtenerPromedioAsignatura(est, area, asignatura) {\n        const asig = est?.areas?.[area]?.asignaturas?.[asignatura]\n        return asig ? this.calcularPromedioAsignatura(asig) : ''\n      },\n      calcularPromedioAsignatura(asig) {\n        const pesos = asig.pesos\n        const periodos = asig.periodos\n        const orden = asig.orden\n        if (orden === 99) return '-'\n        let total = 0\n        for (let p = 1; p <= 4; p++) {\n          const nota = periodos[p] ?? 0\n          total += nota * pesos[p] / 100\n        }\n        return total.toFixed(1)\n        //return this.redondear(promedio).toFixed(1)\n      },\n      calcularPromedioArea(areaData) {\n        const asigns = Object.values(areaData.asignaturas)\n        if (!asigns.length) return '0.00'\n        let total = 0\n        asigns.forEach(asig => {\n          if (asig.orden === 99 && this.datosSeccion.promCompor == 0) return '-'\n          total += parseFloat((this.calcularPromedioAsignatura(asig) * asig.porcentaje) / 100)\n        })\n        return total > 0 ? this.redondear(total).toFixed(1) : ''\n      },\n      calcularPromedioGeneral(est) {\n        const areas = Object.keys(est.areas || {})\n        let total = 0\n        let cantidad = 0\n        areas.forEach(area => {\n          if (!this.esAreaValida(area)) return\n          const promedio = parseFloat(this.calcularPromedioArea(est.areas[area]))\n          if (!isNaN(promedio)) {\n            total += promedio\n            cantidad++\n          }\n        })\n        return cantidad > 0 ? (total / cantidad).toFixed(3) : ''\n      },\n      contarAusencias(tipo) {\n        let total = 0\n        Object.values(this.estudiantesNotas).forEach(est => {\n          if (tipo === 'ausJ') total += est.ausJ || 0\n          if (tipo === 'ausS') total += est.ausS || 0\n        })\n        return total\n      },\n      contarNotasPorAsignatura(area, asignatura, tipo) {\n        let contador = 0\n        Object.values(this.estudiantesNotas).forEach(est => {\n          const nota = est?.[area]?.[asignatura]?.nota\n          const val = est?.[area]?.[asignatura]?.idTipoEspecialidad\n          if (typeof nota !== 'number') return\n          if (val === 1) {\n            if (tipo === 'bajo' && nota < this.datosSeccion.minBas) contador++\n            else if (tipo === 'basico' && nota >= this.datosSeccion.minBas && nota < this.datosSeccion.minAlt) contador++\n            else if (tipo === 'alto' && nota >= this.datosSeccion.minAlt && nota < this.datosSeccion.minSup) contador++\n            else if (tipo === 'superior' && nota >= this.datosSeccion.minSup && nota <= this.datosSeccion.maxSup) contador++\n          } else {\n            if (tipo === 'bajo' && nota < this.datosSeccion.minBasT) contador++\n            else if (tipo === 'basico' && nota >= this.datosSeccion.minBasT && nota < this.datosSeccion.minAltT) contador++\n            else if (tipo === 'alto' && nota >= this.datosSeccion.minAltT && nota < this.datosSeccion.minSupT) contador++\n            else if (tipo === 'superior' && nota >= this.datosSeccion.minSupT && nota <= this.datosSeccion.maxSupT) contador++\n          }\n        })\n        return contador\n      },\n      contarNotasTotales(tipo) {\n        let total = 0\n        Object.values(this.estudiantesNotas).forEach(est => {\n          this.listaAreasAsignaturas.forEach(({ area, asignatura }) => {\n            const nota = est?.[area]?.[asignatura]?.nota\n            const val = est?.[area]?.[asignatura]?.idTipoEspecialidad\n            if (typeof nota !== 'number') return\n            if (val === 1) {\n              if (tipo === 'bajo' && nota < this.datosSeccion.minBas) total++\n              else if (tipo === 'basico' && nota >= this.datosSeccion.minBas && nota < this.datosSeccion.minAlt) total++\n              else if (tipo === 'alto' && nota >= this.datosSeccion.minAlt && nota < this.datosSeccion.minSup) total++\n              else if (tipo === 'superior' && nota >= this.datosSeccion.minSup && nota <= this.datosSeccion.maxSup) total++\n            } else {\n              if (tipo === 'bajo' && nota < this.datosSeccion.minBasT) total++\n              else if (tipo === 'basico' && nota >= this.datosSeccion.minBasT && nota < this.datosSeccion.minAltT) total++\n              else if (tipo === 'alto' && nota >= this.datosSeccion.minAltT && nota < this.datosSeccion.minSupT) total++\n              else if (tipo === 'superior' && nota >= this.datosSeccion.minSupT && nota <= this.datosSeccion.maxSupT) total++\n            }\n          })\n        })\n        return total\n      },\n      iconoPuesto(puesto) {\n        if (puesto === 1) return ''\n        if (puesto === 2) return ''\n        if (puesto === 3) return ''\n        return ''\n      },\n      contarDesempenoEstudiante(areas, tipo) {\n        let contador = 0\n        Object.values(areas || {}).forEach(area => {\n          Object.values(area.asignaturas || {}).forEach(asig => {\n            const nota = parseFloat(this.calcularPromedioAsignatura(asig))\n            const val =  asig.idTipoEspecialidad\n            if (typeof nota !== 'number') return\n            if (val === 1) {\n              if (tipo === 'bajo' && nota < this.datosSeccion.minBas) contador++\n              else if (tipo === 'basico' && nota >= this.datosSeccion.minBas && nota < this.datosSeccion.minAlt) contador++\n              else if (tipo === 'alto' && nota >= this.datosSeccion.minAlt && nota < this.datosSeccion.minSup) contador++\n              else if (tipo === 'superior' && nota >= this.datosSeccion.minSup && nota <= this.datosSeccion.maxSup) contador++\n            } else {\n              if (tipo === 'bajo' && nota < this.datosSeccion.minBasT) contador++\n              else if (tipo === 'basico' && nota >= this.datosSeccion.minBasT && nota < this.datosSeccion.minAltT) contador++\n              else if (tipo === 'alto' && nota >= this.datosSeccion.minAltT && nota < this.datosSeccion.minSupT) contador++\n              else if (tipo === 'superior' && nota >= this.datosSeccion.minSupT && nota <= this.datosSeccion.maxSupT) contador++\n            }\n          })\n        })\n        return contador\n      },\n      fueRecuperada(areas, area, asig) {\n        return areas?.[area]?.[asig]?.fueRecuperada ?? false\n      },\n      obtenerOriginal(areas, area, asig) {\n        const val = areas?.[area]?.[asig]?.original\n        return typeof val === 'number' ? val.toFixed(1) : '0.0'\n      },\n      obtenerRecuperacion(areas, area, asig) {\n        const val = areas?.[area]?.[asig]?.recuperacion\n        return typeof val === 'number' ? val.toFixed(1) : '0.0'\n      },\n      obtenerColor(nota, areas, area, asig) {\n        const val = areas?.[area]?.[asig]?.idTipoEspecialidad\n        if (val === 1) {\n          if (nota < this.datosSeccion.minBas) return 'desempeno-bajo'\n          if (nota < this.datosSeccion.minAlt) return 'desempeno-basico'\n          if (nota < this.datosSeccion.minSup) return 'desempeno-alto'\n          if (nota <= this.datosSeccion.maxSup) return 'desempeno-superior'\n          return 'desempeno-extra'\n        } else {\n          if (nota < this.datosSeccion.minBasT) return 'desempeno-bajo'\n          if (nota < this.datosSeccion.minAltT) return 'desempeno-basico'\n          if (nota < this.datosSeccion.minSupT) return 'desempeno-alto'\n          if (nota <= this.datosSeccion.maxSupT) return 'desempeno-superior'\n          return 'desempeno-extra'\n        }\n      },\n      claseDesempeno(nota) {\n        console.log(nota)\n        if (typeof nota !== 'number') return 'desempeno-extra'\n        if (nota < 3) return 'desempeno-bajo'\n        if (nota < 4) return 'desempeno-basico'\n        if (nota < 4.6) return 'desempeno-alto'\n        if (nota <= 5) return 'desempeno-superior'\n        return 'desempeno-extra'\n      },\n      obtenerColorGeneral(nota) {\n        if (nota < this.datosSeccion.minBas) return 'desempeno-bajo'\n        if (nota < this.datosSeccion.minAlt) return 'desempeno-basico'\n        if (nota < this.datosSeccion.minSup) return 'desempeno-alto'\n        if (nota <= this.datosSeccion.maxSup) return 'desempeno-superior'\n        return 'desempeno-extra'\n      },\n      async consultarEstudiantes() {\n        this.btnCargando = true\n        if (this.idPeriodo == 1) this.periodosVisibles = [1]\n        if (this.idPeriodo == 2) this.periodosVisibles = [1,2]\n        if (this.idPeriodo == 3) this.periodosVisibles = [1,2,3]\n        if (this.idPeriodo == 4) this.periodosVisibles = [1,2,3,4]\n        this.nombreSede = document.getElementById('sedes')[document.getElementById('sedes').selectedIndex].text\n        if (this.idCurso != null) { \n          this.nombreCurso = document.getElementById('cursos')[document.getElementById('cursos').selectedIndex].text\n          this.$store.state.datosCursos.forEach(element => {\n            if (element.id == this.idCurso) {\n              this.idNivel = element.id_nivel\n            }\n          })\n          this.listaAreasAsignaturas = []\n          await axios\n          .get(CONFIG.ROOT_PATH + 'consolidados/areasasignaturas/curso', {params: {idCurso: this.idCurso}})\n          .then(response => {\n            if (response.data.error){\n              this.mensajeEmergente('danger',CONFIG.TITULO_MSG,response.data.mensaje + ' - Lista areas-asignaturas curso')\n              this.btnCargando = false\n            } else{\n              if (response.data.datos != 0) {\n                //this.listaAreasAsignaturas = response.data.datos\n                response.data.datos.forEach(element => {\n                  if (element.orden != 99) {\n                    this.listaAreasAsignaturas.push(element)\n                  }\n                });\n              }\n            }\n          })\n          .catch(err => {\n            this.mensajeEmergente('danger',CONFIG.TITULO_MSG,'Algo salio mal y no se pudo realizar: Lista areas-asignaturas curso. Intente ms tarde.' + err)\n            this.btnCargando = false\n          })\n          this.datosRaw = []\n          await axios\n          .get(CONFIG.ROOT_PATH + 'consolidados/asignaturas/curso/acumulado', {params: {idCurso: this.idCurso, periodo: this.idPeriodo, vigencia: this.$store.state.aLectivo}})\n          .then(response => {\n            if (response.data.error){\n              this.mensajeEmergente('danger',CONFIG.TITULO_MSG,response.data.mensaje + ' - Consolidados asignaturas curso periodo')\n              this.btnCargando = false\n            } else{\n              if (response.data.datos != 0) {\n                this.datosRaw = response.data.datos\n              }\n            }\n          })\n          .catch(err => {\n            this.mensajeEmergente('danger',CONFIG.TITULO_MSG,'Algo salio mal y no se pudo realizar: Consolidados asignaturas curso periodo. Intente ms tarde.' + err)\n            this.btnCargando = false\n          })\n        }\n        //console.log(JSON.stringify(this.listaAreasAsignaturas))\n        this.btnCargando = false\n      },\n      imprimir() {\n        let fecha = 'Fecha: ' + new Date().toLocaleString()\n        let tituloInforme = 'CONSOLIDADO EVALUACIONES FINALES'\n        const contenido = document.querySelector('table').outerHTML\n        const ventana = window.open(\"Consolidados\", \"_blank\")\n        ventana.document.write(`<html><head><title>Imprimir</title></head>\n        <style scoped>\n          table {\n            border-collapse: collapse;\n            width: 100%;\n            text-align: center;\n            font-size: 10px;\n          }\n          th {\n            background: #eee;\n          }\n          .nota-recuperada {\n            border: 2px solid #ffa500;\n            box-shadow: 0 0 5px #ffa500;\n          }\n          .desempeno-bajo { background-color: #f8d7da; color: #721c24; }\n          .desempeno-basico { background-color: #d1ecf1; color: #0c5460; }\n          .desempeno-alto { background-color: #fff3cd; color: #856404; }\n          .desempeno-superior { background-color: #d4edda; color: #155724; }\n          .desempeno-extra { background-color: #f4ecf5; color: #2f2e2e; }\n        </style>\n          <body class=\"container\">\n            <p style=\"text-align: center; font-size: 12px;\">SECRETARA DE EDUCACIN TERRITORIAL DE TUNJA<br><b>${this.$store.state.nombreInstitucion}</b><br>TUNJA - BOYAC<br>${tituloInforme}<br>Sede: ${this.nombreSede} | Curso: ${this.nombreCurso} | Ao Lectivo ${this.$store.state.aLectivo} | Periodo: FINAL</p>\n            ${contenido}\n            <div style=\"text-align: right; font-size: 12px;\"><i>${fecha}</i></div>\n          </body>\n        </html>`)\n        ventana.document.close()\n        ventana.print()\n      },\n      exportarAExcel() {\n        const tabla = document.querySelector('table')\n        const wb = XLSX.utils.table_to_book(tabla)\n        XLSX.writeFile(wb, 'ConsoldidaFinal.xlsx')\n      },\n      redondear(num) {\n        var m = Number((Math.abs(num) * 10).toPrecision(15))\n        return Math.round(m) / 10 * Math.sign(num);\n      },\n      async ocuparComboCursosSede() {\n        this.comboCursosSede = []\n        this.$store.state.datosCursos.forEach(element => {\n          if (element.id_sede == this.idSede) {\n            this.comboCursosSede.push({ 'value': element.id, 'text': element.nomenclatura.toUpperCase() })\n          }\n        })\n      },\n      async ocuparComboSedes() {\n        this.comboSedes = []\n        this.$store.state.datosSedes.forEach(element => {\n          this.comboSedes.push({ 'value': element.id, 'text': element.sede.toUpperCase() })\n        })\n      },\n      async ocuparComboPeriodos() {\n        this.comboPeriodos = []\n        this.$store.state.periodos.forEach(element => {\n          this.comboPeriodos.push({ 'value': element.id, 'text': element.periodo.toUpperCase() })\n        })\n      },\n      mensajeEmergente(variante, titulo, contenido) {\n        this.$bvToast.toast(contenido, { title: titulo, variant: variante, toaster: \"b-toaster-top-center\", solid: true, autoHideDelay: 4000, appendToast: false })\n      }\n    },\n    computed: {\n      totales() {\n        return this.totalesGlobales()\n      },\n      estudiantesNotas() {\n        const mapa = {}\n        this.datosRaw.forEach(row => {\n          const { estudiante, area, asignatura, periodo, definitiva, recuperacion, orden, definitivacompor, definitivapree, idTipoEspecialidad, ausJ, ausS, porcentaje, id_conceptual } = row\n          if (!mapa[estudiante]) {\n            mapa[estudiante] = { id_conceptual, ausJ: 0, ausS: 0, areas: {} }\n          }\n          if (!mapa[estudiante].areas[area]) {\n            mapa[estudiante].areas[area] = { asignaturas: {} }\n          }\n          if (!mapa[estudiante].areas[area].asignaturas[asignatura]) {\n            mapa[estudiante].areas[area].asignaturas[asignatura] = {\n              periodos: {},\n              orden,\n              idTipoEspecialidad,\n              porcentaje,\n              pesos: { 1: 0.2, 2: 0.2, 3: 0.3, 4: 0.3 }\n            }\n          }\n          let notaFinal = 0\n          if (orden === 99) {\n            if (this.datosSeccion.tipoValComp == 1) {\n              notaFinal = definitiva\n            } else {\n              notaFinal = definitivacompor != null ? definitivacompor : ''\n            }\n          } else {\n            if (this.idNivel == 1) {\n              notaFinal = definitivapree != null && definitivapree != 0 && definitivapree != '' ? definitivapree : ''\n            } else {\n              notaFinal = recuperacion > definitiva ? recuperacion : definitiva\n            }\n          }\n          mapa[estudiante].areas[area].asignaturas[asignatura].periodos[periodo] = notaFinal\n          mapa[estudiante].ausJ += ausJ || 0\n          mapa[estudiante].ausS += ausS || 0\n        })\n        return mapa\n      },\n      totalColumnasPromedioArea() {\n        const areasUnicas = new Set(this.listaAreasAsignaturas.map(a => a.area))\n        return areasUnicas.size\n      },\n      puestosPorEstudiante() {\n        const lista = Object.entries(this.estudiantesNotas).map(([nombre, areas]) => {\n          const promedio = parseFloat(this.calcularPromedioGeneral(areas))\n          return { nombre, promedio: isNaN(promedio) ? 0 : promedio }\n        })\n        // Ordenar de mayor a menor\n        lista.sort((a, b) => b.promedio - a.promedio)\n        const puestos = {}\n        let puestoActual = 1\n        let contador = 1\n        let ultimoPromedio = null\n        lista.forEach(est => {\n          if (est.promedio !== ultimoPromedio) {\n            puestoActual = contador\n            ultimoPromedio = est.promedio\n            contador++\n          }\n          puestos[est.nombre] = puestoActual\n          //contador++\n        })\n        return puestos\n      },\n      encabezadoPorArea() {\n        const mapa = {}\n        this.listaAreasAsignaturas.forEach(({ area, asignatura }) => {\n          if (!mapa[area]) mapa[area] = []\n          mapa[area].push(asignatura)\n        })\n        return mapa\n      },\n    },\n    beforeMount() {\n      this.ocuparComboSedes()\n      this.ocuparComboPeriodos()\n      this.datosSeccion = this.$store.state.datosSecciones[this.$store.state.idSeccion - 1]\n      //console.log(JSON.stringify(this.datosSeccion))\n    }\n  }\n</script>\n<style scoped>\n  table {\n    border-collapse: collapse;\n    width: 100%;\n    text-align: center;\n    font-size: 10px;\n  }\n  th {\n    background: #eee;\n  }\n  .nota-recuperada {\n    border: 2px solid #ffa500;\n    box-shadow: 0 0 5px #ffa500;\n  }\n  .desempeno-bajo { background-color: #f8d7da; color: #721c24; }\n  .desempeno-basico { background-color: #d1ecf1; color: #0c5460; }\n  .desempeno-alto { background-color: #fff3cd; color: #856404; }\n  .desempeno-superior { background-color: #d4edda; color: #155724; }\n  .desempeno-extra { background-color: #f4ecf5; color: #2f2e2e; }\n  .promedio-area {\n    background-color: #f2f2f2;\n    font-weight: bold;\n    text-align: center;\n  }\n  .bloque-area th,\n  .bloque-area td {\n    border-right: 3px solid #999; /* lnea divisoria entre reas */\n  }\n\n</style>\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ConsolidadoFinalEmiliani.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ConsolidadoFinalEmiliani.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ConsolidadoFinalEmiliani.vue?vue&type=template&id=fbc2034a&scoped=true&\"\nimport script from \"./ConsolidadoFinalEmiliani.vue?vue&type=script&lang=js&\"\nexport * from \"./ConsolidadoFinalEmiliani.vue?vue&type=script&lang=js&\"\nimport style0 from \"./ConsolidadoFinalEmiliani.vue?vue&type=style&index=0&id=fbc2034a&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"fbc2034a\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('b-row',{staticClass:\"mt-2\"},[_c('b-col',{attrs:{\"lg\":\"12\"}},[_c('b-card',{scopedSlots:_vm._u([{key:\"header\",fn:function(){return [_c('h5',{staticClass:\"mb-0\"},[_c('b-icon',{attrs:{\"icon\":\"card-checklist\",\"aria-hidden\":\"true\"}}),_vm._v(\" CONSOLIDADO EVALUACIONES FINALES\")],1)]},proxy:true}])},[_c('b-card-text',[_c('b-row',[_c('b-col',{attrs:{\"lg\":\"6\"}},[_c('b-form-group',{staticClass:\"etiqueta\",attrs:{\"label\":\"Seleccione la Sede:\",\"label-for\":\"sedes\"}},[_c('b-form-select',{ref:\"sedes\",attrs:{\"id\":\"sedes\",\"options\":_vm.comboSedes,\"disabled\":_vm.idPeriodo!=null ? false : true},on:{\"change\":function($event){_vm.idCurso=null,_vm.ocuparComboCursosSede()}},model:{value:(_vm.idSede),callback:function ($$v) {_vm.idSede=$$v},expression:\"idSede\"}})],1)],1),_c('b-col',{attrs:{\"lg\":\"4\"}},[_c('b-form-group',{staticClass:\"etiqueta\",attrs:{\"label\":\"Seleccione el Curso:\",\"label-for\":\"cursos\"}},[_c('b-form-select',{ref:\"cursos\",attrs:{\"id\":\"cursos\",\"options\":_vm.comboCursosSede,\"disabled\":_vm.idSede!=null ? false : true},on:{\"change\":function($event){return _vm.consultarEstudiantes()}},model:{value:(_vm.idCurso),callback:function ($$v) {_vm.idCurso=$$v},expression:\"idCurso\"}})],1)],1)],1)],1)],1)],1)],1),_c('b-row',[_c('b-col',{attrs:{\"lg\":\"12\"}},[(_vm.btnCargando)?_c('div',[_c('div',{staticClass:\"text-center m-5 text-primary\"},[_c('b-spinner',{staticStyle:{\"width\":\"3rem\",\"height\":\"3rem\"},attrs:{\"label\":\"Spinner\"}}),_c('br'),_c('strong',[_vm._v(\"Cargando informe...\")])],1)]):_vm._e()])],1),(!_vm.btnCargando && _vm.idCurso!=null)?_c('b-row',[_c('b-col',{attrs:{\"lg\":\"12\"}},[_c('table',{staticClass:\"table-responsive\",attrs:{\"border\":\"1\",\"cellspacing\":\"0\",\"cellpadding\":\"1\"}},[_c('thead',[_c('tr',[_c('th',{attrs:{\"rowspan\":\"3\"}},[_vm._v(\"#\")]),_c('th',{attrs:{\"rowspan\":\"3\"}},[_vm._v(\"Estudiante\")]),_vm._l((_vm.encabezadoPorArea),function(asigs,area){return [_c('th',{key:area,attrs:{\"colspan\":asigs.length * 5 + 1}},[_vm._v(_vm._s(area))])]}),_c('th',{attrs:{\"rowspan\":\"2\"}},[_vm._v(\"AuJ\")]),_c('th',{attrs:{\"rowspan\":\"2\"}},[_vm._v(\"AuS\")])],2),_c('tr',[_vm._l((_vm.encabezadoPorArea),function(asigs,area){return [_vm._l((asigs),function(asig,k){return [_c('th',{key:'area-' + asig + k,attrs:{\"colspan\":\"5\"}},[_vm._v(_vm._s(asig))])]}),_c('th',{key:'prom-area-' + area,attrs:{\"rowspan\":\"2\"}},[_vm._v(\"PRO AR\")])]})],2),_c('tr',[_vm._l((_vm.encabezadoPorArea),function(asigs,area){return [_vm._l((asigs),function(asig){return [_c('th',{key:'p1' + asig + area},[_vm._v(\"P1\")]),_c('th',{key:'p2' + asig + area},[_vm._v(\"P2\")]),_c('th',{key:'p3' + asig + area},[_vm._v(\"P3\")]),_c('th',{key:'p4' + asig + area},[_vm._v(\"P4\")]),_c('th',{key:'prom' + asig + area},[_vm._v(\"PR\")])]})]}),_c('th'),_vm._v(\" \"),_c('th')],2)]),_c('tbody',_vm._l((_vm.estudiantesNotas),function(est,nombre,i){return _c('tr',{key:nombre},[_c('td',{staticClass:\"text-left\"},[_vm._v(_vm._s(i + 1))]),_c('td',{staticStyle:{\"text-align\":\"left\"}},[_vm._v(_vm._s(nombre))]),_vm._l((_vm.encabezadoPorArea),function(asigs,area){return [_vm._l((asigs),function(asig){return [_vm._l(([1,2,3,4]),function(p){return _c('td',{key:nombre + area + asig + p},[_vm._v(\" \"+_vm._s(_vm.obtenerNota(est, area, asig, p))+\" \")])}),_c('td',{key:'prom' + nombre + area + asig},[_vm._v(\" \"+_vm._s(_vm.obtenerPromedioAsignatura(est, area, asig))+\" \")])]}),_c('td',{key:'promArea' + nombre + area},[_vm._v(\" \"+_vm._s(_vm.obtenerPromedioArea(est, area))+\" \")])]}),_c('td',[_vm._v(_vm._s(est.ausJ))]),_c('td',[_vm._v(_vm._s(est.ausS))])],2)}),0)]),_c('div',{staticStyle:{\"margin-bottom\":\"1rem\"}},[_c('b-button',{staticClass:\"small mx-1 mt-3\",attrs:{\"variant\":\"primary\"},on:{\"click\":_vm.imprimir}},[_vm._v(\"Imprimir Consolidado\")]),_c('b-button',{staticClass:\"small mx-1 mt-3\",attrs:{\"variant\":\"outline-primary\"},on:{\"click\":_vm.exportarAExcel}},[_vm._v(\"Exportar a Excel\")])],1)])],1):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div>\n    <b-row class=\"mt-2\">\n      <b-col lg=\"12\">\n        <b-card>\n          <template #header>\n            <h5 class=\"mb-0\"><b-icon icon=\"card-checklist\" aria-hidden=\"true\"></b-icon> CONSOLIDADO EVALUACIONES FINALES</h5>\n          </template>\n          <b-card-text>\n            <b-row>\n              <!--\n              <b-col lg=\"2\">\n                <b-form-group label=\"Periodo:\" label-for=\"periodo\" class=\"etiqueta\">\n                  <b-form-select id=\"periodo\" ref=\"periodo\" v-model=\"idPeriodo\" :options=\"comboPeriodos\" @change=\"idSede=null,idCurso=null\"></b-form-select>\n                </b-form-group>\n              </b-col>\n              -->\n              <b-col lg=\"6\">\n                <b-form-group label=\"Seleccione la Sede:\" label-for=\"sedes\" class=\"etiqueta\">\n                  <b-form-select  id=\"sedes\" ref=\"sedes\" v-model=\"idSede\" :options=\"comboSedes\" @change=\"idCurso=null,ocuparComboCursosSede()\" :disabled=\"idPeriodo!=null ? false : true\"></b-form-select>\n                </b-form-group>\n              </b-col>\n              <b-col lg=\"4\">\n                <b-form-group label=\"Seleccione el Curso:\" label-for=\"cursos\" class=\"etiqueta\">\n                  <b-form-select id=\"cursos\" ref=\"cursos\" v-model=\"idCurso\" :options=\"comboCursosSede\" @change=\"consultarEstudiantes()\" :disabled=\"idSede!=null ? false : true\"></b-form-select>\n                </b-form-group>\n              </b-col>\n            </b-row>\n          </b-card-text>\n        </b-card>\n      </b-col>\n    </b-row>\n    <b-row>\n      <b-col lg=\"12\">\n        <div v-if=\"btnCargando\">\n          <div class=\"text-center m-5 text-primary\">\n            <b-spinner style=\"width: 3rem; height: 3rem;\" label=\"Spinner\"></b-spinner>\n            <br><strong>Cargando informe...</strong>\n          </div>\n        </div>\n      </b-col>\n    </b-row>\n    <b-row v-if=\"!btnCargando && idCurso!=null\">\n      <b-col lg=\"12\">\n        <table border=\"1\" cellspacing=\"0\" cellpadding=\"1\" class=\"table-responsive\">\n          <thead>\n            <tr>\n              <th rowspan=\"3\">#</th>\n              <th rowspan=\"3\">Estudiante</th>\n              <template v-for=\"(asigs, area) in encabezadoPorArea\">\n                <th :colspan=\"asigs.length * 5 + 1\" :key=\"area\">{{ area }}</th>\n              </template>\n              <th rowspan=\"2\">AuJ</th>\n              <th rowspan=\"2\">AuS</th>\n            </tr>\n            <tr>\n              <template v-for=\"(asigs, area) in encabezadoPorArea\">\n                <template v-for=\"(asig, k) in asigs\">\n                  <th colspan=\"5\" :key=\"'area-' + asig + k\">{{ asig }}</th>\n                </template>\n                <th rowspan=\"2\" :key=\"'prom-area-' + area\">PRO AR</th>\n              </template>\n            </tr>\n            <tr>\n              <template v-for=\"(asigs, area) in encabezadoPorArea\">\n                <template v-for=\"asig in asigs\">\n                  <th :key=\"'p1' + asig + area\">P1</th>\n                  <th :key=\"'p2' + asig + area\">P2</th>\n                  <th :key=\"'p3' + asig + area\">P3</th>\n                  <th :key=\"'p4' + asig + area\">P4</th>\n                  <th :key=\"'prom' + asig + area\">PR</th>\n                </template>\n              </template>\n              <th></th> <!-- Prom. General -->\n              <th></th>\n            </tr>\n          </thead>\n          <tbody>\n            <tr v-for=\"(est, nombre, i) in estudiantesNotas\" :key=\"nombre\">\n              <td class=\"text-left\">{{ i + 1 }}</td>\n              <td style=\"text-align: left\">{{ nombre }}</td>\n              <template v-for=\"(asigs, area) in encabezadoPorArea\">\n                <template v-for=\"asig in asigs\">\n                  <td v-for=\"p in [1,2,3,4]\" :key=\"nombre + area + asig + p\">\n                    {{ obtenerNota(est, area, asig, p) }}\n                  </td>\n                  <td :key=\"'prom' + nombre + area + asig\">\n                    {{ obtenerPromedioAsignatura(est, area, asig) }}\n                  </td>\n                </template>\n                <td :key=\"'promArea' + nombre + area\">\n                  {{ obtenerPromedioArea(est, area) }}\n                </td>\n              </template>\n\n              <td>{{ est.ausJ }}</td>\n              <td>{{ est.ausS }}</td>\n            </tr>\n          </tbody>\n        </table>\n        <div style=\"margin-bottom: 1rem\">\n          <b-button class=\"small mx-1 mt-3\" variant=\"primary\" @click=\"imprimir\">Imprimir Consolidado</b-button>\n          <b-button class=\"small mx-1 mt-3\" variant=\"outline-primary\" @click=\"exportarAExcel\">Exportar a Excel</b-button>\n        </div>\n      </b-col>\n    </b-row>\n  </div>\n</template>\n\n<script>\n  import axios from \"axios\"\n  import * as CONFIG from '@/assets/config.js'\n  import * as XLSX from 'xlsx'\n\n  export default {\n    name: 'consolidadoponderado',\n    components: {\n    },\n    data () {\n      return {\n        idSede: null,\n        comboSedes: [],\n        idPeriodo: 5,\n        comboPeriodos: null,\n        idCurso: null,\n        comboCursosSede: [],\n        nombreSede: null,\n        nombreCurso: null,\n        idNivel: null,\n        btnCargando: false,\n        datosRaw: [],\n        datosSeccion: {},\n        listaAreasAsignaturas: [],\n      }\n    },\n    methods: {\n      obtenerPromedioArea(est, area) {\n        const areaData = est.areas && est.areas[area]\n        return areaData ? this.calcularPromedioArea(areaData) : '0.00'\n      },\n      obtenerNota(est, area, asignatura, periodo) {\n        const nota = est?.areas?.[area]?.asignaturas?.[asignatura]?.periodos?.[periodo]\n        return typeof nota === 'number' ? nota.toFixed(1) : nota\n      },\n      obtenerPromedioAsignatura(est, area, asignatura) {\n        const asig = est?.areas?.[area]?.asignaturas?.[asignatura]\n        return asig ? this.calcularPromedioAsignatura(asig) : '0.00'\n      },\n      calcularPromedioAsignatura(asig) {\n        const pesos = asig.pesos\n        const periodos = asig.periodos\n        const orden = asig.orden\n        if (orden === 99) return ''\n        let total = 0\n        for (let p = 1; p <= 4; p++) {\n          const nota = periodos[p] ?? 0\n          total += nota * pesos[p] / 100\n        }\n        return total.toFixed(1)\n      },\n      calcularPromedioArea(areaData) {\n        const asigns = Object.values(areaData.asignaturas)\n        if (!asigns.length) return '0.00'\n        let total = 0\n        asigns.forEach(asig => {\n          total += parseFloat(this.calcularPromedioAsignatura(asig))\n        })\n        return (total / asigns.length).toFixed(1)\n      },\n      calcularPromedioGeneral(est) {\n        const areas = Object.values(est.areas)\n        if (!areas.length) return '0.00'\n        let total = 0\n        areas.forEach(area => {\n          total += parseFloat(this.calcularPromedioArea(area))\n        })\n        return (total / areas.length).toFixed(2)\n      },\n      contarAusencias(tipo) {\n        let total = 0\n        Object.values(this.estudiantesNotas).forEach(est => {\n          if (tipo === 'ausJ') total += est.ausJ || 0\n          if (tipo === 'ausS') total += est.ausS || 0\n        })\n        return total\n      },\n      contarNotasPorAsignatura(area, asignatura, tipo) {\n        let contador = 0\n        Object.values(this.estudiantesNotas).forEach(est => {\n          const nota = est?.[area]?.[asignatura]?.nota\n          const val = est?.[area]?.[asignatura]?.idTipoEspecialidad\n          if (typeof nota !== 'number') return\n          if (val === 1) {\n            if (tipo === 'bajo' && nota < this.datosSeccion.minBas) contador++\n            else if (tipo === 'basico' && nota >= this.datosSeccion.minBas && nota < this.datosSeccion.minAlt) contador++\n            else if (tipo === 'alto' && nota >= this.datosSeccion.minAlt && nota < this.datosSeccion.minSup) contador++\n            else if (tipo === 'superior' && nota >= this.datosSeccion.minSup && nota <= this.datosSeccion.maxSup) contador++\n          } else {\n            if (tipo === 'bajo' && nota < this.datosSeccion.minBasT) contador++\n            else if (tipo === 'basico' && nota >= this.datosSeccion.minBasT && nota < this.datosSeccion.minAltT) contador++\n            else if (tipo === 'alto' && nota >= this.datosSeccion.minAltT && nota < this.datosSeccion.minSupT) contador++\n            else if (tipo === 'superior' && nota >= this.datosSeccion.minSupT && nota <= this.datosSeccion.maxSupT) contador++\n          }\n        })\n        return contador\n      },\n      contarNotasTotales(tipo) {\n        let total = 0\n        Object.values(this.estudiantesNotas).forEach(est => {\n          this.listaAreasAsignaturas.forEach(({ area, asignatura }) => {\n            const nota = est?.[area]?.[asignatura]?.nota\n            const val = est?.[area]?.[asignatura]?.idTipoEspecialidad\n            if (typeof nota !== 'number') return\n          if (val === 1) {\n            if (tipo === 'bajo' && nota < this.datosSeccion.minBas) total++\n            else if (tipo === 'basico' && nota >= this.datosSeccion.minBas && nota < this.datosSeccion.minAlt) total++\n            else if (tipo === 'alto' && nota >= this.datosSeccion.minAlt && nota < this.datosSeccion.minSup) total++\n            else if (tipo === 'superior' && nota >= this.datosSeccion.minSup && nota <= this.datosSeccion.maxSup) total++\n          } else {\n            if (tipo === 'bajo' && nota < this.datosSeccion.minBasT) total++\n            else if (tipo === 'basico' && nota >= this.datosSeccion.minBasT && nota < this.datosSeccion.minAltT) total++\n            else if (tipo === 'alto' && nota >= this.datosSeccion.minAltT && nota < this.datosSeccion.minSupT) total++\n            else if (tipo === 'superior' && nota >= this.datosSeccion.minSupT && nota <= this.datosSeccion.maxSupT) total++\n          }\n          })\n        })\n        return total\n      },\n      iconoPuesto(puesto) {\n        if (puesto === 1) return ''\n        if (puesto === 2) return ''\n        if (puesto === 3) return ''\n        return ''\n      },\n      contarDesempenoEstudiante(estAreas, tipo) {\n        let contador = 0\n        this.listaAreasAsignaturas.forEach(({ area, asignatura }) => {\n          const nota = estAreas?.[area]?.[asignatura]?.nota\n          const val =  estAreas?.[area]?.[asignatura]?.idTipoEspecialidad\n          if (typeof nota !== 'number') return\n          if (val === 1) {\n            if (tipo === 'bajo' && nota < this.datosSeccion.minBas) contador++\n            else if (tipo === 'basico' && nota >= this.datosSeccion.minBas && nota < this.datosSeccion.minAlt) contador++\n            else if (tipo === 'alto' && nota >= this.datosSeccion.minAlt && nota < this.datosSeccion.minSup) contador++\n            else if (tipo === 'superior' && nota >= this.datosSeccion.minSup && nota <= this.datosSeccion.maxSup) contador++\n          } else {\n            if (tipo === 'bajo' && nota < this.datosSeccion.minBasT) contador++\n            else if (tipo === 'basico' && nota >= this.datosSeccion.minBasT && nota < this.datosSeccion.minAltT) contador++\n            else if (tipo === 'alto' && nota >= this.datosSeccion.minAltT && nota < this.datosSeccion.minSupT) contador++\n            else if (tipo === 'superior' && nota >= this.datosSeccion.minSupT && nota <= this.datosSeccion.maxSupT) contador++\n          }\n        })\n        return contador\n      },\n      fueRecuperada(areas, area, asig) {\n        return areas?.[area]?.[asig]?.fueRecuperada ?? false\n      },\n      obtenerOriginal(areas, area, asig) {\n        const val = areas?.[area]?.[asig]?.original\n        return typeof val === 'number' ? val.toFixed(1) : '0.0'\n      },\n      obtenerRecuperacion(areas, area, asig) {\n        const val = areas?.[area]?.[asig]?.recuperacion\n        return typeof val === 'number' ? val.toFixed(1) : '0.0'\n      },\n      obtenerColor(nota, areas, area, asig) {\n        const val = areas?.[area]?.[asig]?.idTipoEspecialidad\n        if (val === 1) {\n          if (nota < this.datosSeccion.minBas) return 'desempeno-bajo'\n          if (nota < this.datosSeccion.minAlt) return 'desempeno-basico'\n          if (nota < this.datosSeccion.minSup) return 'desempeno-alto'\n          if (nota <= this.datosSeccion.maxSup) return 'desempeno-superior'\n          return 'desempeno-extra'\n        } else {\n          if (nota < this.datosSeccion.minBasT) return 'desempeno-bajo'\n          if (nota < this.datosSeccion.minAltT) return 'desempeno-basico'\n          if (nota < this.datosSeccion.minSupT) return 'desempeno-alto'\n          if (nota <= this.datosSeccion.maxSupT) return 'desempeno-superior'\n          return 'desempeno-extra'\n        }\n      },\n      obtenerColorGeneral(nota) {\n        if (nota < this.datosSeccion.minBas) return 'desempeno-bajo'\n        if (nota < this.datosSeccion.minAlt) return 'desempeno-basico'\n        if (nota < this.datosSeccion.minSup) return 'desempeno-alto'\n        if (nota <= this.datosSeccion.maxSup) return 'desempeno-superior'\n        return 'desempeno-extra'\n      },\n      async consultarEstudiantes() {\n        this.btnCargando = true\n        this.nombreSede = document.getElementById('sedes')[document.getElementById('sedes').selectedIndex].text\n        if (this.idCurso != null) { \n          this.nombreCurso = document.getElementById('cursos')[document.getElementById('cursos').selectedIndex].text\n          this.$store.state.datosCursos.forEach(element => {\n            if (element.id == this.idCurso) {\n              this.idNivel = element.id_nivel\n            }\n          })\n          this.listaAreasAsignaturas = []\n          await axios\n          .get(CONFIG.ROOT_PATH + 'consolidados/areasasignaturas/curso', {params: {idCurso: this.idCurso}})\n          .then(response => {\n            if (response.data.error){\n              this.mensajeEmergente('danger',CONFIG.TITULO_MSG,response.data.mensaje + ' - Lista areas-asignaturas curso')\n              this.btnCargando = false\n            } else{\n              if (response.data.datos != 0) {\n                //this.listaAreasAsignaturas = response.data.datos\n                response.data.datos.forEach(element => {\n                  if (element.orden != 99) {\n                    this.listaAreasAsignaturas.push(element)\n                  }\n                });\n              }\n            }\n          })\n          .catch(err => {\n            this.mensajeEmergente('danger',CONFIG.TITULO_MSG,'Algo salio mal y no se pudo realizar: Lista areas-asignaturas curso. Intente ms tarde.' + err)\n            this.btnCargando = false\n          })\n          this.datosRaw = []\n          await axios\n          .get(CONFIG.ROOT_PATH + 'consolidados/asignaturas/curso/acumulado', {params: {idCurso: this.idCurso, periodo: this.idPeriodo, vigencia: this.$store.state.aLectivo}})\n          .then(response => {\n            if (response.data.error){\n              this.mensajeEmergente('danger',CONFIG.TITULO_MSG,response.data.mensaje + ' - Consolidados asignaturas curso periodo')\n              this.btnCargando = false\n            } else{\n              if (response.data.datos != 0) {\n                this.datosRaw = response.data.datos\n              }\n            }\n          })\n          .catch(err => {\n            this.mensajeEmergente('danger',CONFIG.TITULO_MSG,'Algo salio mal y no se pudo realizar: Consolidados asignaturas curso periodo. Intente ms tarde.' + err)\n            this.btnCargando = false\n          })\n        }\n        //console.log(JSON.stringify(this.listaAreasAsignaturas))\n        this.btnCargando = false\n      },\n      imprimir() {\n        let fecha = 'Fecha: ' + new Date().toLocaleString()\n        let tituloInforme = 'CONSOLIDADO EVALUACIONES FINALES'\n        const contenido = document.querySelector('table').outerHTML\n        const ventana = window.open(\"Consolidados\", \"_blank\")\n        ventana.document.write(`<html><head><title>Imprimir</title></head>\n        <style scoped>\n          table {\n            border-collapse: collapse;\n            width: 100%;\n            text-align: center;\n            font-size: 10px;\n          }\n          th {\n            background: #eee;\n          }\n          .nota-recuperada {\n            border: 2px solid #ffa500;\n            box-shadow: 0 0 5px #ffa500;\n          }\n          .desempeno-bajo { background-color: #f8d7da; color: #721c24; }\n          .desempeno-basico { background-color: #d1ecf1; color: #0c5460; }\n          .desempeno-alto { background-color: #fff3cd; color: #856404; }\n          .desempeno-superior { background-color: #d4edda; color: #155724; }\n          .desempeno-extra { background-color: #f4ecf5; color: #2f2e2e; }\n        </style>\n          <body class=\"container\">\n            <p style=\"text-align: center; font-size: 12px;\">SECRETARA DE EDUCACIN TERRITORIAL DE TUNJA<br><b>${this.$store.state.nombreInstitucion}</b><br>TUNJA - BOYAC<br>${tituloInforme}<br>Sede: ${this.nombreSede} | Curso: ${this.nombreCurso} | Ao Lectivo ${this.$store.state.aLectivo} | Periodo: FINAL</p>\n            ${contenido}\n            <div style=\"text-align: right; font-size: 12px;\"><i>${fecha}</i></div>\n          </body>\n        </html>`)\n        ventana.document.close()\n        ventana.print()\n      },\n      exportarAExcel() {\n        const tabla = document.querySelector('table')\n        const wb = XLSX.utils.table_to_book(tabla)\n        XLSX.writeFile(wb, 'ConsolidadoFinal.xlsx')\n      },\n      redondear(num) {\n        var m = Number((Math.abs(num) * 10).toPrecision(15))\n        return Math.round(m) / 10 * Math.sign(num);\n      },\n      async ocuparComboCursosSede() {\n        this.comboCursosSede = []\n        this.$store.state.datosCursos.forEach(element => {\n          if (element.id_sede == this.idSede) {\n            this.comboCursosSede.push({ 'value': element.id, 'text': element.nomenclatura.toUpperCase() })\n          }\n        })\n      },\n      async ocuparComboSedes() {\n        this.comboSedes = []\n        this.$store.state.datosSedes.forEach(element => {\n          this.comboSedes.push({ 'value': element.id, 'text': element.sede.toUpperCase() })\n        })\n      },\n      async ocuparComboPeriodos() {\n        this.comboPeriodos = []\n        this.$store.state.periodos.forEach(element => {\n          this.comboPeriodos.push({ 'value': element.id, 'text': element.periodo.toUpperCase() })\n        })\n      },\n      mensajeEmergente(variante, titulo, contenido) {\n        this.$bvToast.toast(contenido, { title: titulo, variant: variante, toaster: \"b-toaster-top-center\", solid: true, autoHideDelay: 4000, appendToast: false })\n      }\n    },\n    computed: {\n      estudiantesNotas() {\n        const mapa = {}\n        this.datosRaw.forEach(row => {\n          const { estudiante, area, asignatura, periodo, definitiva, recuperacion, orden, definitivacompor, idTipoEspecialidad, ausJ, ausS } = row\n          if (!mapa[estudiante]) {\n            mapa[estudiante] = { ausJ: 0, ausS: 0, areas: {} }\n          }\n          if (!mapa[estudiante].areas[area]) {\n            mapa[estudiante].areas[area] = { asignaturas: {} }\n          }\n          if (!mapa[estudiante].areas[area].asignaturas[asignatura]) {\n            mapa[estudiante].areas[area].asignaturas[asignatura] = {\n              periodos: {},\n              orden,\n              pesos: { 1: this.datosSeccion.pesoP1, 2: this.datosSeccion.pesoP2, 3: this.datosSeccion.pesoP3, 4: this.datosSeccion.pesoP4 }\n            }\n          }\n          let notaFinal = 0\n          if (orden === 99) {\n            notaFinal = definitivacompor != null ? definitivacompor : ''\n          } else {\n            notaFinal = recuperacion > definitiva ? recuperacion : definitiva\n          }\n          mapa[estudiante].areas[area].asignaturas[asignatura].periodos[periodo] = notaFinal\n          mapa[estudiante].ausJ += ausJ || 0\n          mapa[estudiante].ausS += ausS || 0\n        })\n        return mapa\n      },\n\n\n\n\n      totalColumnasPromedioArea() {\n        const areasUnicas = new Set(this.listaAreasAsignaturas.map(a => a.area))\n        return areasUnicas.size\n      },\n      puestosPorEstudiante() {\n        const lista = Object.entries(this.estudiantesNotas).map(([nombre, areas]) => {\n          const promedio = parseFloat(this.calcularPromedioGeneral(areas))\n          return { nombre, promedio: isNaN(promedio) ? 0 : promedio }\n        })\n        // Ordenar de mayor a menor\n        lista.sort((a, b) => b.promedio - a.promedio)\n        const puestos = {}\n        let puestoActual = 1\n        let contador = 1\n        let ultimoPromedio = null\n        lista.forEach(est => {\n          if (est.promedio !== ultimoPromedio) {\n            puestoActual = contador\n            ultimoPromedio = est.promedio\n          }\n          puestos[est.nombre] = puestoActual\n          contador++\n        })\n        return puestos\n      },\n      encabezadoPorArea() {\n        const mapa = {}\n        this.listaAreasAsignaturas.forEach(({ area, asignatura }) => {\n          if (!mapa[area]) mapa[area] = []\n          mapa[area].push(asignatura)\n        })\n        return mapa\n      },\n    },\n    beforeMount() {\n      this.ocuparComboSedes()\n      this.ocuparComboPeriodos()\n      this.datosSeccion = this.$store.state.datosSecciones[this.$store.state.idSeccion - 1]\n      //console.log(JSON.stringify(this.datosSeccion))\n    }\n  }\n</script>\n<style scoped>\n  table {\n    border-collapse: collapse;\n    width: 100%;\n    text-align: center;\n    font-size: 10px;\n  }\n  th {\n    background: #eee;\n  }\n  .nota-recuperada {\n    border: 2px solid #ffa500;\n    box-shadow: 0 0 5px #ffa500;\n  }\n  .desempeno-bajo { background-color: #f8d7da; color: #721c24; }\n  .desempeno-basico { background-color: #d1ecf1; color: #0c5460; }\n  .desempeno-alto { background-color: #fff3cd; color: #856404; }\n  .desempeno-superior { background-color: #d4edda; color: #155724; }\n  .desempeno-extra { background-color: #f4ecf5; color: #2f2e2e; }\n\n</style>\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ConsolidadoFinalInem.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ConsolidadoFinalInem.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ConsolidadoFinalInem.vue?vue&type=template&id=63f0d732&scoped=true&\"\nimport script from \"./ConsolidadoFinalInem.vue?vue&type=script&lang=js&\"\nexport * from \"./ConsolidadoFinalInem.vue?vue&type=script&lang=js&\"\nimport style0 from \"./ConsolidadoFinalInem.vue?vue&type=style&index=0&id=63f0d732&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"63f0d732\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('b-row',{staticClass:\"mt-2\"},[_c('b-col',{attrs:{\"lg\":\"12\"}},[_c('b-card',{scopedSlots:_vm._u([{key:\"header\",fn:function(){return [_c('h5',{staticClass:\"mb-0\"},[_c('b-icon',{attrs:{\"icon\":\"card-checklist\",\"aria-hidden\":\"true\"}}),_vm._v(\" CONSOLIDADO EVALUACIONES FINALES POR ASIGNATURA\")],1)]},proxy:true}])},[_c('b-card-text',[_c('b-row',[_c('b-col',{attrs:{\"lg\":\"6\"}},[_c('b-form-group',{staticClass:\"etiqueta\",attrs:{\"label\":\"Seleccione la Sede:\",\"label-for\":\"sedes\"}},[_c('b-form-select',{ref:\"sedes\",attrs:{\"id\":\"sedes\",\"options\":_vm.comboSedes},on:{\"change\":function($event){_vm.idCurso=null,_vm.ocuparComboCursosSede()}},model:{value:(_vm.idSede),callback:function ($$v) {_vm.idSede=$$v},expression:\"idSede\"}})],1)],1),_c('b-col',{attrs:{\"lg\":\"4\"}},[_c('b-form-group',{staticClass:\"etiqueta\",attrs:{\"label\":\"Seleccione el Curso:\",\"label-for\":\"cursos\"}},[_c('b-form-select',{ref:\"cursos\",attrs:{\"id\":\"cursos\",\"options\":_vm.comboCursosSede,\"disabled\":_vm.idSede!=null ? false : true},on:{\"change\":function($event){return _vm.consultarEstudiantes()}},model:{value:(_vm.idCurso),callback:function ($$v) {_vm.idCurso=$$v},expression:\"idCurso\"}})],1)],1)],1)],1)],1)],1)],1),_c('b-row',[_c('b-col',{attrs:{\"lg\":\"12\"}},[(_vm.btnCargando)?_c('div',[_c('div',{staticClass:\"text-center m-5 text-primary\"},[_c('b-spinner',{staticStyle:{\"width\":\"3rem\",\"height\":\"3rem\"},attrs:{\"label\":\"Spinner\"}}),_c('br'),_c('strong',[_vm._v(\"Cargando informe...\")])],1)]):_vm._e()])],1),(!_vm.btnCargando && _vm.idCurso!=null)?_c('b-row',[_c('b-col',{attrs:{\"lg\":\"12\"}},[_c('table',{staticClass:\"table-responsive\",attrs:{\"border\":\"1\",\"cellspacing\":\"0\",\"cellpadding\":\"1\"}},[_c('thead',[_c('tr',[_c('th',{attrs:{\"rowspan\":\"3\"}},[_vm._v(\"#\")]),_c('th',{attrs:{\"rowspan\":\"3\"}},[_vm._v(\"Estudiante\")]),_c('th',{attrs:{\"rowspan\":\"3\"}},[_vm._v(\"Tot\"),_c('br'),_vm._v(\"Asig\"),_c('br'),_vm._v(\"Baj\")]),_c('th',{attrs:{\"rowspan\":\"3\"}},[_vm._v(\"Asignaturas Perdidas\")]),_c('th',{attrs:{\"rowspan\":\"3\"}},[_vm._v(\"PRO GEN\")]),_c('th',{attrs:{\"rowspan\":\"3\"}},[_vm._v(\"Tot\"),_c('br'),_vm._v(\"AuJ\")]),_c('th',{attrs:{\"rowspan\":\"3\"}},[_vm._v(\"Tot\"),_c('br'),_vm._v(\"AuS\")]),_c('th',{attrs:{\"rowspan\":\"3\"}},[_vm._v(\"Puesto\")]),_c('th',{attrs:{\"rowspan\":\"3\"}},[_vm._v(\"#\")])])]),_c('tbody',[_vm._l((_vm.estudiantesNotas),function(est,nombre,i){return _c('tr',{key:nombre},[_c('td',{staticClass:\"text-left\"},[_vm._v(_vm._s(i + 1))]),_c('td',{staticStyle:{\"text-align\":\"left\"}},[_vm._v(_vm._s(nombre))]),_c('td',[_vm._v(_vm._s(est.id_conceptual=='N' ? _vm.contarDesempenoEstudiante(est.areas, 'bajo') : '-'))]),_c('td',{staticStyle:{\"text-align\":\"left\"}},[_vm._v(_vm._s(est.id_conceptual=='N' ? _vm.mostrarNotasPorAsignaturaPerdidas(est.areas, 'bajo') : '-'))]),_c('td',[_vm._v(_vm._s(est.id_conceptual=='N' ? _vm.calcularPromedioGeneral(est) : '-'))]),_c('td',[_vm._v(_vm._s(est.id_conceptual=='N' ? est.ausJ : '-'))]),_c('td',[_vm._v(_vm._s(est.id_conceptual=='N' ? est.ausS : '-'))]),_c('td',[_vm._v(_vm._s(est.id_conceptual=='N' ? _vm.iconoPuesto(_vm.puestosPorEstudiante[nombre]) : '-')+\" \"+_vm._s(est.id_conceptual=='N' ? _vm.puestosPorEstudiante[nombre] : '-'))]),_c('td',{staticClass:\"text-left\"},[_vm._v(_vm._s(i + 1))])])}),_c('tr',{staticStyle:{\"background-color\":\"#f0f0f0\",\"font-weight\":\"bold\"}},[_c('td',{attrs:{\"colspan\":\"2\"}},[_vm._v(\"Total Bajos\")]),_c('td',[_vm._v(_vm._s(_vm.totales.bajo))]),_c('td'),_c('td'),_c('td',[_vm._v(_vm._s(_vm.totales.ausJ))]),_c('td',[_vm._v(_vm._s(_vm.totales.ausS))]),_c('td'),_c('td')])],2)]),_c('div',{staticStyle:{\"margin-bottom\":\"1rem\"}},[_c('b-button',{staticClass:\"small mx-1 mt-3\",attrs:{\"variant\":\"primary\"},on:{\"click\":_vm.imprimir}},[_vm._v(\"Imprimir Consolidado\")]),_c('b-button',{staticClass:\"small mx-1 mt-3\",attrs:{\"variant\":\"outline-primary\"},on:{\"click\":_vm.exportarAExcel}},[_vm._v(\"Exportar a Excel\")])],1)])],1):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div>\n    <b-row class=\"mt-2\">\n      <b-col lg=\"12\">\n        <b-card>\n          <template #header>\n            <h5 class=\"mb-0\"><b-icon icon=\"card-checklist\" aria-hidden=\"true\"></b-icon> CONSOLIDADO EVALUACIONES FINALES POR ASIGNATURA</h5>\n          </template>\n          <b-card-text>\n            <b-row>\n              <!--\n              <b-col lg=\"2\">\n                <b-form-group label=\"Periodo:\" label-for=\"periodo\" class=\"etiqueta\">\n                  <b-form-select id=\"periodo\" ref=\"periodo\" v-model=\"idPeriodo\" :options=\"comboPeriodos\" @change=\"idSede=null,idCurso=null\"></b-form-select>\n                </b-form-group>\n              </b-col>\n              -->\n              <b-col lg=\"6\">\n                <b-form-group label=\"Seleccione la Sede:\" label-for=\"sedes\" class=\"etiqueta\">\n                  <b-form-select  id=\"sedes\" ref=\"sedes\" v-model=\"idSede\" :options=\"comboSedes\" @change=\"idCurso=null,ocuparComboCursosSede()\"></b-form-select>\n                </b-form-group>\n              </b-col>\n              <b-col lg=\"4\">\n                <b-form-group label=\"Seleccione el Curso:\" label-for=\"cursos\" class=\"etiqueta\">\n                  <b-form-select id=\"cursos\" ref=\"cursos\" v-model=\"idCurso\" :options=\"comboCursosSede\" @change=\"consultarEstudiantes()\" :disabled=\"idSede!=null ? false : true\"></b-form-select>\n                </b-form-group>\n              </b-col>\n            </b-row>\n          </b-card-text>\n        </b-card>\n      </b-col>\n    </b-row>\n    <b-row>\n      <b-col lg=\"12\">\n        <div v-if=\"btnCargando\">\n          <div class=\"text-center m-5 text-primary\">\n            <b-spinner style=\"width: 3rem; height: 3rem;\" label=\"Spinner\"></b-spinner>\n            <br><strong>Cargando informe...</strong>\n          </div>\n        </div>\n      </b-col>\n    </b-row>\n    <b-row v-if=\"!btnCargando && idCurso!=null\">\n      <b-col lg=\"12\">\n        <table border=\"1\" cellspacing=\"0\" cellpadding=\"1\" class=\"table-responsive\">\n          <thead>\n            <tr>\n              <th rowspan=\"3\">#</th>\n              <th rowspan=\"3\">Estudiante</th>\n              <!--\n              <template v-for=\"(asigs, area) in encabezadoPorArea\">\n                <th :colspan=\"colspanArea(area)\" :key=\"area\">\n                  {{ area }}\n                </th>\n              </template>\n              -->\n              <th rowspan=\"3\">Tot<br>Asig<br>Baj</th>\n              <th rowspan=\"3\">Asignaturas Perdidas</th>\n              <th rowspan=\"3\">PRO GEN</th>\n              <th rowspan=\"3\">Tot<br>AuJ</th>\n              <th rowspan=\"3\">Tot<br>AuS</th>\n              <th rowspan=\"3\">Puesto</th>\n              <th rowspan=\"3\">#</th>\n            </tr>\n            <!--\n            <tr>\n              <template v-for=\"(asigs, area) in encabezadoPorArea\">\n                <template v-for=\"(asig, k) in asigs\">\n                  <th :colspan=\"periodosVisibles.length + 1\" :key=\"'area-' + asig + k\">\n                    {{ asig }}\n                  </th>\n                </template>\n                <th class=\"promedio-area\" :key=\"'prom-area-' + area\">PRO AR</th>\n              </template>\n            </tr>\n            <tr>\n              <template v-for=\"(asigs, area) in encabezadoPorArea\">\n                <template v-for=\"asig in asigs\">\n                  <th v-for=\"p in periodosVisibles\" :key=\"'h' + area + asig + p\">\n                    P{{ p }}\n                  </th>\n                  <th :key=\"'prom' + asig + area\">PR</th>\n                </template>\n                <th :key=\"'prom' + area\"></th>\n              </template>\n            </tr>\n            -->\n          </thead>\n          <tbody>\n            <tr v-for=\"(est, nombre, i) in estudiantesNotas\" :key=\"nombre\">\n              <td class=\"text-left\">{{ i + 1 }}</td>\n              <td style=\"text-align: left\">{{ nombre }}</td>\n              <!--\n              <template v-for=\"(asigs, area) in encabezadoPorArea\">\n                <template v-for=\"asig in asigs\">\n                  <td v-for=\"p in periodosVisibles\"  :key=\"nombre + area + asig + p\">\n                    {{ est.id_conceptual=='N' ? obtenerNota(est, area, asig, p) : '-' }}\n                  </td>\n                  <td class=\"bloque-area\" :key=\"'prom' + nombre + area + asig\" style=\"font-weight: bold; text-align: center;\">\n                    {{ est.id_conceptual=='N' ? obtenerPromedioAsignatura(est, area, asig) : '-' }}\n                  </td>\n                </template>\n                <td class=\"promedio-area bloque-area\" :key=\"'promArea' + nombre + area\">\n                  {{ est.id_conceptual=='N' ? obtenerPromedioArea(est, area) : '-' }}\n                </td>\n              </template>\n              -->\n              <td>{{ est.id_conceptual=='N' ? contarDesempenoEstudiante(est.areas, 'bajo') : '-' }}</td>\n              <td style=\"text-align: left\">{{ est.id_conceptual=='N' ? mostrarNotasPorAsignaturaPerdidas(est.areas, 'bajo') : '-' }}</td>\n              <td>{{ est.id_conceptual=='N' ? calcularPromedioGeneral(est) : '-' }}</td>\n              <td>{{ est.id_conceptual=='N' ? est.ausJ : '-' }}</td>\n              <td>{{ est.id_conceptual=='N' ? est.ausS : '-' }}</td>\n              <td>{{ est.id_conceptual=='N' ? iconoPuesto(puestosPorEstudiante[nombre]) : '-' }} {{ est.id_conceptual=='N' ? puestosPorEstudiante[nombre] : '-' }}</td>\n              <td class=\"text-left\">{{ i + 1 }}</td>\n            </tr>\n            <tr style=\"background-color: #f0f0f0; font-weight: bold;\">\n              <td colspan=\"2\">Total Bajos</td>\n              <!--\n              <template v-for=\"(asigs, area) in encabezadoPorArea\">\n                <template v-for=\"asig in asigs\">\n                  <td v-for=\"p in periodosVisibles\" :key=\"'bp' + area + asig + p\">\n                    {{ totalBajosPorPeriodo(area, asig, p) }}\n                  </td>\n                  <td :key=\"'bj' + area + asig\">\n                    {{ totalBajosPromedioAsignatura(area, asig) }}\n                  </td>\n                </template>\n                <td  :key=\"'bja' + area\" class=\"promedio-area\">\n                  {{ totalBajosPromedioArea(area) }}\n                </td>\n              </template>\n              -->\n              <td>{{ totales.bajo }}</td>\n              <td></td>\n              <!--\n              <td>{{ totales.basico }}</td>\n              <td>{{ totales.alto }}</td>\n              <td>{{ totales.superior }}</td>\n              -->\n              <td></td>\n              <td>{{ totales.ausJ }}</td>\n              <td>{{ totales.ausS }}</td>\n              <td></td>\n              <td></td>\n            </tr>\n          </tbody>\n        </table>\n        <div style=\"margin-bottom: 1rem\">\n          <b-button class=\"small mx-1 mt-3\" variant=\"primary\" @click=\"imprimir\">Imprimir Consolidado</b-button>\n          <b-button class=\"small mx-1 mt-3\" variant=\"outline-primary\" @click=\"exportarAExcel\">Exportar a Excel</b-button>\n        </div>\n      </b-col>\n    </b-row>\n  </div>\n</template>\n\n<script>\n  import axios from \"axios\"\n  import * as CONFIG from '@/assets/config.js'\n  import * as XLSX from 'xlsx'\n\n  export default {\n    name: 'consolidadopromedio',\n    components: {\n    },\n    data () {\n      return {\n        idSede: null,\n        comboSedes: [],\n        idPeriodo: 5,\n        comboPeriodos: null,\n        idCurso: null,\n        comboCursosSede: [],\n        nombreSede: null,\n        nombreCurso: null,\n        idNivel: null,\n        btnCargando: false,\n        datosRaw: [],\n        datosSeccion: {},\n        listaAreasAsignaturas: [],\n        periodosVisibles: []\n      }\n    },\n    methods: {\n      colspanArea(area) {\n        const asignaturas = this.encabezadoPorArea[area] || []\n        const columnasPorAsignatura = this.periodosVisibles.length + 1\n        const extraColumnaPromArea = 1\n        return (asignaturas.length * columnasPorAsignatura) + extraColumnaPromArea\n      },\n\n      totalBajosPorPeriodo(area, asignatura, periodo) {\n        let total = 0\n        const meta = this.listaAreasAsignaturas.find(\n          a => a.area === area && a.asignatura === asignatura\n        )\n        const idTipoEspecialidad = meta?.idTipoEspecialidad\n        Object.values(this.estudiantesNotas).forEach(est => {\n          const nota = est?.areas?.[area]?.asignaturas?.[asignatura]?.periodos?.[periodo]\n          if (idTipoEspecialidad === 1) {\n            if (nota > 0 && nota < this.datosSeccion.minBas) total++\n          } else {\n            if (nota > 0 && nota < this.datosSeccion.minBasT) total++\n          }\n        })\n        return total\n      },\n      totalBajosPromedioAsignatura(area, asignatura) {\n        let total = 0\n        const meta = this.listaAreasAsignaturas.find(\n          a => a.area === area && a.asignatura === asignatura\n        )\n        const idTipoEspecialidad = meta?.idTipoEspecialidad\n        Object.values(this.estudiantesNotas).forEach(est => {\n          const asig = est?.areas?.[area]?.asignaturas?.[asignatura]\n          if (!asig) return\n          const prom = parseFloat(this.calcularPromedioAsignatura(asig))\n          if (idTipoEspecialidad === 1) {\n            if (prom < this.datosSeccion.minBas) total++\n          } else {\n            if (prom < this.datosSeccion.minBasT) total++\n          }\n        })\n        return total\n      },\n      totalBajosPromedioArea(area) {\n        let total = 0\n        Object.values(this.estudiantesNotas).forEach(est => {\n          const prom = parseFloat(this.obtenerPromedioArea(est, area))\n          if (!isNaN(prom) && prom < this.datosSeccion.minBas) total++\n        })\n        return total\n      },\n      totalesGlobales() {\n        let bajo = 0, basico = 0, alto = 0, superior = 0, ausJ = 0, ausS = 0\n        Object.values(this.estudiantesNotas).forEach(est => {\n          bajo += this.contarDesempenoEstudiante(est.areas, 'bajo')\n          basico += this.contarDesempenoEstudiante(est.areas, 'basico')\n          alto += this.contarDesempenoEstudiante(est.areas, 'alto')\n          superior += this.contarDesempenoEstudiante(est.areas, 'superior')\n          ausJ += est.ausJ || 0\n          ausS += est.ausS || 0\n        })\n\n        return { bajo, basico, alto, superior, ausJ, ausS }\n      },\n      esAreaValida(area) {\n        //const asigns = this.listaAreasAsignaturas.filter(a => a.area === area)\n        //return asigns.some(a => a.orden !== 99)\n        const asigns = this.listaAreasAsignaturas.filter(a => a.area === area)\n        if (asigns.some(a => a.orden !== 99 && a.orden !== 98)) return true\n        else if (asigns.some(a => a.orden === 99) && this.datosSeccion.promCompor == 1) return true\n        else return false\n      },\n      obtenerPromedioArea(est, area) {\n        const areaData = est.areas && est.areas[area]\n        return areaData ? this.calcularPromedioArea(areaData) : ''\n      },\n      calcularPromedioArea(areaData) {\n        const asigns = Object.values(areaData.asignaturas)\n        if (!asigns.length) return '0.00'\n        let total = 0\n        asigns.forEach(asig => {\n          if (asig.orden === 99 && this.datosSeccion.promCompor == 0) return '-'\n          total += parseFloat((this.calcularPromedioAsignatura(asig) * asig.porcentaje) / 100)\n        })\n        return total > 0 ? this.redondear(total).toFixed(1) : ''\n      },\n      obtenerNota(est, area, asignatura, periodo) {\n        let nota = est?.areas?.[area]?.asignaturas?.[asignatura]?.periodos?.[periodo]\n        if (nota === 0) nota = ''\n        return typeof nota === 'number' ? nota.toFixed(1) : nota\n      },\n      obtenerPromedioAsignatura(est, area, asignatura) {\n        const asig = est?.areas?.[area]?.asignaturas?.[asignatura]\n        return asig ? this.calcularPromedioAsignatura(asig) : ''\n      },\n      calcularPromedioAsignatura(asig) {\n        const pesos = asig.pesos\n        const periodos = asig.periodos\n        const orden = asig.orden\n        if (orden === 99 && this.datosSeccion.promCompor == 0) return '-'\n        let total = 0\n        if (this.$store.state.idInstitucion == 'acaa36d0-fcb1-11ec-8267-536b07c743c4') { // Emiliani\n          for (let p = 1; p <= 4; p++) {\n            const nota = periodos[p] ?? 0\n            total += nota * pesos[p] / 100\n          }\n          return this.redondear(total).toFixed(1)\n        } else if (this.$store.state.idInstitucion == 'eb58bf60-fc83-11ec-a1d1-1dc2835404e5') { // Inem\n          if (orden == 55) {\n            let cantidad = 0 // nuevo\n            for (let p = 1; p <= 4; p++) {\n              const nota = periodos[p] ?? 0\n              if (nota > 0) {\n                total += nota\n                cantidad++\n              }\n            }\n            if (total === 0) return ''\n            total = total / cantidad\n            return this.redondear(total).toFixed(1)\n          } else {\n            for (let p = 1; p <= 4; p++) {\n              const nota = periodos[p] ?? 0\n              total += nota * pesos[p] / 100\n            }\n            return this.redondear(total).toFixed(1)\n          }\n        } else if (this.$store.state.idInstitucion == 'c50f3d80-fca0-11ec-8267-536b07c743c4') { // Silvino\n          const nota = periodos[5] ?? 0\n          return nota > 0 ? nota.toFixed(1) : ''\n        } else if (this.$store.state.idInstitucion == '8a1bd1e0-fcb2-11ec-8267-536b07c743c4') { // Libertador\n          const nota = periodos[5] ?? 0\n          return nota > 0 ? nota.toFixed(1) : ''\n        } else {\n          let cantidad = 0 \n          for (let p = 1; p <= 4; p++) {\n            const nota = periodos[p] ?? 0\n            if (nota > 0) {\n              total += nota\n              cantidad++\n            }\n          }\n          if (total === 0) return ''\n          const promedio = total / cantidad\n          return this.redondear(promedio).toFixed(1)\n        }\n      },\n      calcularPromedioGeneral(est) {\n        const areas = Object.keys(est.areas || {})\n        let total = 0\n        let cantidad = 0\n        areas.forEach(area => {\n          if (!this.esAreaValida(area)) return\n          const promedio = parseFloat(this.calcularPromedioArea(est.areas[area]))\n          if (!isNaN(promedio)) {\n            total += promedio\n            cantidad++\n          }\n        })\n        return cantidad > 0 ? (total / cantidad).toFixed(3) : ''\n      },\n      contarAusencias(tipo) {\n        let total = 0\n        Object.values(this.estudiantesNotas).forEach(est => {\n          if (tipo === 'ausJ') total += est.ausJ || 0\n          if (tipo === 'ausS') total += est.ausS || 0\n        })\n        return total\n      },\n      contarNotasPorAsignatura(area, asignatura, tipo) {\n        let contador = 0\n        Object.values(this.estudiantesNotas).forEach(est => {\n          const nota = est?.[area]?.[asignatura]?.nota\n          const val = est?.[area]?.[asignatura]?.idTipoEspecialidad\n          if (typeof nota !== 'number') return\n          if (val === 1) {\n            if (tipo === 'bajo' && nota < this.datosSeccion.minBas) contador++\n            else if (tipo === 'basico' && nota >= this.datosSeccion.minBas && nota < this.datosSeccion.minAlt) contador++\n            else if (tipo === 'alto' && nota >= this.datosSeccion.minAlt && nota < this.datosSeccion.minSup) contador++\n            else if (tipo === 'superior' && nota >= this.datosSeccion.minSup && nota <= this.datosSeccion.maxSup) contador++\n          } else {\n            if (tipo === 'bajo' && nota < this.datosSeccion.minBasT) contador++\n            else if (tipo === 'basico' && nota >= this.datosSeccion.minBasT && nota < this.datosSeccion.minAltT) contador++\n            else if (tipo === 'alto' && nota >= this.datosSeccion.minAltT && nota < this.datosSeccion.minSupT) contador++\n            else if (tipo === 'superior' && nota >= this.datosSeccion.minSupT && nota <= this.datosSeccion.maxSupT) contador++\n          }\n        })\n        return contador\n      },\n      contarNotasTotales(tipo) {\n        let total = 0\n        Object.values(this.estudiantesNotas).forEach(est => {\n          this.listaAreasAsignaturas.forEach(({ area, asignatura }) => {\n            const nota = est?.[area]?.[asignatura]?.nota\n            const val = est?.[area]?.[asignatura]?.idTipoEspecialidad\n            if (typeof nota !== 'number') return\n            if (val === 1) {\n              if (tipo === 'bajo' && nota < this.datosSeccion.minBas) total++\n              else if (tipo === 'basico' && nota >= this.datosSeccion.minBas && nota < this.datosSeccion.minAlt) total++\n              else if (tipo === 'alto' && nota >= this.datosSeccion.minAlt && nota < this.datosSeccion.minSup) total++\n              else if (tipo === 'superior' && nota >= this.datosSeccion.minSup && nota <= this.datosSeccion.maxSup) total++\n            } else {\n              if (tipo === 'bajo' && nota < this.datosSeccion.minBasT) total++\n              else if (tipo === 'basico' && nota >= this.datosSeccion.minBasT && nota < this.datosSeccion.minAltT) total++\n              else if (tipo === 'alto' && nota >= this.datosSeccion.minAltT && nota < this.datosSeccion.minSupT) total++\n              else if (tipo === 'superior' && nota >= this.datosSeccion.minSupT && nota <= this.datosSeccion.maxSupT) total++\n            }\n          })\n        })\n        return total\n      },\n      iconoPuesto(puesto) {\n        if (puesto === 1) return ''\n        if (puesto === 2) return ''\n        if (puesto === 3) return ''\n        return ''\n      },\n      contarDesempenoEstudiante(areas, tipo) {\n        let contador = 0\n        Object.values(areas || {}).forEach(area => {\n          Object.values(area.asignaturas || {}).forEach(asig => {\n            const nota = parseFloat(this.calcularPromedioAsignatura(asig))\n            const val =  asig.idTipoEspecialidad\n            const orden =  asig.orden\n            if (this.$store.state.idInstitucion == 'eb58bf60-fc83-11ec-a1d1-1dc2835404e5' && orden == 90) return // No se tiene en cuenta el area de Inem Exploracion vocacional - Complementaria\n            if (this.$store.state.idInstitucion == '097b7b10-fcaa-11ec-8267-536b07c743c4' && orden == 98) return // No se tiene en cuenta el area de Rural Proyectos Profundizacion\n            if (typeof nota !== 'number' || nota == 0) return\n            if (val === 1) {\n              if (tipo === 'bajo' && nota < this.datosSeccion.minBas) contador++\n              else if (tipo === 'basico' && nota >= this.datosSeccion.minBas && nota < this.datosSeccion.minAlt) contador++\n              else if (tipo === 'alto' && nota >= this.datosSeccion.minAlt && nota < this.datosSeccion.minSup) contador++\n              else if (tipo === 'superior' && nota >= this.datosSeccion.minSup && nota <= this.datosSeccion.maxSup) contador++\n            } else {\n              if (tipo === 'bajo' && nota < this.datosSeccion.minBasT) contador++\n              else if (tipo === 'basico' && nota >= this.datosSeccion.minBasT && nota < this.datosSeccion.minAltT) contador++\n              else if (tipo === 'alto' && nota >= this.datosSeccion.minAltT && nota < this.datosSeccion.minSupT) contador++\n              else if (tipo === 'superior' && nota >= this.datosSeccion.minSupT && nota <= this.datosSeccion.maxSupT) contador++\n            }\n          })\n        })\n        return contador\n      },\n      mostrarNotasPorAsignaturaPerdidas(areas, tipo) {\n        let listaAsigPerdidas = ''\n        Object.values(areas || {}).forEach(area => {\n          Object.values(area.asignaturas || {}).forEach(asig => {\n            const orden =  asig.orden\n            const asignita = asig.asignatura\n            const val =  asig.idTipoEspecialidad\n            if (this.$store.state.idInstitucion == 'eb58bf60-fc83-11ec-a1d1-1dc2835404e5' && orden == 90) return // No se tiene en cuenta el area de Inem Exploracion vocacional - Complementaria\n            if ( (this.$store.state.idInstitucion == '54fd7440-fc81-11ec-a1d1-1dc2835404e5' || this.$store.state.idInstitucion == '7c63ed50-fcb0-11ec-8267-536b07c743c4') && orden == 99 ) { // SandovaL, Santiago\n              const nota = parseFloat(this.calcularPromedioAsignatura(asig))\n              if (typeof nota !== 'number') return\n              if (val === 1) {\n                if (tipo === 'bajo' && nota > 0 && nota < this.datosSeccion.minBas) listaAsigPerdidas += asignita + '(' + nota + ') '\n              } else {\n                if (tipo === 'bajo' && nota > 0 && nota < this.datosSeccion.minBasT) listaAsigPerdidas += asignita + '(' + nota + ') '\n              }\n            }\n            if (orden !== 99 && orden !== 98) {\n              const nota = parseFloat(this.calcularPromedioAsignatura(asig))\n              if (typeof nota !== 'number') return\n              if (val === 1) {\n                if (tipo === 'bajo' && nota > 0 && nota < this.datosSeccion.minBas) listaAsigPerdidas += asignita + '(' + nota + ') '\n              } else {\n                if (tipo === 'bajo' && nota > 0 && nota < this.datosSeccion.minBasT) listaAsigPerdidas += asignita + '(' + nota + ') '\n              }\n            }\n          })\n        })\n        return listaAsigPerdidas\n      },\n      fueRecuperada(areas, area, asig) {\n        return areas?.[area]?.[asig]?.fueRecuperada ?? false\n      },\n      obtenerOriginal(areas, area, asig) {\n        const val = areas?.[area]?.[asig]?.original\n        return typeof val === 'number' ? val.toFixed(1) : '0.0'\n      },\n      obtenerRecuperacion(areas, area, asig) {\n        const val = areas?.[area]?.[asig]?.recuperacion\n        return typeof val === 'number' ? val.toFixed(1) : '0.0'\n      },\n      obtenerColor(nota, areas, area, asig) {\n        const val = areas?.[area]?.[asig]?.idTipoEspecialidad\n        if (val === 1) {\n          if (nota < this.datosSeccion.minBas) return 'desempeno-bajo'\n          if (nota < this.datosSeccion.minAlt) return 'desempeno-basico'\n          if (nota < this.datosSeccion.minSup) return 'desempeno-alto'\n          if (nota <= this.datosSeccion.maxSup) return 'desempeno-superior'\n          return 'desempeno-extra'\n        } else {\n          if (nota < this.datosSeccion.minBasT) return 'desempeno-bajo'\n          if (nota < this.datosSeccion.minAltT) return 'desempeno-basico'\n          if (nota < this.datosSeccion.minSupT) return 'desempeno-alto'\n          if (nota <= this.datosSeccion.maxSupT) return 'desempeno-superior'\n          return 'desempeno-extra'\n        }\n      },\n      claseDesempeno(nota) {\n        console.log(nota)\n        if (typeof nota !== 'number') return 'desempeno-extra'\n        if (nota < 3) return 'desempeno-bajo'\n        if (nota < 4) return 'desempeno-basico'\n        if (nota < 4.6) return 'desempeno-alto'\n        if (nota <= 5) return 'desempeno-superior'\n        return 'desempeno-extra'\n      },\n      obtenerColorGeneral(nota) {\n        if (nota < this.datosSeccion.minBas) return 'desempeno-bajo'\n        if (nota < this.datosSeccion.minAlt) return 'desempeno-basico'\n        if (nota < this.datosSeccion.minSup) return 'desempeno-alto'\n        if (nota <= this.datosSeccion.maxSup) return 'desempeno-superior'\n        return 'desempeno-extra'\n      },\n      async consultarEstudiantes() {\n        this.btnCargando = true\n        if (this.idPeriodo == 1) this.periodosVisibles = [1]\n        if (this.idPeriodo == 2) this.periodosVisibles = [1,2]\n        if (this.idPeriodo == 3) this.periodosVisibles = [1,2,3]\n        if (this.idPeriodo == 4) this.periodosVisibles = [1,2,3,4]\n        this.nombreSede = document.getElementById('sedes')[document.getElementById('sedes').selectedIndex].text\n        if (this.idCurso != null) { \n          this.nombreCurso = document.getElementById('cursos')[document.getElementById('cursos').selectedIndex].text\n          this.$store.state.datosCursos.forEach(element => {\n            if (element.id == this.idCurso) {\n              this.idNivel = element.id_nivel\n            }\n          })\n          this.listaAreasAsignaturas = []\n          await axios\n          .get(CONFIG.ROOT_PATH + 'consolidados/areasasignaturas/curso', {params: {idCurso: this.idCurso}})\n          .then(response => {\n            if (response.data.error){\n              this.mensajeEmergente('danger',CONFIG.TITULO_MSG,response.data.mensaje + ' - Lista areas-asignaturas curso')\n              this.btnCargando = false\n            } else{\n              if (response.data.datos != 0) {\n                //this.listaAreasAsignaturas = response.data.datos\n                response.data.datos.forEach(element => {\n                  if ( this.$store.state.idInstitucion == 'eb58bf60-fc83-11ec-a1d1-1dc2835404e5' ) { //Inem\n                    if (element.orden != 99 && element.orden != 90) {\n                      this.listaAreasAsignaturas.push(element)\n                    }\n                  } else if ( this.$store.state.idInstitucion == 'f5529ba0-fcb3-11ec-8267-536b07c743c4' ) { // Gustavo Rojas\n                    if (element.orden != 99 && element.orden != 15 && element.orden != 16 && element.orden != 98) {\n                      this.listaAreasAsignaturas.push(element)\n                    }\n                  } else if ( this.$store.state.idInstitucion == '097b7b10-fcaa-11ec-8267-536b07c743c4' ) { // Rural\n                    if (element.orden != 99 && element.orden != 98) {\n                      this.listaAreasAsignaturas.push(element)\n                    }\n                  } else if ( this.$store.state.idInstitucion == '54fd7440-fc81-11ec-a1d1-1dc2835404e5' || this.$store.state.idInstitucion == '7c63ed50-fcb0-11ec-8267-536b07c743c4' ) { // Antonio Jose Sandoval, Normal Santiago, \n                    this.listaAreasAsignaturas.push(element)\n                  } else {\n                    if (element.orden != 99) {\n                      this.listaAreasAsignaturas.push(element)\n                    }\n                  }\n                })\n              }\n            }\n          })\n          .catch(err => {\n            this.mensajeEmergente('danger',CONFIG.TITULO_MSG,'Algo salio mal y no se pudo realizar: Lista areas-asignaturas curso. Intente ms tarde.' + err)\n            this.btnCargando = false\n          })\n          this.datosRaw = []\n          await axios\n          .get(CONFIG.ROOT_PATH + 'consolidados/asignaturas/curso/acumulado', {params: {idCurso: this.idCurso, periodo: this.idPeriodo, vigencia: this.$store.state.aLectivo}})\n          .then(response => {\n            if (response.data.error){\n              this.mensajeEmergente('danger',CONFIG.TITULO_MSG,response.data.mensaje + ' - Consolidados asignaturas curso periodo')\n              this.btnCargando = false\n            } else{\n              if (response.data.datos != 0) {\n                this.datosRaw = response.data.datos\n              }\n            }\n          })\n          .catch(err => {\n            this.mensajeEmergente('danger',CONFIG.TITULO_MSG,'Algo salio mal y no se pudo realizar: Consolidados asignaturas curso periodo. Intente ms tarde.' + err)\n            this.btnCargando = false\n          })\n        }\n        //console.log(JSON.stringify(this.listaAreasAsignaturas))\n        this.btnCargando = false\n      },\n      imprimir() {\n        let fecha = 'Fecha: ' + new Date().toLocaleString()\n        let tituloInforme = 'INFORME DE ASIGNATURAS PERDIDAS'\n        const contenido = document.querySelector('table').outerHTML\n        const ventana = window.open(\"Consolidados\", \"_blank\")\n        ventana.document.write(`<html><head><title>Imprimir</title></head>\n        <style scoped>\n          table {\n            border-collapse: collapse;\n            width: 100%;\n            text-align: center;\n            font-size: 10px;\n          }\n          th {\n            background: #eee;\n          }\n          .nota-recuperada {\n            border: 2px solid #ffa500;\n            box-shadow: 0 0 5px #ffa500;\n          }\n          .desempeno-bajo { background-color: #f8d7da; color: #721c24; }\n          .desempeno-basico { background-color: #d1ecf1; color: #0c5460; }\n          .desempeno-alto { background-color: #fff3cd; color: #856404; }\n          .desempeno-superior { background-color: #d4edda; color: #155724; }\n          .desempeno-extra { background-color: #f4ecf5; color: #2f2e2e; }\n        </style>\n          <body class=\"container\">\n            <p style=\"text-align: center; font-size: 12px;\">SECRETARA DE EDUCACIN TERRITORIAL DE TUNJA<br><b>${this.$store.state.nombreInstitucion}</b><br>TUNJA - BOYAC<br>${tituloInforme}<br>Sede: ${this.nombreSede} | Curso: ${this.nombreCurso} | Ao Lectivo ${this.$store.state.aLectivo} | Periodo: FINAL</p>\n            ${contenido}\n            <div style=\"text-align: right; font-size: 12px;\"><i>${fecha}</i></div>\n          </body>\n        </html>`)\n        ventana.document.close()\n        ventana.print()\n      },\n      exportarAExcel() {\n        const tabla = document.querySelector('table')\n        const wb = XLSX.utils.table_to_book(tabla)\n        XLSX.writeFile(wb, 'ConsoldidaFinal.xlsx')\n      },\n      redondear(num) {\n        var m = Number((Math.abs(num) * 10).toPrecision(15))\n        return Math.round(m) / 10 * Math.sign(num);\n      },\n      async ocuparComboCursosSede() {\n        this.comboCursosSede = []\n        this.$store.state.datosCursos.forEach(element => {\n          if (element.id_sede == this.idSede) {\n            this.comboCursosSede.push({ 'value': element.id, 'text': element.nomenclatura.toUpperCase() })\n          }\n        })\n      },\n      async ocuparComboSedes() {\n        this.comboSedes = []\n        this.$store.state.datosSedes.forEach(element => {\n          this.comboSedes.push({ 'value': element.id, 'text': element.sede.toUpperCase() })\n        })\n      },\n      async ocuparComboPeriodos() {\n        this.comboPeriodos = []\n        this.$store.state.periodos.forEach(element => {\n          this.comboPeriodos.push({ 'value': element.id, 'text': element.periodo.toUpperCase() })\n        })\n      },\n      mensajeEmergente(variante, titulo, contenido) {\n        this.$bvToast.toast(contenido, { title: titulo, variant: variante, toaster: \"b-toaster-top-center\", solid: true, autoHideDelay: 4000, appendToast: false })\n      }\n    },\n    computed: {\n      totales() {\n        return this.totalesGlobales()\n      },\n      estudiantesNotas() {\n        const mapa = {}\n        this.datosRaw.forEach(row => {\n          const { estudiante, area, asignatura, periodo, definitiva, recuperacion, orden, definitivacompor, definitivapree, idTipoEspecialidad, ausJ, ausS, porcentaje, id_conceptual } = row\n          if (!mapa[estudiante]) {\n            mapa[estudiante] = { id_conceptual, ausJ: 0, ausS: 0, areas: {} }\n          }\n          if (!mapa[estudiante].areas[area]) {\n            mapa[estudiante].areas[area] = { asignaturas: {} }\n          }\n          if (!mapa[estudiante].areas[area].asignaturas[asignatura]) {\n            mapa[estudiante].areas[area].asignaturas[asignatura] = {\n              asignatura,\n              periodos: {},\n              orden,\n              idTipoEspecialidad,\n              porcentaje,\n              pesos: { 1: this.datosSeccion.pesoP1, 2: this.datosSeccion.pesoP2, 3: this.datosSeccion.pesoP3, 4: this.datosSeccion.pesoP4 }\n            }\n          }\n          let notaFinal = 0\n          if (orden === 99) {\n            if (this.datosSeccion.tipoValComp == 1) {\n              notaFinal = definitiva\n            } else {\n              notaFinal = definitivacompor != null ? definitivacompor : ''\n            }\n          } else {\n            if (this.idNivel == 1) {\n              notaFinal = definitivapree != null && definitivapree != 0 && definitivapree != '' ? definitivapree : ''\n            } else {\n              notaFinal = recuperacion > definitiva ? recuperacion : definitiva\n            }\n          }\n          mapa[estudiante].areas[area].asignaturas[asignatura].periodos[periodo] = notaFinal\n          mapa[estudiante].ausJ += ausJ || 0\n          mapa[estudiante].ausS += ausS || 0\n        })\n        return mapa\n      },\n      totalColumnasPromedioArea() {\n        const areasUnicas = new Set(this.listaAreasAsignaturas.map(a => a.area))\n        return areasUnicas.size\n      },\n      puestosPorEstudiante() {\n        const lista = Object.entries(this.estudiantesNotas).map(([nombre, areas]) => {\n          const promedio = parseFloat(this.calcularPromedioGeneral(areas))\n          return { nombre, promedio: isNaN(promedio) ? 0 : promedio }\n        })\n        // Ordenar de mayor a menor\n        lista.sort((a, b) => b.promedio - a.promedio)\n        const puestos = {}\n        let puestoActual = 1\n        let contador = 1\n        let ultimoPromedio = null\n        lista.forEach(est => {\n          if (est.promedio !== ultimoPromedio) {\n            puestoActual = contador\n            ultimoPromedio = est.promedio\n            contador++\n          }\n          puestos[est.nombre] = puestoActual\n          //contador++\n        })\n        return puestos\n      },\n      encabezadoPorArea() {\n        const mapa = {}\n        this.listaAreasAsignaturas.forEach(({ area, asignatura }) => {\n          if (!mapa[area]) mapa[area] = []\n          mapa[area].push(asignatura)\n        })\n        return mapa\n      },\n    },\n    beforeMount() {\n      this.ocuparComboSedes()\n      this.ocuparComboPeriodos()\n      this.datosSeccion = this.$store.state.datosSecciones[this.$store.state.idSeccion - 1]\n      //console.log(JSON.stringify(this.datosSeccion))\n    }\n  }\n</script>\n<style scoped>\n  table {\n    border-collapse: collapse;\n    width: 100%;\n    text-align: center;\n    font-size: 10px;\n  }\n  th {\n    background: #eee;\n  }\n  .nota-recuperada {\n    border: 2px solid #ffa500;\n    box-shadow: 0 0 5px #ffa500;\n  }\n  .desempeno-bajo { background-color: #f8d7da; color: #721c24; }\n  .desempeno-basico { background-color: #d1ecf1; color: #0c5460; }\n  .desempeno-alto { background-color: #fff3cd; color: #856404; }\n  .desempeno-superior { background-color: #d4edda; color: #155724; }\n  .desempeno-extra { background-color: #f4ecf5; color: #2f2e2e; }\n  .promedio-area {\n    background-color: #f2f2f2;\n    font-weight: bold;\n    text-align: center;\n  }\n  .bloque-area th,\n  .bloque-area td {\n    border-right: 3px solid #999; /* lnea divisoria entre reas */\n  }\n\n</style>\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ResumenFinalAsigPerdidas.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ResumenFinalAsigPerdidas.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ResumenFinalAsigPerdidas.vue?vue&type=template&id=4d1f46c6&scoped=true&\"\nimport script from \"./ResumenFinalAsigPerdidas.vue?vue&type=script&lang=js&\"\nexport * from \"./ResumenFinalAsigPerdidas.vue?vue&type=script&lang=js&\"\nimport style0 from \"./ResumenFinalAsigPerdidas.vue?vue&type=style&index=0&id=4d1f46c6&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"4d1f46c6\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('b-row',{staticClass:\"mt-2\"},[_c('b-col',{attrs:{\"lg\":\"12\"}},[_c('b-card',{scopedSlots:_vm._u([{key:\"header\",fn:function(){return [_c('h5',{staticClass:\"mb-0\"},[_c('b-icon',{attrs:{\"icon\":\"card-checklist\",\"aria-hidden\":\"true\"}}),_vm._v(\" CONSOLIDADO EVALUACIONES FINALES DE AREAS\")],1)]},proxy:true}])},[_c('b-card-text',[_c('b-row',[_c('b-col',{attrs:{\"lg\":\"6\"}},[_c('b-form-group',{staticClass:\"etiqueta\",attrs:{\"label\":\"Seleccione la Sede:\",\"label-for\":\"sedes\"}},[_c('b-form-select',{ref:\"sedes\",attrs:{\"id\":\"sedes\",\"options\":_vm.comboSedes},on:{\"change\":function($event){_vm.idCurso=null,_vm.ocuparComboCursosSede()}},model:{value:(_vm.idSede),callback:function ($$v) {_vm.idSede=$$v},expression:\"idSede\"}})],1)],1),_c('b-col',{attrs:{\"lg\":\"4\"}},[_c('b-form-group',{staticClass:\"etiqueta\",attrs:{\"label\":\"Seleccione el Curso:\",\"label-for\":\"cursos\"}},[_c('b-form-select',{ref:\"cursos\",attrs:{\"id\":\"cursos\",\"options\":_vm.comboCursosSede,\"disabled\":_vm.idSede!=null ? false : true},on:{\"change\":function($event){return _vm.consultarEstudiantes()}},model:{value:(_vm.idCurso),callback:function ($$v) {_vm.idCurso=$$v},expression:\"idCurso\"}})],1)],1)],1)],1)],1)],1)],1),_c('b-row',[_c('b-col',{attrs:{\"lg\":\"12\"}},[(_vm.btnCargando)?_c('div',[_c('div',{staticClass:\"text-center m-5 text-primary\"},[_c('b-spinner',{staticStyle:{\"width\":\"3rem\",\"height\":\"3rem\"},attrs:{\"label\":\"Spinner\"}}),_c('br'),_c('strong',[_vm._v(\"Cargando informe...\")])],1)]):_vm._e()])],1),(!_vm.btnCargando && _vm.idCurso!=null)?_c('b-row',[_c('b-col',{attrs:{\"lg\":\"12\"}},[_c('table',{staticClass:\"table-responsive\",attrs:{\"border\":\"1\",\"cellspacing\":\"0\",\"cellpadding\":\"1\"}},[_c('thead',[_c('tr',[_c('th',{attrs:{\"rowspan\":\"3\"}},[_vm._v(\"#\")]),_c('th',{attrs:{\"rowspan\":\"3\"}},[_vm._v(\"Estudiante\")]),_vm._l((_vm.encabezadoPorArea),function(asigs,area){return [_c('th',{key:area,attrs:{\"colspan\":_vm.colspanArea(area)}},[_vm._v(\" \"+_vm._s(area)+\" \")])]}),_c('th',{attrs:{\"rowspan\":\"3\"}},[_vm._v(\"PRO GEN\")]),_c('th',{attrs:{\"rowspan\":\"3\"}},[_vm._v(\"Tot\"),_c('br'),_vm._v(\"Area\"),_c('br'),_vm._v(\"Baj\")]),_c('th',{attrs:{\"rowspan\":\"3\"}},[_vm._v(\"Tot\"),_c('br'),_vm._v(\"Area\"),_c('br'),_vm._v(\"Bas\")]),_c('th',{attrs:{\"rowspan\":\"3\"}},[_vm._v(\"Tot\"),_c('br'),_vm._v(\"Area\"),_c('br'),_vm._v(\"Alt\")]),_c('th',{attrs:{\"rowspan\":\"3\"}},[_vm._v(\"Tot\"),_c('br'),_vm._v(\"Area\"),_c('br'),_vm._v(\"Sup\")]),_c('th',{attrs:{\"rowspan\":\"3\"}},[_vm._v(\"Tot\"),_c('br'),_vm._v(\"AuJ\")]),_c('th',{attrs:{\"rowspan\":\"3\"}},[_vm._v(\"Tot\"),_c('br'),_vm._v(\"AuS\")]),_c('th',{attrs:{\"rowspan\":\"3\"}},[_vm._v(\"Puesto\")]),_c('th',{attrs:{\"rowspan\":\"3\"}},[_vm._v(\"#\")])],2),_c('tr',[_vm._l((_vm.encabezadoPorArea),function(asigs,area){return [_vm._l((asigs),function(asig,k){return [_c('th',{key:'area-' + asig + k,attrs:{\"colspan\":_vm.periodosVisibles.length + 1}},[_vm._v(\" \"+_vm._s(asig)+\" \")])]}),_c('th',{key:'prom-area-' + area,staticClass:\"promedio-area\"},[_vm._v(\"PRO AR\")])]})],2),_c('tr',[_vm._l((_vm.encabezadoPorArea),function(asigs,area){return [_vm._l((asigs),function(asig){return [_vm._l((_vm.periodosVisibles),function(p){return _c('th',{key:'h' + area + asig + p},[_vm._v(\" P\"+_vm._s(p)+\" \")])}),_c('th',{key:'prom' + asig + area},[_vm._v(\"PR\")])]}),_c('th',{key:'prom' + area})]})],2)]),_c('tbody',[_vm._l((_vm.estudiantesNotas),function(est,nombre,i){return _c('tr',{key:nombre},[_c('td',{staticClass:\"text-left\"},[_vm._v(_vm._s(i + 1))]),_c('td',{staticStyle:{\"text-align\":\"left\"}},[_vm._v(_vm._s(nombre))]),_vm._l((_vm.encabezadoPorArea),function(asigs,area){return [_vm._l((asigs),function(asig){return [_vm._l((_vm.periodosVisibles),function(p){return _c('td',{key:nombre + area + asig + p},[_vm._v(\" \"+_vm._s(est.id_conceptual=='N' ? _vm.obtenerNota(est, area, asig, p) : '-')+\" \")])}),_c('td',{key:'prom' + nombre + area + asig,staticClass:\"bloque-area\",staticStyle:{\"font-weight\":\"bold\",\"text-align\":\"center\"}},[_vm._v(\" \"+_vm._s(est.id_conceptual=='N' ? _vm.obtenerPromedioAsignatura(est, area, asig) : '-')+\" \")])]}),_c('td',{key:'promArea' + nombre + area,staticClass:\"promedio-area bloque-area\"},[_vm._v(\" \"+_vm._s(est.id_conceptual=='N' ? _vm.obtenerPromedioArea(est, area) : '-')+\" \")])]}),_c('td',[_vm._v(_vm._s(est.id_conceptual=='N' ? _vm.calcularPromedioGeneral(est) : '-'))]),_c('td',[_vm._v(_vm._s(est.id_conceptual=='N' ? _vm.contarDesempenoEstudianteArea(est, 'bajo') : '-'))]),_c('td',[_vm._v(_vm._s(est.id_conceptual=='N' ? _vm.contarDesempenoEstudianteArea(est, 'basico') : '-'))]),_c('td',[_vm._v(_vm._s(est.id_conceptual=='N' ? _vm.contarDesempenoEstudianteArea(est, 'alto') : '-'))]),_c('td',[_vm._v(_vm._s(est.id_conceptual=='N' ? _vm.contarDesempenoEstudianteArea(est, 'superior') : '-'))]),_c('td',[_vm._v(_vm._s(est.id_conceptual=='N' ? est.ausJ : '-'))]),_c('td',[_vm._v(_vm._s(est.id_conceptual=='N' ? est.ausS : '-'))]),_c('td',[_vm._v(_vm._s(est.id_conceptual=='N' ? _vm.iconoPuesto(_vm.puestosPorEstudiante[nombre]) : '-')+\" \"+_vm._s(est.id_conceptual=='N' ? _vm.puestosPorEstudiante[nombre] : '-'))]),_c('td',{staticClass:\"text-left\"},[_vm._v(_vm._s(i + 1))])],2)}),_c('tr',{staticStyle:{\"background-color\":\"#f0f0f0\",\"font-weight\":\"bold\"}},[_c('td',{attrs:{\"colspan\":\"2\"}},[_vm._v(\"Total Bajos\")]),_vm._l((_vm.encabezadoPorArea),function(asigs,area){return [_vm._l((asigs),function(asig){return [_vm._l((_vm.periodosVisibles),function(p){return _c('td',{key:'bp' + area + asig + p},[_vm._v(\" \"+_vm._s(_vm.totalBajosPorPeriodo(area, asig, p))+\" \")])}),_c('td',{key:'bj' + area + asig},[_vm._v(\" \"+_vm._s(_vm.totalBajosPromedioAsignatura(area, asig))+\" \")])]}),_c('td',{key:'bja' + area,staticClass:\"promedio-area\"},[_vm._v(\" \"+_vm._s(_vm.totalBajosPromedioArea(area))+\" \")])]}),_c('td'),_vm._v(\" \"),_c('td',[_vm._v(_vm._s(_vm.totales.bajo))]),_c('td',[_vm._v(_vm._s(_vm.totales.basico))]),_c('td',[_vm._v(_vm._s(_vm.totales.alto))]),_c('td',[_vm._v(_vm._s(_vm.totales.superior))]),_c('td',[_vm._v(_vm._s(_vm.totales.ausJ))]),_c('td',[_vm._v(_vm._s(_vm.totales.ausS))]),_c('td'),_vm._v(\" \"),_c('td')],2)],2)]),_c('div',{staticStyle:{\"margin-bottom\":\"1rem\"}},[_c('b-button',{staticClass:\"small mx-1 mt-3\",attrs:{\"variant\":\"primary\"},on:{\"click\":_vm.imprimir}},[_vm._v(\"Imprimir Consolidado\")]),_c('b-button',{staticClass:\"small mx-1 mt-3\",attrs:{\"variant\":\"outline-primary\"},on:{\"click\":_vm.exportarAExcel}},[_vm._v(\"Exportar a Excel\")])],1)])],1):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div>\n    <b-row class=\"mt-2\">\n      <b-col lg=\"12\">\n        <b-card>\n          <template #header>\n            <h5 class=\"mb-0\"><b-icon icon=\"card-checklist\" aria-hidden=\"true\"></b-icon> CONSOLIDADO EVALUACIONES FINALES DE AREAS</h5>\n          </template>\n          <b-card-text>\n            <b-row>\n              <!--\n              <b-col lg=\"2\">\n                <b-form-group label=\"Periodo:\" label-for=\"periodo\" class=\"etiqueta\">\n                  <b-form-select id=\"periodo\" ref=\"periodo\" v-model=\"idPeriodo\" :options=\"comboPeriodos\" @change=\"idSede=null,idCurso=null\"></b-form-select>\n                </b-form-group>\n              </b-col>\n              -->\n              <b-col lg=\"6\">\n                <b-form-group label=\"Seleccione la Sede:\" label-for=\"sedes\" class=\"etiqueta\">\n                  <b-form-select  id=\"sedes\" ref=\"sedes\" v-model=\"idSede\" :options=\"comboSedes\" @change=\"idCurso=null,ocuparComboCursosSede()\"></b-form-select>\n                </b-form-group>\n              </b-col>\n              <b-col lg=\"4\">\n                <b-form-group label=\"Seleccione el Curso:\" label-for=\"cursos\" class=\"etiqueta\">\n                  <b-form-select id=\"cursos\" ref=\"cursos\" v-model=\"idCurso\" :options=\"comboCursosSede\" @change=\"consultarEstudiantes()\" :disabled=\"idSede!=null ? false : true\"></b-form-select>\n                </b-form-group>\n              </b-col>\n            </b-row>\n          </b-card-text>\n        </b-card>\n      </b-col>\n    </b-row>\n    <b-row>\n      <b-col lg=\"12\">\n        <div v-if=\"btnCargando\">\n          <div class=\"text-center m-5 text-primary\">\n            <b-spinner style=\"width: 3rem; height: 3rem;\" label=\"Spinner\"></b-spinner>\n            <br><strong>Cargando informe...</strong>\n          </div>\n        </div>\n      </b-col>\n    </b-row>\n    <b-row v-if=\"!btnCargando && idCurso!=null\">\n      <b-col lg=\"12\">\n        <table border=\"1\" cellspacing=\"0\" cellpadding=\"1\" class=\"table-responsive\">\n          <thead>\n            <tr>\n              <th rowspan=\"3\">#</th>\n              <th rowspan=\"3\">Estudiante</th>\n              <template v-for=\"(asigs, area) in encabezadoPorArea\">\n                <th :colspan=\"colspanArea(area)\" :key=\"area\">\n                  {{ area }}\n                </th>\n              </template>\n              <th rowspan=\"3\">PRO GEN</th>\n              <th rowspan=\"3\">Tot<br>Area<br>Baj</th>\n              <th rowspan=\"3\">Tot<br>Area<br>Bas</th>\n              <th rowspan=\"3\">Tot<br>Area<br>Alt</th>\n              <th rowspan=\"3\">Tot<br>Area<br>Sup</th>\n              <th rowspan=\"3\">Tot<br>AuJ</th>\n              <th rowspan=\"3\">Tot<br>AuS</th>\n              <th rowspan=\"3\">Puesto</th>\n              <th rowspan=\"3\">#</th>\n            </tr>\n            <tr>\n              <template v-for=\"(asigs, area) in encabezadoPorArea\">\n                <template v-for=\"(asig, k) in asigs\">\n                  <th :colspan=\"periodosVisibles.length + 1\" :key=\"'area-' + asig + k\">\n                    {{ asig }}\n                  </th>\n                </template>\n                <th class=\"promedio-area\" :key=\"'prom-area-' + area\">PRO AR</th>\n              </template>\n            </tr>\n            <tr>\n              <template v-for=\"(asigs, area) in encabezadoPorArea\">\n                <template v-for=\"asig in asigs\">\n                  <th v-for=\"p in periodosVisibles\" :key=\"'h' + area + asig + p\">\n                    P{{ p }}\n                  </th>\n                  <th :key=\"'prom' + asig + area\">PR</th>\n                </template>\n                <th :key=\"'prom' + area\"></th>\n              </template>\n              <!-- columnas finales vacas -->\n            </tr>\n          </thead>\n          <tbody>\n            <tr v-for=\"(est, nombre, i) in estudiantesNotas\" :key=\"nombre\">\n              <td class=\"text-left\">{{ i + 1 }}</td>\n              <td style=\"text-align: left\">{{ nombre }}</td>\n              <template v-for=\"(asigs, area) in encabezadoPorArea\">\n                <template v-for=\"asig in asigs\">\n                  <td v-for=\"p in periodosVisibles\"  :key=\"nombre + area + asig + p\">\n                    {{ est.id_conceptual=='N' ? obtenerNota(est, area, asig, p) : '-' }}\n                  </td>\n                  <td class=\"bloque-area\" :key=\"'prom' + nombre + area + asig\" style=\"font-weight: bold; text-align: center;\">\n                    {{ est.id_conceptual=='N' ? obtenerPromedioAsignatura(est, area, asig) : '-' }}\n                  </td>\n                </template>\n                <td class=\"promedio-area bloque-area\" :key=\"'promArea' + nombre + area\">\n                  {{ est.id_conceptual=='N' ? obtenerPromedioArea(est, area) : '-' }}\n                </td>\n              </template>\n\n              <td>{{ est.id_conceptual=='N' ? calcularPromedioGeneral(est) : '-' }}</td>\n              <td>{{ est.id_conceptual=='N' ? contarDesempenoEstudianteArea(est, 'bajo') : '-' }}</td>\n              <td>{{ est.id_conceptual=='N' ? contarDesempenoEstudianteArea(est, 'basico') : '-' }}</td>\n              <td>{{ est.id_conceptual=='N' ? contarDesempenoEstudianteArea(est, 'alto') : '-' }}</td>\n              <td>{{ est.id_conceptual=='N' ? contarDesempenoEstudianteArea(est, 'superior') : '-' }}</td>\n              <td>{{ est.id_conceptual=='N' ? est.ausJ : '-' }}</td>\n              <td>{{ est.id_conceptual=='N' ? est.ausS : '-' }}</td>\n              <td>{{ est.id_conceptual=='N' ? iconoPuesto(puestosPorEstudiante[nombre]) : '-' }} {{ est.id_conceptual=='N' ? puestosPorEstudiante[nombre] : '-' }}</td>\n              <td class=\"text-left\">{{ i + 1 }}</td>\n            </tr>\n            <tr style=\"background-color: #f0f0f0; font-weight: bold;\">\n              <td colspan=\"2\">Total Bajos</td>\n              <template v-for=\"(asigs, area) in encabezadoPorArea\">\n                <template v-for=\"asig in asigs\">\n                  <!-- Bajos por periodo -->\n                  <td v-for=\"p in periodosVisibles\" :key=\"'bp' + area + asig + p\">\n                    {{ totalBajosPorPeriodo(area, asig, p) }}\n                  </td>\n                  <!-- Bajos por promedio de asignatura -->\n                  <td :key=\"'bj' + area + asig\">\n                    {{ totalBajosPromedioAsignatura(area, asig) }}\n                  </td>\n                </template>\n                <!-- Bajos por promedio de rea -->\n                <td  :key=\"'bja' + area\" class=\"promedio-area\">\n                  {{ totalBajosPromedioArea(area) }}\n                </td>\n              </template>\n              <td></td> <!-- Prom. General -->\n              <td>{{ totales.bajo }}</td>\n              <td>{{ totales.basico }}</td>\n              <td>{{ totales.alto }}</td>\n              <td>{{ totales.superior }}</td>\n              <td>{{ totales.ausJ }}</td>\n              <td>{{ totales.ausS }}</td>\n              <td></td> <!-- Puesto -->\n              <td></td>\n            </tr>\n          </tbody>\n        </table>\n        <div style=\"margin-bottom: 1rem\">\n          <b-button class=\"small mx-1 mt-3\" variant=\"primary\" @click=\"imprimir\">Imprimir Consolidado</b-button>\n          <b-button class=\"small mx-1 mt-3\" variant=\"outline-primary\" @click=\"exportarAExcel\">Exportar a Excel</b-button>\n        </div>\n      </b-col>\n    </b-row>\n  </div>\n</template>\n\n<script>\n  import axios from \"axios\"\n  import * as CONFIG from '@/assets/config.js'\n  import * as XLSX from 'xlsx'\n\n  export default {\n    name: 'consolidadopromedio',\n    components: {\n    },\n    data () {\n      return {\n        idSede: null,\n        comboSedes: [],\n        idPeriodo: 5,\n        comboPeriodos: null,\n        idCurso: null,\n        comboCursosSede: [],\n        nombreSede: null,\n        nombreCurso: null,\n        idNivel: null,\n        btnCargando: false,\n        datosRaw: [],\n        datosSeccion: {},\n        listaAreasAsignaturas: [],\n        periodosVisibles: []\n      }\n    },\n    methods: {\n      colspanArea(area) {\n        const asignaturas = this.encabezadoPorArea[area] || []\n        const columnasPorAsignatura = this.periodosVisibles.length + 1\n        const extraColumnaPromArea = 1\n        return (asignaturas.length * columnasPorAsignatura) + extraColumnaPromArea\n      },\n\n      totalBajosPorPeriodo(area, asignatura, periodo) {\n        let total = 0\n        const meta = this.listaAreasAsignaturas.find(\n          a => a.area === area && a.asignatura === asignatura\n        )\n        const idTipoEspecialidad = meta?.idTipoEspecialidad\n        Object.values(this.estudiantesNotas).forEach(est => {\n          const nota = est?.areas?.[area]?.asignaturas?.[asignatura]?.periodos?.[periodo]\n          if (idTipoEspecialidad === 1) {\n            if (nota > 0 && nota < this.datosSeccion.minBas) total++\n          } else {\n            if (nota > 0 && nota < this.datosSeccion.minBasT) total++\n          }\n        })\n        return total\n      },\n      totalBajosPromedioAsignatura(area, asignatura) {\n        let total = 0\n        const meta = this.listaAreasAsignaturas.find(\n          a => a.area === area && a.asignatura === asignatura\n        )\n        const idTipoEspecialidad = meta?.idTipoEspecialidad\n        Object.values(this.estudiantesNotas).forEach(est => {\n          const asig = est?.areas?.[area]?.asignaturas?.[asignatura]\n          if (!asig) return\n          const prom = parseFloat(this.calcularPromedioAsignatura(asig))\n          if (idTipoEspecialidad === 1) {\n            if (prom < this.datosSeccion.minBas) total++\n          } else {\n            if (prom < this.datosSeccion.minBasT) total++\n          }\n        })\n        return total\n      },\n      totalBajosPromedioArea(area) {\n        let total = 0\n        Object.values(this.estudiantesNotas).forEach(est => {\n          const prom = parseFloat(this.obtenerPromedioArea(est, area))\n          if (!isNaN(prom) && prom < this.datosSeccion.minBas) total++\n        })\n        return total\n      },\n      totalesGlobales() {\n        let bajo = 0, basico = 0, alto = 0, superior = 0, ausJ = 0, ausS = 0\n        Object.values(this.estudiantesNotas).forEach(est => {\n          bajo += this.contarDesempenoEstudianteArea(est, 'bajo')\n          basico += this.contarDesempenoEstudianteArea(est, 'basico')\n          alto += this.contarDesempenoEstudianteArea(est, 'alto')\n          superior += this.contarDesempenoEstudianteArea(est, 'superior')\n          ausJ += est.ausJ || 0\n          ausS += est.ausS || 0\n        })\n\n        return { bajo, basico, alto, superior, ausJ, ausS }\n      },\n      esAreaValida(area) {\n        //const asigns = this.listaAreasAsignaturas.filter(a => a.area === area)\n        //return asigns.some(a => a.orden !== 99)\n        const asigns = this.listaAreasAsignaturas.filter(a => a.area === area)\n        if (asigns.some(a => a.orden !== 99 && a.orden !== 98)) return true\n        else if (asigns.some(a => a.orden === 99) && this.datosSeccion.promCompor == 1) return true\n        else return false\n      },\n      obtenerPromedioArea(est, area) {\n        const areaData = est.areas && est.areas[area]\n        return areaData ? this.calcularPromedioArea(areaData) : ''\n      },\n      obtenerNota(est, area, asignatura, periodo) {\n        let nota = est?.areas?.[area]?.asignaturas?.[asignatura]?.periodos?.[periodo]\n        if (nota === 0) nota = ''\n        return typeof nota === 'number' ? nota.toFixed(1) : nota\n      },\n      obtenerPromedioAsignatura(est, area, asignatura) {\n        const asig = est?.areas?.[area]?.asignaturas?.[asignatura]\n        return asig ? this.calcularPromedioAsignatura(asig) : ''\n      },\n      calcularPromedioAsignatura(asig) {\n        const pesos = asig.pesos\n        const periodos = asig.periodos\n        const orden = asig.orden\n        if (orden === 99 && this.datosSeccion.promCompor == 0) return '-'\n        let total = 0\n        if (this.$store.state.idInstitucion == 'acaa36d0-fcb1-11ec-8267-536b07c743c4') { // Emiliani\n          if( orden == 12) {\n            let cantidad = 0 \n            for (let p = 1; p <= 4; p++) {\n              const nota = periodos[p] ?? 0\n              if (nota > 0) {\n                total += nota\n                cantidad++\n              }\n            }\n            if (total === 0) return ''\n            total = total / cantidad\n            return this.redondear(total).toFixed(1) > 0 ? this.redondear(total).toFixed(1) : ''\n          } else {\n            for (let p = 1; p <= 4; p++) {\n              const nota = periodos[p] ?? 0\n              total += nota * pesos[p] / 100\n            }\n            return this.redondear(total).toFixed(1) > 0 ? this.redondear(total).toFixed(1) : ''\n          }\n        } else if (this.$store.state.idInstitucion == 'eb58bf60-fc83-11ec-a1d1-1dc2835404e5') { // Inem\n          if (orden == 55) {\n            let cantidad = 0 // nuevo\n            for (let p = 1; p <= 4; p++) {\n              const nota = periodos[p] ?? 0\n              if (nota > 0) {\n                total += nota\n                cantidad++\n              }\n            }\n            if (total === 0) return ''\n            total = total / cantidad\n            return this.redondear(total).toFixed(1) > 0 ? this.redondear(total).toFixed(1) : ''\n          } else {\n            for (let p = 1; p <= 4; p++) {\n              const nota = periodos[p] ?? 0\n              total += nota * pesos[p] / 100\n            }\n            return this.redondear(total).toFixed(1) > 0 ? this.redondear(total).toFixed(1) : ''\n          }\n        } else if (this.$store.state.idInstitucion == 'c50f3d80-fca0-11ec-8267-536b07c743c4') { // Silvino\n          const nota = periodos[5] ?? 0\n          return nota > 0 ? nota.toFixed(1) : ''\n        } else if (this.$store.state.idInstitucion == '8a1bd1e0-fcb2-11ec-8267-536b07c743c4') { // Libertador\n          const nota = periodos[5] ?? 0\n          return nota > 0 ? nota.toFixed(1) : ''\n        } else {\n          let cantidad = 0 \n          for (let p = 1; p <= 4; p++) {\n            const nota = periodos[p] ?? 0\n            if (nota > 0) {\n              total += nota\n              cantidad++\n            }\n          }\n          if (total === 0) return ''\n          const promedio = total / cantidad\n          return this.redondear(promedio).toFixed(1) > 0 ? this.redondear(promedio).toFixed(1) : ''\n        }\n      },\n      calcularPromedioArea(areaData) {\n        const asigns = Object.values(areaData.asignaturas)\n        if (!asigns.length) return '0.00'\n        let total = 0\n        asigns.forEach(asig => {\n          if (asig.orden === 99 && this.datosSeccion.promCompor == 0) return '-'\n          total += parseFloat((this.calcularPromedioAsignatura(asig) * asig.porcentaje) / 100)\n        })\n        return total > 0 ? this.redondear(total).toFixed(1) : ''\n      },\n      contarDesempenoEstudianteArea(est, tipo) {\n        const areas = Object.keys(est.areas || {})\n        let contador = 0\n        areas.forEach(area => {\n          if (!this.esAreaValida(area)) return\n          const meta = this.listaAreasAsignaturas.find( a => a.area === area)\n          const idTipoEspecialidadArea = meta?.idTipoArea\n          const promedio = parseFloat(this.calcularPromedioArea(est.areas[area]))\n          if (!isNaN(promedio)) {\n            if (idTipoEspecialidadArea === 1) {\n              if (tipo === 'bajo' && promedio < this.datosSeccion.minBas) contador++\n              else if (tipo === 'basico' && promedio >= this.datosSeccion.minBas && promedio < this.datosSeccion.minAlt) contador++\n              else if (tipo === 'alto' && promedio >= this.datosSeccion.minAlt && promedio < this.datosSeccion.minSup) contador++\n              else if (tipo === 'superior' && promedio >= this.datosSeccion.minSup && promedio <= this.datosSeccion.maxSup) contador++\n            } else {\n              if (tipo === 'bajo' && promedio < this.datosSeccion.minBasT) contador++\n              else if (tipo === 'basico' && promedio >= this.datosSeccion.minBasT && promedio < this.datosSeccion.minAltT) contador++\n              else if (tipo === 'alto' && promedio >= this.datosSeccion.minAltT && promedio < this.datosSeccion.minSupT) contador++\n              else if (tipo === 'superior' && promedio >= this.datosSeccion.minSupT && promedio <= this.datosSeccion.maxSupT) contador++\n            }\n          }\n        })\n        return contador\n      },\n      calcularPromedioGeneral(est) {\n        const areas = Object.keys(est.areas || {})\n        let total = 0\n        let cantidad = 0\n        areas.forEach(area => {\n          if (!this.esAreaValida(area)) return\n          const promedio = parseFloat(this.calcularPromedioArea(est.areas[area]))\n          if (!isNaN(promedio)) {\n            total += promedio\n            cantidad++\n          }\n        })\n        return cantidad > 0 ? (total / cantidad).toFixed(3) : ''\n      },\n      contarAusencias(tipo) {\n        let total = 0\n        Object.values(this.estudiantesNotas).forEach(est => {\n          if (tipo === 'ausJ') total += est.ausJ || 0\n          if (tipo === 'ausS') total += est.ausS || 0\n        })\n        return total\n      },\n      contarNotasPorAsignatura(area, asignatura, tipo) {\n        let contador = 0\n        Object.values(this.estudiantesNotas).forEach(est => {\n          const nota = est?.[area]?.[asignatura]?.nota\n          const val = est?.[area]?.[asignatura]?.idTipoEspecialidad\n          if (typeof nota !== 'number') return\n          if (val === 1) {\n            if (tipo === 'bajo' && nota < this.datosSeccion.minBas) contador++\n            else if (tipo === 'basico' && nota >= this.datosSeccion.minBas && nota < this.datosSeccion.minAlt) contador++\n            else if (tipo === 'alto' && nota >= this.datosSeccion.minAlt && nota < this.datosSeccion.minSup) contador++\n            else if (tipo === 'superior' && nota >= this.datosSeccion.minSup && nota <= this.datosSeccion.maxSup) contador++\n          } else {\n            if (tipo === 'bajo' && nota < this.datosSeccion.minBasT) contador++\n            else if (tipo === 'basico' && nota >= this.datosSeccion.minBasT && nota < this.datosSeccion.minAltT) contador++\n            else if (tipo === 'alto' && nota >= this.datosSeccion.minAltT && nota < this.datosSeccion.minSupT) contador++\n            else if (tipo === 'superior' && nota >= this.datosSeccion.minSupT && nota <= this.datosSeccion.maxSupT) contador++\n          }\n        })\n        return contador\n      },\n      contarNotasTotales(tipo) {\n        let total = 0\n        Object.values(this.estudiantesNotas).forEach(est => {\n          this.listaAreasAsignaturas.forEach(({ area, asignatura }) => {\n            const nota = est?.[area]?.[asignatura]?.nota\n            const val = est?.[area]?.[asignatura]?.idTipoEspecialidad\n            if (typeof nota !== 'number') return\n            if (val === 1) {\n              if (tipo === 'bajo' && nota < this.datosSeccion.minBas) total++\n              else if (tipo === 'basico' && nota >= this.datosSeccion.minBas && nota < this.datosSeccion.minAlt) total++\n              else if (tipo === 'alto' && nota >= this.datosSeccion.minAlt && nota < this.datosSeccion.minSup) total++\n              else if (tipo === 'superior' && nota >= this.datosSeccion.minSup && nota <= this.datosSeccion.maxSup) total++\n            } else {\n              if (tipo === 'bajo' && nota < this.datosSeccion.minBasT) total++\n              else if (tipo === 'basico' && nota >= this.datosSeccion.minBasT && nota < this.datosSeccion.minAltT) total++\n              else if (tipo === 'alto' && nota >= this.datosSeccion.minAltT && nota < this.datosSeccion.minSupT) total++\n              else if (tipo === 'superior' && nota >= this.datosSeccion.minSupT && nota <= this.datosSeccion.maxSupT) total++\n            }\n          })\n        })\n        return total\n      },\n      iconoPuesto(puesto) {\n        if (puesto === 1) return ''\n        if (puesto === 2) return ''\n        if (puesto === 3) return ''\n        return ''\n      },\n      contarDesempenoEstudiante(areas, tipo) {\n        let contador = 0\n        Object.values(areas || {}).forEach(area => {\n          Object.values(area.asignaturas || {}).forEach(asig => {\n            const nota = parseFloat(this.calcularPromedioAsignatura(asig))\n            const val =  asig.idTipoEspecialidad\n            const orden =  asig.orden\n            if (this.$store.state.idInstitucion == 'eb58bf60-fc83-11ec-a1d1-1dc2835404e5' && orden == 90) return // No se tiene en cuenta el area de Inem Exploracion vocacional - Complementaria\n            if (this.$store.state.idInstitucion == '097b7b10-fcaa-11ec-8267-536b07c743c4' && orden == 98) return // No se tiene en cuenta el area de Rural Proyectos Profundizacion\n            if (typeof nota !== 'number') return\n            if (val === 1) {\n              if (tipo === 'bajo' && nota < this.datosSeccion.minBas) contador++\n              else if (tipo === 'basico' && nota >= this.datosSeccion.minBas && nota < this.datosSeccion.minAlt) contador++\n              else if (tipo === 'alto' && nota >= this.datosSeccion.minAlt && nota < this.datosSeccion.minSup) contador++\n              else if (tipo === 'superior' && nota >= this.datosSeccion.minSup && nota <= this.datosSeccion.maxSup) contador++\n            } else {\n              if (tipo === 'bajo' && nota < this.datosSeccion.minBasT) contador++\n              else if (tipo === 'basico' && nota >= this.datosSeccion.minBasT && nota < this.datosSeccion.minAltT) contador++\n              else if (tipo === 'alto' && nota >= this.datosSeccion.minAltT && nota < this.datosSeccion.minSupT) contador++\n              else if (tipo === 'superior' && nota >= this.datosSeccion.minSupT && nota <= this.datosSeccion.maxSupT) contador++\n            }\n          })\n        })\n        return contador\n      },\n      fueRecuperada(areas, area, asig) {\n        return areas?.[area]?.[asig]?.fueRecuperada ?? false\n      },\n      obtenerOriginal(areas, area, asig) {\n        const val = areas?.[area]?.[asig]?.original\n        return typeof val === 'number' ? val.toFixed(1) : '0.0'\n      },\n      obtenerRecuperacion(areas, area, asig) {\n        const val = areas?.[area]?.[asig]?.recuperacion\n        return typeof val === 'number' ? val.toFixed(1) : '0.0'\n      },\n      obtenerColor(nota, areas, area, asig) {\n        const val = areas?.[area]?.[asig]?.idTipoEspecialidad\n        if (val === 1) {\n          if (nota < this.datosSeccion.minBas) return 'desempeno-bajo'\n          if (nota < this.datosSeccion.minAlt) return 'desempeno-basico'\n          if (nota < this.datosSeccion.minSup) return 'desempeno-alto'\n          if (nota <= this.datosSeccion.maxSup) return 'desempeno-superior'\n          return 'desempeno-extra'\n        } else {\n          if (nota < this.datosSeccion.minBasT) return 'desempeno-bajo'\n          if (nota < this.datosSeccion.minAltT) return 'desempeno-basico'\n          if (nota < this.datosSeccion.minSupT) return 'desempeno-alto'\n          if (nota <= this.datosSeccion.maxSupT) return 'desempeno-superior'\n          return 'desempeno-extra'\n        }\n      },\n      claseDesempeno(nota) {\n        console.log(nota)\n        if (typeof nota !== 'number') return 'desempeno-extra'\n        if (nota < 3) return 'desempeno-bajo'\n        if (nota < 4) return 'desempeno-basico'\n        if (nota < 4.6) return 'desempeno-alto'\n        if (nota <= 5) return 'desempeno-superior'\n        return 'desempeno-extra'\n      },\n      obtenerColorGeneral(nota) {\n        if (nota < this.datosSeccion.minBas) return 'desempeno-bajo'\n        if (nota < this.datosSeccion.minAlt) return 'desempeno-basico'\n        if (nota < this.datosSeccion.minSup) return 'desempeno-alto'\n        if (nota <= this.datosSeccion.maxSup) return 'desempeno-superior'\n        return 'desempeno-extra'\n      },\n      async consultarEstudiantes() {\n        this.btnCargando = true\n        if (this.idPeriodo == 1) this.periodosVisibles = [1]\n        if (this.idPeriodo == 2) this.periodosVisibles = [1,2]\n        if (this.idPeriodo == 3) this.periodosVisibles = [1,2,3]\n        if (this.idPeriodo == 4) this.periodosVisibles = [1,2,3,4]\n        this.nombreSede = document.getElementById('sedes')[document.getElementById('sedes').selectedIndex].text\n        if (this.idCurso != null) { \n          this.nombreCurso = document.getElementById('cursos')[document.getElementById('cursos').selectedIndex].text\n          this.$store.state.datosCursos.forEach(element => {\n            if (element.id == this.idCurso) {\n              this.idNivel = element.id_nivel\n            }\n          })\n          this.listaAreasAsignaturas = []\n          await axios\n          .get(CONFIG.ROOT_PATH + 'consolidados/areasasignaturas/curso', {params: {idCurso: this.idCurso}})\n          .then(response => {\n            if (response.data.error){\n              this.mensajeEmergente('danger',CONFIG.TITULO_MSG,response.data.mensaje + ' - Lista areas-asignaturas curso')\n              this.btnCargando = false\n            } else{\n              if (response.data.datos != 0) {\n                //this.listaAreasAsignaturas = response.data.datos\n                response.data.datos.forEach(element => {\n                  if ( this.$store.state.idInstitucion == 'eb58bf60-fc83-11ec-a1d1-1dc2835404e5' ) { //Inem\n                    if (element.orden != 99 && element.orden != 90) {\n                      this.listaAreasAsignaturas.push(element)\n                    }\n                  } else if ( this.$store.state.idInstitucion == 'f5529ba0-fcb3-11ec-8267-536b07c743c4' ) { // Gustavo Rojas\n                    if (element.orden != 99 && element.orden != 15 && element.orden != 16 && element.orden != 98) {\n                      this.listaAreasAsignaturas.push(element)\n                    }\n                  } else if ( this.$store.state.idInstitucion == '097b7b10-fcaa-11ec-8267-536b07c743c4' ) { // Rural\n                    if (element.orden != 99 && element.orden != 98) {\n                      this.listaAreasAsignaturas.push(element)\n                    }\n                  } else if ( this.$store.state.idInstitucion == '54fd7440-fc81-11ec-a1d1-1dc2835404e5' || this.$store.state.idInstitucion == '7c63ed50-fcb0-11ec-8267-536b07c743c4' ) { // Antonio Jose Sandoval, Normal Santiago, \n                    this.listaAreasAsignaturas.push(element)\n                  } else {\n                    if (element.orden != 99) {\n                      this.listaAreasAsignaturas.push(element)\n                    }\n                  }\n                })\n              }\n            }\n          })\n          .catch(err => {\n            this.mensajeEmergente('danger',CONFIG.TITULO_MSG,'Algo salio mal y no se pudo realizar: Lista areas-asignaturas curso. Intente ms tarde.' + err)\n            this.btnCargando = false\n          })\n          this.datosRaw = []\n          await axios\n          .get(CONFIG.ROOT_PATH + 'consolidados/asignaturas/curso/acumulado', {params: {idCurso: this.idCurso, periodo: this.idPeriodo, vigencia: this.$store.state.aLectivo}})\n          .then(response => {\n            if (response.data.error){\n              this.mensajeEmergente('danger',CONFIG.TITULO_MSG,response.data.mensaje + ' - Consolidados asignaturas curso periodo')\n              this.btnCargando = false\n            } else{\n              if (response.data.datos != 0) {\n                this.datosRaw = response.data.datos\n              }\n            }\n          })\n          .catch(err => {\n            this.mensajeEmergente('danger',CONFIG.TITULO_MSG,'Algo salio mal y no se pudo realizar: Consolidados asignaturas curso periodo. Intente ms tarde.' + err)\n            this.btnCargando = false\n          })\n        }\n        //console.log(JSON.stringify(this.listaAreasAsignaturas))\n        this.btnCargando = false\n      },\n      imprimir() {\n        let fecha = 'Fecha: ' + new Date().toLocaleString()\n        let tituloInforme = 'CONSOLIDADO EVALUACIONES FINALES POR AREAS'\n        const contenido = document.querySelector('table').outerHTML\n        const ventana = window.open(\"Consolidados\", \"_blank\")\n        ventana.document.write(`<html><head><title>Imprimir</title></head>\n        <style scoped>\n          table {\n            border-collapse: collapse;\n            width: 100%;\n            text-align: center;\n            font-size: 10px;\n          }\n          th {\n            background: #eee;\n          }\n          .nota-recuperada {\n            border: 2px solid #ffa500;\n            box-shadow: 0 0 5px #ffa500;\n          }\n          .desempeno-bajo { background-color: #f8d7da; color: #721c24; }\n          .desempeno-basico { background-color: #d1ecf1; color: #0c5460; }\n          .desempeno-alto { background-color: #fff3cd; color: #856404; }\n          .desempeno-superior { background-color: #d4edda; color: #155724; }\n          .desempeno-extra { background-color: #f4ecf5; color: #2f2e2e; }\n        </style>\n          <body class=\"container\">\n            <p style=\"text-align: center; font-size: 12px;\">SECRETARA DE EDUCACIN TERRITORIAL DE TUNJA<br><b>${this.$store.state.nombreInstitucion}</b><br>TUNJA - BOYAC<br>${tituloInforme}<br>Sede: ${this.nombreSede} | Curso: ${this.nombreCurso} | Ao Lectivo ${this.$store.state.aLectivo} | Periodo: FINAL</p>\n            ${contenido}\n            <div style=\"text-align: right; font-size: 12px;\"><i>${fecha}</i></div>\n          </body>\n        </html>`)\n        ventana.document.close()\n        ventana.print()\n      },\n      exportarAExcel() {\n        const tabla = document.querySelector('table')\n        const wb = XLSX.utils.table_to_book(tabla)\n        XLSX.writeFile(wb, 'ConsoldidaFinal.xlsx')\n      },\n      redondear(num) {\n        var m = Number((Math.abs(num) * 10).toPrecision(15))\n        return Math.round(m) / 10 * Math.sign(num);\n      },\n      async ocuparComboCursosSede() {\n        this.comboCursosSede = []\n        this.$store.state.datosCursos.forEach(element => {\n          if (element.id_sede == this.idSede) {\n            this.comboCursosSede.push({ 'value': element.id, 'text': element.nomenclatura.toUpperCase() })\n          }\n        })\n      },\n      async ocuparComboSedes() {\n        this.comboSedes = []\n        this.$store.state.datosSedes.forEach(element => {\n          this.comboSedes.push({ 'value': element.id, 'text': element.sede.toUpperCase() })\n        })\n      },\n      async ocuparComboPeriodos() {\n        this.comboPeriodos = []\n        this.$store.state.periodos.forEach(element => {\n          this.comboPeriodos.push({ 'value': element.id, 'text': element.periodo.toUpperCase() })\n        })\n      },\n      mensajeEmergente(variante, titulo, contenido) {\n        this.$bvToast.toast(contenido, { title: titulo, variant: variante, toaster: \"b-toaster-top-center\", solid: true, autoHideDelay: 4000, appendToast: false })\n      }\n    },\n    computed: {\n      totales() {\n        return this.totalesGlobales()\n      },\n      estudiantesNotas() {\n        const mapa = {}\n        this.datosRaw.forEach(row => {\n          const { estudiante, area, asignatura, periodo, definitiva, recuperacion, orden, definitivacompor, definitivapree, idTipoEspecialidad, ausJ, ausS, porcentaje, id_conceptual } = row\n          if (!mapa[estudiante]) {\n            mapa[estudiante] = { id_conceptual, ausJ: 0, ausS: 0, areas: {} }\n          }\n          if (!mapa[estudiante].areas[area]) {\n            mapa[estudiante].areas[area] = { asignaturas: {} }\n          }\n          if (!mapa[estudiante].areas[area].asignaturas[asignatura]) {\n            mapa[estudiante].areas[area].asignaturas[asignatura] = {\n              periodos: {},\n              orden,\n              idTipoEspecialidad,\n              porcentaje,\n              pesos: { 1: this.datosSeccion.pesoP1, 2: this.datosSeccion.pesoP2, 3: this.datosSeccion.pesoP3, 4: this.datosSeccion.pesoP4 }\n            }\n          }\n          let notaFinal = 0\n          if (orden === 99) {\n            if (this.datosSeccion.tipoValComp == 1) {\n              notaFinal = definitiva\n            } else {\n              notaFinal = definitivacompor != null ? definitivacompor : ''\n            }\n          } else {\n            if (this.idNivel == 1) {\n              notaFinal = definitivapree != null && definitivapree != 0 && definitivapree != '' ? definitivapree : ''\n            } else {\n              notaFinal = recuperacion > definitiva ? recuperacion : definitiva\n            }\n          }\n          mapa[estudiante].areas[area].asignaturas[asignatura].periodos[periodo] = notaFinal\n          mapa[estudiante].ausJ += ausJ || 0\n          mapa[estudiante].ausS += ausS || 0\n        })\n        return mapa\n      },\n      totalColumnasPromedioArea() {\n        const areasUnicas = new Set(this.listaAreasAsignaturas.map(a => a.area))\n        return areasUnicas.size\n      },\n      puestosPorEstudiante() {\n        const lista = Object.entries(this.estudiantesNotas).map(([nombre, areas]) => {\n          const promedio = parseFloat(this.calcularPromedioGeneral(areas))\n          return { nombre, promedio: isNaN(promedio) ? 0 : promedio }\n        })\n        // Ordenar de mayor a menor\n        lista.sort((a, b) => b.promedio - a.promedio)\n        const puestos = {}\n        let puestoActual = 1\n        let contador = 1\n        let ultimoPromedio = null\n        lista.forEach(est => {\n          if (est.promedio !== ultimoPromedio) {\n            puestoActual = contador\n            ultimoPromedio = est.promedio\n            contador++\n          }\n          puestos[est.nombre] = puestoActual\n          //contador++\n        })\n        return puestos\n      },\n      encabezadoPorArea() {\n        const mapa = {}\n        this.listaAreasAsignaturas.forEach(({ area, asignatura }) => {\n          if (!mapa[area]) mapa[area] = []\n          mapa[area].push(asignatura)\n        })\n        return mapa\n      },\n    },\n    beforeMount() {\n      this.ocuparComboSedes()\n      this.ocuparComboPeriodos()\n      this.datosSeccion = this.$store.state.datosSecciones[this.$store.state.idSeccion - 1]\n      //console.log(JSON.stringify(this.datosSeccion))\n    }\n  }\n</script>\n<style scoped>\n  table {\n    border-collapse: collapse;\n    width: 100%;\n    text-align: center;\n    font-size: 10px;\n  }\n  th {\n    background: #eee;\n  }\n  .nota-recuperada {\n    border: 2px solid #ffa500;\n    box-shadow: 0 0 5px #ffa500;\n  }\n  .desempeno-bajo { background-color: #f8d7da; color: #721c24; }\n  .desempeno-basico { background-color: #d1ecf1; color: #0c5460; }\n  .desempeno-alto { background-color: #fff3cd; color: #856404; }\n  .desempeno-superior { background-color: #d4edda; color: #155724; }\n  .desempeno-extra { background-color: #f4ecf5; color: #2f2e2e; }\n  .promedio-area {\n    background-color: #f2f2f2;\n    font-weight: bold;\n    text-align: center;\n  }\n  .bloque-area th,\n  .bloque-area td {\n    border-right: 3px solid #999; /* lnea divisoria entre reas */\n  }\n\n</style>\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ConsolidadoFinalAreas.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ConsolidadoFinalAreas.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ConsolidadoFinalAreas.vue?vue&type=template&id=26ab95d5&scoped=true&\"\nimport script from \"./ConsolidadoFinalAreas.vue?vue&type=script&lang=js&\"\nexport * from \"./ConsolidadoFinalAreas.vue?vue&type=script&lang=js&\"\nimport style0 from \"./ConsolidadoFinalAreas.vue?vue&type=style&index=0&id=26ab95d5&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"26ab95d5\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('b-row',{staticClass:\"mt-2\"},[_c('b-col',{attrs:{\"lg\":\"12\"}},[_c('b-card',{scopedSlots:_vm._u([{key:\"header\",fn:function(){return [_c('h5',{staticClass:\"mb-0\"},[_c('b-icon',{attrs:{\"icon\":\"card-checklist\",\"aria-hidden\":\"true\"}}),_vm._v(\" RESUMEN DE PROMOCIN DEFINITIVO POR AREAS\")],1)]},proxy:true}])},[_c('b-card-text',[_c('b-row',[_c('b-col',{attrs:{\"lg\":\"6\"}},[_c('b-form-group',{staticClass:\"etiqueta\",attrs:{\"label\":\"Seleccione la Sede:\",\"label-for\":\"sedes\"}},[_c('b-form-select',{ref:\"sedes\",attrs:{\"id\":\"sedes\",\"options\":_vm.comboSedes},on:{\"change\":function($event){_vm.idCurso=null,_vm.ocuparComboCursosSede()}},model:{value:(_vm.idSede),callback:function ($$v) {_vm.idSede=$$v},expression:\"idSede\"}})],1)],1),_c('b-col',{attrs:{\"lg\":\"4\"}},[_c('b-form-group',{staticClass:\"etiqueta\",attrs:{\"label\":\"Seleccione el Curso:\",\"label-for\":\"cursos\"}},[_c('b-form-select',{ref:\"cursos\",attrs:{\"id\":\"cursos\",\"options\":_vm.comboCursosSede,\"disabled\":_vm.idSede!=null ? false : true},on:{\"change\":function($event){return _vm.consultarEstudiantes()}},model:{value:(_vm.idCurso),callback:function ($$v) {_vm.idCurso=$$v},expression:\"idCurso\"}})],1)],1)],1)],1)],1)],1)],1),_c('b-row',[_c('b-col',{attrs:{\"lg\":\"12\"}},[(_vm.btnCargando)?_c('div',[_c('div',{staticClass:\"text-center m-5 text-primary\"},[_c('b-spinner',{staticStyle:{\"width\":\"3rem\",\"height\":\"3rem\"},attrs:{\"label\":\"Spinner\"}}),_c('br'),_c('strong',[_vm._v(\"Cargando informe...\")])],1)]):_vm._e()])],1),(!_vm.btnCargando && _vm.idCurso!=null)?_c('b-row',[_c('b-col',{attrs:{\"lg\":\"12\"}},[_c('table',{staticClass:\"table-responsive\",attrs:{\"border\":\"1\",\"cellspacing\":\"0\",\"cellpadding\":\"1\"}},[_c('thead',[_c('tr',[_c('th',[_vm._v(\"#\")]),_c('th',[_vm._v(\"Estudiante\")]),_c('th',[_vm._v(\"Estado Final Promocin\")]),_c('th',[_vm._v(\"#\")])])]),_c('tbody',_vm._l((_vm.estudiantesNotas),function(est,nombre,i){return _c('tr',{key:nombre},[_c('td',{staticClass:\"text-left\"},[_vm._v(_vm._s(i + 1))]),_c('td',{staticStyle:{\"text-align\":\"left\"}},[_vm._v(_vm._s(nombre))]),_c('td',{staticStyle:{\"text-align\":\"left\"}},[_vm._v(_vm._s(est.id_conceptual=='N' ? _vm.mostrarEstadoPromocion(est.obs_comision,_vm.contarDesempenoEstudianteArea(est, 'bajo'),est.idMatricula) : '-'))]),_c('td',{staticClass:\"text-left\"},[_vm._v(_vm._s(i + 1))])])}),0)]),_c('div',{staticStyle:{\"margin-bottom\":\"1rem\"}},[_c('b-button',{staticClass:\"small mx-1 mt-3\",attrs:{\"variant\":\"primary\"},on:{\"click\":_vm.imprimir}},[_vm._v(\"Imprimir Consolidado\")]),_c('b-button',{staticClass:\"small mx-1 mt-3\",attrs:{\"variant\":\"outline-primary\"},on:{\"click\":_vm.exportarAExcel}},[_vm._v(\"Exportar a Excel\")])],1)])],1):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div>\n    <b-row class=\"mt-2\">\n      <b-col lg=\"12\">\n        <b-card>\n          <template #header>\n            <h5 class=\"mb-0\"><b-icon icon=\"card-checklist\" aria-hidden=\"true\"></b-icon> RESUMEN DE PROMOCIN DEFINITIVO POR AREAS</h5>\n          </template>\n          <b-card-text>\n            <b-row>\n              <!--\n              <b-col lg=\"2\">\n                <b-form-group label=\"Periodo:\" label-for=\"periodo\" class=\"etiqueta\">\n                  <b-form-select id=\"periodo\" ref=\"periodo\" v-model=\"idPeriodo\" :options=\"comboPeriodos\" @change=\"idSede=null,idCurso=null\"></b-form-select>\n                </b-form-group>\n              </b-col>\n              -->\n              <b-col lg=\"6\">\n                <b-form-group label=\"Seleccione la Sede:\" label-for=\"sedes\" class=\"etiqueta\">\n                  <b-form-select  id=\"sedes\" ref=\"sedes\" v-model=\"idSede\" :options=\"comboSedes\" @change=\"idCurso=null,ocuparComboCursosSede()\"></b-form-select>\n                </b-form-group>\n              </b-col>\n              <b-col lg=\"4\">\n                <b-form-group label=\"Seleccione el Curso:\" label-for=\"cursos\" class=\"etiqueta\">\n                  <b-form-select id=\"cursos\" ref=\"cursos\" v-model=\"idCurso\" :options=\"comboCursosSede\" @change=\"consultarEstudiantes()\" :disabled=\"idSede!=null ? false : true\"></b-form-select>\n                </b-form-group>\n              </b-col>\n            </b-row>\n          </b-card-text>\n        </b-card>\n      </b-col>\n    </b-row>\n    <b-row>\n      <b-col lg=\"12\">\n        <div v-if=\"btnCargando\">\n          <div class=\"text-center m-5 text-primary\">\n            <b-spinner style=\"width: 3rem; height: 3rem;\" label=\"Spinner\"></b-spinner>\n            <br><strong>Cargando informe...</strong>\n          </div>\n        </div>\n      </b-col>\n    </b-row>\n    <b-row v-if=\"!btnCargando && idCurso!=null\">\n      <b-col lg=\"12\">\n        <table border=\"1\" cellspacing=\"0\" cellpadding=\"1\" class=\"table-responsive\">\n          <thead>\n            <tr>\n              <th>#</th>\n              <th>Estudiante</th>\n              <!--\n              <template v-for=\"(asigs, area) in encabezadoPorArea\">\n                <th :colspan=\"colspanArea(area)\" :key=\"area\">\n                  {{ area }}\n                </th>\n              </template>\n              -->\n              <th>Estado Final Promocin</th>\n              <!--\n              <th rowspan=\"3\">PRO GEN</th>\n              <th rowspan=\"3\">Tot<br>Area<br>Baj</th>\n              <th rowspan=\"3\">Tot<br>Area<br>Bas</th>\n              <th rowspan=\"3\">Tot<br>Area<br>Alt</th>\n              <th rowspan=\"3\">Tot<br>Area<br>Sup</th>\n              <th rowspan=\"3\">Tot<br>AuJ</th>\n              <th rowspan=\"3\">Tot<br>AuS</th>\n              <th rowspan=\"3\">Puesto</th>\n              -->\n              <th>#</th>\n            </tr>\n            <!--\n            <tr>\n              <template v-for=\"(asigs, area) in encabezadoPorArea\">\n                <template v-for=\"(asig, k) in asigs\">\n                  <th :colspan=\"periodosVisibles.length + 1\" :key=\"'area-' + asig + k\">\n                    {{ asig }}\n                  </th>\n                </template>\n                <th class=\"promedio-area\" :key=\"'prom-area-' + area\">PRO AR</th>\n              </template>\n            </tr>\n            <tr>\n              <template v-for=\"(asigs, area) in encabezadoPorArea\">\n                <template v-for=\"asig in asigs\">\n                  <th v-for=\"p in periodosVisibles\" :key=\"'h' + area + asig + p\">\n                    P{{ p }}\n                  </th>\n                  <th :key=\"'prom' + asig + area\">PR</th>\n                </template>\n                <th :key=\"'prom' + area\"></th>\n              </template>\n            </tr>\n            -->\n          </thead>\n          <tbody>\n            <tr v-for=\"(est, nombre, i) in estudiantesNotas\" :key=\"nombre\">\n              <td class=\"text-left\">{{ i + 1 }}</td>\n              <td style=\"text-align: left\">{{ nombre }}</td>\n              <!--\n              <template v-for=\"(asigs, area) in encabezadoPorArea\">\n                <template v-for=\"asig in asigs\">\n                  <td v-for=\"p in periodosVisibles\"  :key=\"nombre + area + asig + p\">\n                    {{ est.id_conceptual=='N' ? obtenerNota(est, area, asig, p) : '-' }}\n                  </td>\n                  <td class=\"bloque-area\" :key=\"'prom' + nombre + area + asig\" style=\"font-weight: bold; text-align: center;\">\n                    {{ est.id_conceptual=='N' ? obtenerPromedioAsignatura(est, area, asig) : '-' }}\n                  </td>\n                </template>\n                <td class=\"promedio-area bloque-area\" :key=\"'promArea' + nombre + area\">\n                  {{ est.id_conceptual=='N' ? obtenerPromedioArea(est, area) : '-' }}\n                </td>\n              </template>\n              -->\n              <td style=\"text-align: left\">{{ est.id_conceptual=='N' ? mostrarEstadoPromocion(est.obs_comision,contarDesempenoEstudianteArea(est, 'bajo'),est.idMatricula) : '-' }}</td>\n              <!--\n              <td>{{ est.id_conceptual=='N' ? calcularPromedioGeneral(est) : '-' }}</td>\n              <td>{{ est.id_conceptual=='N' ? contarDesempenoEstudianteArea(est, 'bajo') : '-' }}</td>\n              <td>{{ est.id_conceptual=='N' ? contarDesempenoEstudianteArea(est, 'basico') : '-' }}</td>\n              <td>{{ est.id_conceptual=='N' ? contarDesempenoEstudianteArea(est, 'alto') : '-' }}</td>\n              <td>{{ est.id_conceptual=='N' ? contarDesempenoEstudianteArea(est, 'superior') : '-' }}</td>\n              <td>{{ est.id_conceptual=='N' ? est.ausJ : '-' }}</td>\n              <td>{{ est.id_conceptual=='N' ? est.ausS : '-' }}</td>\n              <td>{{ est.id_conceptual=='N' ? iconoPuesto(puestosPorEstudiante[nombre]) : '-' }} {{ est.id_conceptual=='N' ? puestosPorEstudiante[nombre] : '-' }}</td>\n              -->\n              <td class=\"text-left\">{{ i + 1 }}</td>\n            </tr>\n            <!--\n            <tr style=\"background-color: #f0f0f0; font-weight: bold;\">\n              <td colspan=\"2\">Total Bajos</td>\n              <template v-for=\"(asigs, area) in encabezadoPorArea\">\n                <template v-for=\"asig in asigs\">\n                  <td v-for=\"p in periodosVisibles\" :key=\"'bp' + area + asig + p\">\n                    {{ totalBajosPorPeriodo(area, asig, p) }}\n                  </td>\n                  <td :key=\"'bj' + area + asig\">\n                    {{ totalBajosPromedioAsignatura(area, asig) }}\n                  </td>\n                </template>\n                <td  :key=\"'bja' + area\" class=\"promedio-area\">\n                  {{ totalBajosPromedioArea(area) }}\n                </td>\n              </template>\n              <td></td>\n              <td></td>\n              <td>{{ totales.bajo }}</td>\n              <td>{{ totales.basico }}</td>\n              <td>{{ totales.alto }}</td>\n              <td>{{ totales.superior }}</td>\n              <td>{{ totales.ausJ }}</td>\n              <td>{{ totales.ausS }}</td>\n              <td></td>\n              <td></td>\n            </tr>\n            -->\n          </tbody>\n        </table>\n        <div style=\"margin-bottom: 1rem\">\n          <b-button class=\"small mx-1 mt-3\" variant=\"primary\" @click=\"imprimir\">Imprimir Consolidado</b-button>\n          <b-button class=\"small mx-1 mt-3\" variant=\"outline-primary\" @click=\"exportarAExcel\">Exportar a Excel</b-button>\n        </div>\n      </b-col>\n    </b-row>\n  </div>\n</template>\n\n<script>\n  import axios from \"axios\"\n  import * as CONFIG from '@/assets/config.js'\n  import * as XLSX from 'xlsx'\nimport AreasPerdidasVue from './AreasPerdidas.vue'\n\n  export default {\n    name: 'resumenpromocionareas',\n    components: {\n    },\n    data () {\n      return {\n        idSede: null,\n        comboSedes: [],\n        idPeriodo: 5,\n        comboPeriodos: null,\n        idCurso: null,\n        comboCursosSede: [],\n        nombreSede: null,\n        nombreCurso: null,\n        idNivel: null,\n        btnCargando: false,\n        datosRaw: [],\n        datosSeccion: {},\n        listaAreasAsignaturas: [],\n        periodosVisibles: [],\n        listaHabilitaciones: [],\n      }\n    },\n    methods: {\n      mostrarEstadoPromocion(obs_comision,areasPerdidas,idMatricula) {\n        if (areasPerdidas != 9999) {\n          let perdioHabilitacion = 0\n          let contHabilitaciones = 0\n          const meta = this.listaHabilitaciones.filter(h => h.id_matricula === idMatricula)\n          meta.forEach(element => {\n            if (element.habilitacion < 3) perdioHabilitacion++\n            contHabilitaciones++\n          })\n          if ( this.$store.state.idInstitucion == 'f5529ba0-fcb3-11ec-8267-536b07c743c4') { // GUSTAVO ROJAS\n            if (obs_comision === null || obs_comision === '') {\n              if (perdioHabilitacion > 0) return 'REPROBADO' // reprobo por perdida de habilitacion\n              if (areasPerdidas == 0) {\n                return contHabilitaciones == 0 ? 'APROB EL GRADO' : 'PROMOVIDO'\n              } else {\n                return 'REPROBADO'\n              }\n            } else {\n              return 'PROMOVIDO POR COMISIN DE EVALUACIN'\n            }\n          } else if ( this.$store.state.idInstitucion == '17ee4f30-fc80-11ec-a1d1-1dc2835404e5') { // ENSLAP\n            if (this.$store.state.idSeccion == 1) {\n              if (areasPerdidas == 0) {\n                return 'APROB EL GRADO'\n              } else {\n                return 'REPROB'\n              }\n            } else {\n              if (areasPerdidas == 0) {\n                return 'APROB EL SEMESTRE'\n              } else {\n                return 'REPROB EL SEMESTRE'\n              }\n            }\n          } else if ( this.$store.state.idInstitucion == '7c63ed50-fcb0-11ec-8267-536b07c743c4') { // SANTIAGO\n            if (this.$store.state.idSeccion == 1) {\n              if (areasPerdidas == 0) {\n                return 'APROB EL GRADO'\n              } else {\n                return 'REPROB'\n              }\n            } else {\n              if (areasPerdidas == 0) {\n                return 'APROB EL SEMESTRE'\n              } else {\n                return 'REPROB EL SEMESTRE'\n              }\n            }\n          } else if ( this.$store.state.idInstitucion == 'f0491770-fca8-11ec-8267-536b07c743c4') { // GONZALO\n            if (areasPerdidas == 0) {\n              return 'APROB EL GRADO'\n            } else {\n              return 'REPROB'\n            }\n          } else {\n            if (areasPerdidas == 0) {\n              return 'APROB EL GRADO'\n            } else {\n              return 'REPROB'\n            }\n          }\n        } else {\n          return 'REPROB (Sin Notas)'\n        }\n      },\n      colspanArea(area) {\n        const asignaturas = this.encabezadoPorArea[area] || []\n        const columnasPorAsignatura = this.periodosVisibles.length + 1\n        const extraColumnaPromArea = 1\n        return (asignaturas.length * columnasPorAsignatura) + extraColumnaPromArea\n      },\n\n      totalBajosPorPeriodo(area, asignatura, periodo) {\n        let total = 0\n        const meta = this.listaAreasAsignaturas.find(\n          a => a.area === area && a.asignatura === asignatura\n        )\n        const idTipoEspecialidad = meta?.idTipoEspecialidad\n        Object.values(this.estudiantesNotas).forEach(est => {\n          const nota = est?.areas?.[area]?.asignaturas?.[asignatura]?.periodos?.[periodo]\n          if (idTipoEspecialidad === 1) {\n            if (nota > 0 && nota < this.datosSeccion.minBas) total++\n          } else {\n            if (nota > 0 && nota < this.datosSeccion.minBasT) total++\n          }\n        })\n        return total\n      },\n      totalBajosPromedioAsignatura(area, asignatura) {\n        let total = 0\n        const meta = this.listaAreasAsignaturas.find(\n          a => a.area === area && a.asignatura === asignatura\n        )\n        const idTipoEspecialidad = meta?.idTipoEspecialidad\n        Object.values(this.estudiantesNotas).forEach(est => {\n          const asig = est?.areas?.[area]?.asignaturas?.[asignatura]\n          if (!asig) return\n          const prom = parseFloat(this.calcularPromedioAsignatura(asig))\n          if (idTipoEspecialidad === 1) {\n            if (prom < this.datosSeccion.minBas) total++\n          } else {\n            if (prom < this.datosSeccion.minBasT) total++\n          }\n        })\n        return total\n      },\n      totalBajosPromedioArea(area) {\n        let total = 0\n        Object.values(this.estudiantesNotas).forEach(est => {\n          const prom = parseFloat(this.obtenerPromedioArea(est, area))\n          if (!isNaN(prom) && prom < this.datosSeccion.minBas) total++\n        })\n        return total\n      },\n      totalesGlobales() {\n        let bajo = 0, basico = 0, alto = 0, superior = 0, ausJ = 0, ausS = 0\n        Object.values(this.estudiantesNotas).forEach(est => {\n          bajo += this.contarDesempenoEstudianteArea(est, 'bajo')\n          basico += this.contarDesempenoEstudianteArea(est, 'basico')\n          alto += this.contarDesempenoEstudianteArea(est, 'alto')\n          superior += this.contarDesempenoEstudianteArea(est, 'superior')\n          ausJ += est.ausJ || 0\n          ausS += est.ausS || 0\n        })\n\n        return { bajo, basico, alto, superior, ausJ, ausS }\n      },\n      esAreaValida(area) {\n        //const asigns = this.listaAreasAsignaturas.filter(a => a.area === area)\n        //return asigns.some(a => a.orden !== 99)\n        const asigns = this.listaAreasAsignaturas.filter(a => a.area === area)\n        if (asigns.some(a => a.orden !== 99 && a.orden !== 98)) return true\n        else if (asigns.some(a => a.orden === 99) && this.datosSeccion.promCompor == 1) return true\n        else return false\n      },\n      obtenerPromedioArea(est, area) {\n        const areaData = est.areas && est.areas[area]\n        return areaData ? this.calcularPromedioArea(areaData) : ''\n      },\n      obtenerNota(est, area, asignatura, periodo) {\n        let nota = est?.areas?.[area]?.asignaturas?.[asignatura]?.periodos?.[periodo]\n        if (nota === 0) nota = ''\n        return typeof nota === 'number' ? nota.toFixed(1) : nota\n      },\n      obtenerPromedioAsignatura(est, area, asignatura) {\n        const asig = est?.areas?.[area]?.asignaturas?.[asignatura]\n        return asig ? this.calcularPromedioAsignatura(asig) : ''\n      },\n      calcularPromedioAsignatura(asig) {\n        const pesos = asig.pesos\n        const periodos = asig.periodos\n        const orden = asig.orden\n        if (orden === 99 && this.datosSeccion.promCompor == 0) return '-'\n        let total = 0\n        if (this.$store.state.idInstitucion == 'acaa36d0-fcb1-11ec-8267-536b07c743c4') { // Emiliani\n          if( orden == 12) {\n            let cantidad = 0 \n            for (let p = 1; p <= 4; p++) {\n              const nota = periodos[p] ?? 0\n              if (nota > 0) {\n                total += nota\n                cantidad++\n              }\n            }\n            if (total === 0) return ''\n            total = total / cantidad\n            return this.redondear(total).toFixed(1) > 0 ? this.redondear(total).toFixed(1) : ''\n          } else {\n            for (let p = 1; p <= 4; p++) {\n              const nota = periodos[p] ?? 0\n              total += nota * pesos[p] / 100\n            }\n            return this.redondear(total).toFixed(1) > 0 ? this.redondear(total).toFixed(1) : ''\n          }\n        } else if (this.$store.state.idInstitucion == 'eb58bf60-fc83-11ec-a1d1-1dc2835404e5') { // Inem\n          if (orden == 55) {\n            let cantidad = 0 // nuevo\n            for (let p = 1; p <= 4; p++) {\n              const nota = periodos[p] ?? 0\n              if (nota > 0) {\n                total += nota\n                cantidad++\n              }\n            }\n            if (total === 0) return ''\n            total = total / cantidad\n            return this.redondear(total).toFixed(1) > 0 ? this.redondear(total).toFixed(1) : ''\n          } else {\n            for (let p = 1; p <= 4; p++) {\n              const nota = periodos[p] ?? 0\n              total += nota * pesos[p] / 100\n            }\n            return this.redondear(total).toFixed(1) > 0 ? this.redondear(total).toFixed(1) : ''\n          }\n        } else if (this.$store.state.idInstitucion == 'c50f3d80-fca0-11ec-8267-536b07c743c4') { // Silvino\n          const nota = periodos[5] ?? 0\n          return nota > 0 ? nota.toFixed(1) : ''\n        } else if (this.$store.state.idInstitucion == '8a1bd1e0-fcb2-11ec-8267-536b07c743c4') { // Libertador\n          const nota = periodos[5] ?? 0\n          return nota > 0 ? nota.toFixed(1) : ''\n        } else if (this.$store.state.idInstitucion == '17ee4f30-fc80-11ec-a1d1-1dc2835404e5') { // Enslap\n          let cantidad = 0 \n          for (let p = 1; p <= 4; p++) {\n            const nota = asig.periodos[p] ?? 0\n            if (nota > 0) {\n              total += nota\n              cantidad++\n            }\n          }\n          if (total === 0) return ''\n          const promedio = this.$store.state.idSeccion == 1 ? total / 4 : total\n          return this.redondear(promedio).toFixed(1) > 0 ? this.redondear(promedio).toFixed(1) : ''\n        } else if (this.$store.state.idInstitucion == '7c63ed50-fcb0-11ec-8267-536b07c743c4') { // Santiago\n          let cantidad = 0 \n          for (let p = 1; p <= 4; p++) {\n            const nota = asig.periodos[p] ?? 0\n            if (nota > 0) {\n              total += nota\n              cantidad++\n            }\n          }\n          if (total === 0) return ''\n          const promedio = total / cantidad\n          return this.redondear(promedio).toFixed(1) > 0 ? this.redondear(promedio).toFixed(1) : ''\n        } else if (this.$store.state.idInstitucion == '54fd7440-fc81-11ec-a1d1-1dc2835404e5') { // Sandoval\n          let cantidad = 0 \n          for (let p = 1; p <= 4; p++) {\n            const nota = asig.periodos[p] ?? 0\n            if (nota > 0) {\n              total += nota\n              cantidad++\n            }\n          }\n          if (total === 0) return ''\n          const promedio = total / 4\n          return this.redondear(promedio).toFixed(1) > 0 ? this.redondear(promedio).toFixed(1) : ''\n        } else {\n          let cantidad = 0 \n          for (let p = 1; p <= 4; p++) {\n            const nota = periodos[p] ?? 0\n            if (nota > 0) {\n              total += nota\n              cantidad++\n            }\n          }\n          if (total === 0) return ''\n          const promedio = total / cantidad\n          return this.redondear(promedio).toFixed(1) > 0 ? this.redondear(promedio).toFixed(1) : ''\n        }\n      },\n      calcularPromedioArea(areaData) {\n        const asigns = Object.values(areaData.asignaturas)\n        if (!asigns.length) return '0.00'\n        let total = 0\n        asigns.forEach(asig => {\n          //console.log(asig)\n          if (asig.orden === 99 && this.datosSeccion.promCompor == 0) return '-'\n          const idAsignaturaCurso = asig.idAsignaturaCurso\n          const idMatricula = asig.idMatricula\n          const habilit = this.mostrarHabilitacion(idMatricula,idAsignaturaCurso)\n          const promAsigna = parseFloat((this.calcularPromedioAsignatura(asig) * asig.porcentaje) / 100)\n          const valorSumar = habilit.habilitacion > promAsigna ? habilit.habilitacion : promAsigna\n          total += valorSumar //parseFloat((this.calcularPromedioAsignatura(asig) * asig.porcentaje) / 100)\n          /*\n          const ausJArea = asig.orden == 98 || asig.orden == 99 ? '' : ausJ > 0 ? ausJ : ''\n          const ihArea = asig.ih\n          const minPierdeFallas = (ihArea * 40 * .2) + 1\n          if ((this.orden !== 99) && (ausSArea >= minPierdeFallas)) this.perdioPorFallas = 1\n          */\n        })\n        return total > 0 ? this.redondear(total).toFixed(1) : ''\n      },\n      contarDesempenoEstudianteArea(est, tipo) {\n        const areas = Object.keys(est.areas || {})\n        let contador = 0\n        let cuantasAreas = 0\n        areas.forEach(area => {\n          if (!this.esAreaValida(area)) return\n          const meta = this.listaAreasAsignaturas.find( a => a.area === area)\n          const idTipoEspecialidadArea = meta?.idTipoArea\n          const promedio = parseFloat(this.calcularPromedioArea(est.areas[area]))\n          if (!isNaN(promedio)) {\n            cuantasAreas++\n            if (idTipoEspecialidadArea === 1) {\n              if (tipo === 'bajo' && promedio < this.datosSeccion.minBas) contador++\n              else if (tipo === 'basico' && promedio >= this.datosSeccion.minBas && promedio < this.datosSeccion.minAlt) contador++\n              else if (tipo === 'alto' && promedio >= this.datosSeccion.minAlt && promedio < this.datosSeccion.minSup) contador++\n              else if (tipo === 'superior' && promedio >= this.datosSeccion.minSup && promedio <= this.datosSeccion.maxSup) contador++\n            } else {\n              if (tipo === 'bajo' && promedio < this.datosSeccion.minBasT) contador++\n              else if (tipo === 'basico' && promedio >= this.datosSeccion.minBasT && promedio < this.datosSeccion.minAltT) contador++\n              else if (tipo === 'alto' && promedio >= this.datosSeccion.minAltT && promedio < this.datosSeccion.minSupT) contador++\n              else if (tipo === 'superior' && promedio >= this.datosSeccion.minSupT && promedio <= this.datosSeccion.maxSupT) contador++\n            }\n          }\n        })\n        return cuantasAreas > 0 ? contador : 9999\n      },\n      calcularPromedioGeneral(est) {\n        const areas = Object.keys(est.areas || {})\n        let total = 0\n        let cantidad = 0\n        areas.forEach(area => {\n          if (!this.esAreaValida(area)) return\n          const promedio = parseFloat(this.calcularPromedioArea(est.areas[area]))\n          if (!isNaN(promedio)) {\n            total += promedio\n            cantidad++\n          }\n        })\n        return cantidad > 0 ? (total / cantidad).toFixed(3) : ''\n      },\n      contarAusencias(tipo) {\n        let total = 0\n        Object.values(this.estudiantesNotas).forEach(est => {\n          if (tipo === 'ausJ') total += est.ausJ || 0\n          if (tipo === 'ausS') total += est.ausS || 0\n        })\n        return total\n      },\n      contarNotasPorAsignatura(area, asignatura, tipo) {\n        let contador = 0\n        Object.values(this.estudiantesNotas).forEach(est => {\n          const nota = est?.[area]?.[asignatura]?.nota\n          const val = est?.[area]?.[asignatura]?.idTipoEspecialidad\n          if (typeof nota !== 'number') return\n          if (val === 1) {\n            if (tipo === 'bajo' && nota < this.datosSeccion.minBas) contador++\n            else if (tipo === 'basico' && nota >= this.datosSeccion.minBas && nota < this.datosSeccion.minAlt) contador++\n            else if (tipo === 'alto' && nota >= this.datosSeccion.minAlt && nota < this.datosSeccion.minSup) contador++\n            else if (tipo === 'superior' && nota >= this.datosSeccion.minSup && nota <= this.datosSeccion.maxSup) contador++\n          } else {\n            if (tipo === 'bajo' && nota < this.datosSeccion.minBasT) contador++\n            else if (tipo === 'basico' && nota >= this.datosSeccion.minBasT && nota < this.datosSeccion.minAltT) contador++\n            else if (tipo === 'alto' && nota >= this.datosSeccion.minAltT && nota < this.datosSeccion.minSupT) contador++\n            else if (tipo === 'superior' && nota >= this.datosSeccion.minSupT && nota <= this.datosSeccion.maxSupT) contador++\n          }\n        })\n        return contador\n      },\n      contarNotasTotales(tipo) {\n        let total = 0\n        Object.values(this.estudiantesNotas).forEach(est => {\n          this.listaAreasAsignaturas.forEach(({ area, asignatura }) => {\n            const nota = est?.[area]?.[asignatura]?.nota\n            const val = est?.[area]?.[asignatura]?.idTipoEspecialidad\n            if (typeof nota !== 'number') return\n            if (val === 1) {\n              if (tipo === 'bajo' && nota < this.datosSeccion.minBas) total++\n              else if (tipo === 'basico' && nota >= this.datosSeccion.minBas && nota < this.datosSeccion.minAlt) total++\n              else if (tipo === 'alto' && nota >= this.datosSeccion.minAlt && nota < this.datosSeccion.minSup) total++\n              else if (tipo === 'superior' && nota >= this.datosSeccion.minSup && nota <= this.datosSeccion.maxSup) total++\n            } else {\n              if (tipo === 'bajo' && nota < this.datosSeccion.minBasT) total++\n              else if (tipo === 'basico' && nota >= this.datosSeccion.minBasT && nota < this.datosSeccion.minAltT) total++\n              else if (tipo === 'alto' && nota >= this.datosSeccion.minAltT && nota < this.datosSeccion.minSupT) total++\n              else if (tipo === 'superior' && nota >= this.datosSeccion.minSupT && nota <= this.datosSeccion.maxSupT) total++\n            }\n          })\n        })\n        return total\n      },\n      iconoPuesto(puesto) {\n        if (puesto === 1) return ''\n        if (puesto === 2) return ''\n        if (puesto === 3) return ''\n        return ''\n      },\n      contarDesempenoEstudiante(areas, tipo) {\n        let contador = 0\n        Object.values(areas || {}).forEach(area => {\n          Object.values(area.asignaturas || {}).forEach(asig => {\n            const nota = parseFloat(this.calcularPromedioAsignatura(asig))\n            const val =  asig.idTipoEspecialidad\n            const orden =  asig.orden\n            if (this.$store.state.idInstitucion == 'eb58bf60-fc83-11ec-a1d1-1dc2835404e5' && orden == 90) return // No se tiene en cuenta el area de Inem Exploracion vocacional - Complementaria\n            if (this.$store.state.idInstitucion == '097b7b10-fcaa-11ec-8267-536b07c743c4' && orden == 98) return // No se tiene en cuenta el area de Rural Proyectos Profundizacion\n            if (typeof nota !== 'number') return\n            if (val === 1) {\n              if (tipo === 'bajo' && nota < this.datosSeccion.minBas) contador++\n              else if (tipo === 'basico' && nota >= this.datosSeccion.minBas && nota < this.datosSeccion.minAlt) contador++\n              else if (tipo === 'alto' && nota >= this.datosSeccion.minAlt && nota < this.datosSeccion.minSup) contador++\n              else if (tipo === 'superior' && nota >= this.datosSeccion.minSup && nota <= this.datosSeccion.maxSup) contador++\n            } else {\n              if (tipo === 'bajo' && nota < this.datosSeccion.minBasT) contador++\n              else if (tipo === 'basico' && nota >= this.datosSeccion.minBasT && nota < this.datosSeccion.minAltT) contador++\n              else if (tipo === 'alto' && nota >= this.datosSeccion.minAltT && nota < this.datosSeccion.minSupT) contador++\n              else if (tipo === 'superior' && nota >= this.datosSeccion.minSupT && nota <= this.datosSeccion.maxSupT) contador++\n            }\n          })\n        })\n        return contador\n      },\n      fueRecuperada(areas, area, asig) {\n        return areas?.[area]?.[asig]?.fueRecuperada ?? false\n      },\n      obtenerOriginal(areas, area, asig) {\n        const val = areas?.[area]?.[asig]?.original\n        return typeof val === 'number' ? val.toFixed(1) : '0.0'\n      },\n      obtenerRecuperacion(areas, area, asig) {\n        const val = areas?.[area]?.[asig]?.recuperacion\n        return typeof val === 'number' ? val.toFixed(1) : '0.0'\n      },\n      obtenerColor(nota, areas, area, asig) {\n        const val = areas?.[area]?.[asig]?.idTipoEspecialidad\n        if (val === 1) {\n          if (nota < this.datosSeccion.minBas) return 'desempeno-bajo'\n          if (nota < this.datosSeccion.minAlt) return 'desempeno-basico'\n          if (nota < this.datosSeccion.minSup) return 'desempeno-alto'\n          if (nota <= this.datosSeccion.maxSup) return 'desempeno-superior'\n          return 'desempeno-extra'\n        } else {\n          if (nota < this.datosSeccion.minBasT) return 'desempeno-bajo'\n          if (nota < this.datosSeccion.minAltT) return 'desempeno-basico'\n          if (nota < this.datosSeccion.minSupT) return 'desempeno-alto'\n          if (nota <= this.datosSeccion.maxSupT) return 'desempeno-superior'\n          return 'desempeno-extra'\n        }\n      },\n      claseDesempeno(nota) {\n        //console.log(nota)\n        if (typeof nota !== 'number') return 'desempeno-extra'\n        if (nota < 3) return 'desempeno-bajo'\n        if (nota < 4) return 'desempeno-basico'\n        if (nota < 4.6) return 'desempeno-alto'\n        if (nota <= 5) return 'desempeno-superior'\n        return 'desempeno-extra'\n      },\n      obtenerColorGeneral(nota) {\n        if (nota < this.datosSeccion.minBas) return 'desempeno-bajo'\n        if (nota < this.datosSeccion.minAlt) return 'desempeno-basico'\n        if (nota < this.datosSeccion.minSup) return 'desempeno-alto'\n        if (nota <= this.datosSeccion.maxSup) return 'desempeno-superior'\n        return 'desempeno-extra'\n      },\n      mostrarHabilitacion(idMatricula,idAsignaturaCurso) {\n        const meta = this.listaHabilitaciones.find(h => h.id_matricula === idMatricula && h.id_asignatura_curso === idAsignaturaCurso)\n        if (!(meta === undefined)) {\n          const valor = meta.habilitacion > 0 ? meta.habilitacion.toFixed(1) : ''\n          const fechita = meta.fecha !== null && meta.fecha !== '' ? meta.fecha.substr(0,10) : ''\n          const actica = meta.acta != null ? meta.acta : ''\n          return {habilitacion: valor, acta: actica, fecha: fechita }\n        } else {\n          return {habilitacion: '', acta: '', fecha: ''}\n        }\n      },\n      async consultarHabilitaciones() {\n        this.listaHabilitaciones = []\n        await axios\n        .get(CONFIG.ROOT_PATH + 'boletines/habilitaciones/curso', {params: {vigencia: this.$store.state.aLectivo}})\n        .then(response => {\n          if (response.data.error){\n            this.mensajeEmergente('danger',CONFIG.TITULO_MSG,response.data.mensaje + ' - Consulta habilitacion')\n            this.btnCargando = false\n          } else{\n            if (response.data.datos != 0) {\n              this.listaHabilitaciones = response.data.datos\n              //console.log(JSON.stringify(response.data.datos))\n            }\n          }\n        })\n        .catch(err => {\n          this.mensajeEmergente('danger',CONFIG.TITULO_MSG,'Algo salio mal y no se pudo realizar: Consulta habilitacion. Intente ms tarde.' + err)\n        })\n      },\n      async consultarEstudiantes() {\n        this.btnCargando = true\n        if (this.idPeriodo == 1) this.periodosVisibles = [1]\n        if (this.idPeriodo == 2) this.periodosVisibles = [1,2]\n        if (this.idPeriodo == 3) this.periodosVisibles = [1,2,3]\n        if (this.idPeriodo == 4) this.periodosVisibles = [1,2,3,4]\n        this.nombreSede = document.getElementById('sedes')[document.getElementById('sedes').selectedIndex].text\n        if (this.idCurso != null) { \n          this.nombreCurso = document.getElementById('cursos')[document.getElementById('cursos').selectedIndex].text\n          this.$store.state.datosCursos.forEach(element => {\n            if (element.id == this.idCurso) {\n              this.idNivel = element.id_nivel\n            }\n          })\n          this.listaAreasAsignaturas = []\n          await axios\n          .get(CONFIG.ROOT_PATH + 'consolidados/areasasignaturas/curso', {params: {idCurso: this.idCurso}})\n          .then(response => {\n            if (response.data.error){\n              this.mensajeEmergente('danger',CONFIG.TITULO_MSG,response.data.mensaje + ' - Lista areas-asignaturas curso')\n              this.btnCargando = false\n            } else{\n              if (response.data.datos != 0) {\n                //this.listaAreasAsignaturas = response.data.datos\n                response.data.datos.forEach(element => {\n                  if ( this.$store.state.idInstitucion == 'eb58bf60-fc83-11ec-a1d1-1dc2835404e5' ) { //Inem\n                    if (element.orden != 99 && element.orden != 90) {\n                      this.listaAreasAsignaturas.push(element)\n                    }\n                  } else if ( this.$store.state.idInstitucion == 'f5529ba0-fcb3-11ec-8267-536b07c743c4' ) { // Gustavo Rojas\n                    if (element.orden != 99 && element.orden != 15 && element.orden != 16 && element.orden != 98) {\n                      this.listaAreasAsignaturas.push(element)\n                    }\n                  } else if ( this.$store.state.idInstitucion == '097b7b10-fcaa-11ec-8267-536b07c743c4' ) { // Rural\n                    if (element.orden != 99 && element.orden != 98) {\n                      this.listaAreasAsignaturas.push(element)\n                    }\n                  } else if ( this.$store.state.idInstitucion == '54fd7440-fc81-11ec-a1d1-1dc2835404e5' || this.$store.state.idInstitucion == '7c63ed50-fcb0-11ec-8267-536b07c743c4' ) { // Antonio Jose Sandoval, Normal Santiago, \n                    this.listaAreasAsignaturas.push(element)\n                  } else {\n                    if (element.orden != 99) {\n                      this.listaAreasAsignaturas.push(element)\n                    }\n                  }\n                })\n              }\n            }\n          })\n          .catch(err => {\n            this.mensajeEmergente('danger',CONFIG.TITULO_MSG,'Algo salio mal y no se pudo realizar: Lista areas-asignaturas curso. Intente ms tarde.' + err)\n            this.btnCargando = false\n          })\n          this.datosRaw = []\n          await axios\n          .get(CONFIG.ROOT_PATH + 'consolidados/asignaturas/curso/acumulado', {params: {idCurso: this.idCurso, periodo: this.idPeriodo, vigencia: this.$store.state.aLectivo}})\n          .then(response => {\n            if (response.data.error){\n              this.mensajeEmergente('danger',CONFIG.TITULO_MSG,response.data.mensaje + ' - Consolidados asignaturas curso periodo')\n              this.btnCargando = false\n            } else{\n              if (response.data.datos != 0) {\n                this.datosRaw = response.data.datos\n                //console.log(JSON.stringify(this.datosRaw))\n              }\n            }\n          })\n          .catch(err => {\n            this.mensajeEmergente('danger',CONFIG.TITULO_MSG,'Algo salio mal y no se pudo realizar: Consolidados asignaturas curso periodo. Intente ms tarde.' + err)\n            this.btnCargando = false\n          })\n        }\n        //console.log(JSON.stringify(this.listaAreasAsignaturas))\n        this.btnCargando = false\n      },\n      imprimir() {\n        let fecha = 'Fecha: ' + new Date().toLocaleString()\n        let tituloInforme = 'ESTADOS FINALES DE PROMOCIN ESCOLAR'\n        const contenido = document.querySelector('table').outerHTML\n        const ventana = window.open(\"Consolidados\", \"_blank\")\n        ventana.document.write(`<html><head><title>Imprimir</title></head>\n        <style scoped>\n          table {\n            border-collapse: collapse;\n            width: 100%;\n            text-align: center;\n            font-size: 10px;\n          }\n          th {\n            background: #eee;\n          }\n          .nota-recuperada {\n            border: 2px solid #ffa500;\n            box-shadow: 0 0 5px #ffa500;\n          }\n          .desempeno-bajo { background-color: #f8d7da; color: #721c24; }\n          .desempeno-basico { background-color: #d1ecf1; color: #0c5460; }\n          .desempeno-alto { background-color: #fff3cd; color: #856404; }\n          .desempeno-superior { background-color: #d4edda; color: #155724; }\n          .desempeno-extra { background-color: #f4ecf5; color: #2f2e2e; }\n        </style>\n          <body class=\"container\">\n            <p style=\"text-align: center; font-size: 12px;\">SECRETARA DE EDUCACIN TERRITORIAL DE TUNJA<br><b>${this.$store.state.nombreInstitucion}</b><br>TUNJA - BOYAC<br>${tituloInforme}<br>Sede: ${this.nombreSede} | Curso: ${this.nombreCurso} | Ao Lectivo ${this.$store.state.aLectivo} | Periodo: FINAL</p>\n            ${contenido}\n            <div style=\"text-align: right; font-size: 12px;\"><i>${fecha}</i></div>\n          </body>\n        </html>`)\n        ventana.document.close()\n        ventana.print()\n      },\n      exportarAExcel() {\n        const tabla = document.querySelector('table')\n        const wb = XLSX.utils.table_to_book(tabla)\n        XLSX.writeFile(wb, 'ConsoldidaFinal.xlsx')\n      },\n      redondear(num) {\n        var m = Number((Math.abs(num) * 10).toPrecision(15))\n        return Math.round(m) / 10 * Math.sign(num);\n      },\n      async ocuparComboCursosSede() {\n        this.comboCursosSede = []\n        this.$store.state.datosCursos.forEach(element => {\n          if (element.id_sede == this.idSede) {\n            this.comboCursosSede.push({ 'value': element.id, 'text': element.nomenclatura.toUpperCase() })\n          }\n        })\n      },\n      async ocuparComboSedes() {\n        this.comboSedes = []\n        this.$store.state.datosSedes.forEach(element => {\n          this.comboSedes.push({ 'value': element.id, 'text': element.sede.toUpperCase() })\n        })\n      },\n      async ocuparComboPeriodos() {\n        this.comboPeriodos = []\n        this.$store.state.periodos.forEach(element => {\n          this.comboPeriodos.push({ 'value': element.id, 'text': element.periodo.toUpperCase() })\n        })\n      },\n      mensajeEmergente(variante, titulo, contenido) {\n        this.$bvToast.toast(contenido, { title: titulo, variant: variante, toaster: \"b-toaster-top-center\", solid: true, autoHideDelay: 4000, appendToast: false })\n      }\n    },\n    computed: {\n      totales() {\n        return this.totalesGlobales()\n      },\n      estudiantesNotas() {\n        const mapa = {}\n        this.datosRaw.forEach(row => {\n          const { obs_comision, id_matricula, idAsignaturaCurso, estudiante, area, asignatura, ih, periodo, definitiva, recuperacion, orden, definitivacompor, definitivapree, idTipoEspecialidad, ausJ, ausS, porcentaje, id_conceptual } = row\n          if (!mapa[estudiante]) {\n            mapa[estudiante] = { idMatricula: id_matricula, obs_comision, id_conceptual, ausJ: 0, ausS: 0, areas: {} }\n          }\n          if (!mapa[estudiante].areas[area]) {\n            mapa[estudiante].areas[area] = { asignaturas: {} }\n          }\n          if (!mapa[estudiante].areas[area].asignaturas[asignatura]) {\n            mapa[estudiante].areas[area].asignaturas[asignatura] = {\n              idMatricula: id_matricula,\n              idAsignaturaCurso,\n              ih,\n              periodos: {},\n              orden,\n              idTipoEspecialidad,\n              porcentaje,\n              pesos: { 1: this.datosSeccion.pesoP1, 2: this.datosSeccion.pesoP2, 3: this.datosSeccion.pesoP3, 4: this.datosSeccion.pesoP4 }\n            }\n          }\n          let notaFinal = 0\n          if (orden === 99) {\n            if (this.datosSeccion.tipoValComp == 1) {\n              notaFinal = definitiva\n            } else {\n              notaFinal = definitivacompor != null ? definitivacompor : ''\n            }\n          } else {\n            if (this.idNivel == 1) {\n              notaFinal = definitivapree != null && definitivapree != 0 && definitivapree != '' ? definitivapree : ''\n            } else {\n              notaFinal = recuperacion > definitiva ? recuperacion : definitiva\n            }\n          }\n          mapa[estudiante].areas[area].asignaturas[asignatura].periodos[periodo] = notaFinal\n          mapa[estudiante].ausJ += ausJ || 0\n          mapa[estudiante].ausS += ausS || 0\n        })\n        return mapa\n      },\n      totalColumnasPromedioArea() {\n        const areasUnicas = new Set(this.listaAreasAsignaturas.map(a => a.area))\n        return areasUnicas.size\n      },\n      puestosPorEstudiante() {\n        const lista = Object.entries(this.estudiantesNotas).map(([nombre, areas]) => {\n          const promedio = parseFloat(this.calcularPromedioGeneral(areas))\n          return { nombre, promedio: isNaN(promedio) ? 0 : promedio }\n        })\n        // Ordenar de mayor a menor\n        lista.sort((a, b) => b.promedio - a.promedio)\n        const puestos = {}\n        let puestoActual = 1\n        let contador = 1\n        let ultimoPromedio = null\n        lista.forEach(est => {\n          if (est.promedio !== ultimoPromedio) {\n            puestoActual = contador\n            ultimoPromedio = est.promedio\n            contador++\n          }\n          puestos[est.nombre] = puestoActual\n          //contador++\n        })\n        return puestos\n      },\n      encabezadoPorArea() {\n        const mapa = {}\n        this.listaAreasAsignaturas.forEach(({ area, asignatura }) => {\n          if (!mapa[area]) mapa[area] = []\n          mapa[area].push(asignatura)\n        })\n        return mapa\n      },\n    },\n    beforeMount() {\n      this.ocuparComboSedes()\n      this.ocuparComboPeriodos()\n      this.consultarHabilitaciones()\n      this.datosSeccion = this.$store.state.datosSecciones[this.$store.state.idSeccion - 1]\n      //console.log(JSON.stringify(this.datosSeccion))\n    }\n  }\n</script>\n<style scoped>\n  table {\n    border-collapse: collapse;\n    width: 100%;\n    text-align: center;\n    font-size: 10px;\n  }\n  th {\n    background: #eee;\n  }\n  .nota-recuperada {\n    border: 2px solid #ffa500;\n    box-shadow: 0 0 5px #ffa500;\n  }\n  .desempeno-bajo { background-color: #f8d7da; color: #721c24; }\n  .desempeno-basico { background-color: #d1ecf1; color: #0c5460; }\n  .desempeno-alto { background-color: #fff3cd; color: #856404; }\n  .desempeno-superior { background-color: #d4edda; color: #155724; }\n  .desempeno-extra { background-color: #f4ecf5; color: #2f2e2e; }\n  .promedio-area {\n    background-color: #f2f2f2;\n    font-weight: bold;\n    text-align: center;\n  }\n  .bloque-area th,\n  .bloque-area td {\n    border-right: 3px solid #999; /* lnea divisoria entre reas */\n  }\n\n</style>\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ResumenPromocionAreasDefinitivo.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ResumenPromocionAreasDefinitivo.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ResumenPromocionAreasDefinitivo.vue?vue&type=template&id=a4b7125e&scoped=true&\"\nimport script from \"./ResumenPromocionAreasDefinitivo.vue?vue&type=script&lang=js&\"\nexport * from \"./ResumenPromocionAreasDefinitivo.vue?vue&type=script&lang=js&\"\nimport style0 from \"./ResumenPromocionAreasDefinitivo.vue?vue&type=style&index=0&id=a4b7125e&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"a4b7125e\",\n  null\n  \n)\n\nexport default component.exports","<template>\n  <div>\n    <b-row class=\"mt-2\">\n      <b-col lg=\"12\">\n        <b-card>\n          <template #header>\n            <h5 class=\"mb-0\"><b-icon icon=\"card-checklist\" aria-hidden=\"true\"></b-icon> CONSOLIDADOS</h5>\n          </template>\n          <b-card-text>\n            <b-row>\n              <b-col lg=\"12\">\n                <b-card bg-variant=\"light\" text-variant=\"\">\n                  <b-card-text>\n                    <b-row>\n                      <b-col lg=\"4\">\n                        <h6>Evaluaciones</h6>\n                        <b-form-group label=\"\" v-slot=\"{ ariaDescribedby }\">\n                          <b-form-radio v-model=\"idConsolidado\" :aria-describedby=\"ariaDescribedby\" name=\"some-radios\" value=\"1\">Resumen por Periodo</b-form-radio>\n                          <b-form-radio v-model=\"idConsolidado\" :aria-describedby=\"ariaDescribedby\" name=\"some-radios\" value=\"2\">Consolidado Acumulado/Promedio</b-form-radio>\n                          <b-form-radio v-model=\"idConsolidado\" :aria-describedby=\"ariaDescribedby\" name=\"some-radios\" value=\"3\">Consolidado Acumulado/Ponderado</b-form-radio>\n                          <b-form-radio v-model=\"idConsolidado\" :aria-describedby=\"ariaDescribedby\" name=\"some-radios\" value=\"4\">Notas Faltantes por Asignatura</b-form-radio>\n                          <b-form-radio v-model=\"idConsolidado\" :aria-describedby=\"ariaDescribedby\" name=\"some-radios\" value=\"5\">Notas Faltantes por rea</b-form-radio>\n                        </b-form-group>\n                      </b-col>\n                      <b-col lg=\"4\">\n                        <h6>Ausencias</h6>\n                        <b-form-group label=\"\" v-slot=\"{ ariaDescribedby }\">\n                          <b-form-radio v-model=\"idConsolidado\" :aria-describedby=\"ariaDescribedby\" name=\"some-radios\" value=\"10\">Ausencias por Periodo</b-form-radio>\n                          <b-form-radio v-model=\"idConsolidado\" :aria-describedby=\"ariaDescribedby\" name=\"some-radios\" value=\"11\">Consolidado Ausencias</b-form-radio>\n                        </b-form-group>\n                        <h6>Perdidas</h6>\n                        <b-form-group label=\"\" v-slot=\"{ ariaDescribedby }\">\n                          <b-form-radio v-model=\"idConsolidado\" :aria-describedby=\"ariaDescribedby\" name=\"some-radios\" value=\"20\">Asignaturas Perdidas</b-form-radio>\n                          <b-form-radio v-model=\"idConsolidado\" :aria-describedby=\"ariaDescribedby\" name=\"some-radios\" value=\"21\">reas Perdidas</b-form-radio>\n                        </b-form-group>\n                      </b-col>\n                      <b-col lg=\"4\">\n                        <h6>Finales</h6>\n                        <b-form-group label=\"\" v-slot=\"{ ariaDescribedby }\">\n                          <b-form-radio v-model=\"idConsolidado\" :aria-describedby=\"ariaDescribedby\" name=\"some-radios\" value=\"33\">Consolidado Evaluaciones Finales por Asignaturas</b-form-radio>\n                          <b-form-radio v-model=\"idConsolidado\" :aria-describedby=\"ariaDescribedby\" name=\"some-radios\" value=\"35\">Consolidado Evaluaciones Finales por reas</b-form-radio>\n                          <!--\n                          <b-form-radio v-model=\"idConsolidado\" :aria-describedby=\"ariaDescribedby\" name=\"some-radios\" value=\"30\">Resumen Final por Estudiante</b-form-radio>\n                          <b-form-radio v-model=\"idConsolidado\" :aria-describedby=\"ariaDescribedby\" name=\"some-radios\" value=\"31\">Resumen Final por Estudiante con Habilitaciones</b-form-radio>\n                          -->\n                          <b-form-radio v-model=\"idConsolidado\" :aria-describedby=\"ariaDescribedby\" name=\"some-radios\" value=\"34\">Informe de Asignaturas Perdidas</b-form-radio>\n                          <b-form-radio v-model=\"idConsolidado\" :aria-describedby=\"ariaDescribedby\" name=\"some-radios\" value=\"32\">Reporte Estados sin Superacin Final (Pendientes)</b-form-radio>\n                          <b-form-radio v-model=\"idConsolidado\" :aria-describedby=\"ariaDescribedby\" name=\"some-radios\" value=\"36\">Estados Finales de Promocin Escolar</b-form-radio>\n                        </b-form-group>\n                      </b-col>\n                    </b-row>\n                  </b-card-text>\n                </b-card>\n              </b-col>\n            </b-row>\n            <b-row>\n              <b-col lg=\"12\">\n                <div v-if=\"idConsolidado==1\">\n                  <ResumenPeriodo/>\n                </div>\n                <div v-if=\"idConsolidado==2\">\n                  <ConsolidadoPromedio/>\n                </div>\n                <div v-if=\"idConsolidado==3\">\n                  <ConsolidadoPonderado/>\n                </div>\n                <div v-if=\"idConsolidado==4\">\n                  <NotasFaltantes/>\n                </div>\n                <div v-if=\"idConsolidado==5\">\n                  <NotasFaltantesArea/>\n                </div>\n                <div v-if=\"idConsolidado==10\">\n                  <AusenciasPeriodo/>\n                </div>\n                <div v-if=\"idConsolidado==11\">\n                  <AusenciasPeriodos/>\n                </div>\n                <div v-if=\"idConsolidado==20\">\n                  <AsignaturasPerdidas/>\n                </div>\n                <div v-if=\"idConsolidado==21\">\n                  <AreasPerdidas/>\n                </div>\n                <div v-if=\"idConsolidado==30\">\n                  <ResumenFinal/>\n                </div>\n                <div v-if=\"idConsolidado==31\">\n                  <ResumenFinalHab/>\n                </div>\n                <div v-if=\"idConsolidado==32\">\n                  <ResumenPromocionAreas/>\n                </div>\n                <div v-if=\"idConsolidado==33\">\n                  <ConsolidadoFinal/>\n                </div>\n                <div v-if=\"idConsolidado==34\">\n                  <ResumenFinalAsigPerdidas/>\n                </div>\n                <div v-if=\"idConsolidado==35\">\n                  <ConsolidadoFinalAreas/>\n                </div>\n                <div v-if=\"idConsolidado==36\">\n                  <ResumenPromocionAreasDefinitivo/>\n                </div>\n              </b-col>\n            </b-row>\n          </b-card-text>\n        </b-card>\n      </b-col>\n    </b-row>\n  </div>\n</template>\n\n<script>\n  import axios from \"axios\"\n  import * as CONFIG from '@/assets/config.js'\n  import ResumenPeriodo from '@/views/informes/consolidados/ResumenPeriodo'\n  import ConsolidadoPromedio from '@/views/informes/consolidados/ConsolidadoPromedio'\n  import NotasFaltantes from '@/views/informes/consolidados/NotasFaltantes'\n  import NotasFaltantesArea from '@/views/informes/consolidados/NotasFaltantesArea'\n  import ConsolidadoPonderado from '@/views/informes/consolidados/ConsolidadoPonderado'\n  import AusenciasPeriodo from '@/views/informes/consolidados/AusenciasPeriodo'\n  import AusenciasPeriodos from '@/views/informes/consolidados/AusenciasPeriodos'\n  import ResumenFinal from '@/views/informes/consolidados/ResumenFinal'\n  import ResumenFinalHab from '@/views/informes/consolidados/ResumenFinalHab'\n  import ResumenPromocionAreas from '@/views/informes/consolidados/ResumenPromocionAreas'\n  import AsignaturasPerdidas from '@/views/informes/consolidados/AsignaturasPerdidas'\n  import AreasPerdidas from '@/views/informes/consolidados/AreasPerdidas'\n  import ConsolidadoFinal from '@/views/informes/consolidados/ConsolidadoFinal'\n  import ConsolidadoFinalEmiliani from '@/views/informes/consolidados/ConsolidadoFinalEmiliani'\n  import ConsolidadoFinalInem from '@/views/informes/consolidados/ConsolidadoFinalInem'\n  import ResumenFinalAsigPerdidas from '@/views/informes/consolidados/ResumenFinalAsigPerdidas'\n  import ConsolidadoFinalAreas from '@/views/informes/consolidados/ConsolidadoFinalAreas'\n  import ResumenPromocionAreasDefinitivo from '@/views/informes/consolidados/ResumenPromocionAreasDefinitivo'\n\n  export default {\n    name: 'consolidados',\n    components: {\n      ResumenPeriodo,\n      ConsolidadoPromedio,\n      ConsolidadoPonderado,\n      NotasFaltantes,\n      NotasFaltantesArea,\n      AusenciasPeriodo,\n      AusenciasPeriodos,\n      ResumenFinal,\n      ResumenFinalHab,\n      ResumenPromocionAreas,\n      AsignaturasPerdidas,\n      AreasPerdidas,\n      ConsolidadoFinal,\n      ConsolidadoFinalEmiliani,\n      ConsolidadoFinalInem,\n      ResumenFinalAsigPerdidas,\n      ConsolidadoFinalAreas,\n      ResumenPromocionAreasDefinitivo,\n    },\n    data () {\n      return {\n        idConsolidado: null,\n      }\n    },\n    methods: {\n      mensajeEmergente(variante, titulo, contenido) {\n        this.$bvToast.toast(contenido, { title: titulo, variant: variante, toaster: \"b-toaster-top-center\", solid: true, autoHideDelay: 4000, appendToast: false })\n      }\n    },\n    beforeMount() {\n    }\n  }\n</script>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Consolidados.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Consolidados.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Consolidados.vue?vue&type=template&id=148f1ad4&\"\nimport script from \"./Consolidados.vue?vue&type=script&lang=js&\"\nexport * from \"./Consolidados.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ConsolidadoFinal.vue?vue&type=style&index=0&id=ae2d58f6&scoped=true&lang=css&\"","import arrayLikeToArray from \"./arrayLikeToArray.js\";\nexport default function _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return arrayLikeToArray(arr);\n}","export default function _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter);\n}","export default function _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}","import arrayWithoutHoles from \"./arrayWithoutHoles.js\";\nimport iterableToArray from \"./iterableToArray.js\";\nimport unsupportedIterableToArray from \"./unsupportedIterableToArray.js\";\nimport nonIterableSpread from \"./nonIterableSpread.js\";\nexport default function _toConsumableArray(arr) {\n  return arrayWithoutHoles(arr) || iterableToArray(arr) || unsupportedIterableToArray(arr) || nonIterableSpread();\n}","export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ConsolidadoFinalEmiliani.vue?vue&type=style&index=0&id=fbc2034a&scoped=true&lang=css&\"","export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AusenciasPeriodos.vue?vue&type=style&index=0&id=c83aa168&scoped=true&lang=css&\"","export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./NotasFaltantesArea.vue?vue&type=style&index=0&id=f8e70a2a&scoped=true&lang=css&\"","export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ConsolidadoFinalInem.vue?vue&type=style&index=0&id=63f0d732&scoped=true&lang=css&\"","export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ConsolidadoPromedio.vue?vue&type=style&index=0&id=44a06de5&scoped=true&lang=css&\"","export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ResumenFinalAsigPerdidas.vue?vue&type=style&index=0&id=4d1f46c6&scoped=true&lang=css&\"","export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AreasPerdidas.vue?vue&type=style&index=0&id=98a0c286&scoped=true&lang=css&\"","/**\n * Copyright (c) 2014-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nvar runtime = (function (exports) {\n  \"use strict\";\n\n  var Op = Object.prototype;\n  var hasOwn = Op.hasOwnProperty;\n  var undefined; // More compressible than void 0.\n  var $Symbol = typeof Symbol === \"function\" ? Symbol : {};\n  var iteratorSymbol = $Symbol.iterator || \"@@iterator\";\n  var asyncIteratorSymbol = $Symbol.asyncIterator || \"@@asyncIterator\";\n  var toStringTagSymbol = $Symbol.toStringTag || \"@@toStringTag\";\n\n  function define(obj, key, value) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n    return obj[key];\n  }\n  try {\n    // IE 8 has a broken Object.defineProperty that only works on DOM objects.\n    define({}, \"\");\n  } catch (err) {\n    define = function(obj, key, value) {\n      return obj[key] = value;\n    };\n  }\n\n  function wrap(innerFn, outerFn, self, tryLocsList) {\n    // If outerFn provided and outerFn.prototype is a Generator, then outerFn.prototype instanceof Generator.\n    var protoGenerator = outerFn && outerFn.prototype instanceof Generator ? outerFn : Generator;\n    var generator = Object.create(protoGenerator.prototype);\n    var context = new Context(tryLocsList || []);\n\n    // The ._invoke method unifies the implementations of the .next,\n    // .throw, and .return methods.\n    generator._invoke = makeInvokeMethod(innerFn, self, context);\n\n    return generator;\n  }\n  exports.wrap = wrap;\n\n  // Try/catch helper to minimize deoptimizations. Returns a completion\n  // record like context.tryEntries[i].completion. This interface could\n  // have been (and was previously) designed to take a closure to be\n  // invoked without arguments, but in all the cases we care about we\n  // already have an existing method we want to call, so there's no need\n  // to create a new function object. We can even get away with assuming\n  // the method takes exactly one argument, since that happens to be true\n  // in every case, so we don't have to touch the arguments object. The\n  // only additional allocation required is the completion record, which\n  // has a stable shape and so hopefully should be cheap to allocate.\n  function tryCatch(fn, obj, arg) {\n    try {\n      return { type: \"normal\", arg: fn.call(obj, arg) };\n    } catch (err) {\n      return { type: \"throw\", arg: err };\n    }\n  }\n\n  var GenStateSuspendedStart = \"suspendedStart\";\n  var GenStateSuspendedYield = \"suspendedYield\";\n  var GenStateExecuting = \"executing\";\n  var GenStateCompleted = \"completed\";\n\n  // Returning this object from the innerFn has the same effect as\n  // breaking out of the dispatch switch statement.\n  var ContinueSentinel = {};\n\n  // Dummy constructor functions that we use as the .constructor and\n  // .constructor.prototype properties for functions that return Generator\n  // objects. For full spec compliance, you may wish to configure your\n  // minifier not to mangle the names of these two functions.\n  function Generator() {}\n  function GeneratorFunction() {}\n  function GeneratorFunctionPrototype() {}\n\n  // This is a polyfill for %IteratorPrototype% for environments that\n  // don't natively support it.\n  var IteratorPrototype = {};\n  IteratorPrototype[iteratorSymbol] = function () {\n    return this;\n  };\n\n  var getProto = Object.getPrototypeOf;\n  var NativeIteratorPrototype = getProto && getProto(getProto(values([])));\n  if (NativeIteratorPrototype &&\n      NativeIteratorPrototype !== Op &&\n      hasOwn.call(NativeIteratorPrototype, iteratorSymbol)) {\n    // This environment has a native %IteratorPrototype%; use it instead\n    // of the polyfill.\n    IteratorPrototype = NativeIteratorPrototype;\n  }\n\n  var Gp = GeneratorFunctionPrototype.prototype =\n    Generator.prototype = Object.create(IteratorPrototype);\n  GeneratorFunction.prototype = Gp.constructor = GeneratorFunctionPrototype;\n  GeneratorFunctionPrototype.constructor = GeneratorFunction;\n  GeneratorFunction.displayName = define(\n    GeneratorFunctionPrototype,\n    toStringTagSymbol,\n    \"GeneratorFunction\"\n  );\n\n  // Helper for defining the .next, .throw, and .return methods of the\n  // Iterator interface in terms of a single ._invoke method.\n  function defineIteratorMethods(prototype) {\n    [\"next\", \"throw\", \"return\"].forEach(function(method) {\n      define(prototype, method, function(arg) {\n        return this._invoke(method, arg);\n      });\n    });\n  }\n\n  exports.isGeneratorFunction = function(genFun) {\n    var ctor = typeof genFun === \"function\" && genFun.constructor;\n    return ctor\n      ? ctor === GeneratorFunction ||\n        // For the native GeneratorFunction constructor, the best we can\n        // do is to check its .name property.\n        (ctor.displayName || ctor.name) === \"GeneratorFunction\"\n      : false;\n  };\n\n  exports.mark = function(genFun) {\n    if (Object.setPrototypeOf) {\n      Object.setPrototypeOf(genFun, GeneratorFunctionPrototype);\n    } else {\n      genFun.__proto__ = GeneratorFunctionPrototype;\n      define(genFun, toStringTagSymbol, \"GeneratorFunction\");\n    }\n    genFun.prototype = Object.create(Gp);\n    return genFun;\n  };\n\n  // Within the body of any async function, `await x` is transformed to\n  // `yield regeneratorRuntime.awrap(x)`, so that the runtime can test\n  // `hasOwn.call(value, \"__await\")` to determine if the yielded value is\n  // meant to be awaited.\n  exports.awrap = function(arg) {\n    return { __await: arg };\n  };\n\n  function AsyncIterator(generator, PromiseImpl) {\n    function invoke(method, arg, resolve, reject) {\n      var record = tryCatch(generator[method], generator, arg);\n      if (record.type === \"throw\") {\n        reject(record.arg);\n      } else {\n        var result = record.arg;\n        var value = result.value;\n        if (value &&\n            typeof value === \"object\" &&\n            hasOwn.call(value, \"__await\")) {\n          return PromiseImpl.resolve(value.__await).then(function(value) {\n            invoke(\"next\", value, resolve, reject);\n          }, function(err) {\n            invoke(\"throw\", err, resolve, reject);\n          });\n        }\n\n        return PromiseImpl.resolve(value).then(function(unwrapped) {\n          // When a yielded Promise is resolved, its final value becomes\n          // the .value of the Promise<{value,done}> result for the\n          // current iteration.\n          result.value = unwrapped;\n          resolve(result);\n        }, function(error) {\n          // If a rejected Promise was yielded, throw the rejection back\n          // into the async generator function so it can be handled there.\n          return invoke(\"throw\", error, resolve, reject);\n        });\n      }\n    }\n\n    var previousPromise;\n\n    function enqueue(method, arg) {\n      function callInvokeWithMethodAndArg() {\n        return new PromiseImpl(function(resolve, reject) {\n          invoke(method, arg, resolve, reject);\n        });\n      }\n\n      return previousPromise =\n        // If enqueue has been called before, then we want to wait until\n        // all previous Promises have been resolved before calling invoke,\n        // so that results are always delivered in the correct order. If\n        // enqueue has not been called before, then it is important to\n        // call invoke immediately, without waiting on a callback to fire,\n        // so that the async generator function has the opportunity to do\n        // any necessary setup in a predictable way. This predictability\n        // is why the Promise constructor synchronously invokes its\n        // executor callback, and why async functions synchronously\n        // execute code before the first await. Since we implement simple\n        // async functions in terms of async generators, it is especially\n        // important to get this right, even though it requires care.\n        previousPromise ? previousPromise.then(\n          callInvokeWithMethodAndArg,\n          // Avoid propagating failures to Promises returned by later\n          // invocations of the iterator.\n          callInvokeWithMethodAndArg\n        ) : callInvokeWithMethodAndArg();\n    }\n\n    // Define the unified helper method that is used to implement .next,\n    // .throw, and .return (see defineIteratorMethods).\n    this._invoke = enqueue;\n  }\n\n  defineIteratorMethods(AsyncIterator.prototype);\n  AsyncIterator.prototype[asyncIteratorSymbol] = function () {\n    return this;\n  };\n  exports.AsyncIterator = AsyncIterator;\n\n  // Note that simple async functions are implemented on top of\n  // AsyncIterator objects; they just return a Promise for the value of\n  // the final result produced by the iterator.\n  exports.async = function(innerFn, outerFn, self, tryLocsList, PromiseImpl) {\n    if (PromiseImpl === void 0) PromiseImpl = Promise;\n\n    var iter = new AsyncIterator(\n      wrap(innerFn, outerFn, self, tryLocsList),\n      PromiseImpl\n    );\n\n    return exports.isGeneratorFunction(outerFn)\n      ? iter // If outerFn is a generator, return the full iterator.\n      : iter.next().then(function(result) {\n          return result.done ? result.value : iter.next();\n        });\n  };\n\n  function makeInvokeMethod(innerFn, self, context) {\n    var state = GenStateSuspendedStart;\n\n    return function invoke(method, arg) {\n      if (state === GenStateExecuting) {\n        throw new Error(\"Generator is already running\");\n      }\n\n      if (state === GenStateCompleted) {\n        if (method === \"throw\") {\n          throw arg;\n        }\n\n        // Be forgiving, per 25.3.3.3.3 of the spec:\n        // https://people.mozilla.org/~jorendorff/es6-draft.html#sec-generatorresume\n        return doneResult();\n      }\n\n      context.method = method;\n      context.arg = arg;\n\n      while (true) {\n        var delegate = context.delegate;\n        if (delegate) {\n          var delegateResult = maybeInvokeDelegate(delegate, context);\n          if (delegateResult) {\n            if (delegateResult === ContinueSentinel) continue;\n            return delegateResult;\n          }\n        }\n\n        if (context.method === \"next\") {\n          // Setting context._sent for legacy support of Babel's\n          // function.sent implementation.\n          context.sent = context._sent = context.arg;\n\n        } else if (context.method === \"throw\") {\n          if (state === GenStateSuspendedStart) {\n            state = GenStateCompleted;\n            throw context.arg;\n          }\n\n          context.dispatchException(context.arg);\n\n        } else if (context.method === \"return\") {\n          context.abrupt(\"return\", context.arg);\n        }\n\n        state = GenStateExecuting;\n\n        var record = tryCatch(innerFn, self, context);\n        if (record.type === \"normal\") {\n          // If an exception is thrown from innerFn, we leave state ===\n          // GenStateExecuting and loop back for another invocation.\n          state = context.done\n            ? GenStateCompleted\n            : GenStateSuspendedYield;\n\n          if (record.arg === ContinueSentinel) {\n            continue;\n          }\n\n          return {\n            value: record.arg,\n            done: context.done\n          };\n\n        } else if (record.type === \"throw\") {\n          state = GenStateCompleted;\n          // Dispatch the exception by looping back around to the\n          // context.dispatchException(context.arg) call above.\n          context.method = \"throw\";\n          context.arg = record.arg;\n        }\n      }\n    };\n  }\n\n  // Call delegate.iterator[context.method](context.arg) and handle the\n  // result, either by returning a { value, done } result from the\n  // delegate iterator, or by modifying context.method and context.arg,\n  // setting context.delegate to null, and returning the ContinueSentinel.\n  function maybeInvokeDelegate(delegate, context) {\n    var method = delegate.iterator[context.method];\n    if (method === undefined) {\n      // A .throw or .return when the delegate iterator has no .throw\n      // method always terminates the yield* loop.\n      context.delegate = null;\n\n      if (context.method === \"throw\") {\n        // Note: [\"return\"] must be used for ES3 parsing compatibility.\n        if (delegate.iterator[\"return\"]) {\n          // If the delegate iterator has a return method, give it a\n          // chance to clean up.\n          context.method = \"return\";\n          context.arg = undefined;\n          maybeInvokeDelegate(delegate, context);\n\n          if (context.method === \"throw\") {\n            // If maybeInvokeDelegate(context) changed context.method from\n            // \"return\" to \"throw\", let that override the TypeError below.\n            return ContinueSentinel;\n          }\n        }\n\n        context.method = \"throw\";\n        context.arg = new TypeError(\n          \"The iterator does not provide a 'throw' method\");\n      }\n\n      return ContinueSentinel;\n    }\n\n    var record = tryCatch(method, delegate.iterator, context.arg);\n\n    if (record.type === \"throw\") {\n      context.method = \"throw\";\n      context.arg = record.arg;\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    var info = record.arg;\n\n    if (! info) {\n      context.method = \"throw\";\n      context.arg = new TypeError(\"iterator result is not an object\");\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    if (info.done) {\n      // Assign the result of the finished delegate to the temporary\n      // variable specified by delegate.resultName (see delegateYield).\n      context[delegate.resultName] = info.value;\n\n      // Resume execution at the desired location (see delegateYield).\n      context.next = delegate.nextLoc;\n\n      // If context.method was \"throw\" but the delegate handled the\n      // exception, let the outer generator proceed normally. If\n      // context.method was \"next\", forget context.arg since it has been\n      // \"consumed\" by the delegate iterator. If context.method was\n      // \"return\", allow the original .return call to continue in the\n      // outer generator.\n      if (context.method !== \"return\") {\n        context.method = \"next\";\n        context.arg = undefined;\n      }\n\n    } else {\n      // Re-yield the result returned by the delegate method.\n      return info;\n    }\n\n    // The delegate iterator is finished, so forget it and continue with\n    // the outer generator.\n    context.delegate = null;\n    return ContinueSentinel;\n  }\n\n  // Define Generator.prototype.{next,throw,return} in terms of the\n  // unified ._invoke helper method.\n  defineIteratorMethods(Gp);\n\n  define(Gp, toStringTagSymbol, \"Generator\");\n\n  // A Generator should always return itself as the iterator object when the\n  // @@iterator function is called on it. Some browsers' implementations of the\n  // iterator prototype chain incorrectly implement this, causing the Generator\n  // object to not be returned from this call. This ensures that doesn't happen.\n  // See https://github.com/facebook/regenerator/issues/274 for more details.\n  Gp[iteratorSymbol] = function() {\n    return this;\n  };\n\n  Gp.toString = function() {\n    return \"[object Generator]\";\n  };\n\n  function pushTryEntry(locs) {\n    var entry = { tryLoc: locs[0] };\n\n    if (1 in locs) {\n      entry.catchLoc = locs[1];\n    }\n\n    if (2 in locs) {\n      entry.finallyLoc = locs[2];\n      entry.afterLoc = locs[3];\n    }\n\n    this.tryEntries.push(entry);\n  }\n\n  function resetTryEntry(entry) {\n    var record = entry.completion || {};\n    record.type = \"normal\";\n    delete record.arg;\n    entry.completion = record;\n  }\n\n  function Context(tryLocsList) {\n    // The root entry object (effectively a try statement without a catch\n    // or a finally block) gives us a place to store values thrown from\n    // locations where there is no enclosing try statement.\n    this.tryEntries = [{ tryLoc: \"root\" }];\n    tryLocsList.forEach(pushTryEntry, this);\n    this.reset(true);\n  }\n\n  exports.keys = function(object) {\n    var keys = [];\n    for (var key in object) {\n      keys.push(key);\n    }\n    keys.reverse();\n\n    // Rather than returning an object with a next method, we keep\n    // things simple and return the next function itself.\n    return function next() {\n      while (keys.length) {\n        var key = keys.pop();\n        if (key in object) {\n          next.value = key;\n          next.done = false;\n          return next;\n        }\n      }\n\n      // To avoid creating an additional object, we just hang the .value\n      // and .done properties off the next function object itself. This\n      // also ensures that the minifier will not anonymize the function.\n      next.done = true;\n      return next;\n    };\n  };\n\n  function values(iterable) {\n    if (iterable) {\n      var iteratorMethod = iterable[iteratorSymbol];\n      if (iteratorMethod) {\n        return iteratorMethod.call(iterable);\n      }\n\n      if (typeof iterable.next === \"function\") {\n        return iterable;\n      }\n\n      if (!isNaN(iterable.length)) {\n        var i = -1, next = function next() {\n          while (++i < iterable.length) {\n            if (hasOwn.call(iterable, i)) {\n              next.value = iterable[i];\n              next.done = false;\n              return next;\n            }\n          }\n\n          next.value = undefined;\n          next.done = true;\n\n          return next;\n        };\n\n        return next.next = next;\n      }\n    }\n\n    // Return an iterator with no values.\n    return { next: doneResult };\n  }\n  exports.values = values;\n\n  function doneResult() {\n    return { value: undefined, done: true };\n  }\n\n  Context.prototype = {\n    constructor: Context,\n\n    reset: function(skipTempReset) {\n      this.prev = 0;\n      this.next = 0;\n      // Resetting context._sent for legacy support of Babel's\n      // function.sent implementation.\n      this.sent = this._sent = undefined;\n      this.done = false;\n      this.delegate = null;\n\n      this.method = \"next\";\n      this.arg = undefined;\n\n      this.tryEntries.forEach(resetTryEntry);\n\n      if (!skipTempReset) {\n        for (var name in this) {\n          // Not sure about the optimal order of these conditions:\n          if (name.charAt(0) === \"t\" &&\n              hasOwn.call(this, name) &&\n              !isNaN(+name.slice(1))) {\n            this[name] = undefined;\n          }\n        }\n      }\n    },\n\n    stop: function() {\n      this.done = true;\n\n      var rootEntry = this.tryEntries[0];\n      var rootRecord = rootEntry.completion;\n      if (rootRecord.type === \"throw\") {\n        throw rootRecord.arg;\n      }\n\n      return this.rval;\n    },\n\n    dispatchException: function(exception) {\n      if (this.done) {\n        throw exception;\n      }\n\n      var context = this;\n      function handle(loc, caught) {\n        record.type = \"throw\";\n        record.arg = exception;\n        context.next = loc;\n\n        if (caught) {\n          // If the dispatched exception was caught by a catch block,\n          // then let that catch block handle the exception normally.\n          context.method = \"next\";\n          context.arg = undefined;\n        }\n\n        return !! caught;\n      }\n\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        var record = entry.completion;\n\n        if (entry.tryLoc === \"root\") {\n          // Exception thrown outside of any try block that could handle\n          // it, so set the completion value of the entire function to\n          // throw the exception.\n          return handle(\"end\");\n        }\n\n        if (entry.tryLoc <= this.prev) {\n          var hasCatch = hasOwn.call(entry, \"catchLoc\");\n          var hasFinally = hasOwn.call(entry, \"finallyLoc\");\n\n          if (hasCatch && hasFinally) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            } else if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else if (hasCatch) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            }\n\n          } else if (hasFinally) {\n            if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else {\n            throw new Error(\"try statement without catch or finally\");\n          }\n        }\n      }\n    },\n\n    abrupt: function(type, arg) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc <= this.prev &&\n            hasOwn.call(entry, \"finallyLoc\") &&\n            this.prev < entry.finallyLoc) {\n          var finallyEntry = entry;\n          break;\n        }\n      }\n\n      if (finallyEntry &&\n          (type === \"break\" ||\n           type === \"continue\") &&\n          finallyEntry.tryLoc <= arg &&\n          arg <= finallyEntry.finallyLoc) {\n        // Ignore the finally entry if control is not jumping to a\n        // location outside the try/catch block.\n        finallyEntry = null;\n      }\n\n      var record = finallyEntry ? finallyEntry.completion : {};\n      record.type = type;\n      record.arg = arg;\n\n      if (finallyEntry) {\n        this.method = \"next\";\n        this.next = finallyEntry.finallyLoc;\n        return ContinueSentinel;\n      }\n\n      return this.complete(record);\n    },\n\n    complete: function(record, afterLoc) {\n      if (record.type === \"throw\") {\n        throw record.arg;\n      }\n\n      if (record.type === \"break\" ||\n          record.type === \"continue\") {\n        this.next = record.arg;\n      } else if (record.type === \"return\") {\n        this.rval = this.arg = record.arg;\n        this.method = \"return\";\n        this.next = \"end\";\n      } else if (record.type === \"normal\" && afterLoc) {\n        this.next = afterLoc;\n      }\n\n      return ContinueSentinel;\n    },\n\n    finish: function(finallyLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.finallyLoc === finallyLoc) {\n          this.complete(entry.completion, entry.afterLoc);\n          resetTryEntry(entry);\n          return ContinueSentinel;\n        }\n      }\n    },\n\n    \"catch\": function(tryLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc === tryLoc) {\n          var record = entry.completion;\n          if (record.type === \"throw\") {\n            var thrown = record.arg;\n            resetTryEntry(entry);\n          }\n          return thrown;\n        }\n      }\n\n      // The context.catch method must only be called with a location\n      // argument that corresponds to a known catch block.\n      throw new Error(\"illegal catch attempt\");\n    },\n\n    delegateYield: function(iterable, resultName, nextLoc) {\n      this.delegate = {\n        iterator: values(iterable),\n        resultName: resultName,\n        nextLoc: nextLoc\n      };\n\n      if (this.method === \"next\") {\n        // Deliberately forget the last sent value so that we don't\n        // accidentally pass it on to the delegate.\n        this.arg = undefined;\n      }\n\n      return ContinueSentinel;\n    }\n  };\n\n  // Regardless of whether this script is executing as a CommonJS module\n  // or not, return the runtime object so that we can declare the variable\n  // regeneratorRuntime in the outer scope, which allows this module to be\n  // injected easily by `bin/regenerator --include-runtime script.js`.\n  return exports;\n\n}(\n  // If this script is executing as a CommonJS module, use module.exports\n  // as the regeneratorRuntime namespace. Otherwise create a new empty\n  // object. Either way, the resulting object will be used to initialize\n  // the regeneratorRuntime variable at the top of this file.\n  typeof module === \"object\" ? module.exports : {}\n));\n\ntry {\n  regeneratorRuntime = runtime;\n} catch (accidentalStrictMode) {\n  // This module should not be running in strict mode, so the above\n  // assignment should always work unless something is misconfigured. Just\n  // in case runtime.js accidentally runs in strict mode, we can escape\n  // strict mode using a global Function call. This could conceivably fail\n  // if a Content Security Policy forbids using Function, but in that case\n  // the proper solution is to fix the accidental strict mode problem. If\n  // you've misconfigured your bundler to force strict mode and applied a\n  // CSP to forbid Function, and you're not willing to fix either of those\n  // problems, please detail your unique predicament in a GitHub issue.\n  Function(\"r\", \"regeneratorRuntime = r\")(runtime);\n}\n","export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./NotasFaltantes.vue?vue&type=style&index=0&id=71a8e479&scoped=true&lang=css&\"","export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ResumenPeriodo.vue?vue&type=style&index=0&id=516e5d7a&scoped=true&lang=css&\"","export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ConsolidadoPonderado.vue?vue&type=style&index=0&id=39e3ab4c&scoped=true&lang=css&\"","export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ResumenPromocionAreas.vue?vue&type=style&index=0&id=f56f20da&scoped=true&lang=css&\"","export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ConsolidadoFinalAreas.vue?vue&type=style&index=0&id=26ab95d5&scoped=true&lang=css&\"","export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AusenciasPeriodo.vue?vue&type=style&index=0&id=47b943f5&scoped=true&lang=css&\"","export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ResumenPromocionAreasDefinitivo.vue?vue&type=style&index=0&id=a4b7125e&scoped=true&lang=css&\""],"sourceRoot":""}