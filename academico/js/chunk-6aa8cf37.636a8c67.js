(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6aa8cf37"],{"0119":function(e,t,o){},"049f":function(e,t,o){},"0fa6":function(e,t,o){"use strict";o("783a")},"1da1":function(e,t,o){"use strict";o.d(t,"a",(function(){return n}));o("d3b7");function a(e,t,o,a,n,r,s){try{var i=e[r](s),c=i.value}catch(d){return void o(d)}i.done?t(c):Promise.resolve(c).then(a,n)}function n(e){return function(){var t=this,o=arguments;return new Promise((function(n,r){var s=e.apply(t,o);function i(e){a(s,n,r,i,c,"next",e)}function c(e){a(s,n,r,i,c,"throw",e)}i(void 0)}))}}},"207c":function(e,t,o){"use strict";o.r(t);var a=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("b-row",{staticClass:"mt-2"},[o("b-col",{attrs:{lg:"12"}},[o("b-card",{scopedSlots:e._u([{key:"header",fn:function(){return[o("h5",{staticClass:"mb-0"},[o("b-icon",{attrs:{icon:"card-checklist","aria-hidden":"true"}}),e._v(" CONSOLIDADOS")],1)]},proxy:!0}])},[o("b-card-text",[o("b-row",[o("b-col",{attrs:{lg:"12"}},[o("b-card",{attrs:{"bg-variant":"light","text-variant":""}},[o("b-card-text",[o("b-row",[o("b-col",{attrs:{lg:"4"}},[o("h6",[e._v("Evaluaciones")]),o("b-form-group",{attrs:{label:""},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.ariaDescribedby;return[o("b-form-radio",{attrs:{"aria-describedby":a,name:"some-radios",value:"1"},model:{value:e.idConsolidado,callback:function(t){e.idConsolidado=t},expression:"idConsolidado"}},[e._v("Resumen por Periodo")]),o("b-form-radio",{attrs:{"aria-describedby":a,name:"some-radios",value:"2"},model:{value:e.idConsolidado,callback:function(t){e.idConsolidado=t},expression:"idConsolidado"}},[e._v("Consolidado Acumulado/Promedio")]),o("b-form-radio",{attrs:{"aria-describedby":a,name:"some-radios",value:"3"},model:{value:e.idConsolidado,callback:function(t){e.idConsolidado=t},expression:"idConsolidado"}},[e._v("Consolidado Acumulado/Ponderado")]),o("b-form-radio",{attrs:{"aria-describedby":a,name:"some-radios",value:"4"},model:{value:e.idConsolidado,callback:function(t){e.idConsolidado=t},expression:"idConsolidado"}},[e._v("Notas Faltantes por Asignatura")]),o("b-form-radio",{attrs:{"aria-describedby":a,name:"some-radios",value:"5"},model:{value:e.idConsolidado,callback:function(t){e.idConsolidado=t},expression:"idConsolidado"}},[e._v("Notas Faltantes por √Årea")])]}}])})],1),o("b-col",{attrs:{lg:"4"}},[o("h6",[e._v("Ausencias")]),o("b-form-group",{attrs:{label:""},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.ariaDescribedby;return[o("b-form-radio",{attrs:{"aria-describedby":a,name:"some-radios",value:"10"},model:{value:e.idConsolidado,callback:function(t){e.idConsolidado=t},expression:"idConsolidado"}},[e._v("Ausencias por Periodo")]),o("b-form-radio",{attrs:{"aria-describedby":a,name:"some-radios",value:"11"},model:{value:e.idConsolidado,callback:function(t){e.idConsolidado=t},expression:"idConsolidado"}},[e._v("Consolidado Ausencias")])]}}])}),o("h6",[e._v("Perdidas")]),o("b-form-group",{attrs:{label:""},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.ariaDescribedby;return[o("b-form-radio",{attrs:{"aria-describedby":a,name:"some-radios",value:"20"},model:{value:e.idConsolidado,callback:function(t){e.idConsolidado=t},expression:"idConsolidado"}},[e._v("Asignaturas Perdidas")]),o("b-form-radio",{attrs:{"aria-describedby":a,name:"some-radios",value:"21"},model:{value:e.idConsolidado,callback:function(t){e.idConsolidado=t},expression:"idConsolidado"}},[e._v("√Åreas Perdidas")])]}}])})],1),o("b-col",{attrs:{lg:"4"}},[o("h6",[e._v("Finales")]),o("b-form-group",{attrs:{label:""},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.ariaDescribedby;return[o("b-form-radio",{attrs:{"aria-describedby":a,name:"some-radios",value:"33"},model:{value:e.idConsolidado,callback:function(t){e.idConsolidado=t},expression:"idConsolidado"}},[e._v("Consolidado Evaluaciones Finales por Asignaturas")]),o("b-form-radio",{attrs:{"aria-describedby":a,name:"some-radios",value:"35"},model:{value:e.idConsolidado,callback:function(t){e.idConsolidado=t},expression:"idConsolidado"}},[e._v("Consolidado Evaluaciones Finales por √Åreas")]),o("b-form-radio",{attrs:{"aria-describedby":a,name:"some-radios",value:"34"},model:{value:e.idConsolidado,callback:function(t){e.idConsolidado=t},expression:"idConsolidado"}},[e._v("Informe de Asignaturas Perdidas")]),o("b-form-radio",{attrs:{"aria-describedby":a,name:"some-radios",value:"32"},model:{value:e.idConsolidado,callback:function(t){e.idConsolidado=t},expression:"idConsolidado"}},[e._v("Reporte Estados sin Superaci√≥n Final (Pendientes)")]),o("b-form-radio",{attrs:{"aria-describedby":a,name:"some-radios",value:"36"},model:{value:e.idConsolidado,callback:function(t){e.idConsolidado=t},expression:"idConsolidado"}},[e._v("Estados Finales de Promoci√≥n Escolar")])]}}])})],1)],1)],1)],1)],1)],1),o("b-row",[o("b-col",{attrs:{lg:"12"}},[1==e.idConsolidado?o("div",[o("ResumenPeriodo")],1):e._e(),2==e.idConsolidado?o("div",[o("ConsolidadoPromedio")],1):e._e(),3==e.idConsolidado?o("div",[o("ConsolidadoPonderado")],1):e._e(),4==e.idConsolidado?o("div",[o("NotasFaltantes")],1):e._e(),5==e.idConsolidado?o("div",[o("NotasFaltantesArea")],1):e._e(),10==e.idConsolidado?o("div",[o("AusenciasPeriodo")],1):e._e(),11==e.idConsolidado?o("div",[o("AusenciasPeriodos")],1):e._e(),20==e.idConsolidado?o("div",[o("AsignaturasPerdidas")],1):e._e(),21==e.idConsolidado?o("div",[o("AreasPerdidas")],1):e._e(),30==e.idConsolidado?o("div",[o("ResumenFinal")],1):e._e(),31==e.idConsolidado?o("div",[o("ResumenFinalHab")],1):e._e(),32==e.idConsolidado?o("div",[o("ResumenPromocionAreas")],1):e._e(),33==e.idConsolidado?o("div",[o("ConsolidadoFinal")],1):e._e(),34==e.idConsolidado?o("div",[o("ResumenFinalAsigPerdidas")],1):e._e(),35==e.idConsolidado?o("div",[o("ConsolidadoFinalAreas")],1):e._e(),36==e.idConsolidado?o("div",[o("ResumenPromocionAreasDefinitivo")],1):e._e()])],1)],1)],1)],1)],1)],1)},n=[],r=o("bc3a"),s=o.n(r),i=o("9c40"),c=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("b-row",{staticClass:"mt-2"},[o("b-col",{attrs:{lg:"12"}},[o("b-card",{scopedSlots:e._u([{key:"header",fn:function(){return[o("h5",{staticClass:"mb-0"},[o("b-icon",{attrs:{icon:"card-checklist","aria-hidden":"true"}}),e._v(" RESUMEN DE EVALUACIONES POR PERIODO")],1)]},proxy:!0}])},[o("b-card-text",[o("b-row",[o("b-col",{attrs:{lg:"2"}},[o("b-form-group",{staticClass:"etiqueta",attrs:{label:"Periodo:","label-for":"periodo"}},[o("b-form-select",{ref:"periodo",attrs:{id:"periodo",options:e.comboPeriodos},on:{change:function(t){e.idSede=null,e.idCurso=null}},model:{value:e.idPeriodo,callback:function(t){e.idPeriodo=t},expression:"idPeriodo"}})],1)],1),o("b-col",{attrs:{lg:"6"}},[o("b-form-group",{staticClass:"etiqueta",attrs:{label:"Seleccione la Sede:","label-for":"sedes"}},[o("b-form-select",{ref:"sedes",attrs:{id:"sedes",options:e.comboSedes,disabled:null==e.idPeriodo},on:{change:function(t){e.idCurso=null,e.ocuparComboCursosSede()}},model:{value:e.idSede,callback:function(t){e.idSede=t},expression:"idSede"}})],1)],1),o("b-col",{attrs:{lg:"4"}},[o("b-form-group",{staticClass:"etiqueta",attrs:{label:"Seleccione el Curso:","label-for":"cursos"}},[o("b-form-select",{ref:"cursos",attrs:{id:"cursos",options:e.comboCursosSede,disabled:null==e.idSede},on:{change:function(t){return e.consultarEstudiantes()}},model:{value:e.idCurso,callback:function(t){e.idCurso=t},expression:"idCurso"}})],1)],1)],1)],1)],1)],1)],1),o("b-row",[o("b-col",{attrs:{lg:"12"}},[e.btnCargando?o("div",[o("div",{staticClass:"text-center m-5 text-primary"},[o("b-spinner",{staticStyle:{width:"3rem",height:"3rem"},attrs:{label:"Spinner"}}),o("br"),o("strong",[e._v("Cargando informe...")])],1)]):e._e()])],1),e.btnCargando||null==e.idCurso?e._e():o("b-row",[o("b-col",{attrs:{lg:"12"}},[o("table",{staticClass:"table-responsive",attrs:{border:"1",cellspacing:"0",cellpadding:"1"}},[o("thead",[o("tr",[o("th",{attrs:{rowspan:"2"}},[e._v("#")]),o("th",{attrs:{rowspan:"2"}},[e._v("Estudiante")]),e._l(e.encabezadoPorArea,(function(t,a){return o("th",{key:"area"+a,attrs:{colspan:t.length+1}},[e._v(" "+e._s(a)+" ")])})),o("th",{attrs:{rowspan:"2"}},[e._v("PRO GEN")]),o("th",{attrs:{rowspan:"2"}},[e._v("Baj")]),o("th",{attrs:{rowspan:"2"}},[e._v("Bas")]),o("th",{attrs:{rowspan:"2"}},[e._v("Alt")]),o("th",{attrs:{rowspan:"2"}},[e._v("Sup")]),o("th",{attrs:{rowspan:"2"}},[e._v("AuJ")]),o("th",{attrs:{rowspan:"2"}},[e._v("AuS")]),o("th",{attrs:{rowspan:"2"}},[e._v("Pto")]),o("th",{attrs:{rowspan:"2"}},[e._v("#")])],2),o("tr",[e._l(Object.keys(e.encabezadoPorArea),(function(t,a){return[e._l(e.encabezadoPorArea[t],(function(a,n){return o("th",{key:"Asigna-"+t+a+n},[e._v(e._s(a))])})),o("th",{key:"Asi-"+t+a},[e._v("Prom")])]}))],2)]),o("tbody",[e._l(e.estudiantesNotas,(function(t,a,n){return o("tr",{key:a},[o("td",{staticClass:"text-left"},[e._v(e._s(n+1))]),o("td",{staticStyle:{"text-align":"left"}},[e._v(e._s(a))]),e._l(Object.keys(e.encabezadoPorArea),(function(a){return[e._l(e.encabezadoPorArea[a],(function(n,r){return o("td",{key:a+n+r,class:[e.obtenerColor(e.obtenerNota(t,a,n),t,a,n),e.fueRecuperada(t,a,n)?"nota-recuperada":""],attrs:{title:e.fueRecuperada(t,a,n)?"Recuperada desde "+e.obtenerOriginal(t,a,n)+" ‚Üí "+e.obtenerRecuperacion(t,a,n):"Nota final: "+e.obtenerNota(t,a,n)}},[e._v(" "+e._s("N"==t.id_conceptual?e.obtenerNota(t,a,n):"-")+" ")])})),o("td",{key:a+n,staticStyle:{"font-weight":"bold"}},[e._v(" "+e._s("N"==t.id_conceptual?e.calcularPromedioArea(t,a):"-")+" ")])]})),o("td",{class:e.obtenerColorGeneral(e.calcularPromedioGeneral(t)),staticStyle:{"font-weight":"bold","text-align":"center"}},[e._v(" "+e._s("N"==t.id_conceptual?e.calcularPromedioGeneral(t):"-")+" ")]),o("td",{staticStyle:{"text-align":"center",color:"#b22222"}},[e._v(" "+e._s("N"==t.id_conceptual?e.contarDesempenoEstudiante(t,"bajo"):"-")+" ")]),o("td",{staticStyle:{"text-align":"center",color:"#2980b9"}},[e._v(" "+e._s("N"==t.id_conceptual?e.contarDesempenoEstudiante(t,"basico"):"-")+" ")]),o("td",{staticStyle:{"text-align":"center",color:"#e67e22"}},[e._v(" "+e._s("N"==t.id_conceptual?e.contarDesempenoEstudiante(t,"alto"):"-")+" ")]),o("td",{staticStyle:{"text-align":"center",color:"#2e7d32"}},[e._v(" "+e._s("N"==t.id_conceptual?e.contarDesempenoEstudiante(t,"superior"):"-")+" ")]),o("td",{staticStyle:{"text-align":"center"}},[e._v(" "+e._s("N"==t.id_conceptual?t.ausJ:"-")+" ")]),o("td",{staticStyle:{"text-align":"center"}},[e._v(" "+e._s("N"==t.id_conceptual?t.ausS:"-")+" ")]),o("td",{staticStyle:{"text-align":"center","font-weight":"bold"}},[e._v(" "+e._s("N"==t.id_conceptual?e.iconoPuesto(e.puestosPorEstudiante[a]):"-")+" "+e._s("N"==t.id_conceptual?e.puestosPorEstudiante[a]:"-")+" ")]),o("td",{staticClass:"text-left"},[e._v(e._s(n+1))])],2)})),o("tr",{staticStyle:{"background-color":"#f0f0f0","font-weight":"bold"}},[o("td",{attrs:{colspan:"2"}},[e._v("Total Bajos")]),e._l(Object.keys(e.encabezadoPorArea),(function(t){return[e._l(e.encabezadoPorArea[t],(function(a){return[o("td",{key:a+t,staticStyle:{"text-align":"center",color:"#b22222"}},[e._v(" "+e._s(e.contarNotasPorAsignatura(t,a,"bajo"))+" ")])]})),o("td",{key:"bja"+t},[e._v(" "+e._s(e.totalBajosPromedioArea(t))+" ")])]})),o("td"),e._v(" "),o("td",[e._v(e._s(e.contarNotasTotales("bajo")))]),o("td",[e._v(e._s(e.contarNotasTotales("basico")))]),o("td",[e._v(e._s(e.contarNotasTotales("alto")))]),o("td",[e._v(e._s(e.contarNotasTotales("superior")))]),o("td",[e._v(e._s(e.contarAusencias("ausJ")))]),o("td",[e._v(e._s(e.contarAusencias("ausS")))]),o("td"),e._v(" "),o("td")],2)],2)]),o("div",{staticStyle:{"margin-bottom":"1rem"}},[o("b-button",{staticClass:"small mx-1 mt-3",attrs:{variant:"primary"},on:{click:e.imprimir}},[e._v("Imprimir Consolidado")]),o("b-button",{staticClass:"small mx-1 mt-3",attrs:{variant:"outline-primary"},on:{click:e.exportarAExcel}},[e._v("Exportar a Excel")])],1)])],1)],1)},d=[],u=o("3835"),l=o("1da1"),m=o("2909"),p=(o("96cf"),o("159b"),o("07ac"),o("7db0"),o("d3b7"),o("6062"),o("3ca3"),o("ddb0"),o("d81d"),o("4de4"),o("b680"),o("99af"),o("a9e3"),o("2af1"),o("4fad"),o("1146")),b={name:"resumenperiodo",components:{},data:function(){return{idSede:null,comboSedes:[],idPeriodo:null,comboPeriodos:null,idCurso:null,comboCursosSede:[],nombreSede:null,nombreCurso:null,idNivel:null,btnCargando:!1,datosRaw:[],datosSeccion:{},listaAreasAsignaturas:[]}},methods:{totalBajosPromedioArea:function(e){var t=this,o=0;return Object.values(this.estudiantesNotas).forEach((function(a){var n=parseFloat(t.calcularPromedioArea(a,e));!isNaN(n)&&n<t.datosSeccion.minBas&&o++})),o},contarAusencias:function(e){var t=0;return Object.values(this.estudiantesNotas).forEach((function(o){"ausJ"===e&&(t+=o.ausJ||0),"ausS"===e&&(t+=o.ausS||0)})),t},contarNotasPorAsignatura:function(e,t,o){var a=this,n=0;return Object.values(this.estudiantesNotas).forEach((function(r){var s,i,c=null===r||void 0===r||null===(s=r[e])||void 0===s||null===(i=s[t])||void 0===i?void 0:i.nota,d=a.listaAreasAsignaturas.find((function(o){return o.area===e&&o.asignatura===t})),u=null===d||void 0===d?void 0:d.idTipoEspecialidad;"number"===typeof c&&(1===u?("bajo"===o&&c<a.datosSeccion.minBas||"basico"===o&&c>=a.datosSeccion.minBas&&c<a.datosSeccion.minAlt||"alto"===o&&c>=a.datosSeccion.minAlt&&c<a.datosSeccion.minSup||"superior"===o&&c>=a.datosSeccion.minSup&&c<=a.datosSeccion.maxSup)&&n++:("bajo"===o&&c<a.datosSeccion.minBasT||"basico"===o&&c>=a.datosSeccion.minBasT&&c<a.datosSeccion.minAltT||"alto"===o&&c>=a.datosSeccion.minAltT&&c<a.datosSeccion.minSupT||"superior"===o&&c>=a.datosSeccion.minSupT&&c<=a.datosSeccion.maxSupT)&&n++)})),n},contarNotasTotales:function(e){var t=this,o=0;return Object.values(this.estudiantesNotas).forEach((function(a){t.listaAreasAsignaturas.forEach((function(n){var r,s,i,c,d=n.area,u=n.asignatura,l=null===a||void 0===a||null===(r=a[d])||void 0===r||null===(s=r[u])||void 0===s?void 0:s.nota,m=null===a||void 0===a||null===(i=a[d])||void 0===i||null===(c=i[u])||void 0===c?void 0:c.idTipoEspecialidad;"number"===typeof l&&(1===m?("bajo"===e&&l<t.datosSeccion.minBas||"basico"===e&&l>=t.datosSeccion.minBas&&l<t.datosSeccion.minAlt||"alto"===e&&l>=t.datosSeccion.minAlt&&l<t.datosSeccion.minSup||"superior"===e&&l>=t.datosSeccion.minSup&&l<=t.datosSeccion.maxSup)&&o++:("bajo"===e&&l<t.datosSeccion.minBasT||"basico"===e&&l>=t.datosSeccion.minBasT&&l<t.datosSeccion.minAltT||"alto"===e&&l>=t.datosSeccion.minAltT&&l<t.datosSeccion.minSupT||"superior"===e&&l>=t.datosSeccion.minSupT&&l<=t.datosSeccion.maxSupT)&&o++)}))})),o},iconoPuesto:function(e){return 1===e?"ü•á":2===e?"ü•à":3===e?"ü•â":""},calcularPromedioGeneral:function(e){var t=this,o=Object(m["a"])(new Set(this.listaAreasAsignaturas.map((function(e){return e.area})))),a=0,n=0;return o.forEach((function(o){if(1==t.datosSeccion.promCompor){var r=t.listaAreasAsignaturas.filter((function(e){return e.area===o&&98!==e.orden}));if(!r.length)return;var s=parseFloat(t.calcularPromedioArea(e,o));isNaN(s)||(a+=s,n++)}else{var i=t.listaAreasAsignaturas.filter((function(e){return e.area===o&&99!==e.orden&&98!==e.orden}));if(!i.length)return;var c=parseFloat(t.calcularPromedioArea(e,o));isNaN(c)||(a+=c,n++)}})),n>0?(a/n).toFixed(3):""},contarDesempenoEstudiante:function(e,t){var o=this,a=0;return this.listaAreasAsignaturas.forEach((function(n){var r,s,i,c,d=n.area,u=n.asignatura,l=null===e||void 0===e||null===(r=e[d])||void 0===r||null===(s=r[u])||void 0===s?void 0:s.nota,m=null===e||void 0===e||null===(i=e[d])||void 0===i||null===(c=i[u])||void 0===c?void 0:c.idTipoEspecialidad;"number"===typeof l&&(1===m?("bajo"===t&&l<o.datosSeccion.minBas||"basico"===t&&l>=o.datosSeccion.minBas&&l<o.datosSeccion.minAlt||"alto"===t&&l>=o.datosSeccion.minAlt&&l<o.datosSeccion.minSup||"superior"===t&&l>=o.datosSeccion.minSup&&l<=o.datosSeccion.maxSup)&&a++:("bajo"===t&&l<o.datosSeccion.minBasT||"basico"===t&&l>=o.datosSeccion.minBasT&&l<o.datosSeccion.minAltT||"alto"===t&&l>=o.datosSeccion.minAltT&&l<o.datosSeccion.minSupT||"superior"===t&&l>=o.datosSeccion.minSupT&&l<=o.datosSeccion.maxSupT)&&a++)})),a},obtenerNota:function(e,t,o){var a,n,r,s=null!==(a=null===e||void 0===e||null===(n=e[t])||void 0===n||null===(r=n[o])||void 0===r?void 0:r.nota)&&void 0!==a?a:"";return"number"===typeof s?s.toFixed(1):s},fueRecuperada:function(e,t,o){var a,n,r;return null!==(a=null===e||void 0===e||null===(n=e[t])||void 0===n||null===(r=n[o])||void 0===r?void 0:r.fueRecuperada)&&void 0!==a&&a},obtenerOriginal:function(e,t,o){var a,n,r=null===e||void 0===e||null===(a=e[t])||void 0===a||null===(n=a[o])||void 0===n?void 0:n.original;return"number"===typeof r?r.toFixed(1):"0.0"},obtenerRecuperacion:function(e,t,o){var a,n,r=null===e||void 0===e||null===(a=e[t])||void 0===a||null===(n=a[o])||void 0===n?void 0:n.recuperacion;return"number"===typeof r?r.toFixed(1):"0.0"},obtenerColor:function(e,t,o,a){var n,r,s=null===t||void 0===t||null===(n=t[o])||void 0===n||null===(r=n[a])||void 0===r?void 0:r.idTipoEspecialidad;if(e>0)if(1===s){if(e<this.datosSeccion.minBas)return"desempeno-bajo";if(e<this.datosSeccion.minAlt)return"desempeno-basico";if(e<this.datosSeccion.minSup)return"desempeno-alto";if(e<=this.datosSeccion.maxSup)return"desempeno-superior"}else{if(e<this.datosSeccion.minBasT)return"desempeno-bajo";if(e<this.datosSeccion.minAltT)return"desempeno-basico";if(e<this.datosSeccion.minSupT)return"desempeno-alto";if(e<=this.datosSeccion.maxSupT)return"desempeno-superior"}return"desempeno-extra"},obtenerColorGeneral:function(e){return e<this.datosSeccion.minBas?"desempeno-bajo":e<this.datosSeccion.minAlt?"desempeno-basico":e<this.datosSeccion.minSup?"desempeno-alto":e<=this.datosSeccion.maxSup?"desempeno-superior":"desempeno-extra"},calcularPromedioArea:function(e,t){var o="";if(o=1==this.datosSeccion.promCompor?this.listaAreasAsignaturas.filter((function(e){return e.area===t&&98!==e.orden})):this.listaAreasAsignaturas.filter((function(e){return e.area===t&&99!==e.orden&&98!==e.orden})),!o.length)return"";o[0].idTipoArea;var a=0;return o.forEach((function(o){var n,r,s,i=null!==(n=null===e||void 0===e||null===(r=e[t])||void 0===r||null===(s=r[o.asignatura])||void 0===s?void 0:s.nota)&&void 0!==n?n:0;a+=i*(o.porcentaje/100)})),a>0?this.redondear(a).toFixed(1):""},consultarEstudiantes:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.btnCargando=!0,e.nombreSede=document.getElementById("sedes")[document.getElementById("sedes").selectedIndex].text,null==e.idCurso){t.next=11;break}return e.nombreCurso=document.getElementById("cursos")[document.getElementById("cursos").selectedIndex].text,e.$store.state.datosCursos.forEach((function(t){t.id==e.idCurso&&(e.idNivel=t.id_nivel)})),e.listaAreasAsignaturas=[],t.next=8,s.a.get(i["d"]+"consolidados/areasasignaturas/curso",{params:{idCurso:e.idCurso}}).then((function(t){t.data.error?(e.mensajeEmergente("danger",i["h"],t.data.mensaje+" - Lista areas-asignaturas curso"),e.btnCargando=!1):0!=t.data.datos&&(e.listaAreasAsignaturas=t.data.datos)})).catch((function(t){e.mensajeEmergente("danger",i["h"],"Algo salio mal y no se pudo realizar: Lista areas-asignaturas curso. Intente m√°s tarde."+t),e.btnCargando=!1}));case 8:return e.datosRaw=[],t.next=11,s.a.get(i["d"]+"consolidados/asignaturas/curso/periodo",{params:{idCurso:e.idCurso,periodo:e.idPeriodo,vigencia:e.$store.state.aLectivo}}).then((function(t){t.data.error?(e.mensajeEmergente("danger",i["h"],t.data.mensaje+" - Consolidados asignaturas curso periodo"),e.btnCargando=!1):0!=t.data.datos&&(e.datosRaw=t.data.datos)})).catch((function(t){e.mensajeEmergente("danger",i["h"],"Algo salio mal y no se pudo realizar: Consolidados asignaturas curso periodo. Intente m√°s tarde."+t),e.btnCargando=!1}));case 11:e.btnCargando=!1;case 12:case"end":return t.stop()}}),t)})))()},imprimir:function(){var e="Fecha: "+(new Date).toLocaleString(),t="RESUMEN DE EVALUACIONES POR PERIODO",o=document.querySelector("table").outerHTML,a=window.open("Consolidados","_blank");a.document.write('<html><head><title>Imprimir</title></head>\n      <style scoped>\n        table {\n          border-collapse: collapse;\n          width: 100%;\n          text-align: center;\n          font-size: 10px;\n        }\n        th {\n          background: #eee;\n        }\n        .nota-recuperada {\n          border: 2px solid #ffa500;\n          box-shadow: 0 0 5px #ffa500;\n        }\n        .desempeno-bajo { background-color: #f8d7da; color: #721c24; }\n        .desempeno-basico { background-color: #d1ecf1; color: #0c5460; }\n        .desempeno-alto { background-color: #fff3cd; color: #856404; }\n        .desempeno-superior { background-color: #d4edda; color: #155724; }\n        .desempeno-extra { background-color: #f4ecf5; color: #2f2e2e; }\n      </style>\n        <body class="container">\n          <p style="text-align: center; font-size: 12px;">SECRETAR√çA DE EDUCACI√ìN TERRITORIAL DE TUNJA<br><b>'.concat(this.$store.state.nombreInstitucion,"</b><br>TUNJA - BOYAC√Å<br>").concat(t,"<br>Sede: ").concat(this.nombreSede," | Curso: ").concat(this.nombreCurso," | A√±o Lectivo ").concat(this.$store.state.aLectivo," | Periodo: ").concat(this.idPeriodo,"</p>\n          ").concat(o,'\n          <div style="text-align: right; font-size: 12px;"><i>').concat(e,"</i></div>\n        </body>\n      </html>")),a.document.close(),a.print()},exportarAExcel:function(){var e=document.querySelector("table"),t=p["utils"].table_to_book(e);p["writeFile"](t,"notas.xlsx")},redondear:function(e){var t=Number((10*Math.abs(e)).toPrecision(15));return Math.round(t)/10*Math.sign(e)},ocuparComboCursosSede:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.comboCursosSede=[],e.$store.state.datosCursos.forEach((function(t){t.id_sede==e.idSede&&e.comboCursosSede.push({value:t.id,text:t.nomenclatura.toUpperCase()})}));case 2:case"end":return t.stop()}}),t)})))()},ocuparComboSedes:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.comboSedes=[],e.$store.state.datosSedes.forEach((function(t){e.comboSedes.push({value:t.id,text:t.sede.toUpperCase()})}));case 2:case"end":return t.stop()}}),t)})))()},ocuparComboPeriodos:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.comboPeriodos=[],e.$store.state.periodos.forEach((function(t){e.comboPeriodos.push({value:t.id,text:t.periodo.toUpperCase()})}));case 2:case"end":return t.stop()}}),t)})))()},mensajeEmergente:function(e,t,o){this.$bvToast.toast(o,{title:t,variant:e,toaster:"b-toaster-top-center",solid:!0,autoHideDelay:4e3,appendToast:!1})}},computed:{totalColumnasPromedioArea:function(){var e=new Set(this.listaAreasAsignaturas.map((function(e){return e.area})));return e.size},puestosPorEstudiante:function(){var e=this,t=Object.entries(this.estudiantesNotas).map((function(t){var o=Object(u["a"])(t,2),a=o[0],n=o[1],r=parseFloat(e.calcularPromedioGeneral(n));return{nombre:a,promedio:isNaN(r)?0:r}}));t.sort((function(e,t){return t.promedio-e.promedio}));var o={},a=1,n=1,r=null;return t.forEach((function(e){e.promedio!==r&&(a=n,r=e.promedio),o[e.nombre]=a,n++})),o},encabezadoPorArea:function(){var e={};return this.listaAreasAsignaturas.forEach((function(t){var o=t.area,a=t.asignatura;e[o]||(e[o]=[]),e[o].push(a)})),e},estudiantesNotas:function(){var e=this,t={};return this.datosRaw.forEach((function(o){var a=o.estudiante,n=o.area,r=o.asignatura,s=o.definitiva,i=o.recuperacion,c=o.orden,d=o.definitivacompor,u=o.definitivapree,l=o.idTipoEspecialidad,m=o.ausJ,p=o.ausS,b=o.id_conceptual;t[a]||(t[a]={id_conceptual:b,ausJ:0,ausS:0}),t[a][n]||(t[a][n]={});var f=0;f=99===c?1==e.datosSeccion.tipoValComp?s:null!=d&&0!=d&&""!=d?d:"":1==e.idNivel?null!=u&&0!=u&&""!=u?u:"":s>0?i>s?i:s:"",t[a][n][r]={nota:f,fueRecuperada:i>s,original:s,recuperacion:i,idTipoEspecialidad:l},t[a].ausJ+=m||0,t[a].ausS+=p||0})),t}},beforeMount:function(){this.ocuparComboSedes(),this.ocuparComboPeriodos(),this.datosSeccion=this.$store.state.datosSecciones[this.$store.state.idSeccion-1]}},f=b,v=(o("a4bd"),o("2877")),h=Object(v["a"])(f,c,d,!1,null,"516e5d7a",null),S=h.exports,g=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("b-row",{staticClass:"mt-2"},[o("b-col",{attrs:{lg:"12"}},[o("b-card",{scopedSlots:e._u([{key:"header",fn:function(){return[o("h5",{staticClass:"mb-0"},[o("b-icon",{attrs:{icon:"card-checklist","aria-hidden":"true"}}),e._v(" CONSOLIDADO EVALUACIONES ACUMULADO POR PROMEDIO")],1)]},proxy:!0}])},[o("b-card-text",[o("b-row",[o("b-col",{attrs:{lg:"2"}},[o("b-form-group",{staticClass:"etiqueta",attrs:{label:"Periodo:","label-for":"periodo"}},[o("b-form-select",{ref:"periodo",attrs:{id:"periodo",options:e.comboPeriodos},on:{change:function(t){e.idSede=null,e.idCurso=null}},model:{value:e.idPeriodo,callback:function(t){e.idPeriodo=t},expression:"idPeriodo"}})],1)],1),o("b-col",{attrs:{lg:"6"}},[o("b-form-group",{staticClass:"etiqueta",attrs:{label:"Seleccione la Sede:","label-for":"sedes"}},[o("b-form-select",{ref:"sedes",attrs:{id:"sedes",options:e.comboSedes,disabled:null==e.idPeriodo},on:{change:function(t){e.idCurso=null,e.ocuparComboCursosSede()}},model:{value:e.idSede,callback:function(t){e.idSede=t},expression:"idSede"}})],1)],1),o("b-col",{attrs:{lg:"4"}},[o("b-form-group",{staticClass:"etiqueta",attrs:{label:"Seleccione el Curso:","label-for":"cursos"}},[o("b-form-select",{ref:"cursos",attrs:{id:"cursos",options:e.comboCursosSede,disabled:null==e.idSede},on:{change:function(t){return e.consultarEstudiantes()}},model:{value:e.idCurso,callback:function(t){e.idCurso=t},expression:"idCurso"}})],1)],1)],1)],1)],1)],1)],1),o("b-row",[o("b-col",{attrs:{lg:"12"}},[e.btnCargando?o("div",[o("div",{staticClass:"text-center m-5 text-primary"},[o("b-spinner",{staticStyle:{width:"3rem",height:"3rem"},attrs:{label:"Spinner"}}),o("br"),o("strong",[e._v("Cargando informe...")])],1)]):e._e()])],1),e.btnCargando||null==e.idCurso?e._e():o("b-row",[o("b-col",{attrs:{lg:"12"}},[o("table",{staticClass:"table-responsive",attrs:{border:"1",cellspacing:"0",cellpadding:"1"}},[o("thead",[o("tr",[o("th",{attrs:{rowspan:"3"}},[e._v("#")]),o("th",{attrs:{rowspan:"3"}},[e._v("Estudiante")]),e._l(e.encabezadoPorArea,(function(t,a){return[o("th",{key:a,attrs:{colspan:e.colspanArea(a)}},[e._v(" "+e._s(a)+" ")])]})),o("th",{attrs:{rowspan:"3"}},[e._v("PRO GEN")]),o("th",{attrs:{rowspan:"3"}},[e._v("Baj")]),o("th",{attrs:{rowspan:"3"}},[e._v("Bas")]),o("th",{attrs:{rowspan:"3"}},[e._v("Alt")]),o("th",{attrs:{rowspan:"3"}},[e._v("Sup")]),o("th",{attrs:{rowspan:"3"}},[e._v("AuJ")]),o("th",{attrs:{rowspan:"3"}},[e._v("AuS")]),o("th",{attrs:{rowspan:"3"}},[e._v("Pto")]),o("th",{attrs:{rowspan:"3"}},[e._v("#")])],2),o("tr",[e._l(e.encabezadoPorArea,(function(t,a){return[e._l(t,(function(t,a){return[o("th",{key:"area-"+t+a,attrs:{colspan:e.periodosVisibles.length+1}},[e._v(" "+e._s(t)+" ")])]})),o("th",{key:"prom-area-"+a,staticClass:"promedio-area"},[e._v("PRO AR")])]}))],2),o("tr",[e._l(e.encabezadoPorArea,(function(t,a){return[e._l(t,(function(t){return[e._l(e.periodosVisibles,(function(n){return o("th",{key:"h"+a+t+n},[e._v(" P"+e._s(n)+" ")])})),o("th",{key:"prom"+t+a},[e._v("PR")])]})),o("th",{key:"prom"+a})]}))],2)]),o("tbody",[e._l(e.estudiantesNotas,(function(t,a,n){return o("tr",{key:a},[o("td",{staticClass:"text-left"},[e._v(e._s(n+1))]),o("td",{staticStyle:{"text-align":"left"}},[e._v(e._s(a))]),e._l(e.encabezadoPorArea,(function(n,r){return[e._l(n,(function(n){return[e._l(e.periodosVisibles,(function(s){return o("td",{key:a+r+n+s},[e._v(" "+e._s("N"==t.id_conceptual?e.obtenerNota(t,r,n,s):"-")+" ")])})),o("td",{key:"prom"+a+r+n,staticClass:"bloque-area",staticStyle:{"font-weight":"bold","text-align":"center"}},[e._v(" "+e._s("N"==t.id_conceptual?e.obtenerPromedioAsignatura(t,r,n):"-")+" ")])]})),o("td",{key:"promArea"+a+r,staticClass:"promedio-area bloque-area"},[e._v(" "+e._s("N"==t.id_conceptual?e.obtenerPromedioArea(t,r):"-")+" ")])]})),o("td",[e._v(e._s("N"==t.id_conceptual?e.calcularPromedioGeneral(t):"-"))]),o("td",[e._v(e._s("N"==t.id_conceptual?e.contarDesempenoEstudiante(t.areas,"bajo"):"-"))]),o("td",[e._v(e._s("N"==t.id_conceptual?e.contarDesempenoEstudiante(t.areas,"basico"):"-"))]),o("td",[e._v(e._s("N"==t.id_conceptual?e.contarDesempenoEstudiante(t.areas,"alto"):"-"))]),o("td",[e._v(e._s("N"==t.id_conceptual?e.contarDesempenoEstudiante(t.areas,"superior"):"-"))]),o("td",[e._v(e._s("N"==t.id_conceptual?t.ausJ:"-"))]),o("td",[e._v(e._s("N"==t.id_conceptual?t.ausS:"-"))]),o("td",[e._v(e._s("N"==t.id_conceptual?e.iconoPuesto(e.puestosPorEstudiante[a]):"-")+" "+e._s("N"==t.id_conceptual?e.puestosPorEstudiante[a]:"-"))]),o("td",{staticClass:"text-left"},[e._v(e._s(n+1))])],2)})),o("tr",{staticStyle:{"background-color":"#f0f0f0","font-weight":"bold"}},[o("td",{attrs:{colspan:"2"}},[e._v("Total Bajos")]),e._l(e.encabezadoPorArea,(function(t,a){return[e._l(t,(function(t){return[e._l(e.periodosVisibles,(function(n){return o("td",{key:"bp"+a+t+n},[e._v(" "+e._s(e.totalBajosPorPeriodo(a,t,n))+" ")])})),o("td",{key:"bj"+a+t},[e._v(" "+e._s(e.totalBajosPromedioAsignatura(a,t))+" ")])]})),o("td",{key:"bja"+a,staticClass:"promedio-area"},[e._v(" "+e._s(e.totalBajosPromedioArea(a))+" ")])]})),o("td"),e._v(" "),o("td",[e._v(e._s(e.totales.bajo))]),o("td",[e._v(e._s(e.totales.basico))]),o("td",[e._v(e._s(e.totales.alto))]),o("td",[e._v(e._s(e.totales.superior))]),o("td",[e._v(e._s(e.totales.ausJ))]),o("td",[e._v(e._s(e.totales.ausS))]),o("td"),e._v(" "),o("td")],2)],2)]),o("div",{staticStyle:{"margin-bottom":"1rem"}},[o("b-button",{staticClass:"small mx-1 mt-3",attrs:{variant:"primary"},on:{click:e.imprimir}},[e._v("Imprimir Consolidado")]),o("b-button",{staticClass:"small mx-1 mt-3",attrs:{variant:"outline-primary"},on:{click:e.exportarAExcel}},[e._v("Exportar a Excel")])],1)])],1)],1)},C=[],A=(o("b64b"),{name:"consolidadopromedio",components:{},data:function(){return{idSede:null,comboSedes:[],idPeriodo:null,comboPeriodos:null,idCurso:null,comboCursosSede:[],nombreSede:null,nombreCurso:null,idNivel:null,btnCargando:!1,datosRaw:[],datosSeccion:{},listaAreasAsignaturas:[],periodosVisibles:[]}},methods:{colspanArea:function(e){var t=this.encabezadoPorArea[e]||[],o=this.periodosVisibles.length+1,a=1;return t.length*o+a},totalBajosPorPeriodo:function(e,t,o){var a=this,n=0,r=this.listaAreasAsignaturas.find((function(o){return o.area===e&&o.asignatura===t})),s=null===r||void 0===r?void 0:r.idTipoEspecialidad;return Object.values(this.estudiantesNotas).forEach((function(r){var i,c,d,u,l,m=null===r||void 0===r||null===(i=r.areas)||void 0===i||null===(c=i[e])||void 0===c||null===(d=c.asignaturas)||void 0===d||null===(u=d[t])||void 0===u||null===(l=u.periodos)||void 0===l?void 0:l[o];1===s?m>0&&m<a.datosSeccion.minBas&&n++:m>0&&m<a.datosSeccion.minBasT&&n++})),n},totalBajosPromedioAsignatura:function(e,t){var o=this,a=0,n=this.listaAreasAsignaturas.find((function(o){return o.area===e&&o.asignatura===t})),r=null===n||void 0===n?void 0:n.idTipoEspecialidad;return Object.values(this.estudiantesNotas).forEach((function(n){var s,i,c,d=null===n||void 0===n||null===(s=n.areas)||void 0===s||null===(i=s[e])||void 0===i||null===(c=i.asignaturas)||void 0===c?void 0:c[t];if(d){var u=parseFloat(o.calcularPromedioAsignatura(d));1===r?u<o.datosSeccion.minBas&&a++:u<o.datosSeccion.minBasT&&a++}})),a},totalBajosPromedioArea:function(e){var t=this,o=0;return Object.values(this.estudiantesNotas).forEach((function(a){var n=parseFloat(t.obtenerPromedioArea(a,e));!isNaN(n)&&n<t.datosSeccion.minBas&&o++})),o},totalesGlobales:function(){var e=this,t=0,o=0,a=0,n=0,r=0,s=0;return Object.values(this.estudiantesNotas).forEach((function(i){t+=e.contarDesempenoEstudiante(i.areas,"bajo"),o+=e.contarDesempenoEstudiante(i.areas,"basico"),a+=e.contarDesempenoEstudiante(i.areas,"alto"),n+=e.contarDesempenoEstudiante(i.areas,"superior"),r+=i.ausJ||0,s+=i.ausS||0})),{bajo:t,basico:o,alto:a,superior:n,ausJ:r,ausS:s}},esAreaValida:function(e){var t=this.listaAreasAsignaturas.filter((function(t){return t.area===e}));return!!t.some((function(e){return 99!==e.orden&&98!==e.orden}))||!(!t.some((function(e){return 99===e.orden}))||1!=this.datosSeccion.promCompor)},obtenerPromedioArea:function(e,t){var o=e.areas&&e.areas[t];return o?this.calcularPromedioArea(o):""},obtenerNota:function(e,t,o,a){var n,r,s,i,c,d=null===e||void 0===e||null===(n=e.areas)||void 0===n||null===(r=n[t])||void 0===r||null===(s=r.asignaturas)||void 0===s||null===(i=s[o])||void 0===i||null===(c=i.periodos)||void 0===c?void 0:c[a];return 0===d&&(d=""),"number"===typeof d?d.toFixed(1):d},obtenerPromedioAsignatura:function(e,t,o){var a,n,r,s=null===e||void 0===e||null===(a=e.areas)||void 0===a||null===(n=a[t])||void 0===n||null===(r=n.asignaturas)||void 0===r?void 0:r[o];return s?this.calcularPromedioAsignatura(s):""},calcularPromedioAsignatura:function(e){e.pesos;var t=e.periodos,o=e.orden;if(99===o&&0==this.datosSeccion.promCompor)return"-";for(var a=0,n=0,r=1;r<=4;r++){var s,i=null!==(s=t[r])&&void 0!==s?s:0;i>0&&(a+=i,n++)}if(0===a)return"";var c=a/n;return this.redondear(c).toFixed(1)},calcularPromedioArea:function(e){var t=this,o=Object.values(e.asignaturas);if(!o.length)return"0.00";var a=0;return o.forEach((function(e){if(99===e.orden&&0==t.datosSeccion.promCompor)return"-";a+=parseFloat(t.calcularPromedioAsignatura(e)*e.porcentaje/100)})),a>0?this.redondear(a).toFixed(1):""},calcularPromedioGeneral:function(e){var t=this,o=Object.keys(e.areas||{}),a=0,n=0;return o.forEach((function(o){if(t.esAreaValida(o)){var r=parseFloat(t.calcularPromedioArea(e.areas[o]));isNaN(r)||(a+=r,n++)}})),n>0?(a/n).toFixed(3):""},contarAusencias:function(e){var t=0;return Object.values(this.estudiantesNotas).forEach((function(o){"ausJ"===e&&(t+=o.ausJ||0),"ausS"===e&&(t+=o.ausS||0)})),t},contarNotasPorAsignatura:function(e,t,o){var a=this,n=0;return Object.values(this.estudiantesNotas).forEach((function(r){var s,i,c,d,u=null===r||void 0===r||null===(s=r[e])||void 0===s||null===(i=s[t])||void 0===i?void 0:i.nota,l=null===r||void 0===r||null===(c=r[e])||void 0===c||null===(d=c[t])||void 0===d?void 0:d.idTipoEspecialidad;"number"===typeof u&&(1===l?("bajo"===o&&u<a.datosSeccion.minBas||"basico"===o&&u>=a.datosSeccion.minBas&&u<a.datosSeccion.minAlt||"alto"===o&&u>=a.datosSeccion.minAlt&&u<a.datosSeccion.minSup||"superior"===o&&u>=a.datosSeccion.minSup&&u<=a.datosSeccion.maxSup)&&n++:("bajo"===o&&u<a.datosSeccion.minBasT||"basico"===o&&u>=a.datosSeccion.minBasT&&u<a.datosSeccion.minAltT||"alto"===o&&u>=a.datosSeccion.minAltT&&u<a.datosSeccion.minSupT||"superior"===o&&u>=a.datosSeccion.minSupT&&u<=a.datosSeccion.maxSupT)&&n++)})),n},contarNotasTotales:function(e){var t=this,o=0;return Object.values(this.estudiantesNotas).forEach((function(a){t.listaAreasAsignaturas.forEach((function(n){var r,s,i,c,d=n.area,u=n.asignatura,l=null===a||void 0===a||null===(r=a[d])||void 0===r||null===(s=r[u])||void 0===s?void 0:s.nota,m=null===a||void 0===a||null===(i=a[d])||void 0===i||null===(c=i[u])||void 0===c?void 0:c.idTipoEspecialidad;"number"===typeof l&&(1===m?("bajo"===e&&l<t.datosSeccion.minBas||"basico"===e&&l>=t.datosSeccion.minBas&&l<t.datosSeccion.minAlt||"alto"===e&&l>=t.datosSeccion.minAlt&&l<t.datosSeccion.minSup||"superior"===e&&l>=t.datosSeccion.minSup&&l<=t.datosSeccion.maxSup)&&o++:("bajo"===e&&l<t.datosSeccion.minBasT||"basico"===e&&l>=t.datosSeccion.minBasT&&l<t.datosSeccion.minAltT||"alto"===e&&l>=t.datosSeccion.minAltT&&l<t.datosSeccion.minSupT||"superior"===e&&l>=t.datosSeccion.minSupT&&l<=t.datosSeccion.maxSupT)&&o++)}))})),o},iconoPuesto:function(e){return 1===e?"ü•á":2===e?"ü•à":3===e?"ü•â":""},contarDesempenoEstudiante:function(e,t){var o=this,a=0;return Object.values(e||{}).forEach((function(e){Object.values(e.asignaturas||{}).forEach((function(e){var n=parseFloat(o.calcularPromedioAsignatura(e)),r=e.idTipoEspecialidad;"number"===typeof n&&(1===r?("bajo"===t&&n<o.datosSeccion.minBas||"basico"===t&&n>=o.datosSeccion.minBas&&n<o.datosSeccion.minAlt||"alto"===t&&n>=o.datosSeccion.minAlt&&n<o.datosSeccion.minSup||"superior"===t&&n>=o.datosSeccion.minSup&&n<=o.datosSeccion.maxSup)&&a++:("bajo"===t&&n<o.datosSeccion.minBasT||"basico"===t&&n>=o.datosSeccion.minBasT&&n<o.datosSeccion.minAltT||"alto"===t&&n>=o.datosSeccion.minAltT&&n<o.datosSeccion.minSupT||"superior"===t&&n>=o.datosSeccion.minSupT&&n<=o.datosSeccion.maxSupT)&&a++)}))})),a},fueRecuperada:function(e,t,o){var a,n,r;return null!==(a=null===e||void 0===e||null===(n=e[t])||void 0===n||null===(r=n[o])||void 0===r?void 0:r.fueRecuperada)&&void 0!==a&&a},obtenerOriginal:function(e,t,o){var a,n,r=null===e||void 0===e||null===(a=e[t])||void 0===a||null===(n=a[o])||void 0===n?void 0:n.original;return"number"===typeof r?r.toFixed(1):"0.0"},obtenerRecuperacion:function(e,t,o){var a,n,r=null===e||void 0===e||null===(a=e[t])||void 0===a||null===(n=a[o])||void 0===n?void 0:n.recuperacion;return"number"===typeof r?r.toFixed(1):"0.0"},obtenerColor:function(e,t,o,a){var n,r,s=null===t||void 0===t||null===(n=t[o])||void 0===n||null===(r=n[a])||void 0===r?void 0:r.idTipoEspecialidad;return 1===s?e<this.datosSeccion.minBas?"desempeno-bajo":e<this.datosSeccion.minAlt?"desempeno-basico":e<this.datosSeccion.minSup?"desempeno-alto":e<=this.datosSeccion.maxSup?"desempeno-superior":"desempeno-extra":e<this.datosSeccion.minBasT?"desempeno-bajo":e<this.datosSeccion.minAltT?"desempeno-basico":e<this.datosSeccion.minSupT?"desempeno-alto":e<=this.datosSeccion.maxSupT?"desempeno-superior":"desempeno-extra"},claseDesempeno:function(e){return console.log(e),"number"!==typeof e?"desempeno-extra":e<3?"desempeno-bajo":e<4?"desempeno-basico":e<4.6?"desempeno-alto":e<=5?"desempeno-superior":"desempeno-extra"},obtenerColorGeneral:function(e){return e<this.datosSeccion.minBas?"desempeno-bajo":e<this.datosSeccion.minAlt?"desempeno-basico":e<this.datosSeccion.minSup?"desempeno-alto":e<=this.datosSeccion.maxSup?"desempeno-superior":"desempeno-extra"},consultarEstudiantes:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.btnCargando=!0,1==e.idPeriodo&&(e.periodosVisibles=[1]),2==e.idPeriodo&&(e.periodosVisibles=[1,2]),3==e.idPeriodo&&(e.periodosVisibles=[1,2,3]),4==e.idPeriodo&&(e.periodosVisibles=[1,2,3,4]),e.nombreSede=document.getElementById("sedes")[document.getElementById("sedes").selectedIndex].text,null==e.idCurso){t.next=15;break}return e.nombreCurso=document.getElementById("cursos")[document.getElementById("cursos").selectedIndex].text,e.$store.state.datosCursos.forEach((function(t){t.id==e.idCurso&&(e.idNivel=t.id_nivel)})),e.listaAreasAsignaturas=[],t.next=12,s.a.get(i["d"]+"consolidados/areasasignaturas/curso",{params:{idCurso:e.idCurso}}).then((function(t){t.data.error?(e.mensajeEmergente("danger",i["h"],t.data.mensaje+" - Lista areas-asignaturas curso"),e.btnCargando=!1):0!=t.data.datos&&(e.listaAreasAsignaturas=t.data.datos)})).catch((function(t){e.mensajeEmergente("danger",i["h"],"Algo salio mal y no se pudo realizar: Lista areas-asignaturas curso. Intente m√°s tarde."+t),e.btnCargando=!1}));case 12:return e.datosRaw=[],t.next=15,s.a.get(i["d"]+"consolidados/asignaturas/curso/acumulado",{params:{idCurso:e.idCurso,periodo:e.idPeriodo,vigencia:e.$store.state.aLectivo}}).then((function(t){t.data.error?(e.mensajeEmergente("danger",i["h"],t.data.mensaje+" - Consolidados asignaturas curso periodo"),e.btnCargando=!1):0!=t.data.datos&&(e.datosRaw=t.data.datos)})).catch((function(t){e.mensajeEmergente("danger",i["h"],"Algo salio mal y no se pudo realizar: Consolidados asignaturas curso periodo. Intente m√°s tarde."+t),e.btnCargando=!1}));case 15:e.btnCargando=!1;case 16:case"end":return t.stop()}}),t)})))()},imprimir:function(){var e="Fecha: "+(new Date).toLocaleString(),t="CONSOLIDADO EVALUACIONES ACUMULADO POR PROMEDIO",o=document.querySelector("table").outerHTML,a=window.open("Consolidados","_blank");a.document.write('<html><head><title>Imprimir</title></head>\n      <style scoped>\n        table {\n          border-collapse: collapse;\n          width: 100%;\n          text-align: center;\n          font-size: 10px;\n        }\n        th {\n          background: #eee;\n        }\n        .nota-recuperada {\n          border: 2px solid #ffa500;\n          box-shadow: 0 0 5px #ffa500;\n        }\n        .desempeno-bajo { background-color: #f8d7da; color: #721c24; }\n        .desempeno-basico { background-color: #d1ecf1; color: #0c5460; }\n        .desempeno-alto { background-color: #fff3cd; color: #856404; }\n        .desempeno-superior { background-color: #d4edda; color: #155724; }\n        .desempeno-extra { background-color: #f4ecf5; color: #2f2e2e; }\n      </style>\n        <body class="container">\n          <p style="text-align: center; font-size: 12px;">SECRETAR√çA DE EDUCACI√ìN TERRITORIAL DE TUNJA<br><b>'.concat(this.$store.state.nombreInstitucion,"</b><br>TUNJA - BOYAC√Å<br>").concat(t,"<br>Sede: ").concat(this.nombreSede," | Curso: ").concat(this.nombreCurso," | A√±o Lectivo ").concat(this.$store.state.aLectivo," | Periodo: ").concat(this.idPeriodo,"</p>\n          ").concat(o,'\n          <div style="text-align: right; font-size: 12px;"><i>').concat(e,"</i></div>\n        </body>\n      </html>")),a.document.close(),a.print()},exportarAExcel:function(){var e=document.querySelector("table"),t=p["utils"].table_to_book(e);p["writeFile"](t,"notas.xlsx")},redondear:function(e){var t=Number((10*Math.abs(e)).toPrecision(15));return Math.round(t)/10*Math.sign(e)},ocuparComboCursosSede:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.comboCursosSede=[],e.$store.state.datosCursos.forEach((function(t){t.id_sede==e.idSede&&e.comboCursosSede.push({value:t.id,text:t.nomenclatura.toUpperCase()})}));case 2:case"end":return t.stop()}}),t)})))()},ocuparComboSedes:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.comboSedes=[],e.$store.state.datosSedes.forEach((function(t){e.comboSedes.push({value:t.id,text:t.sede.toUpperCase()})}));case 2:case"end":return t.stop()}}),t)})))()},ocuparComboPeriodos:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.comboPeriodos=[],e.$store.state.periodos.forEach((function(t){e.comboPeriodos.push({value:t.id,text:t.periodo.toUpperCase()})}));case 2:case"end":return t.stop()}}),t)})))()},mensajeEmergente:function(e,t,o){this.$bvToast.toast(o,{title:t,variant:e,toaster:"b-toaster-top-center",solid:!0,autoHideDelay:4e3,appendToast:!1})}},computed:{totales:function(){return this.totalesGlobales()},estudiantesNotas:function(){var e=this,t={};return this.datosRaw.forEach((function(o){var a=o.estudiante,n=o.area,r=o.asignatura,s=o.periodo,i=o.definitiva,c=o.recuperacion,d=o.orden,u=o.definitivacompor,l=o.definitivapree,m=o.idTipoEspecialidad,p=o.ausJ,b=o.ausS,f=o.porcentaje,v=o.id_conceptual;t[a]||(t[a]={id_conceptual:v,ausJ:0,ausS:0,areas:{}}),t[a].areas[n]||(t[a].areas[n]={asignaturas:{}}),t[a].areas[n].asignaturas[r]||(t[a].areas[n].asignaturas[r]={periodos:{},orden:d,idTipoEspecialidad:m,porcentaje:f,pesos:{1:.2,2:.2,3:.3,4:.3}});var h=0;h=99===d?1==e.datosSeccion.tipoValComp?i:null!=u?u:"":1==e.idNivel?null!=l&&0!=l&&""!=l?l:"":c>i?c:i,t[a].areas[n].asignaturas[r].periodos[s]=h,t[a].ausJ+=p||0,t[a].ausS+=b||0})),t},totalColumnasPromedioArea:function(){var e=new Set(this.listaAreasAsignaturas.map((function(e){return e.area})));return e.size},puestosPorEstudiante:function(){var e=this,t=Object.entries(this.estudiantesNotas).map((function(t){var o=Object(u["a"])(t,2),a=o[0],n=o[1],r=parseFloat(e.calcularPromedioGeneral(n));return{nombre:a,promedio:isNaN(r)?0:r}}));t.sort((function(e,t){return t.promedio-e.promedio}));var o={},a=1,n=1,r=null;return t.forEach((function(e){e.promedio!==r&&(a=n,r=e.promedio),o[e.nombre]=a,n++})),o},encabezadoPorArea:function(){var e={};return this.listaAreasAsignaturas.forEach((function(t){var o=t.area,a=t.asignatura;e[o]||(e[o]=[]),e[o].push(a)})),e}},beforeMount:function(){this.ocuparComboSedes(),this.ocuparComboPeriodos(),this.datosSeccion=this.$store.state.datosSecciones[this.$store.state.idSeccion-1]}}),_=A,x=(o("6d63"),Object(v["a"])(_,g,C,!1,null,"44a06de5",null)),E=x.exports,y=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("b-row",{staticClass:"mt-2"},[o("b-col",{attrs:{lg:"12"}},[o("b-card",{scopedSlots:e._u([{key:"header",fn:function(){return[o("h5",{staticClass:"mb-0"},[o("b-icon",{attrs:{icon:"card-checklist","aria-hidden":"true"}}),e._v(" CONSOLIDADO NOTAS FALTANTES POR ASIGNATURA")],1)]},proxy:!0}])},[o("b-card-text",[o("b-row",[o("b-col",{attrs:{lg:"2"}},[o("b-form-group",{staticClass:"etiqueta",attrs:{label:"Periodo:","label-for":"periodo"}},[o("b-form-select",{ref:"periodo",attrs:{id:"periodo",options:e.comboPeriodos},on:{change:function(t){e.idSede=null,e.idCurso=null}},model:{value:e.idPeriodo,callback:function(t){e.idPeriodo=t},expression:"idPeriodo"}})],1)],1),o("b-col",{attrs:{lg:"6"}},[o("b-form-group",{staticClass:"etiqueta",attrs:{label:"Seleccione la Sede:","label-for":"sedes"}},[o("b-form-select",{ref:"sedes",attrs:{id:"sedes",options:e.comboSedes,disabled:null==e.idPeriodo},on:{change:function(t){e.idCurso=null,e.ocuparComboCursosSede()}},model:{value:e.idSede,callback:function(t){e.idSede=t},expression:"idSede"}})],1)],1),o("b-col",{attrs:{lg:"4"}},[o("b-form-group",{staticClass:"etiqueta",attrs:{label:"Seleccione el Curso:","label-for":"cursos"}},[o("b-form-select",{ref:"cursos",attrs:{id:"cursos",options:e.comboCursosSede,disabled:null==e.idSede},on:{change:function(t){return e.consultarEstudiantes()}},model:{value:e.idCurso,callback:function(t){e.idCurso=t},expression:"idCurso"}})],1)],1)],1)],1)],1)],1)],1),o("b-row",[o("b-col",{attrs:{lg:"12"}},[e.btnCargando?o("div",[o("div",{staticClass:"text-center m-5 text-primary"},[o("b-spinner",{staticStyle:{width:"3rem",height:"3rem"},attrs:{label:"Spinner"}}),o("br"),o("strong",[e._v("Cargando informe...")])],1)]):e._e()])],1),e.btnCargando||null==e.idCurso?e._e():o("b-row",[o("b-col",{attrs:{lg:"12"}},[o("table",{staticClass:"table-responsive",attrs:{border:"1",cellspacing:"0",cellpadding:"1"}},[o("thead",[o("tr",[o("th",{attrs:{rowspan:"3"}},[e._v("#")]),o("th",{attrs:{rowspan:"3"}},[e._v("Estudiante")]),e._l(e.encabezadoPorArea,(function(t,a){return[o("th",{key:a,attrs:{colspan:e.colspanArea(a)}},[e._v(" "+e._s(a)+" ")])]})),o("th",{attrs:{rowspan:"3"}},[e._v("#")])],2),o("tr",[e._l(e.encabezadoPorArea,(function(t){return[e._l(t,(function(t,a){return[o("th",{key:"area-"+t+a,attrs:{colspan:e.periodosVisibles.length+1}},[e._v(" "+e._s(t)+" ")])]}))]}))],2),o("tr",[e._l(e.encabezadoPorArea,(function(t,a){return[e._l(t,(function(t,n){return[o("th",{key:"acum"+t+a+n},[e._v("ACU")]),o("th",{key:"prom"+t+a+n},[e._v("PRM")]),o("th",{key:"falta"+t+a+n},[e._v("FALTA")])]}))]}))],2)]),o("tbody",e._l(e.estudiantesNotas,(function(t,a,n){return o("tr",{key:a},[o("td",{staticClass:"text-left"},[e._v(e._s(n+1))]),o("td",{staticStyle:{"text-align":"left"}},[e._v(e._s(a))]),e._l(e.encabezadoPorArea,(function(n,r){return[e._l(n,(function(n){return[o("td",{key:"prom"+a+r+n,staticClass:"bloque-area"},[e._v(" "+e._s(e.obtenerAcumulado(t,r,n))+" ")]),o("td",{key:"prom"+a+r+n+1,staticClass:"bloque-area"},[e._v(" "+e._s(e.obtenerPromedioAsignatura(t,r,n))+" ")]),o("td",{key:"prom"+a+r+n+2,staticClass:"bloque-area",staticStyle:{"font-weight":"bold","text-align":"center"}},[e._v(" "+e._s(e.obtenerNotaFaltante(t,r,n))+" ")])]}))]})),o("td",{staticClass:"text-left"},[e._v(e._s(n+1))])],2)})),0)]),o("div",{staticStyle:{"margin-bottom":"1rem"}},[o("b-button",{staticClass:"small mx-1 mt-3",attrs:{variant:"primary"},on:{click:e.imprimir}},[e._v("Imprimir Consolidado")]),o("b-button",{staticClass:"small mx-1 mt-3",attrs:{variant:"outline-primary"},on:{click:e.exportarAExcel}},[e._v("Exportar a Excel")])],1)])],1)],1)},P=[],w={name:"consolidadopromedio",components:{},data:function(){return{idSede:null,comboSedes:[],idPeriodo:null,comboPeriodos:null,idCurso:null,comboCursosSede:[],nombreSede:null,nombreCurso:null,idNivel:null,btnCargando:!1,datosRaw:[],datosSeccion:{},listaAreasAsignaturas:[],periodosVisibles:[]}},methods:{colspanArea:function(e){var t=this.encabezadoPorArea[e]||[],o=this.periodosVisibles.length+1,a=0;return t.length*o+a},esAreaValida:function(e){var t=this.listaAreasAsignaturas.filter((function(t){return t.area===e}));return!!t.some((function(e){return 99!==e.orden&&98!==e.orden}))||!(!t.some((function(e){return 99===e.orden}))||1!=this.datosSeccion.promCompor)},obtenerNota:function(e,t,o,a){var n,r,s,i,c,d=null===e||void 0===e||null===(n=e.areas)||void 0===n||null===(r=n[t])||void 0===r||null===(s=r.asignaturas)||void 0===s||null===(i=s[o])||void 0===i||null===(c=i.periodos)||void 0===c?void 0:c[a];return 0===d&&(d=""),"number"===typeof d?d.toFixed(1):d},obtenerNotaFaltante:function(e,t,o){var a,n,r,s=null===e||void 0===e||null===(a=e.areas)||void 0===a||null===(n=a[t])||void 0===n||null===(r=n.asignaturas)||void 0===r?void 0:r[o];return s?this.calcularNotaFaltante(s):""},calcularNotaFaltante:function(e){var t=e.idTipoEspecialidad,o=e.periodos,a=e.orden;if(99===a&&0==this.datosSeccion.promCompor)return"-";for(var n=0,r=1;r<=3;r++){var s,i=null!==(s=o[r])&&void 0!==s?s:0;n+=i}if(0===n)return"";var c=0;return c=1===t?4*this.datosSeccion.minBas-n:4*this.datosSeccion.minBasT-n,c.toFixed(1)},obtenerAcumulado:function(e,t,o){var a,n,r,s=null===e||void 0===e||null===(a=e.areas)||void 0===a||null===(n=a[t])||void 0===n||null===(r=n.asignaturas)||void 0===r?void 0:r[o];return s?this.calcularAcumulado(s):""},calcularAcumulado:function(e){e.pesos;var t=e.periodos,o=e.orden;if(99===o&&0==this.datosSeccion.promCompor)return"-";for(var a=0,n=1;n<=4;n++){var r,s=null!==(r=t[n])&&void 0!==r?r:0;a+=s}return 0===a?"":a.toFixed(1)},obtenerPromedioAsignatura:function(e,t,o){var a,n,r,s=null===e||void 0===e||null===(a=e.areas)||void 0===a||null===(n=a[t])||void 0===n||null===(r=n.asignaturas)||void 0===r?void 0:r[o];return s?this.calcularPromedioAsignatura(s):""},calcularPromedioAsignatura:function(e){e.pesos;var t=e.periodos,o=e.orden;if(99===o&&0==this.datosSeccion.promCompor)return"-";for(var a=0,n=1;n<=4;n++){var r,s=null!==(r=t[n])&&void 0!==r?r:0;a+=s}if(0===a)return"";var i=a/this.idPeriodo;return this.redondear(i).toFixed(1)},contarAusencias:function(e){var t=0;return Object.values(this.estudiantesNotas).forEach((function(o){"ausJ"===e&&(t+=o.ausJ||0),"ausS"===e&&(t+=o.ausS||0)})),t},contarNotasPorAsignatura:function(e,t,o){var a=this,n=0;return Object.values(this.estudiantesNotas).forEach((function(r){var s,i,c,d,u=null===r||void 0===r||null===(s=r[e])||void 0===s||null===(i=s[t])||void 0===i?void 0:i.nota,l=null===r||void 0===r||null===(c=r[e])||void 0===c||null===(d=c[t])||void 0===d?void 0:d.idTipoEspecialidad;"number"===typeof u&&(1===l?("bajo"===o&&u<a.datosSeccion.minBas||"basico"===o&&u>=a.datosSeccion.minBas&&u<a.datosSeccion.minAlt||"alto"===o&&u>=a.datosSeccion.minAlt&&u<a.datosSeccion.minSup||"superior"===o&&u>=a.datosSeccion.minSup&&u<=a.datosSeccion.maxSup)&&n++:("bajo"===o&&u<a.datosSeccion.minBasT||"basico"===o&&u>=a.datosSeccion.minBasT&&u<a.datosSeccion.minAltT||"alto"===o&&u>=a.datosSeccion.minAltT&&u<a.datosSeccion.minSupT||"superior"===o&&u>=a.datosSeccion.minSupT&&u<=a.datosSeccion.maxSupT)&&n++)})),n},fueRecuperada:function(e,t,o){var a,n,r;return null!==(a=null===e||void 0===e||null===(n=e[t])||void 0===n||null===(r=n[o])||void 0===r?void 0:r.fueRecuperada)&&void 0!==a&&a},obtenerOriginal:function(e,t,o){var a,n,r=null===e||void 0===e||null===(a=e[t])||void 0===a||null===(n=a[o])||void 0===n?void 0:n.original;return"number"===typeof r?r.toFixed(1):"0.0"},obtenerRecuperacion:function(e,t,o){var a,n,r=null===e||void 0===e||null===(a=e[t])||void 0===a||null===(n=a[o])||void 0===n?void 0:n.recuperacion;return"number"===typeof r?r.toFixed(1):"0.0"},obtenerColor:function(e,t,o,a){var n,r,s=null===t||void 0===t||null===(n=t[o])||void 0===n||null===(r=n[a])||void 0===r?void 0:r.idTipoEspecialidad;return 1===s?e<this.datosSeccion.minBas?"desempeno-bajo":e<this.datosSeccion.minAlt?"desempeno-basico":e<this.datosSeccion.minSup?"desempeno-alto":e<=this.datosSeccion.maxSup?"desempeno-superior":"desempeno-extra":e<this.datosSeccion.minBasT?"desempeno-bajo":e<this.datosSeccion.minAltT?"desempeno-basico":e<this.datosSeccion.minSupT?"desempeno-alto":e<=this.datosSeccion.maxSupT?"desempeno-superior":"desempeno-extra"},claseDesempeno:function(e){return"number"!==typeof e?"desempeno-extra":e<3?"desempeno-bajo":e<4?"desempeno-basico":e<4.6?"desempeno-alto":e<=5?"desempeno-superior":"desempeno-extra"},obtenerColorGeneral:function(e){return e<this.datosSeccion.minBas?"desempeno-bajo":e<this.datosSeccion.minAlt?"desempeno-basico":e<this.datosSeccion.minSup?"desempeno-alto":e<=this.datosSeccion.maxSup?"desempeno-superior":"desempeno-extra"},consultarEstudiantes:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.btnCargando=!0,e.periodosVisibles=[1,2],e.nombreSede=document.getElementById("sedes")[document.getElementById("sedes").selectedIndex].text,null==e.idCurso){t.next=12;break}return e.nombreCurso=document.getElementById("cursos")[document.getElementById("cursos").selectedIndex].text,e.$store.state.datosCursos.forEach((function(t){t.id==e.idCurso&&(e.idNivel=t.id_nivel)})),e.listaAreasAsignaturas=[],t.next=9,s.a.get(i["d"]+"consolidados/areasasignaturas/curso",{params:{idCurso:e.idCurso}}).then((function(t){t.data.error?(e.mensajeEmergente("danger",i["h"],t.data.mensaje+" - Lista areas-asignaturas curso"),e.btnCargando=!1):0!=t.data.datos&&(e.listaAreasAsignaturas=t.data.datos)})).catch((function(t){e.mensajeEmergente("danger",i["h"],"Algo salio mal y no se pudo realizar: Lista areas-asignaturas curso. Intente m√°s tarde."+t),e.btnCargando=!1}));case 9:return e.datosRaw=[],t.next=12,s.a.get(i["d"]+"consolidados/asignaturas/curso/acumulado",{params:{idCurso:e.idCurso,periodo:e.idPeriodo,vigencia:e.$store.state.aLectivo}}).then((function(t){t.data.error?(e.mensajeEmergente("danger",i["h"],t.data.mensaje+" - Consolidados asignaturas curso periodo"),e.btnCargando=!1):0!=t.data.datos&&(e.datosRaw=t.data.datos)})).catch((function(t){e.mensajeEmergente("danger",i["h"],"Algo salio mal y no se pudo realizar: Consolidados asignaturas curso periodo. Intente m√°s tarde."+t),e.btnCargando=!1}));case 12:e.btnCargando=!1;case 13:case"end":return t.stop()}}),t)})))()},imprimir:function(){var e="Fecha: "+(new Date).toLocaleString(),t="CONSOLIDADO NOTAS FALTANTES POR ASIGNATURA",o=document.querySelector("table").outerHTML,a=window.open("NotaFaltanteAsignatura","_blank");a.document.write('<html><head><title>NotaFaltanteAsignatura</title></head>\n      <style scoped>\n        table {\n          border-collapse: collapse;\n          width: 100%;\n          text-align: center;\n          font-size: 10px;\n        }\n        th {\n          background: #eee;\n        }\n        .nota-recuperada {\n          border: 2px solid #ffa500;\n          box-shadow: 0 0 5px #ffa500;\n        }\n        .desempeno-bajo { background-color: #f8d7da; color: #721c24; }\n        .desempeno-basico { background-color: #d1ecf1; color: #0c5460; }\n        .desempeno-alto { background-color: #fff3cd; color: #856404; }\n        .desempeno-superior { background-color: #d4edda; color: #155724; }\n        .desempeno-extra { background-color: #f4ecf5; color: #2f2e2e; }\n      </style>\n        <body class="container">\n          <p style="text-align: center; font-size: 12px;">SECRETAR√çA DE EDUCACI√ìN TERRITORIAL DE TUNJA<br><b>'.concat(this.$store.state.nombreInstitucion,"</b><br>TUNJA - BOYAC√Å<br>").concat(t,"<br>Sede: ").concat(this.nombreSede," | Curso: ").concat(this.nombreCurso," | A√±o Lectivo ").concat(this.$store.state.aLectivo," | Periodo: ").concat(this.idPeriodo,"</p>\n          ").concat(o,'\n          <div style="text-align: right; font-size: 12px;"><i>').concat(e,"</i></div>\n        </body>\n      </html>")),a.document.close(),a.print()},exportarAExcel:function(){var e=document.querySelector("table"),t=p["utils"].table_to_book(e);p["writeFile"](t,"NotaFaltanteAsignatura.xlsx")},redondear:function(e){var t=Number((10*Math.abs(e)).toPrecision(15));return Math.round(t)/10*Math.sign(e)},ocuparComboCursosSede:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.comboCursosSede=[],e.$store.state.datosCursos.forEach((function(t){t.id_sede==e.idSede&&e.comboCursosSede.push({value:t.id,text:t.nomenclatura.toUpperCase()})}));case 2:case"end":return t.stop()}}),t)})))()},ocuparComboSedes:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.comboSedes=[],e.$store.state.datosSedes.forEach((function(t){e.comboSedes.push({value:t.id,text:t.sede.toUpperCase()})}));case 2:case"end":return t.stop()}}),t)})))()},ocuparComboPeriodos:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.comboPeriodos=[],e.$store.state.periodos.forEach((function(t){e.comboPeriodos.push({value:t.id,text:t.periodo.toUpperCase()})}));case 2:case"end":return t.stop()}}),t)})))()},mensajeEmergente:function(e,t,o){this.$bvToast.toast(o,{title:t,variant:e,toaster:"b-toaster-top-center",solid:!0,autoHideDelay:4e3,appendToast:!1})}},computed:{estudiantesNotas:function(){var e=this,t={};return this.datosRaw.forEach((function(o){var a=o.estudiante,n=o.area,r=o.asignatura,s=o.periodo,i=o.definitiva,c=o.recuperacion,d=o.orden,u=o.definitivacompor,l=o.idTipoEspecialidad,m=o.ausJ,p=o.ausS,b=o.porcentaje;t[a]||(t[a]={ausJ:0,ausS:0,areas:{}}),t[a].areas[n]||(t[a].areas[n]={asignaturas:{}}),t[a].areas[n].asignaturas[r]||(t[a].areas[n].asignaturas[r]={periodos:{},orden:d,idTipoEspecialidad:l,porcentaje:b,pesos:{1:.2,2:.2,3:.3,4:.3}});var f=0;f=99===d?1==e.datosSeccion.tipoValComp?i:null!=u?u:"":c>i?c:i,t[a].areas[n].asignaturas[r].periodos[s]=f,t[a].ausJ+=m||0,t[a].ausS+=p||0})),t},totalColumnasPromedioArea:function(){var e=new Set(this.listaAreasAsignaturas.map((function(e){return e.area})));return e.size},encabezadoPorArea:function(){var e={};return this.listaAreasAsignaturas.forEach((function(t){var o=t.area,a=t.asignatura;e[o]||(e[o]=[]),e[o].push(a)})),e}},beforeMount:function(){this.ocuparComboSedes(),this.ocuparComboPeriodos(),this.datosSeccion=this.$store.state.datosSecciones[this.$store.state.idSeccion-1]}},T=w,j=(o("9d0c"),Object(v["a"])(T,y,P,!1,null,"71a8e479",null)),N=j.exports,k=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("b-row",{staticClass:"mt-2"},[o("b-col",{attrs:{lg:"12"}},[o("b-card",{scopedSlots:e._u([{key:"header",fn:function(){return[o("h5",{staticClass:"mb-0"},[o("b-icon",{attrs:{icon:"card-checklist","aria-hidden":"true"}}),e._v(" CONSOLIDADO NOTAS FALTANTES POR √ÅREA")],1)]},proxy:!0}])},[o("b-card-text",[o("b-row",[o("b-col",{attrs:{lg:"2"}},[o("b-form-group",{staticClass:"etiqueta",attrs:{label:"Periodo:","label-for":"periodo"}},[o("b-form-select",{ref:"periodo",attrs:{id:"periodo",options:e.comboPeriodos},on:{change:function(t){e.idSede=null,e.idCurso=null}},model:{value:e.idPeriodo,callback:function(t){e.idPeriodo=t},expression:"idPeriodo"}})],1)],1),o("b-col",{attrs:{lg:"6"}},[o("b-form-group",{staticClass:"etiqueta",attrs:{label:"Seleccione la Sede:","label-for":"sedes"}},[o("b-form-select",{ref:"sedes",attrs:{id:"sedes",options:e.comboSedes,disabled:null==e.idPeriodo},on:{change:function(t){e.idCurso=null,e.ocuparComboCursosSede()}},model:{value:e.idSede,callback:function(t){e.idSede=t},expression:"idSede"}})],1)],1),o("b-col",{attrs:{lg:"4"}},[o("b-form-group",{staticClass:"etiqueta",attrs:{label:"Seleccione el Curso:","label-for":"cursos"}},[o("b-form-select",{ref:"cursos",attrs:{id:"cursos",options:e.comboCursosSede,disabled:null==e.idSede},on:{change:function(t){return e.consultarEstudiantes()}},model:{value:e.idCurso,callback:function(t){e.idCurso=t},expression:"idCurso"}})],1)],1)],1)],1)],1)],1)],1),o("b-row",[o("b-col",{attrs:{lg:"12"}},[e.btnCargando?o("div",[o("div",{staticClass:"text-center m-5 text-primary"},[o("b-spinner",{staticStyle:{width:"3rem",height:"3rem"},attrs:{label:"Spinner"}}),o("br"),o("strong",[e._v("Cargando informe...")])],1)]):e._e()])],1),e.btnCargando||null==e.idCurso?e._e():o("b-row",[o("b-col",{attrs:{lg:"12"}},[o("table",{staticClass:"table-responsive",attrs:{border:"1",cellspacing:"0",cellpadding:"1"}},[o("thead",[o("tr",[o("th",{attrs:{rowspan:"3"}},[e._v("#")]),o("th",{attrs:{rowspan:"3"}},[e._v("Estudiante")]),e._l(e.encabezadoPorArea,(function(t,a){return[o("th",{key:a,attrs:{colspan:e.colspanArea(a)+1}},[e._v(" "+e._s(a)+" ")])]})),o("th",{attrs:{rowspan:"3"}},[e._v("#")])],2),o("tr",[e._l(e.encabezadoPorArea,(function(t,a){return[e._l(t,(function(t,a){return[o("th",{key:"area-"+t+a,attrs:{colspan:1}},[e._v(" "+e._s(t)+" ")])]})),o("th",{key:"prom-area-"+a,staticClass:"promedio-area"},[e._v("Prom")]),o("th",{key:"falta-"+a,staticClass:"promedio-area"},[e._v("Nota")])]}))],2),o("tr",[e._l(e.encabezadoPorArea,(function(t,a){return[e._l(t,(function(e){return[o("th",{key:"prom"+e+a})]})),o("th",{key:"prom"+a},[e._v("√Årea")]),o("th",{key:"falta"+a},[e._v("Falta")])]}))],2)]),o("tbody",e._l(e.estudiantesNotas,(function(t,a,n){return o("tr",{key:a},[o("td",{staticClass:"text-left"},[e._v(e._s(n+1))]),o("td",{staticStyle:{"text-align":"left"}},[e._v(e._s(a))]),e._l(e.encabezadoPorArea,(function(n,r){return[e._l(n,(function(n){return[o("td",{key:"prom"+a+r+n,staticClass:"bloque-area",staticStyle:{"font-weight":"bold","text-align":"center"}},[e._v(" "+e._s("N"==t.id_conceptual?e.obtenerPromedioAsignatura(t,r,n):"-")+" ")])]})),o("td",{key:"promArea"+a+r},[e._v(" "+e._s("N"==t.id_conceptual?e.obtenerPromedioArea(t,r):"-")+" ")]),o("td",{key:"faltaArea"+a+r,staticClass:"promedio-area bloque-area"},[o("span",{style:e.redondear(4*e.datosSeccion.minBas-3*e.obtenerPromedioArea(t,r)).toFixed(1)>5?"color: red":""},[e._v(e._s("N"==t.id_conceptual&&e.redondear(4*e.datosSeccion.minBas-3*e.obtenerPromedioArea(t,r)).toFixed(1)<10?e.redondear(4*e.datosSeccion.minBas-3*e.obtenerPromedioArea(t,r)).toFixed(1):"-"))])])]})),o("td",{staticClass:"text-left"},[e._v(e._s(n+1))])],2)})),0)]),o("div",{staticStyle:{"margin-bottom":"1rem"}},[o("b-button",{staticClass:"small mx-1 mt-3",attrs:{variant:"primary"},on:{click:e.imprimir}},[e._v("Imprimir Consolidado")]),o("b-button",{staticClass:"small mx-1 mt-3",attrs:{variant:"outline-primary"},on:{click:e.exportarAExcel}},[e._v("Exportar a Excel")])],1)])],1)],1)},O=[],R={name:"notasfaltantesarea",components:{},data:function(){return{idSede:null,comboSedes:[],idPeriodo:null,comboPeriodos:null,idCurso:null,comboCursosSede:[],nombreSede:null,nombreCurso:null,idNivel:null,btnCargando:!1,datosRaw:[],datosSeccion:{},listaAreasAsignaturas:[],periodosVisibles:[]}},methods:{colspanArea:function(e){var t=this.encabezadoPorArea[e]||[],o=1,a=1;return t.length*o+a},totalBajosPorPeriodo:function(e,t,o){var a=this,n=0,r=this.listaAreasAsignaturas.find((function(o){return o.area===e&&o.asignatura===t})),s=null===r||void 0===r?void 0:r.idTipoEspecialidad;return Object.values(this.estudiantesNotas).forEach((function(r){var i,c,d,u,l,m=null===r||void 0===r||null===(i=r.areas)||void 0===i||null===(c=i[e])||void 0===c||null===(d=c.asignaturas)||void 0===d||null===(u=d[t])||void 0===u||null===(l=u.periodos)||void 0===l?void 0:l[o];1===s?m>0&&m<a.datosSeccion.minBas&&n++:m>0&&m<a.datosSeccion.minBasT&&n++})),n},totalBajosPromedioAsignatura:function(e,t){var o=this,a=0,n=this.listaAreasAsignaturas.find((function(o){return o.area===e&&o.asignatura===t})),r=null===n||void 0===n?void 0:n.idTipoEspecialidad;return Object.values(this.estudiantesNotas).forEach((function(n){var s,i,c,d=null===n||void 0===n||null===(s=n.areas)||void 0===s||null===(i=s[e])||void 0===i||null===(c=i.asignaturas)||void 0===c?void 0:c[t];if(d){var u=parseFloat(o.calcularPromedioAsignatura(d));1===r?u<o.datosSeccion.minBas&&a++:u<o.datosSeccion.minBasT&&a++}})),a},totalBajosPromedioArea:function(e){var t=this,o=0;return Object.values(this.estudiantesNotas).forEach((function(a){var n=parseFloat(t.obtenerPromedioArea(a,e));!isNaN(n)&&n<t.datosSeccion.minBas&&o++})),o},totalesGlobales:function(){var e=this,t=0,o=0,a=0,n=0,r=0,s=0;return Object.values(this.estudiantesNotas).forEach((function(i){t+=e.contarDesempenoEstudiante(i.areas,"bajo"),o+=e.contarDesempenoEstudiante(i.areas,"basico"),a+=e.contarDesempenoEstudiante(i.areas,"alto"),n+=e.contarDesempenoEstudiante(i.areas,"superior"),r+=i.ausJ||0,s+=i.ausS||0})),{bajo:t,basico:o,alto:a,superior:n,ausJ:r,ausS:s}},esAreaValida:function(e){var t=this.listaAreasAsignaturas.filter((function(t){return t.area===e}));return!!t.some((function(e){return 99!==e.orden&&98!==e.orden}))||!(!t.some((function(e){return 99===e.orden}))||1!=this.datosSeccion.promCompor)},obtenerPromedioArea:function(e,t){var o=e.areas&&e.areas[t];return o?this.calcularPromedioArea(o):""},obtenerNota:function(e,t,o,a){var n,r,s,i,c,d=null===e||void 0===e||null===(n=e.areas)||void 0===n||null===(r=n[t])||void 0===r||null===(s=r.asignaturas)||void 0===s||null===(i=s[o])||void 0===i||null===(c=i.periodos)||void 0===c?void 0:c[a];return 0===d&&(d=""),"number"===typeof d?d.toFixed(1):d},obtenerPromedioAsignatura:function(e,t,o){var a,n,r,s=null===e||void 0===e||null===(a=e.areas)||void 0===a||null===(n=a[t])||void 0===n||null===(r=n.asignaturas)||void 0===r?void 0:r[o];return s?this.calcularPromedioAsignatura(s):""},calcularPromedioAsignatura:function(e){e.pesos;var t=e.periodos,o=e.orden;if(99===o&&0==this.datosSeccion.promCompor)return"-";for(var a=0,n=0,r=1;r<=4;r++){var s,i=null!==(s=t[r])&&void 0!==s?s:0;a+=i,i>0&&n++}if(0===a)return"";var c=a/n;return this.redondear(c).toFixed(1)},calcularPromedioArea:function(e){var t=this,o=Object.values(e.asignaturas);if(!o.length)return"0.00";var a=0;return o.forEach((function(e){if(99===e.orden&&0==t.datosSeccion.promCompor)return"-";a+=parseFloat(t.calcularPromedioAsignatura(e)*e.porcentaje/100)})),a>0?this.redondear(a).toFixed(1):""},calcularPromedioGeneral:function(e){var t=this,o=Object.keys(e.areas||{}),a=0,n=0;return o.forEach((function(o){if(t.esAreaValida(o)){var r=parseFloat(t.calcularPromedioArea(e.areas[o]));isNaN(r)||(a+=r,n++)}})),n>0?(a/n).toFixed(3):""},contarAusencias:function(e){var t=0;return Object.values(this.estudiantesNotas).forEach((function(o){"ausJ"===e&&(t+=o.ausJ||0),"ausS"===e&&(t+=o.ausS||0)})),t},contarNotasPorAsignatura:function(e,t,o){var a=this,n=0;return Object.values(this.estudiantesNotas).forEach((function(r){var s,i,c,d,u=null===r||void 0===r||null===(s=r[e])||void 0===s||null===(i=s[t])||void 0===i?void 0:i.nota,l=null===r||void 0===r||null===(c=r[e])||void 0===c||null===(d=c[t])||void 0===d?void 0:d.idTipoEspecialidad;"number"===typeof u&&(1===l?("bajo"===o&&u<a.datosSeccion.minBas||"basico"===o&&u>=a.datosSeccion.minBas&&u<a.datosSeccion.minAlt||"alto"===o&&u>=a.datosSeccion.minAlt&&u<a.datosSeccion.minSup||"superior"===o&&u>=a.datosSeccion.minSup&&u<=a.datosSeccion.maxSup)&&n++:("bajo"===o&&u<a.datosSeccion.minBasT||"basico"===o&&u>=a.datosSeccion.minBasT&&u<a.datosSeccion.minAltT||"alto"===o&&u>=a.datosSeccion.minAltT&&u<a.datosSeccion.minSupT||"superior"===o&&u>=a.datosSeccion.minSupT&&u<=a.datosSeccion.maxSupT)&&n++)})),n},contarNotasTotales:function(e){var t=this,o=0;return Object.values(this.estudiantesNotas).forEach((function(a){t.listaAreasAsignaturas.forEach((function(n){var r,s,i,c,d=n.area,u=n.asignatura,l=null===a||void 0===a||null===(r=a[d])||void 0===r||null===(s=r[u])||void 0===s?void 0:s.nota,m=null===a||void 0===a||null===(i=a[d])||void 0===i||null===(c=i[u])||void 0===c?void 0:c.idTipoEspecialidad;"number"===typeof l&&(1===m?("bajo"===e&&l<t.datosSeccion.minBas||"basico"===e&&l>=t.datosSeccion.minBas&&l<t.datosSeccion.minAlt||"alto"===e&&l>=t.datosSeccion.minAlt&&l<t.datosSeccion.minSup||"superior"===e&&l>=t.datosSeccion.minSup&&l<=t.datosSeccion.maxSup)&&o++:("bajo"===e&&l<t.datosSeccion.minBasT||"basico"===e&&l>=t.datosSeccion.minBasT&&l<t.datosSeccion.minAltT||"alto"===e&&l>=t.datosSeccion.minAltT&&l<t.datosSeccion.minSupT||"superior"===e&&l>=t.datosSeccion.minSupT&&l<=t.datosSeccion.maxSupT)&&o++)}))})),o},iconoPuesto:function(e){return 1===e?"ü•á":2===e?"ü•à":3===e?"ü•â":""},contarDesempenoEstudiante:function(e,t){var o=this,a=0;return Object.values(e||{}).forEach((function(e){Object.values(e.asignaturas||{}).forEach((function(e){var n=parseFloat(o.calcularPromedioAsignatura(e)),r=e.idTipoEspecialidad;"number"===typeof n&&(1===r?("bajo"===t&&n<o.datosSeccion.minBas||"basico"===t&&n>=o.datosSeccion.minBas&&n<o.datosSeccion.minAlt||"alto"===t&&n>=o.datosSeccion.minAlt&&n<o.datosSeccion.minSup||"superior"===t&&n>=o.datosSeccion.minSup&&n<=o.datosSeccion.maxSup)&&a++:("bajo"===t&&n<o.datosSeccion.minBasT||"basico"===t&&n>=o.datosSeccion.minBasT&&n<o.datosSeccion.minAltT||"alto"===t&&n>=o.datosSeccion.minAltT&&n<o.datosSeccion.minSupT||"superior"===t&&n>=o.datosSeccion.minSupT&&n<=o.datosSeccion.maxSupT)&&a++)}))})),a},fueRecuperada:function(e,t,o){var a,n,r;return null!==(a=null===e||void 0===e||null===(n=e[t])||void 0===n||null===(r=n[o])||void 0===r?void 0:r.fueRecuperada)&&void 0!==a&&a},obtenerOriginal:function(e,t,o){var a,n,r=null===e||void 0===e||null===(a=e[t])||void 0===a||null===(n=a[o])||void 0===n?void 0:n.original;return"number"===typeof r?r.toFixed(1):"0.0"},obtenerRecuperacion:function(e,t,o){var a,n,r=null===e||void 0===e||null===(a=e[t])||void 0===a||null===(n=a[o])||void 0===n?void 0:n.recuperacion;return"number"===typeof r?r.toFixed(1):"0.0"},obtenerColor:function(e,t,o,a){var n,r,s=null===t||void 0===t||null===(n=t[o])||void 0===n||null===(r=n[a])||void 0===r?void 0:r.idTipoEspecialidad;return 1===s?e<this.datosSeccion.minBas?"desempeno-bajo":e<this.datosSeccion.minAlt?"desempeno-basico":e<this.datosSeccion.minSup?"desempeno-alto":e<=this.datosSeccion.maxSup?"desempeno-superior":"desempeno-extra":e<this.datosSeccion.minBasT?"desempeno-bajo":e<this.datosSeccion.minAltT?"desempeno-basico":e<this.datosSeccion.minSupT?"desempeno-alto":e<=this.datosSeccion.maxSupT?"desempeno-superior":"desempeno-extra"},claseDesempeno:function(e){return console.log(e),"number"!==typeof e?"desempeno-extra":e<3?"desempeno-bajo":e<4?"desempeno-basico":e<4.6?"desempeno-alto":e<=5?"desempeno-superior":"desempeno-extra"},obtenerColorGeneral:function(e){return e<this.datosSeccion.minBas?"desempeno-bajo":e<this.datosSeccion.minAlt?"desempeno-basico":e<this.datosSeccion.minSup?"desempeno-alto":e<=this.datosSeccion.maxSup?"desempeno-superior":"desempeno-extra"},consultarEstudiantes:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.btnCargando=!0,1==e.idPeriodo&&(e.periodosVisibles=[1]),2==e.idPeriodo&&(e.periodosVisibles=[1,2]),3==e.idPeriodo&&(e.periodosVisibles=[1,2,3]),4==e.idPeriodo&&(e.periodosVisibles=[1,2,3,4]),e.nombreSede=document.getElementById("sedes")[document.getElementById("sedes").selectedIndex].text,null==e.idCurso){t.next=15;break}return e.nombreCurso=document.getElementById("cursos")[document.getElementById("cursos").selectedIndex].text,e.$store.state.datosCursos.forEach((function(t){t.id==e.idCurso&&(e.idNivel=t.id_nivel)})),e.listaAreasAsignaturas=[],t.next=12,s.a.get(i["d"]+"consolidados/areasasignaturas/curso",{params:{idCurso:e.idCurso}}).then((function(t){t.data.error?(e.mensajeEmergente("danger",i["h"],t.data.mensaje+" - Lista areas-asignaturas curso"),e.btnCargando=!1):0!=t.data.datos&&(e.listaAreasAsignaturas=t.data.datos)})).catch((function(t){e.mensajeEmergente("danger",i["h"],"Algo salio mal y no se pudo realizar: Lista areas-asignaturas curso. Intente m√°s tarde."+t),e.btnCargando=!1}));case 12:return e.datosRaw=[],t.next=15,s.a.get(i["d"]+"consolidados/asignaturas/curso/acumulado",{params:{idCurso:e.idCurso,periodo:e.idPeriodo,vigencia:e.$store.state.aLectivo}}).then((function(t){t.data.error?(e.mensajeEmergente("danger",i["h"],t.data.mensaje+" - Consolidados asignaturas curso periodo"),e.btnCargando=!1):0!=t.data.datos&&(e.datosRaw=t.data.datos)})).catch((function(t){e.mensajeEmergente("danger",i["h"],"Algo salio mal y no se pudo realizar: Consolidados asignaturas curso periodo. Intente m√°s tarde."+t),e.btnCargando=!1}));case 15:e.btnCargando=!1;case 16:case"end":return t.stop()}}),t)})))()},imprimir:function(){var e="Fecha: "+(new Date).toLocaleString(),t="CONSOLIDADO NOTAS FALTANTES POR √ÅREA",o=document.querySelector("table").outerHTML,a=window.open("NotaFaltanteArea","_blank");a.document.write('<html><head><title>NotaFaltanteArea</title></head>\n      <style scoped>\n        table {\n          border-collapse: collapse;\n          width: 100%;\n          text-align: center;\n          font-size: 10px;\n        }\n        th {\n          background: #eee;\n        }\n        .nota-recuperada {\n          border: 2px solid #ffa500;\n          box-shadow: 0 0 5px #ffa500;\n        }\n        .desempeno-bajo { background-color: #f8d7da; color: #721c24; }\n        .desempeno-basico { background-color: #d1ecf1; color: #0c5460; }\n        .desempeno-alto { background-color: #fff3cd; color: #856404; }\n        .desempeno-superior { background-color: #d4edda; color: #155724; }\n        .desempeno-extra { background-color: #f4ecf5; color: #2f2e2e; }\n      </style>\n        <body class="container">\n          <p style="text-align: center; font-size: 12px;">SECRETAR√çA DE EDUCACI√ìN TERRITORIAL DE TUNJA<br><b>'.concat(this.$store.state.nombreInstitucion,"</b><br>TUNJA - BOYAC√Å<br>").concat(t,"<br>Sede: ").concat(this.nombreSede," | Curso: ").concat(this.nombreCurso," | A√±o Lectivo ").concat(this.$store.state.aLectivo," | Periodo: ").concat(this.idPeriodo,"</p>\n          ").concat(o,'\n          <div style="text-align: right; font-size: 12px;"><i>').concat(e,"</i></div>\n        </body>\n      </html>")),a.document.close(),a.print()},exportarAExcel:function(){var e=document.querySelector("table"),t=p["utils"].table_to_book(e);p["writeFile"](t,"NotaFaltanteArea.xlsx")},redondear:function(e){var t=Number((10*Math.abs(e)).toPrecision(15));return Math.round(t)/10*Math.sign(e)},ocuparComboCursosSede:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.comboCursosSede=[],e.$store.state.datosCursos.forEach((function(t){t.id_sede==e.idSede&&e.comboCursosSede.push({value:t.id,text:t.nomenclatura.toUpperCase()})}));case 2:case"end":return t.stop()}}),t)})))()},ocuparComboSedes:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.comboSedes=[],e.$store.state.datosSedes.forEach((function(t){e.comboSedes.push({value:t.id,text:t.sede.toUpperCase()})}));case 2:case"end":return t.stop()}}),t)})))()},ocuparComboPeriodos:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.comboPeriodos=[],e.$store.state.periodos.forEach((function(t){e.comboPeriodos.push({value:t.id,text:t.periodo.toUpperCase()})}));case 2:case"end":return t.stop()}}),t)})))()},mensajeEmergente:function(e,t,o){this.$bvToast.toast(o,{title:t,variant:e,toaster:"b-toaster-top-center",solid:!0,autoHideDelay:4e3,appendToast:!1})}},computed:{totales:function(){return this.totalesGlobales()},estudiantesNotas:function(){var e=this,t={};return this.datosRaw.forEach((function(o){var a=o.estudiante,n=o.area,r=o.asignatura,s=o.periodo,i=o.definitiva,c=o.recuperacion,d=o.orden,u=o.definitivacompor,l=o.idTipoEspecialidad,m=o.ausJ,p=o.ausS,b=o.porcentaje,f=o.id_conceptual;t[a]||(t[a]={id_conceptual:f,ausJ:0,ausS:0,areas:{}}),t[a].areas[n]||(t[a].areas[n]={asignaturas:{}}),t[a].areas[n].asignaturas[r]||(t[a].areas[n].asignaturas[r]={periodos:{},orden:d,idTipoEspecialidad:l,porcentaje:b,pesos:{1:.2,2:.2,3:.3,4:.3}});var v=0;v=99===d?1==e.datosSeccion.tipoValComp?i:null!=u?u:"":c>i?c:i,t[a].areas[n].asignaturas[r].periodos[s]=v,t[a].ausJ+=m||0,t[a].ausS+=p||0})),t},totalColumnasPromedioArea:function(){var e=new Set(this.listaAreasAsignaturas.map((function(e){return e.area})));return e.size},puestosPorEstudiante:function(){var e=this,t=Object.entries(this.estudiantesNotas).map((function(t){var o=Object(u["a"])(t,2),a=o[0],n=o[1],r=parseFloat(e.calcularPromedioGeneral(n));return{nombre:a,promedio:isNaN(r)?0:r}}));t.sort((function(e,t){return t.promedio-e.promedio}));var o={},a=1,n=1,r=null;return t.forEach((function(e){e.promedio!==r&&(a=n,r=e.promedio),o[e.nombre]=a,n++})),o},encabezadoPorArea:function(){var e={};return this.listaAreasAsignaturas.forEach((function(t){var o=t.area,a=t.asignatura;e[o]||(e[o]=[]),e[o].push(a)})),e}},beforeMount:function(){this.ocuparComboSedes(),this.ocuparComboPeriodos(),this.datosSeccion=this.$store.state.datosSecciones[this.$store.state.idSeccion-1]}},I=R,B=(o("57d2"),Object(v["a"])(I,k,O,!1,null,"f8e70a2a",null)),F=B.exports,D=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("b-row",{staticClass:"mt-2"},[o("b-col",{attrs:{lg:"12"}},[o("b-card",{scopedSlots:e._u([{key:"header",fn:function(){return[o("h5",{staticClass:"mb-0"},[o("b-icon",{attrs:{icon:"card-checklist","aria-hidden":"true"}}),e._v(" CONSOLIDADO EVALUACIONES ACUMULADO PONDERADO")],1)]},proxy:!0}])},[o("b-card-text",[o("b-row",[o("b-col",{attrs:{lg:"2"}},[o("b-form-group",{staticClass:"etiqueta",attrs:{label:"Periodo:","label-for":"periodo"}},[o("b-form-select",{ref:"periodo",attrs:{id:"periodo",options:e.comboPeriodos},on:{change:function(t){e.idSede=null,e.idCurso=null}},model:{value:e.idPeriodo,callback:function(t){e.idPeriodo=t},expression:"idPeriodo"}})],1)],1),o("b-col",{attrs:{lg:"6"}},[o("b-form-group",{staticClass:"etiqueta",attrs:{label:"Seleccione la Sede:","label-for":"sedes"}},[o("b-form-select",{ref:"sedes",attrs:{id:"sedes",options:e.comboSedes,disabled:null==e.idPeriodo},on:{change:function(t){e.idCurso=null,e.ocuparComboCursosSede()}},model:{value:e.idSede,callback:function(t){e.idSede=t},expression:"idSede"}})],1)],1),o("b-col",{attrs:{lg:"4"}},[o("b-form-group",{staticClass:"etiqueta",attrs:{label:"Seleccione el Curso:","label-for":"cursos"}},[o("b-form-select",{ref:"cursos",attrs:{id:"cursos",options:e.comboCursosSede,disabled:null==e.idSede},on:{change:function(t){return e.consultarEstudiantes()}},model:{value:e.idCurso,callback:function(t){e.idCurso=t},expression:"idCurso"}})],1)],1)],1)],1)],1)],1)],1),o("b-row",[o("b-col",{attrs:{lg:"12"}},[e.btnCargando?o("div",[o("div",{staticClass:"text-center m-5 text-primary"},[o("b-spinner",{staticStyle:{width:"3rem",height:"3rem"},attrs:{label:"Spinner"}}),o("br"),o("strong",[e._v("Cargando informe...")])],1)]):e._e()])],1),e.btnCargando||null==e.idCurso?e._e():o("b-row",[o("b-col",{attrs:{lg:"12"}},[o("table",{staticClass:"table-responsive",attrs:{border:"1",cellspacing:"0",cellpadding:"1"}},[o("thead",[o("tr",[o("th",{attrs:{rowspan:"3"}},[e._v("#")]),o("th",{attrs:{rowspan:"3"}},[e._v("Estudiante")]),e._l(e.encabezadoPorArea,(function(t,a){return[o("th",{key:a,attrs:{colspan:5*t.length+1}},[e._v(e._s(a))])]})),o("th",{attrs:{rowspan:"2"}},[e._v("AuJ")]),o("th",{attrs:{rowspan:"2"}},[e._v("AuS")])],2),o("tr",[e._l(e.encabezadoPorArea,(function(t,a){return[e._l(t,(function(t,a){return[o("th",{key:"area-"+t+a,attrs:{colspan:"5"}},[e._v(e._s(t))])]})),o("th",{key:"prom-area-"+a,attrs:{rowspan:"2"}},[e._v("PRO AR")])]}))],2),o("tr",[e._l(e.encabezadoPorArea,(function(t,a){return[e._l(t,(function(t){return[o("th",{key:"p1"+t+a},[e._v("P1")]),o("th",{key:"p2"+t+a},[e._v("P2")]),o("th",{key:"p3"+t+a},[e._v("P3")]),o("th",{key:"p4"+t+a},[e._v("P4")]),o("th",{key:"prom"+t+a},[e._v("PR")])]}))]})),o("th"),e._v(" "),o("th")],2)]),o("tbody",e._l(e.estudiantesNotas,(function(t,a,n){return o("tr",{key:a},[o("td",{staticClass:"text-left"},[e._v(e._s(n+1))]),o("td",{staticStyle:{"text-align":"left"}},[e._v(e._s(a))]),e._l(e.encabezadoPorArea,(function(n,r){return[e._l(n,(function(n){return[e._l([1,2,3,4],(function(s){return o("td",{key:a+r+n+s},[e._v(" "+e._s(e.obtenerNota(t,r,n,s))+" ")])})),o("td",{key:"prom"+a+r+n},[e._v(" "+e._s(e.obtenerPromedioAsignatura(t,r,n))+" ")])]})),o("td",{key:"promArea"+a+r},[e._v(" "+e._s(e.obtenerPromedioArea(t,r))+" ")])]})),o("td",[e._v(e._s(t.ausJ))]),o("td",[e._v(e._s(t.ausS))])],2)})),0)]),o("div",{staticStyle:{"margin-bottom":"1rem"}},[o("b-button",{staticClass:"small mx-1 mt-3",attrs:{variant:"primary"},on:{click:e.imprimir}},[e._v("Imprimir Consolidado")]),o("b-button",{staticClass:"small mx-1 mt-3",attrs:{variant:"outline-primary"},on:{click:e.exportarAExcel}},[e._v("Exportar a Excel")])],1)])],1)],1)},$=[],L={name:"consolidadoponderado",components:{},data:function(){return{idSede:null,comboSedes:[],idPeriodo:null,comboPeriodos:null,idCurso:null,comboCursosSede:[],nombreSede:null,nombreCurso:null,idNivel:null,btnCargando:!1,datosRaw:[],datosSeccion:{},listaAreasAsignaturas:[]}},methods:{obtenerPromedioArea:function(e,t){var o=e.areas&&e.areas[t];return o?this.calcularPromedioArea(o):"0.0"},obtenerNota:function(e,t,o,a){var n,r,s,i,c,d=null===e||void 0===e||null===(n=e.areas)||void 0===n||null===(r=n[t])||void 0===r||null===(s=r.asignaturas)||void 0===s||null===(i=s[o])||void 0===i||null===(c=i.periodos)||void 0===c?void 0:c[a];return"number"===typeof d?d.toFixed(1):d},obtenerPromedioAsignatura:function(e,t,o){var a,n,r,s=null===e||void 0===e||null===(a=e.areas)||void 0===a||null===(n=a[t])||void 0===n||null===(r=n.asignaturas)||void 0===r?void 0:r[o];return s?this.calcularPromedioAsignatura(s):"0.0"},calcularPromedioAsignatura:function(e){var t=e.pesos,o=e.periodos,a=e.orden;if(99===a)return"";var n=0;if("eb58bf60-fc83-11ec-a1d1-1dc2835404e5"==this.$store.state.idInstitucion&&55==a){for(var r=0,s=1;s<=4;s++){var i,c=null!==(i=o[s])&&void 0!==i?i:0;c>0&&(n+=c,r++)}if(0===n)return"";n/=r}else for(var d=1;d<=4;d++){var u,l=null!==(u=o[d])&&void 0!==u?u:0;n+=l*t[d]/100}return this.redondear(n).toFixed(1)},calcularPromedioArea:function(e){var t=this,o=Object.values(e.asignaturas);if(!o.length)return"0.0";var a=0;return o.forEach((function(e){a+=parseFloat(t.calcularPromedioAsignatura(e))})),(a/o.length).toFixed(1)},calcularPromedioGeneral:function(e){var t=this,o=Object.values(e.areas);if(!o.length)return"0.00";var a=0;return o.forEach((function(e){a+=parseFloat(t.calcularPromedioArea(e))})),(a/o.length).toFixed(1)},contarAusencias:function(e){var t=0;return Object.values(this.estudiantesNotas).forEach((function(o){"ausJ"===e&&(t+=o.ausJ||0),"ausS"===e&&(t+=o.ausS||0)})),t},contarNotasPorAsignatura:function(e,t,o){var a=this,n=0;return Object.values(this.estudiantesNotas).forEach((function(r){var s,i,c,d,u=null===r||void 0===r||null===(s=r[e])||void 0===s||null===(i=s[t])||void 0===i?void 0:i.nota,l=null===r||void 0===r||null===(c=r[e])||void 0===c||null===(d=c[t])||void 0===d?void 0:d.idTipoEspecialidad;"number"===typeof u&&(1===l?("bajo"===o&&u<a.datosSeccion.minBas||"basico"===o&&u>=a.datosSeccion.minBas&&u<a.datosSeccion.minAlt||"alto"===o&&u>=a.datosSeccion.minAlt&&u<a.datosSeccion.minSup||"superior"===o&&u>=a.datosSeccion.minSup&&u<=a.datosSeccion.maxSup)&&n++:("bajo"===o&&u<a.datosSeccion.minBasT||"basico"===o&&u>=a.datosSeccion.minBasT&&u<a.datosSeccion.minAltT||"alto"===o&&u>=a.datosSeccion.minAltT&&u<a.datosSeccion.minSupT||"superior"===o&&u>=a.datosSeccion.minSupT&&u<=a.datosSeccion.maxSupT)&&n++)})),n},contarNotasTotales:function(e){var t=this,o=0;return Object.values(this.estudiantesNotas).forEach((function(a){t.listaAreasAsignaturas.forEach((function(n){var r,s,i,c,d=n.area,u=n.asignatura,l=null===a||void 0===a||null===(r=a[d])||void 0===r||null===(s=r[u])||void 0===s?void 0:s.nota,m=null===a||void 0===a||null===(i=a[d])||void 0===i||null===(c=i[u])||void 0===c?void 0:c.idTipoEspecialidad;"number"===typeof l&&(1===m?("bajo"===e&&l<t.datosSeccion.minBas||"basico"===e&&l>=t.datosSeccion.minBas&&l<t.datosSeccion.minAlt||"alto"===e&&l>=t.datosSeccion.minAlt&&l<t.datosSeccion.minSup||"superior"===e&&l>=t.datosSeccion.minSup&&l<=t.datosSeccion.maxSup)&&o++:("bajo"===e&&l<t.datosSeccion.minBasT||"basico"===e&&l>=t.datosSeccion.minBasT&&l<t.datosSeccion.minAltT||"alto"===e&&l>=t.datosSeccion.minAltT&&l<t.datosSeccion.minSupT||"superior"===e&&l>=t.datosSeccion.minSupT&&l<=t.datosSeccion.maxSupT)&&o++)}))})),o},iconoPuesto:function(e){return 1===e?"ü•á":2===e?"ü•à":3===e?"ü•â":""},contarDesempenoEstudiante:function(e,t){var o=this,a=0;return this.listaAreasAsignaturas.forEach((function(n){var r,s,i,c,d=n.area,u=n.asignatura,l=null===e||void 0===e||null===(r=e[d])||void 0===r||null===(s=r[u])||void 0===s?void 0:s.nota,m=null===e||void 0===e||null===(i=e[d])||void 0===i||null===(c=i[u])||void 0===c?void 0:c.idTipoEspecialidad;"number"===typeof l&&(1===m?("bajo"===t&&l<o.datosSeccion.minBas||"basico"===t&&l>=o.datosSeccion.minBas&&l<o.datosSeccion.minAlt||"alto"===t&&l>=o.datosSeccion.minAlt&&l<o.datosSeccion.minSup||"superior"===t&&l>=o.datosSeccion.minSup&&l<=o.datosSeccion.maxSup)&&a++:("bajo"===t&&l<o.datosSeccion.minBasT||"basico"===t&&l>=o.datosSeccion.minBasT&&l<o.datosSeccion.minAltT||"alto"===t&&l>=o.datosSeccion.minAltT&&l<o.datosSeccion.minSupT||"superior"===t&&l>=o.datosSeccion.minSupT&&l<=o.datosSeccion.maxSupT)&&a++)})),a},fueRecuperada:function(e,t,o){var a,n,r;return null!==(a=null===e||void 0===e||null===(n=e[t])||void 0===n||null===(r=n[o])||void 0===r?void 0:r.fueRecuperada)&&void 0!==a&&a},obtenerOriginal:function(e,t,o){var a,n,r=null===e||void 0===e||null===(a=e[t])||void 0===a||null===(n=a[o])||void 0===n?void 0:n.original;return"number"===typeof r?r.toFixed(1):"0.0"},obtenerRecuperacion:function(e,t,o){var a,n,r=null===e||void 0===e||null===(a=e[t])||void 0===a||null===(n=a[o])||void 0===n?void 0:n.recuperacion;return"number"===typeof r?r.toFixed(1):"0.0"},obtenerColor:function(e,t,o,a){var n,r,s=null===t||void 0===t||null===(n=t[o])||void 0===n||null===(r=n[a])||void 0===r?void 0:r.idTipoEspecialidad;return 1===s?e<this.datosSeccion.minBas?"desempeno-bajo":e<this.datosSeccion.minAlt?"desempeno-basico":e<this.datosSeccion.minSup?"desempeno-alto":e<=this.datosSeccion.maxSup?"desempeno-superior":"desempeno-extra":e<this.datosSeccion.minBasT?"desempeno-bajo":e<this.datosSeccion.minAltT?"desempeno-basico":e<this.datosSeccion.minSupT?"desempeno-alto":e<=this.datosSeccion.maxSupT?"desempeno-superior":"desempeno-extra"},obtenerColorGeneral:function(e){return e<this.datosSeccion.minBas?"desempeno-bajo":e<this.datosSeccion.minAlt?"desempeno-basico":e<this.datosSeccion.minSup?"desempeno-alto":e<=this.datosSeccion.maxSup?"desempeno-superior":"desempeno-extra"},consultarEstudiantes:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.btnCargando=!0,e.nombreSede=document.getElementById("sedes")[document.getElementById("sedes").selectedIndex].text,null==e.idCurso){t.next=11;break}return e.nombreCurso=document.getElementById("cursos")[document.getElementById("cursos").selectedIndex].text,e.$store.state.datosCursos.forEach((function(t){t.id==e.idCurso&&(e.idNivel=t.id_nivel)})),e.listaAreasAsignaturas=[],t.next=8,s.a.get(i["d"]+"consolidados/areasasignaturas/curso",{params:{idCurso:e.idCurso}}).then((function(t){t.data.error?(e.mensajeEmergente("danger",i["h"],t.data.mensaje+" - Lista areas-asignaturas curso"),e.btnCargando=!1):0!=t.data.datos&&t.data.datos.forEach((function(t){90!=t.orden&&e.listaAreasAsignaturas.push(t)}))})).catch((function(t){e.mensajeEmergente("danger",i["h"],"Algo salio mal y no se pudo realizar: Lista areas-asignaturas curso. Intente m√°s tarde."+t),e.btnCargando=!1}));case 8:return e.datosRaw=[],t.next=11,s.a.get(i["d"]+"consolidados/asignaturas/curso/acumulado",{params:{idCurso:e.idCurso,periodo:e.idPeriodo,vigencia:e.$store.state.aLectivo}}).then((function(t){t.data.error?(e.mensajeEmergente("danger",i["h"],t.data.mensaje+" - Consolidados asignaturas curso periodo"),e.btnCargando=!1):0!=t.data.datos&&(e.datosRaw=t.data.datos)})).catch((function(t){e.mensajeEmergente("danger",i["h"],"Algo salio mal y no se pudo realizar: Consolidados asignaturas curso periodo. Intente m√°s tarde."+t),e.btnCargando=!1}));case 11:e.btnCargando=!1;case 12:case"end":return t.stop()}}),t)})))()},imprimir:function(){var e="Fecha: "+(new Date).toLocaleString(),t="CONSOLIDADO EVALUACIONES ACUMULADO PONDERADO",o=document.querySelector("table").outerHTML,a=window.open("Consolidados","_blank");a.document.write('<html><head><title>Imprimir</title></head>\n      <style scoped>\n        table {\n          border-collapse: collapse;\n          width: 100%;\n          text-align: center;\n          font-size: 10px;\n        }\n        th {\n          background: #eee;\n        }\n        .nota-recuperada {\n          border: 2px solid #ffa500;\n          box-shadow: 0 0 5px #ffa500;\n        }\n        .desempeno-bajo { background-color: #f8d7da; color: #721c24; }\n        .desempeno-basico { background-color: #d1ecf1; color: #0c5460; }\n        .desempeno-alto { background-color: #fff3cd; color: #856404; }\n        .desempeno-superior { background-color: #d4edda; color: #155724; }\n        .desempeno-extra { background-color: #f4ecf5; color: #2f2e2e; }\n      </style>\n        <body class="container">\n          <p style="text-align: center; font-size: 12px;">SECRETAR√çA DE EDUCACI√ìN TERRITORIAL DE TUNJA<br><b>'.concat(this.$store.state.nombreInstitucion,"</b><br>TUNJA - BOYAC√Å<br>").concat(t,"<br>Sede: ").concat(this.nombreSede," | Curso: ").concat(this.nombreCurso," | A√±o Lectivo ").concat(this.$store.state.aLectivo," | Periodo: ").concat(this.idPeriodo,"</p>\n          ").concat(o,'\n          <div style="text-align: right; font-size: 12px;"><i>').concat(e,"</i></div>\n        </body>\n      </html>")),a.document.close(),a.print()},exportarAExcel:function(){var e=document.querySelector("table"),t=p["utils"].table_to_book(e);p["writeFile"](t,"notas.xlsx")},redondear:function(e){var t=Number((10*Math.abs(e)).toPrecision(15));return Math.round(t)/10*Math.sign(e)},ocuparComboCursosSede:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.comboCursosSede=[],e.$store.state.datosCursos.forEach((function(t){t.id_sede==e.idSede&&e.comboCursosSede.push({value:t.id,text:t.nomenclatura.toUpperCase()})}));case 2:case"end":return t.stop()}}),t)})))()},ocuparComboSedes:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.comboSedes=[],e.$store.state.datosSedes.forEach((function(t){e.comboSedes.push({value:t.id,text:t.sede.toUpperCase()})}));case 2:case"end":return t.stop()}}),t)})))()},ocuparComboPeriodos:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.comboPeriodos=[],e.$store.state.periodos.forEach((function(t){e.comboPeriodos.push({value:t.id,text:t.periodo.toUpperCase()})}));case 2:case"end":return t.stop()}}),t)})))()},mensajeEmergente:function(e,t,o){this.$bvToast.toast(o,{title:t,variant:e,toaster:"b-toaster-top-center",solid:!0,autoHideDelay:4e3,appendToast:!1})}},computed:{estudiantesNotas:function(){var e=this,t={};return this.datosRaw.forEach((function(o){var a=o.estudiante,n=o.area,r=o.asignatura,s=o.periodo,i=o.definitiva,c=o.recuperacion,d=o.orden,u=o.definitivacompor,l=(o.idTipoEspecialidad,o.ausJ),m=o.ausS;t[a]||(t[a]={ausJ:0,ausS:0,areas:{}}),t[a].areas[n]||(t[a].areas[n]={asignaturas:{}}),t[a].areas[n].asignaturas[r]||(t[a].areas[n].asignaturas[r]={periodos:{},orden:d,pesos:{1:e.datosSeccion.pesoP1,2:e.datosSeccion.pesoP2,3:e.datosSeccion.pesoP3,4:e.datosSeccion.pesoP4}});var p=0;p=99===d?null!=u?u:"":c>i?c:i,t[a].areas[n].asignaturas[r].periodos[s]=p,t[a].ausJ+=l||0,t[a].ausS+=m||0})),t},totalColumnasPromedioArea:function(){var e=new Set(this.listaAreasAsignaturas.map((function(e){return e.area})));return e.size},puestosPorEstudiante:function(){var e=this,t=Object.entries(this.estudiantesNotas).map((function(t){var o=Object(u["a"])(t,2),a=o[0],n=o[1],r=parseFloat(e.calcularPromedioGeneral(n));return{nombre:a,promedio:isNaN(r)?0:r}}));t.sort((function(e,t){return t.promedio-e.promedio}));var o={},a=1,n=1,r=null;return t.forEach((function(e){e.promedio!==r&&(a=n,r=e.promedio),o[e.nombre]=a,n++})),o},encabezadoPorArea:function(){var e={};return this.listaAreasAsignaturas.forEach((function(t){var o=t.area,a=t.asignatura;e[o]||(e[o]=[]),e[o].push(a)})),e}},beforeMount:function(){this.ocuparComboSedes(),this.ocuparComboPeriodos(),this.datosSeccion=this.$store.state.datosSecciones[this.$store.state.idSeccion-1]}},J=L,z=(o("a5ab"),Object(v["a"])(J,D,$,!1,null,"39e3ab4c",null)),U=z.exports,M=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("b-row",{staticClass:"mt-2"},[o("b-col",{attrs:{lg:"12"}},[o("b-card",{scopedSlots:e._u([{key:"header",fn:function(){return[o("h5",{staticClass:"mb-0"},[o("b-icon",{attrs:{icon:"card-checklist","aria-hidden":"true"}}),e._v(" CONSOLIDADO AUSENCIAS")],1)]},proxy:!0}])},[o("b-card-text",[o("b-row",[o("b-col",{attrs:{lg:"2"}},[o("b-form-group",{staticClass:"etiqueta",attrs:{label:"Periodo:","label-for":"periodo"}},[o("b-form-select",{ref:"periodo",attrs:{id:"periodo",options:e.comboPeriodos},on:{change:function(t){e.idSede=null,e.idCurso=null}},model:{value:e.idPeriodo,callback:function(t){e.idPeriodo=t},expression:"idPeriodo"}})],1)],1),o("b-col",{attrs:{lg:"6"}},[o("b-form-group",{staticClass:"etiqueta",attrs:{label:"Seleccione la Sede:","label-for":"sedes"}},[o("b-form-select",{ref:"sedes",attrs:{id:"sedes",options:e.comboSedes,disabled:null==e.idPeriodo},on:{change:function(t){e.idCurso=null,e.ocuparComboCursosSede()}},model:{value:e.idSede,callback:function(t){e.idSede=t},expression:"idSede"}})],1)],1),o("b-col",{attrs:{lg:"4"}},[o("b-form-group",{staticClass:"etiqueta",attrs:{label:"Seleccione el Curso:","label-for":"cursos"}},[o("b-form-select",{ref:"cursos",attrs:{id:"cursos",options:e.comboCursosSede,disabled:null==e.idSede},on:{change:function(t){return e.consultarEstudiantes()}},model:{value:e.idCurso,callback:function(t){e.idCurso=t},expression:"idCurso"}})],1)],1)],1)],1)],1)],1)],1),o("b-row",[o("b-col",{attrs:{lg:"12"}},[e.btnCargando?o("div",[o("div",{staticClass:"text-center m-5 text-primary"},[o("b-spinner",{staticStyle:{width:"3rem",height:"3rem"},attrs:{label:"Spinner"}}),o("br"),o("strong",[e._v("Cargando informe...")])],1)]):e._e()])],1),e.btnCargando||null==e.idCurso?e._e():o("b-row",[o("b-col",{attrs:{lg:"12"}},[o("table",{staticClass:"tabla-ausencias",attrs:{border:"1",cellspacing:"0",cellpadding:"1"}},[o("thead",[o("tr",[o("th",{attrs:{rowspan:"3"}},[e._v("#")]),o("th",{attrs:{rowspan:"3"}},[e._v("Estudiante")]),e._l(e.asignaturasValidas,(function(t,a){return[o("th",{key:"head-"+a,attrs:{colspan:2*e.periodos.length}},[e._v(e._s(t.asignatura))])]})),o("th",{attrs:{rowspan:"3"}},[e._v("TJ")]),o("th",{attrs:{rowspan:"3"}},[e._v("TS")]),o("th",{attrs:{rowspan:"3"}},[e._v("#")])],2),o("tr",[e._l(e.asignaturasValidas,(function(t,a){return[e._l(e.periodos,(function(t){return[o("th",{key:"p-"+a+"-"+t,attrs:{colspan:"2"}},[e._v(e._s(t))])]}))]}))],2),o("tr",[e._l(e.asignaturasValidas,(function(t,a){return[e._l(e.periodos,(function(t){return[o("th",{key:"tipoJ-"+a+"-"+t},[e._v("J")]),o("th",{key:"tipoS-"+a+"-"+t},[e._v("S")])]}))]}))],2)]),o("tbody",[e._l(e.consolidadoAusencias,(function(t,a){return o("tr",{key:t.estudiante},[o("td",[e._v(e._s(a+1))]),o("td",{staticStyle:{"text-align":"left"}},[e._v(e._s(t.estudiante))]),e._l(e.asignaturasValidas,(function(a,n){return[e._l(e.periodos,(function(r){return[o("td",{key:n+"J-"+t.estudiante+a.asignatura+r},[e._v(e._s(e.getAusencia(t,a,r,"ausJ")))]),o("td",{key:n+"S-"+t.estudiante+a.asignatura+r},[e._v(e._s(e.getAusencia(t,a,r,"ausS")))])]}))]})),o("td",[o("strong",[e._v(e._s(t.totalAusJ))])]),o("td",[o("strong",[e._v(e._s(t.totalAusS))])]),o("td",[e._v(e._s(a+1))])],2)})),o("tr",{staticStyle:{"background-color":"#f0f0f0","font-weight":"bold"}},[o("td",{attrs:{colspan:"2"}},[o("strong",[e._v("Totales")])]),e._l(e.asignaturasValidas,(function(t,a){return[e._l(e.periodos,(function(n){return[o("td",{key:a+"J-"+t.asignatura+n},[e._v(e._s(e.getAusenciaTotal(t,n,"ausJ")))]),o("td",{key:a+"S-"+t.asignatura+n},[e._v(e._s(e.getAusenciaTotal(t,n,"ausS")))])]}))]})),o("td",[e._v(e._s(e.getTotalGeneral("totalAusJ")))]),o("td",[e._v(e._s(e.getTotalGeneral("totalAusS")))])],2)],2)]),o("div",{staticStyle:{"margin-bottom":"1rem"}},[o("b-button",{staticClass:"small mx-1 mt-3",attrs:{variant:"primary"},on:{click:e.imprimir}},[e._v("Imprimir Consolidado")]),o("b-button",{staticClass:"small mx-1 mt-3",attrs:{variant:"outline-primary"},on:{click:e.exportarAExcel}},[e._v("Exportar a Excel")])],1)])],1)],1)},V=[],q=(o("a630"),o("fb6a"),{name:"ausencias",props:{},components:{},data:function(){return{idSede:null,comboSedes:[],idPeriodo:null,comboPeriodos:null,idCurso:null,comboCursosSede:[],nombreSede:null,nombreCurso:null,idNivel:null,btnCargando:!1,dataConsultada:[],datosSeccion:{},listaAreasAsignaturas:[],listaEstudiantes:[],ausencias:[]}},methods:{getTotalGeneral:function(e){return this.consolidadoAusencias.reduce((function(t,o){return t+(parseInt(o[e])||0)}),0)},getAusenciaTotal:function(e,t,o){var a=(null===e||void 0===e?void 0:e.asignatura)||e,n=this.consolidadoAusencias.reduce((function(e,n){var r,s,i,c=null===(r=n.asignaturas)||void 0===r||null===(s=r[a])||void 0===s||null===(i=s[t])||void 0===i?void 0:i[o];return e+(parseInt(c)||0)}),0);return n},getAusencia:function(e,t,o,a){try{var n,r,s;return(null===(n=e.asignaturas)||void 0===n||null===(r=n[t.asignatura])||void 0===r||null===(s=r[o])||void 0===s?void 0:s[a])||""}catch(i){return""}},consultarEstudiantes:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.btnCargando=!0,e.nombreSede=document.getElementById("sedes")[document.getElementById("sedes").selectedIndex].text,null==e.idCurso){t.next=14;break}return e.nombreCurso=document.getElementById("cursos")[document.getElementById("cursos").selectedIndex].text,e.$store.state.datosCursos.forEach((function(t){t.id==e.idCurso&&(e.idNivel=t.id_nivel)})),e.listaEstudiantes=[],t.next=8,s.a.get(i["d"]+"consolidado/listaestudiantes/curso",{params:{idCurso:e.idCurso,vigencia:e.$store.state.aLectivo}}).then((function(t){t.data.error?e.mensajeEmergente("danger",i["h"],t.data.mensaje+" - Consulta Lista Curso"):0!=t.data.datos&&(e.listaEstudiantes=t.data.datos)})).catch((function(t){e.mensajeEmergente("danger",i["h"],"Algo salio mal y no se pudo realizar: Consulta Lista Curso. Intente m√°s tarde."+t)}));case 8:return e.listaAreasAsignaturas=[],t.next=11,s.a.get(i["d"]+"consolidados/areasasignaturas/curso",{params:{idCurso:e.idCurso}}).then((function(t){t.data.error?(e.mensajeEmergente("danger",i["h"],t.data.mensaje+" - Lista areas-asignaturas curso"),e.btnCargando=!1):0!=t.data.datos&&(e.listaAreasAsignaturas=t.data.datos)})).catch((function(t){e.mensajeEmergente("danger",i["h"],"Algo salio mal y no se pudo realizar: Lista areas-asignaturas curso. Intente m√°s tarde."+t),e.btnCargando=!1}));case 11:return e.dataConsultada=[],t.next=14,s.a.get(i["d"]+"consolidados/ausencias/curso/periodo",{params:{idCurso:e.idCurso,periodo:e.idPeriodo,vigencia:e.$store.state.aLectivo}}).then((function(t){t.data.error?(e.mensajeEmergente("danger",i["h"],t.data.mensaje+" - Consolidados ausencias curso periodo"),e.btnCargando=!1):0!=t.data.datos&&(e.dataConsultada=t.data.datos)})).catch((function(t){e.mensajeEmergente("danger",i["h"],"Algo salio mal y no se pudo realizar: Consolidados ausencias curso periodo. Intente m√°s tarde."+t),e.btnCargando=!1}));case 14:e.btnCargando=!1;case 15:case"end":return t.stop()}}),t)})))()},imprimir:function(){var e="Fecha: "+(new Date).toLocaleString(),t="CONSOLIDADO DE AUSENCIAS",o=document.querySelector("table").outerHTML,a=window.open("Ausencias","_blank");a.document.write('<html><head><title>Ausencias</title></head>\n      <style scoped>\n        .tabla-ausencias {\n            border-collapse: collapse;\n            width: 100%;\n            text-align: center;\n            font-size: 10px;\n        }\n        .tabla-ausencias th {\n          background: #eee;\n        }\n      </style>\n        <body class="container">\n          <p style="text-align: center; font-size: 12px;">SECRETAR√çA DE EDUCACI√ìN TERRITORIAL DE TUNJA<br><b>'.concat(this.$store.state.nombreInstitucion,"</b><br>TUNJA - BOYAC√Å<br>").concat(t,"<br>Sede: ").concat(this.nombreSede," | Curso: ").concat(this.nombreCurso," | A√±o Lectivo ").concat(this.$store.state.aLectivo," | Periodo: ").concat(this.idPeriodo,"</p>\n          ").concat(o,'\n          <div style="text-align: right; font-size: 12px;"><i>').concat(e,"</i></div>\n        </body>\n      </html>")),a.document.close(),a.print()},exportarAExcel:function(){var e=document.querySelector("table"),t=p["utils"].table_to_book(e);p["writeFile"](t,"ausencias.xlsx")},ocuparComboCursosSede:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.comboCursosSede=[],e.$store.state.datosCursos.forEach((function(t){t.id_sede==e.idSede&&e.comboCursosSede.push({value:t.id,text:t.nomenclatura.toUpperCase()})}));case 2:case"end":return t.stop()}}),t)})))()},ocuparComboSedes:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.comboSedes=[],e.$store.state.datosSedes.forEach((function(t){e.comboSedes.push({value:t.id,text:t.sede.toUpperCase()})}));case 2:case"end":return t.stop()}}),t)})))()},ocuparComboPeriodos:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.comboPeriodos=[],e.$store.state.periodos.forEach((function(t){e.comboPeriodos.push({value:t.id,text:t.periodo.toUpperCase()})}));case 2:case"end":return t.stop()}}),t)})))()},mensajeEmergente:function(e,t,o){this.$bvToast.toast(o,{title:t,variant:e,toaster:"b-toaster-top-center",solid:!0,autoHideDelay:4e3,appendToast:!1})}},computed:{totalesPorColumna:function(){var e=this,t={};return this.asignaturasValidas.forEach((function(o){var a=o.asignatura;t[a]={},e.periodos.forEach((function(o){var n=0,r=0;e.consolidadoAusencias.forEach((function(e){var t,s,i,c,d,u;n+=(null===(t=e.asignaturas)||void 0===t||null===(s=t[a])||void 0===s||null===(i=s[o])||void 0===i?void 0:i.ausJ)||0,r+=(null===(c=e.asignaturas)||void 0===c||null===(d=c[a])||void 0===d||null===(u=d[o])||void 0===u?void 0:u.ausS)||0})),t[a][o]={ausJ:n,ausS:r}}))})),t},periodos:function(){return Array.from({length:this.idPeriodo},(function(e,t){return"P".concat(t+1)}))},asignaturasValidas:function(){return this.listaAreasAsignaturas.filter((function(e){return 999!==e.orden}))},consolidadoAusencias:function(){var e=this;return this.listaEstudiantes.map((function(t){var o={estudiante:t.estudiante,asignaturas:{},totalAusJ:0,totalAusS:0};return e.asignaturasValidas.forEach((function(a){var n=a.asignatura;o.asignaturas[n]={},e.periodos.forEach((function(a){var r=e.dataConsultada.find((function(e){return e.idMatricula===t.idMatricula&&e.asignatura===n&&e.periodo===parseInt(a.slice(1))})),s=(null===r||void 0===r?void 0:r.ausJ)||0,i=(null===r||void 0===r?void 0:r.ausS)||0;o.asignaturas[n][a]={ausJ:s,ausS:i},o.totalAusJ+=s,o.totalAusS+=i}))})),o}))}},beforeMount:function(){this.ocuparComboSedes(),this.ocuparComboPeriodos(),this.datosSeccion=this.$store.state.datosSecciones[this.$store.state.idSeccion-1]}}),G=q,H=(o("b45a"),Object(v["a"])(G,M,V,!1,null,"47b943f5",null)),Y=H.exports,K=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("b-row",{staticClass:"mt-2"},[o("b-col",{attrs:{lg:"12"}},[o("b-card",{scopedSlots:e._u([{key:"header",fn:function(){return[o("h5",{staticClass:"mb-0"},[o("b-icon",{attrs:{icon:"card-checklist","aria-hidden":"true"}}),e._v(" CONSOLIDADO AUSENCIAS ACUMULADAS")],1)]},proxy:!0}])},[o("b-card-text",[o("b-row",[o("b-col",{attrs:{lg:"2"}},[o("b-form-group",{staticClass:"etiqueta",attrs:{label:"Periodo:","label-for":"periodo"}},[o("b-form-select",{ref:"periodo",attrs:{id:"periodo",options:e.comboPeriodos},on:{change:function(t){e.idSede=null,e.idCurso=null}},model:{value:e.idPeriodo,callback:function(t){e.idPeriodo=t},expression:"idPeriodo"}})],1)],1),o("b-col",{attrs:{lg:"6"}},[o("b-form-group",{staticClass:"etiqueta",attrs:{label:"Seleccione la Sede:","label-for":"sedes"}},[o("b-form-select",{ref:"sedes",attrs:{id:"sedes",options:e.comboSedes,disabled:null==e.idPeriodo},on:{change:function(t){e.idCurso=null,e.ocuparComboCursosSede()}},model:{value:e.idSede,callback:function(t){e.idSede=t},expression:"idSede"}})],1)],1),o("b-col",{attrs:{lg:"4"}},[o("b-form-group",{staticClass:"etiqueta",attrs:{label:"Seleccione el Curso:","label-for":"cursos"}},[o("b-form-select",{ref:"cursos",attrs:{id:"cursos",options:e.comboCursosSede,disabled:null==e.idSede},on:{change:function(t){return e.consultarEstudiantes()}},model:{value:e.idCurso,callback:function(t){e.idCurso=t},expression:"idCurso"}})],1)],1)],1)],1)],1)],1)],1),o("b-row",[o("b-col",{attrs:{lg:"12"}},[e.btnCargando?o("div",[o("div",{staticClass:"text-center m-5 text-primary"},[o("b-spinner",{staticStyle:{width:"3rem",height:"3rem"},attrs:{label:"Spinner"}}),o("br"),o("strong",[e._v("Cargando informe...")])],1)]):e._e()])],1),e.btnCargando||null==e.idCurso?e._e():o("b-row",[o("b-col",{attrs:{lg:"12"}},[o("table",{staticClass:"tabla-ausencias",attrs:{border:"1",cellspacing:"0",cellpadding:"1"}},[o("thead",[o("tr",[o("th",{attrs:{rowspan:"2"}},[e._v("#")]),o("th",{attrs:{rowspan:"2"}},[e._v("Estudiante")]),e._l(e.asignaturasValidas,(function(t,a){return[o("th",{key:"head-"+a,attrs:{colspan:2}},[e._v(e._s(t.asignatura))])]})),o("th",{attrs:{rowspan:"2"}},[e._v("TotalAJ")]),o("th",{attrs:{rowspan:"2"}},[e._v("TotalAS")]),o("th",{attrs:{rowspan:"2"}},[e._v("#")])],2),o("tr",[e._l(e.asignaturasValidas,(function(t,a){return[o("th",{key:"headJ-"+a},[e._v("AJ")]),o("th",{key:"headS-"+a},[e._v("AS")])]}))],2)]),o("tbody",[e._l(e.ausenciasConsolidadas,(function(t,a){return o("tr",{key:t.idMatricula},[o("td",[e._v(e._s(a+1))]),o("td",{staticStyle:{"text-align":"left"}},[e._v(e._s(t.estudiante))]),e._l(e.asignaturasValidas,(function(a,n){return[o("td",{key:n+"J-"+t.estudiante+a.asignatura},[e._v(e._s(e.getAusencia(t,a,"ausJ")))]),o("td",{key:n+"S-"+t.estudiante+a.asignatura},[e._v(e._s(e.getAusencia(t,a,"ausS")))])]})),o("td",[o("strong",[e._v(e._s(t.totalAusJ))])]),o("td",[o("strong",[e._v(e._s(t.totalAusS))])]),o("td",[e._v(e._s(a+1))])],2)})),o("tr",{staticStyle:{"background-color":"#f0f0f0","font-weight":"bold"}},[o("td",{attrs:{colspan:"2"}},[o("strong",[e._v("Totales")])]),e._l(e.asignaturasValidas,(function(t,a){return[o("td",{key:a+"J-"+t.asignatura},[e._v(e._s(e.totalesPorAsignatura[t.asignatura].ausJ))]),o("td",{key:a+"S-"+t.asignatura},[e._v(e._s(e.totalesPorAsignatura[t.asignatura].ausS))])]})),o("td",[e._v(e._s(e.ausenciasConsolidadas.reduce((function(e,t){return e+t.totalAusJ}),0)))]),o("td",[e._v(e._s(e.ausenciasConsolidadas.reduce((function(e,t){return e+t.totalAusS}),0)))]),o("td")],2)],2)]),o("div",{staticStyle:{"margin-bottom":"1rem"}},[o("b-button",{staticClass:"small mx-1 mt-3",attrs:{variant:"primary"},on:{click:e.imprimir}},[e._v("Imprimir Consolidado")]),o("b-button",{staticClass:"small mx-1 mt-3",attrs:{variant:"outline-primary"},on:{click:e.exportarAExcel}},[e._v("Exportar a Excel")])],1)])],1)],1)},Q=[],W={name:"ausenciasperiodos",props:{},components:{},data:function(){return{idSede:null,comboSedes:[],idPeriodo:null,comboPeriodos:null,idCurso:null,comboCursosSede:[],nombreSede:null,nombreCurso:null,idNivel:null,btnCargando:!1,dataConsultada:[],datosSeccion:{},listaAreasAsignaturas:[],listaEstudiantes:[],ausencias:[]}},methods:{getAusencia:function(e,t,o){var a,n,r,s,i,c=(null===t||void 0===t?void 0:t.asignatura)||t;return(null===e||void 0===e||null===(a=e.asignaturas)||void 0===a||null===(n=a[c])||void 0===n?void 0:n[o])>0?null!==(r=null===e||void 0===e||null===(s=e.asignaturas)||void 0===s||null===(i=s[c])||void 0===i?void 0:i[o])&&void 0!==r?r:0:""},consultarEstudiantes:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.btnCargando=!0,e.nombreSede=document.getElementById("sedes")[document.getElementById("sedes").selectedIndex].text,null==e.idCurso){t.next=14;break}return e.nombreCurso=document.getElementById("cursos")[document.getElementById("cursos").selectedIndex].text,e.$store.state.datosCursos.forEach((function(t){t.id==e.idCurso&&(e.idNivel=t.id_nivel)})),e.listaEstudiantes=[],t.next=8,s.a.get(i["d"]+"consolidado/listaestudiantes/curso",{params:{idCurso:e.idCurso,vigencia:e.$store.state.aLectivo}}).then((function(t){t.data.error?e.mensajeEmergente("danger",i["h"],t.data.mensaje+" - Consulta Lista Curso"):0!=t.data.datos&&(e.listaEstudiantes=t.data.datos)})).catch((function(t){e.mensajeEmergente("danger",i["h"],"Algo salio mal y no se pudo realizar: Consulta Lista Curso. Intente m√°s tarde."+t)}));case 8:return e.listaAreasAsignaturas=[],t.next=11,s.a.get(i["d"]+"consolidados/areasasignaturas/curso",{params:{idCurso:e.idCurso}}).then((function(t){t.data.error?(e.mensajeEmergente("danger",i["h"],t.data.mensaje+" - Lista areas-asignaturas curso"),e.btnCargando=!1):0!=t.data.datos&&(e.listaAreasAsignaturas=t.data.datos)})).catch((function(t){e.mensajeEmergente("danger",i["h"],"Algo salio mal y no se pudo realizar: Lista areas-asignaturas curso. Intente m√°s tarde."+t),e.btnCargando=!1}));case 11:return e.dataConsultada=[],t.next=14,s.a.get(i["d"]+"consolidados/ausencias/curso/periodos",{params:{idCurso:e.idCurso,periodo:e.idPeriodo,vigencia:e.$store.state.aLectivo}}).then((function(t){t.data.error?(e.mensajeEmergente("danger",i["h"],t.data.mensaje+" - Consolidados ausencias curso acumuladas"),e.btnCargando=!1):0!=t.data.datos&&(e.dataConsultada=t.data.datos)})).catch((function(t){e.mensajeEmergente("danger",i["h"],"Algo salio mal y no se pudo realizar: Consolidados ausencias curso acumuladas. Intente m√°s tarde."+t),e.btnCargando=!1}));case 14:e.btnCargando=!1;case 15:case"end":return t.stop()}}),t)})))()},imprimir:function(){var e="Fecha: "+(new Date).toLocaleString(),t="CONSOLIDADO DE AUSENCIAS ACUMULADAS",o=document.querySelector("table").outerHTML,a=window.open("Ausencias","_blank");a.document.write('<html><head><title>Ausencias</title></head>\n      <style scoped>\n        .tabla-ausencias {\n            border-collapse: collapse;\n            width: 100%;\n            text-align: center;\n            font-size: 10px;\n        }\n        .tabla-ausencias th {\n          background: #eee;\n        }\n      </style>\n        <body class="container">\n          <p style="text-align: center; font-size: 12px;">SECRETAR√çA DE EDUCACI√ìN TERRITORIAL DE TUNJA<br><b>'.concat(this.$store.state.nombreInstitucion,"</b><br>TUNJA - BOYAC√Å<br>").concat(t,"<br>Sede: ").concat(this.nombreSede," | Curso: ").concat(this.nombreCurso," | A√±o Lectivo ").concat(this.$store.state.aLectivo," | Periodo: ").concat(this.idPeriodo,"</p>\n          ").concat(o,'\n          <div style="text-align: right; font-size: 12px;"><i>').concat(e,"</i></div>\n        </body>\n      </html>")),a.document.close(),a.print()},exportarAExcel:function(){var e=document.querySelector("table"),t=p["utils"].table_to_book(e);p["writeFile"](t,"ausencias.xlsx")},ocuparComboCursosSede:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.comboCursosSede=[],e.$store.state.datosCursos.forEach((function(t){t.id_sede==e.idSede&&e.comboCursosSede.push({value:t.id,text:t.nomenclatura.toUpperCase()})}));case 2:case"end":return t.stop()}}),t)})))()},ocuparComboSedes:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.comboSedes=[],e.$store.state.datosSedes.forEach((function(t){e.comboSedes.push({value:t.id,text:t.sede.toUpperCase()})}));case 2:case"end":return t.stop()}}),t)})))()},ocuparComboPeriodos:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.comboPeriodos=[],e.$store.state.periodos.forEach((function(t){e.comboPeriodos.push({value:t.id,text:t.periodo.toUpperCase()})}));case 2:case"end":return t.stop()}}),t)})))()},mensajeEmergente:function(e,t,o){this.$bvToast.toast(o,{title:t,variant:e,toaster:"b-toaster-top-center",solid:!0,autoHideDelay:4e3,appendToast:!1})}},computed:{asignaturasValidas:function(){return this.listaAreasAsignaturas.filter((function(e){return 999!==e.orden}))},ausenciasConsolidadas:function(){var e=this;return this.listaEstudiantes.map((function(t){var o={estudiante:t.estudiante,idMatricula:t.idMatricula,asignaturas:{},totalAusJ:0,totalAusS:0};return e.asignaturasValidas.forEach((function(a){var n=e.dataConsultada.filter((function(o){return o.idMatricula===t.idMatricula&&o.asignatura===a.asignatura&&o.periodo<=e.idPeriodo})),r=n.reduce((function(e,t){return e+(parseInt(t.ausJ)||0)}),0),s=n.reduce((function(e,t){return e+(parseInt(t.ausS)||0)}),0);o.asignaturas[a.asignatura]={ausJ:r,ausS:s},o.totalAusJ+=r,o.totalAusS+=s})),o}))},totalesPorAsignatura:function(){var e=this,t={};return this.asignaturasValidas.forEach((function(o){var a=0,n=0;e.ausenciasConsolidadas.forEach((function(e){var t,r;a+=(null===(t=e.asignaturas[o.asignatura])||void 0===t?void 0:t.ausJ)||0,n+=(null===(r=e.asignaturas[o.asignatura])||void 0===r?void 0:r.ausS)||0})),t[o.asignatura]={ausJ:a,ausS:n}})),t}},beforeMount:function(){this.ocuparComboSedes(),this.ocuparComboPeriodos(),this.datosSeccion=this.$store.state.datosSecciones[this.$store.state.idSeccion-1]}},X=W,Z=(o("4529"),Object(v["a"])(X,K,Q,!1,null,"c83aa168",null)),ee=Z.exports,te=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("b-row",{staticClass:"mt-2"},[o("b-col",{attrs:{lg:"12"}},[o("b-card",{scopedSlots:e._u([{key:"header",fn:function(){return[o("h5",{staticClass:"mb-0"},[o("b-icon",{attrs:{icon:"card-checklist","aria-hidden":"true"}}),e._v(" RESUMEN FINAL DE EVALUACIONES")],1)]},proxy:!0},{key:"footer",fn:function(){return[o("em",[e._v("Consulta desempe√±os finales.")])]},proxy:!0}])},[o("b-card-text",[o("b-row",[o("b-col",{attrs:{lg:"3"}},[o("b-form-group",{staticClass:"etiqueta",attrs:{label:"Seleccione la Sede:","label-for":"sedes"}},[o("b-form-select",{ref:"sedes",attrs:{id:"sedes",options:e.comboSedes},on:{change:function(t){e.idCurso=null,e.idMatricula=null,e.ocuparComboCursosSede()}},model:{value:e.idSede,callback:function(t){e.idSede=t},expression:"idSede"}})],1)],1),o("b-col",{attrs:{lg:"3"}},[o("b-form-group",{staticClass:"etiqueta",attrs:{label:"Seleccione el Curso:","label-for":"cursos"}},[o("b-form-select",{ref:"cursos",attrs:{id:"cursos",options:e.comboCursosSede,disabled:null==e.idSede},on:{change:function(t){e.idMatricula=null,e.ocuparComboEstudiantes(),e.consultaAsignaturasCurso()}},model:{value:e.idCurso,callback:function(t){e.idCurso=t},expression:"idCurso"}})],1)],1),o("b-col",{attrs:{lg:"6"}},[o("b-form-group",{staticClass:"etiqueta",attrs:{label:"Seleccione el Estudiante:","label-for":"estud"}},[o("b-form-select",{ref:"estud",attrs:{id:"estud",options:e.comboEstudiantes,disabled:null==e.idCurso},on:{change:function(t){return e.estudiantesNotas()}},model:{value:e.idMatricula,callback:function(t){e.idMatricula=t},expression:"idMatricula"}})],1)],1)],1),null!=e.idMatricula?o("div",[o("b-row",[o("b-col",{attrs:{lg:"12"}},[o("hr")])],1),o("b-row",[o("b-col",[e.btnCargando?o("div",[o("div",{staticClass:"text-center m-5 text-primary"},[o("b-spinner",{staticStyle:{width:"3rem",height:"3rem"},attrs:{label:"Spinner"}}),o("br"),o("strong",[e._v("Cargando planilla...")])],1)]):o("div",[o("b-row",{staticClass:"mt-2"},[o("b-col",[o("vue-good-table",{ref:"table",attrs:{columns:e.encabColumnas,rows:e.listaNotasAsignaturasCurso,styleClass:"vgt-table condensed bordered striped","line-numbers":!0},scopedSlots:e._u([{key:"table-row",fn:function(t){return["nombreAsignatura"==t.column.field?o("span",[o("span",[e._v(e._s(t.row.nombreAsignatura))])]):e._e(),"promedioFinal"==t.column.field?o("span",[o("span",[o("b",[e._v(e._s(t.row.promedioFinal))])])]):e._e(),"desempeno"==t.column.field?o("span",[o("span",[o("b",[e._v(e._s(t.row.desempeno))])])]):e._e()]}}],null,!1,312808138)},[o("div",{attrs:{slot:"emptystate"},slot:"emptystate"},[o("h5",{staticClass:"text-danger ml-5"},[e._v("No existen asignaturas en la planilla")])])])],1),o("b-col",{attrs:{lg:"12"}},[o("div",{staticStyle:{"margin-bottom":"1rem"}},[o("b-button",{staticClass:"small mx-1 mt-3",attrs:{variant:"primary"},on:{click:e.imprimir}},[e._v("Imprimir Consolidado")]),o("b-button",{staticClass:"small mx-1 mt-3",attrs:{variant:"outline-primary"},on:{click:e.exportarAExcel}},[e._v("Exportar a Excel")])],1)])],1)],1)])],1)],1):e._e()],1)],1)],1)],1)],1)},oe=[],ae=(o("dac4"),o("f617")),ne={name:"resumenfinal",components:{VueGoodTable:ae["a"]},data:function(){return{idSede:null,comboSedes:[],idCurso:null,comboCursosSede:[],idMatricula:null,comboEstudiantes:[],nombreEstudiante:null,listaAsignaturasCurso:[],encabColumnas:[{label:"Asignatura",field:"nombreAsignatura",sortable:!1},{label:"Final",field:"promedioFinal",sortable:!1},{label:"Desempe√±o",field:"desempeno",sortable:!1}],notas:[],btnCargando:!1,listaNotasAsignaturasCurso:[]}},methods:{imprimir:function(){var e="Fecha: "+(new Date).toLocaleString(),t="RESUMEN FINAL DE EVALUACIONES",o=document.querySelector("table").outerHTML,a=window.open("Final","_blank");a.document.write('<html><head><title>Final</title></head>\n      <style scoped>\n        .tabla-estado-final {\n            border-collapse: collapse;\n            width: 100%;\n            text-align: center;\n            font-size: 10px;\n        }\n        .tabla-estado-final th {\n          background: #eee;\n        }\n      </style>\n        <body class="container">\n          <p style="text-align: center; font-size: 12px;">SECRETAR√çA DE EDUCACI√ìN TERRITORIAL DE TUNJA<br><b>'.concat(this.$store.state.nombreInstitucion,"</b><br>TUNJA - BOYAC√Å<br>").concat(t,"<br>Sede: ").concat(this.nombreSede," | Curso: ").concat(this.nombreCurso," | A√±o Lectivo ").concat(this.$store.state.aLectivo,"<br>Estudiante: ").concat(this.nombreEstudiante,"</p>\n          ").concat(o,'\n          <div style="text-align: right; font-size: 12px;"><i>').concat(e,"</i></div>\n        </body>\n      </html>")),a.document.close(),a.print()},exportarAExcel:function(){var e=document.querySelector("table"),t=p["utils"].table_to_book(e);p["writeFile"](t,"Promocion.xlsx")},generarPromediosFinalesConDesempeno:function(e,t){var o=this,a={};t.forEach((function(e){var t="".concat(e.idMatricula,"-").concat(e.asignatura);a[t]||(a[t]={idMatricula:e.idMatricula,asignatura:e.asignatura,habilitacion:e.habilitacion,fecha:e.fecha,acta:e.acta,vigencia:o.$store.state.aLectivo,valores:[]});var n=parseFloat(e.notaFinal);isNaN(n)||a[t].valores.push(n)}));var n=Object.values(a).map((function(t){var a=e.find((function(e){return e.asignatura===t.asignatura}));if(!a||99===a.orden)return null;var n=t.valores.reduce((function(e,t){return e+t}),0),r=t.valores.length>0?o.redondear(n/t.valores.length).toFixed(1):null,s=a.idTipoEspecialidad,i="";return null!==r&&(i=1==s?r<o.datosSeccion.minBas?"BAJO":r<o.datosSeccion.minAlt?"B√ÅSICO":r<o.datosSeccion.minSup?"ALTO":"SUPERIOR":r<o.datosSeccion.minBasT?"BAJO":r<o.datosSeccion.minAltT?"B√ÅSICO":r<o.datosSeccion.minSupT?"ALTO":"SUPERIOR"),{idMatricula:t.idMatricula,idAsignaturaCurso:(null===a||void 0===a?void 0:a.idAsignaturaCurso)||null,nombreAsignatura:(null===a||void 0===a?void 0:a.nombreAsignatura)||t.asignatura,promedioFinal:r||"",desempeno:i,habilitacion:t.habilitacion,fecha:t.fecha,acta:t.acta,vigencia:t.vigencia,orden:a.orden}})).filter((function(e){return null!==e}));return n.sort((function(e,t){return e.orden-t.orden}))},estudiantesNotas:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.btnCargando=!0,e.notas=[],e.nombreSede=document.getElementById("sedes")[document.getElementById("sedes").selectedIndex].text,null==e.idMatricula){t.next=10;break}return e.nombreEstudiante=document.getElementById("estud")[document.getElementById("estud").selectedIndex].text,e.nombreCurso=document.getElementById("cursos")[document.getElementById("cursos").selectedIndex].text,e.$store.state.datosCursos.forEach((function(t){t.id==e.idCurso&&(e.idNivel=t.id_nivel)})),t.next=9,s.a.get(i["d"]+"academico/notashabilitaciones/estudiante",{params:{idCurso:e.idCurso,idMatricula:e.idMatricula,vigencia:e.$store.state.aLectivo}}).then((function(t){t.data.error?(e.mensajeEmergente("danger",i["h"],t.data.mensaje+" - Consolidados asignaturas curso periodo"),e.btnCargando=!1):0!=t.data.datos&&(e.notas=t.data.datos)})).catch((function(t){e.mensajeEmergente("danger",i["h"],"Algo salio mal y no se pudo realizar: Consolidados asignaturas curso periodo. Intente m√°s tarde."+t),e.btnCargando=!1}));case 9:e.listaNotasAsignaturasCurso=!!e.notas.length&&e.generarPromediosFinalesConDesempeno(e.listaAsignaturasCurso,e.notas);case 10:e.btnCargando=!1;case 11:case"end":return t.stop()}}),t)})))()},consultaAsignaturasCurso:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.listaAsignaturasCurso=[],t.next=3,s.a.get(i["d"]+"academico/asignacioncurso/habilitaciones",{params:{idCurso:e.idCurso}}).then((function(t){t.data.error?e.mensajeEmergente("danger",i["h"],t.data.mensaje+" - Lista asignaturas curso"):0!=t.data.datos&&(e.listaAsignaturasCurso=t.data.datos)})).catch((function(t){e.mensajeEmergente("danger",i["h"],"Algo salio mal y no se pudo realizar: Lista asignaci√≥n docentes curso. Intente m√°s tarde."+t)}));case 3:case"end":return t.stop()}}),t)})))()},ocuparComboEstudiantes:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.comboEstudiantes=[],t.next=3,s.a.get(i["d"]+"academico/listacurso/habilitaciones",{params:{idCurso:e.idCurso,vigencia:e.$store.state.aLectivo}}).then((function(t){t.data.error?e.mensajeEmergente("danger",i["h"],t.data.mensaje+" - Consulta Lista Curso"):0!=t.data.datos&&t.data.datos.forEach((function(t){e.comboEstudiantes.push({value:t.idMatricula,text:t.estudiante})}))})).catch((function(t){e.mensajeEmergente("danger",i["h"],"Algo salio mal y no se pudo realizar: Consulta Lista Curso. Intente m√°s tarde."+t)}));case 3:case"end":return t.stop()}}),t)})))()},ocuparComboCursosSede:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.comboCursosSede=[],e.$store.state.datosCursos.forEach((function(t){t.id_sede==e.idSede&&e.comboCursosSede.push({value:t.id,text:t.nomenclatura.toUpperCase()})}));case 2:case"end":return t.stop()}}),t)})))()},ocuparComboSedes:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.comboSedes=[],e.$store.state.datosSedes.forEach((function(t){e.comboSedes.push({value:t.id,text:t.sede.toUpperCase()})}));case 2:case"end":return t.stop()}}),t)})))()},handleKeyNavigation:function(e,t,o){if("ArrowDown"===e.key){var a=this.$refs["".concat(o,"-").concat(t+1)];a&&a.focus()}else if("ArrowUp"===e.key){var n=this.$refs["".concat(o,"-").concat(t-1)];n&&n.focus()}},redondear:function(e){var t=Number((10*Math.abs(e)).toPrecision(15));return Math.round(t)/10*Math.sign(e)},soloNumeros:function(e){var t=window.Event?e.which:e.keyCode;t>=48&&t<=57||t>=96&&t<=105||8==t||9==t||37==t||39==t||e.preventDefault()},soloDecimales:function(e){var t=window.Event?e.which:e.keyCode;t>=48&&t<=57||t>=96&&t<=105||8==t||9==t||37==t||39==t||110==t||189==t||190==t||e.preventDefault()},tdClassFuncDiversa:function(e){if("S"==e.id_diversa)return"text-center alert alert-warning"},mensajeEmergente:function(e,t,o){this.$bvToast.toast(o,{title:t,variant:e,toaster:"b-toaster-top-center",solid:!0,autoHideDelay:4e3,appendToast:!1})}},beforeMount:function(){1==this.$store.state.idRol||12==this.$store.state.idRol||1==this.$store.state.perActNotas?(this.ocuparComboSedes(),this.datosSeccion=this.$store.state.datosSecciones[this.$store.state.idSeccion-1]):this.$router.push("/restringida")},computed:{}},re=ne,se=Object(v["a"])(re,te,oe,!1,null,null,null),ie=se.exports,ce=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("b-row",{staticClass:"mt-2"},[o("b-col",{attrs:{lg:"12"}},[o("b-card",{scopedSlots:e._u([{key:"header",fn:function(){return[o("h5",{staticClass:"mb-0"},[o("b-icon",{attrs:{icon:"card-checklist","aria-hidden":"true"}}),e._v(" RESUMEN FINAL DE EVALUACIONES CON HABILITACIONES")],1)]},proxy:!0},{key:"footer",fn:function(){return[o("em",[e._v("Consulta desempe√±os finales.")])]},proxy:!0}])},[o("b-card-text",[o("b-row",[o("b-col",{attrs:{lg:"3"}},[o("b-form-group",{staticClass:"etiqueta",attrs:{label:"Seleccione la Sede:","label-for":"sedes"}},[o("b-form-select",{ref:"sedes",attrs:{id:"sedes",options:e.comboSedes},on:{change:function(t){e.idCurso=null,e.idMatricula=null,e.ocuparComboCursosSede()}},model:{value:e.idSede,callback:function(t){e.idSede=t},expression:"idSede"}})],1)],1),o("b-col",{attrs:{lg:"3"}},[o("b-form-group",{staticClass:"etiqueta",attrs:{label:"Seleccione el Curso:","label-for":"cursos"}},[o("b-form-select",{ref:"cursos",attrs:{id:"cursos",options:e.comboCursosSede,disabled:null==e.idSede},on:{change:function(t){e.idMatricula=null,e.ocuparComboEstudiantes(),e.consultaAsignaturasCurso()}},model:{value:e.idCurso,callback:function(t){e.idCurso=t},expression:"idCurso"}})],1)],1),o("b-col",{attrs:{lg:"6"}},[o("b-form-group",{staticClass:"etiqueta",attrs:{label:"Seleccione el Estudiante:","label-for":"estud"}},[o("b-form-select",{ref:"estud",attrs:{id:"estud",options:e.comboEstudiantes,disabled:null==e.idCurso},on:{change:function(t){return e.estudiantesNotas()}},model:{value:e.idMatricula,callback:function(t){e.idMatricula=t},expression:"idMatricula"}})],1)],1)],1),null!=e.idMatricula?o("div",[o("b-row",[o("b-col",{attrs:{lg:"12"}},[o("hr")])],1),o("b-row",[o("b-col",[e.btnCargando?o("div",[o("div",{staticClass:"text-center m-5 text-primary"},[o("b-spinner",{staticStyle:{width:"3rem",height:"3rem"},attrs:{label:"Spinner"}}),o("br"),o("strong",[e._v("Cargando planilla...")])],1)]):o("div",[o("b-row",{staticClass:"mt-2"},[o("b-col",[o("vue-good-table",{ref:"table",attrs:{columns:e.encabColumnas,rows:e.listaNotasAsignaturasCurso,styleClass:"vgt-table condensed bordered striped","line-numbers":!0},scopedSlots:e._u([{key:"table-row",fn:function(t){return["nombreAsignatura"==t.column.field?o("span",[o("span",[e._v(e._s(t.row.nombreAsignatura))])]):e._e(),"promedioFinal"==t.column.field?o("span",[o("span",[o("b",[e._v(e._s(t.row.promedioFinal))])])]):e._e(),"desempeno"==t.column.field?o("span",[o("span",[o("b",[e._v(e._s(t.row.desempeno))])])]):e._e(),"habilitacion"==t.column.field?o("span",[o("span",[o("b",[e._v(e._s(t.row.habilitacion))])])]):e._e()]}}],null,!1,1171639959)},[o("div",{attrs:{slot:"emptystate"},slot:"emptystate"},[o("h5",{staticClass:"text-danger ml-5"},[e._v("No existen asignaturas en la planilla")])])])],1),o("b-col",{attrs:{lg:"12"}},[o("div",{staticStyle:{"margin-bottom":"1rem"}},[o("b-button",{staticClass:"small mx-1 mt-3",attrs:{variant:"primary"},on:{click:e.imprimir}},[e._v("Imprimir Consolidado")]),o("b-button",{staticClass:"small mx-1 mt-3",attrs:{variant:"outline-primary"},on:{click:e.exportarAExcel}},[e._v("Exportar a Excel")])],1)])],1)],1)])],1)],1):e._e()],1)],1)],1)],1)],1)},de=[],ue={name:"resumenfinalhab",components:{VueGoodTable:ae["a"]},data:function(){return{idSede:null,comboSedes:[],idCurso:null,comboCursosSede:[],idMatricula:null,comboEstudiantes:[],nombreEstudiante:null,listaAsignaturasCurso:[],encabColumnas:[{label:"Asignatura",field:"nombreAsignatura",sortable:!1},{label:"Final",field:"promedioFinal",sortable:!1},{label:"Desempe√±o",field:"desempeno",sortable:!1},{label:"Habil",field:"habilitacion",width:"5%",sortable:!1}],notas:[],btnCargando:!1,listaNotasAsignaturasCurso:[]}},methods:{imprimir:function(){var e="Fecha: "+(new Date).toLocaleString(),t="RESUMEN FINAL DE EVALUACIONES CON HABILITACIONES",o=document.querySelector("table").outerHTML,a=window.open("FinalHabil","_blank");a.document.write('<html><head><title>FinalHabil</title></head>\n      <style scoped>\n        .tabla-estado-final {\n            border-collapse: collapse;\n            width: 100%;\n            text-align: center;\n            font-size: 10px;\n        }\n        .tabla-estado-final th {\n          background: #eee;\n        }\n      </style>\n        <body class="container">\n          <p style="text-align: center; font-size: 12px;">SECRETAR√çA DE EDUCACI√ìN TERRITORIAL DE TUNJA<br><b>'.concat(this.$store.state.nombreInstitucion,"</b><br>TUNJA - BOYAC√Å<br>").concat(t,"<br>Sede: ").concat(this.nombreSede," | Curso: ").concat(this.nombreCurso," | A√±o Lectivo ").concat(this.$store.state.aLectivo,"<br>Estudiante: ").concat(this.nombreEstudiante,"</p>\n          ").concat(o,'\n          <div style="text-align: right; font-size: 12px;"><i>').concat(e,"</i></div>\n        </body>\n      </html>")),a.document.close(),a.print()},exportarAExcel:function(){var e=document.querySelector("table"),t=p["utils"].table_to_book(e);p["writeFile"](t,"Promocion.xlsx")},generarPromediosFinalesConDesempeno:function(e,t){var o=this,a={};t.forEach((function(e){var t="".concat(e.idMatricula,"-").concat(e.asignatura);a[t]||(a[t]={idMatricula:e.idMatricula,asignatura:e.asignatura,habilitacion:e.habilitacion,fecha:e.fecha,acta:e.acta,vigencia:o.$store.state.aLectivo,valores:[]});var n=parseFloat(e.notaFinal);isNaN(n)||a[t].valores.push(n)}));var n=Object.values(a).map((function(t){var a=e.find((function(e){return e.asignatura===t.asignatura}));if(!a||99===a.orden)return null;var n=t.valores.reduce((function(e,t){return e+t}),0),r=t.valores.length>0?o.redondear(n/t.valores.length).toFixed(1):null,s=a.idTipoEspecialidad,i="";return null!==r&&(i=1==s?r<o.datosSeccion.minBas?"BAJO":r<o.datosSeccion.minAlt?"B√ÅSICO":r<o.datosSeccion.minSup?"ALTO":"SUPERIOR":r<o.datosSeccion.minBasT?"BAJO":r<o.datosSeccion.minAltT?"B√ÅSICO":r<o.datosSeccion.minSupT?"ALTO":"SUPERIOR"),{idMatricula:t.idMatricula,idAsignaturaCurso:(null===a||void 0===a?void 0:a.idAsignaturaCurso)||null,nombreAsignatura:(null===a||void 0===a?void 0:a.nombreAsignatura)||t.asignatura,promedioFinal:r||"",desempeno:i,habilitacion:t.habilitacion,fecha:t.fecha,acta:t.acta,vigencia:t.vigencia,orden:a.orden}})).filter((function(e){return null!==e}));return n.sort((function(e,t){return e.orden-t.orden}))},estudiantesNotas:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.btnCargando=!0,e.notas=[],e.nombreSede=document.getElementById("sedes")[document.getElementById("sedes").selectedIndex].text,null==e.idMatricula){t.next=10;break}return e.nombreEstudiante=document.getElementById("estud")[document.getElementById("estud").selectedIndex].text,e.nombreCurso=document.getElementById("cursos")[document.getElementById("cursos").selectedIndex].text,e.$store.state.datosCursos.forEach((function(t){t.id==e.idCurso&&(e.idNivel=t.id_nivel)})),t.next=9,s.a.get(i["d"]+"academico/notashabilitaciones/estudiante",{params:{idCurso:e.idCurso,idMatricula:e.idMatricula,vigencia:e.$store.state.aLectivo}}).then((function(t){t.data.error?(e.mensajeEmergente("danger",i["h"],t.data.mensaje+" - Consolidados asignaturas curso periodo"),e.btnCargando=!1):0!=t.data.datos&&(e.notas=t.data.datos)})).catch((function(t){e.mensajeEmergente("danger",i["h"],"Algo salio mal y no se pudo realizar: Consolidados asignaturas curso periodo. Intente m√°s tarde."+t),e.btnCargando=!1}));case 9:e.listaNotasAsignaturasCurso=!!e.notas.length&&e.generarPromediosFinalesConDesempeno(e.listaAsignaturasCurso,e.notas);case 10:e.btnCargando=!1;case 11:case"end":return t.stop()}}),t)})))()},consultaAsignaturasCurso:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.listaAsignaturasCurso=[],t.next=3,s.a.get(i["d"]+"academico/asignacioncurso/habilitaciones",{params:{idCurso:e.idCurso}}).then((function(t){t.data.error?e.mensajeEmergente("danger",i["h"],t.data.mensaje+" - Lista asignaturas curso"):0!=t.data.datos&&(e.listaAsignaturasCurso=t.data.datos)})).catch((function(t){e.mensajeEmergente("danger",i["h"],"Algo salio mal y no se pudo realizar: Lista asignaci√≥n docentes curso. Intente m√°s tarde."+t)}));case 3:case"end":return t.stop()}}),t)})))()},ocuparComboEstudiantes:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.comboEstudiantes=[],t.next=3,s.a.get(i["d"]+"academico/listacurso/habilitaciones",{params:{idCurso:e.idCurso,vigencia:e.$store.state.aLectivo}}).then((function(t){t.data.error?e.mensajeEmergente("danger",i["h"],t.data.mensaje+" - Consulta Lista Curso"):0!=t.data.datos&&t.data.datos.forEach((function(t){e.comboEstudiantes.push({value:t.idMatricula,text:t.estudiante})}))})).catch((function(t){e.mensajeEmergente("danger",i["h"],"Algo salio mal y no se pudo realizar: Consulta Lista Curso. Intente m√°s tarde."+t)}));case 3:case"end":return t.stop()}}),t)})))()},ocuparComboCursosSede:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.comboCursosSede=[],e.$store.state.datosCursos.forEach((function(t){t.id_sede==e.idSede&&e.comboCursosSede.push({value:t.id,text:t.nomenclatura.toUpperCase()})}));case 2:case"end":return t.stop()}}),t)})))()},ocuparComboSedes:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.comboSedes=[],e.$store.state.datosSedes.forEach((function(t){e.comboSedes.push({value:t.id,text:t.sede.toUpperCase()})}));case 2:case"end":return t.stop()}}),t)})))()},handleKeyNavigation:function(e,t,o){if("ArrowDown"===e.key){var a=this.$refs["".concat(o,"-").concat(t+1)];a&&a.focus()}else if("ArrowUp"===e.key){var n=this.$refs["".concat(o,"-").concat(t-1)];n&&n.focus()}},redondear:function(e){var t=Number((10*Math.abs(e)).toPrecision(15));return Math.round(t)/10*Math.sign(e)},soloNumeros:function(e){var t=window.Event?e.which:e.keyCode;t>=48&&t<=57||t>=96&&t<=105||8==t||9==t||37==t||39==t||e.preventDefault()},soloDecimales:function(e){var t=window.Event?e.which:e.keyCode;t>=48&&t<=57||t>=96&&t<=105||8==t||9==t||37==t||39==t||110==t||189==t||190==t||e.preventDefault()},tdClassFuncDiversa:function(e){if("S"==e.id_diversa)return"text-center alert alert-warning"},mensajeEmergente:function(e,t,o){this.$bvToast.toast(o,{title:t,variant:e,toaster:"b-toaster-top-center",solid:!0,autoHideDelay:4e3,appendToast:!1})}},beforeMount:function(){1==this.$store.state.idRol||12==this.$store.state.idRol||1==this.$store.state.perActNotas?(this.ocuparComboSedes(),this.datosSeccion=this.$store.state.datosSecciones[this.$store.state.idSeccion-1]):this.$router.push("/restringida")},computed:{}},le=ue,me=Object(v["a"])(le,ce,de,!1,null,null,null),pe=me.exports,be=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("b-row",{staticClass:"mt-2"},[o("b-col",{attrs:{lg:"12"}},[o("b-card",{scopedSlots:e._u([{key:"header",fn:function(){return[o("h5",{staticClass:"mb-0"},[o("b-icon",{attrs:{icon:"card-checklist","aria-hidden":"true"}}),e._v(" RESUMEN DE PROMOCI√ìN POR AREAS")],1)]},proxy:!0}])},[o("b-card-text",[o("b-row",[o("b-col",{attrs:{lg:"6"}},[o("b-form-group",{staticClass:"etiqueta",attrs:{label:"Seleccione la Sede:","label-for":"sedes"}},[o("b-form-select",{ref:"sedes",attrs:{id:"sedes",options:e.comboSedes},on:{change:function(t){e.idCurso=null,e.ocuparComboCursosSede()}},model:{value:e.idSede,callback:function(t){e.idSede=t},expression:"idSede"}})],1)],1),o("b-col",{attrs:{lg:"4"}},[o("b-form-group",{staticClass:"etiqueta",attrs:{label:"Seleccione el Curso:","label-for":"cursos"}},[o("b-form-select",{ref:"cursos",attrs:{id:"cursos",options:e.comboCursosSede,disabled:null==e.idSede},on:{change:function(t){return e.consultarEstudiantes()}},model:{value:e.idCurso,callback:function(t){e.idCurso=t},expression:"idCurso"}})],1)],1)],1)],1)],1)],1)],1),o("b-row",[o("b-col",{attrs:{lg:"12"}},[e.btnCargando?o("div",[o("div",{staticClass:"text-center m-5 text-primary"},[o("b-spinner",{staticStyle:{width:"3rem",height:"3rem"},attrs:{label:"Spinner"}}),o("br"),o("strong",[e._v("Cargando informe...")])],1)]):e._e()])],1),e.btnCargando||null==e.idCurso?e._e():o("b-row",[o("b-col",{attrs:{lg:"12"}},[o("table",{staticClass:"table-responsive",attrs:{border:"1",cellspacing:"0",cellpadding:"1"}},[o("thead",[o("tr",[o("th",[e._v("#")]),o("th",[e._v("Estudiante")]),o("th",[e._v("Estado Sin Superaci√≥n Final")]),o("th",[e._v("PRO GEN")]),o("th",[e._v("Tot"),o("br"),e._v("Area"),o("br"),e._v("Baj")]),o("th",[e._v("Tot"),o("br"),e._v("Area"),o("br"),e._v("Bas")]),o("th",[e._v("Tot"),o("br"),e._v("Area"),o("br"),e._v("Alt")]),o("th",[e._v("Tot"),o("br"),e._v("Area"),o("br"),e._v("Sup")]),o("th",[e._v("Tot"),o("br"),e._v("AuJ")]),o("th",[e._v("Tot"),o("br"),e._v("AuS")]),o("th",[e._v("Puesto")]),o("th",[e._v("#")])])]),o("tbody",[e._l(e.estudiantesNotas,(function(t,a,n){return o("tr",{key:a},[o("td",{staticClass:"text-left"},[e._v(e._s(n+1))]),o("td",{staticStyle:{"text-align":"left"}},[e._v(e._s(a))]),o("td",{staticStyle:{"text-align":"left"}},[e._v(e._s("N"==t.id_conceptual?e.mostrarEstadoPromocion(e.contarDesempenoEstudianteArea(t,"bajo")):"-"))]),o("td",[e._v(e._s("N"==t.id_conceptual?e.calcularPromedioGeneral(t):"-"))]),o("td",[e._v(e._s("N"==t.id_conceptual?e.contarDesempenoEstudianteArea(t,"bajo"):"-"))]),o("td",[e._v(e._s("N"==t.id_conceptual?e.contarDesempenoEstudianteArea(t,"basico"):"-"))]),o("td",[e._v(e._s("N"==t.id_conceptual?e.contarDesempenoEstudianteArea(t,"alto"):"-"))]),o("td",[e._v(e._s("N"==t.id_conceptual?e.contarDesempenoEstudianteArea(t,"superior"):"-"))]),o("td",[e._v(e._s("N"==t.id_conceptual?t.ausJ:"-"))]),o("td",[e._v(e._s("N"==t.id_conceptual?t.ausS:"-"))]),o("td",[e._v(e._s("N"==t.id_conceptual?e.iconoPuesto(e.puestosPorEstudiante[a]):"-")+" "+e._s("N"==t.id_conceptual?e.puestosPorEstudiante[a]:"-"))]),o("td",{staticClass:"text-left"},[e._v(e._s(n+1))])])})),o("tr",{staticStyle:{"background-color":"#f0f0f0","font-weight":"bold"}},[o("td",{attrs:{colspan:"2"}},[e._v("Total Bajos")]),o("td"),o("td"),o("td",[e._v(e._s(e.totales.bajo))]),o("td",[e._v(e._s(e.totales.basico))]),o("td",[e._v(e._s(e.totales.alto))]),o("td",[e._v(e._s(e.totales.superior))]),o("td",[e._v(e._s(e.totales.ausJ))]),o("td",[e._v(e._s(e.totales.ausS))]),o("td"),e._v(" "),o("td")])],2)]),o("div",{staticStyle:{"margin-bottom":"1rem"}},[o("b-button",{staticClass:"small mx-1 mt-3",attrs:{variant:"primary"},on:{click:e.imprimir}},[e._v("Imprimir Consolidado")]),o("b-button",{staticClass:"small mx-1 mt-3",attrs:{variant:"outline-primary"},on:{click:e.exportarAExcel}},[e._v("Exportar a Excel")])],1)])],1)],1)},fe=[],ve=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("b-row",{staticClass:"mt-2"},[o("b-col",{attrs:{lg:"12"}},[o("b-card",{scopedSlots:e._u([{key:"header",fn:function(){return[o("h5",{staticClass:"mb-0"},[o("b-icon",{attrs:{icon:"card-checklist","aria-hidden":"true"}}),e._v(" CONSOLIDADO √ÅREAS PERDIDAS")],1)]},proxy:!0}])},[o("b-card-text",[o("b-row",[o("b-col",{attrs:{lg:"2"}},[o("b-form-group",{staticClass:"etiqueta",attrs:{label:"Periodo:","label-for":"periodo"}},[o("b-form-select",{ref:"periodo",attrs:{id:"periodo",options:e.comboPeriodos},on:{change:function(t){e.idSede=null,e.idCurso=null}},model:{value:e.idPeriodo,callback:function(t){e.idPeriodo=t},expression:"idPeriodo"}})],1)],1),o("b-col",{attrs:{lg:"6"}},[o("b-form-group",{staticClass:"etiqueta",attrs:{label:"Seleccione la Sede:","label-for":"sedes"}},[o("b-form-select",{ref:"sedes",attrs:{id:"sedes",options:e.comboSedes,disabled:null==e.idPeriodo},on:{change:function(t){e.idCurso=null,e.ocuparComboCursosSede()}},model:{value:e.idSede,callback:function(t){e.idSede=t},expression:"idSede"}})],1)],1),o("b-col",{attrs:{lg:"4"}},[o("b-form-group",{staticClass:"etiqueta",attrs:{label:"Seleccione el Curso:","label-for":"cursos"}},[o("b-form-select",{ref:"cursos",attrs:{id:"cursos",options:e.comboCursosSede,disabled:null==e.idSede},on:{change:function(t){return e.consultarEstudiantes()}},model:{value:e.idCurso,callback:function(t){e.idCurso=t},expression:"idCurso"}})],1)],1)],1)],1)],1)],1)],1),o("b-row",[o("b-col",{attrs:{lg:"12"}},[e.btnCargando?o("div",[o("div",{staticClass:"text-center m-5 text-primary"},[o("b-spinner",{staticStyle:{width:"3rem",height:"3rem"},attrs:{label:"Spinner"}}),o("br"),o("strong",[e._v("Cargando informe...")])],1)]):e._e()])],1),e.btnCargando||null==e.idCurso?e._e():o("b-row",[o("b-col",{attrs:{lg:"12"}},[o("table",{staticClass:"tabla-perdidas",attrs:{border:"1",cellspacing:"0",cellpadding:"1"}},[o("thead",[o("tr",[o("th",[e._v("Estudiante")]),o("th",[e._v("√Åreas Perdidas")]),o("th",[e._v("Total")])])]),o("tbody",e._l(e.informeAreasPerdidas,(function(t){return o("tr",{key:t.estudiante},[o("td",[e._v(e._s(t.estudiante))]),o("td",[e._v(e._s(t.perdidas.join(", ")))]),o("td",[e._v(e._s(t.total))])])})),0)]),o("div",{staticStyle:{"margin-bottom":"1rem"}},[o("b-button",{staticClass:"small mx-1 mt-3",attrs:{variant:"primary"},on:{click:e.imprimir}},[e._v("Imprimir Consolidado")]),o("b-button",{staticClass:"small mx-1 mt-3",attrs:{variant:"outline-primary"},on:{click:e.exportarAExcel}},[e._v("Exportar a Excel")])],1)])],1)],1)},he=[],Se={name:"areasperdidas",props:{},components:{},data:function(){return{idSede:null,comboSedes:[],idPeriodo:null,comboPeriodos:null,idCurso:null,comboCursosSede:[],nombreSede:null,nombreCurso:null,idNivel:null,btnCargando:!1,dataConsultada:[],datosSeccion:{},listaAreasAsignaturas:[],listaEstudiantes:[],ausencias:[]}},methods:{consultarEstudiantes:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.btnCargando=!0,e.nombreSede=document.getElementById("sedes")[document.getElementById("sedes").selectedIndex].text,null==e.idCurso){t.next=11;break}return e.nombreCurso=document.getElementById("cursos")[document.getElementById("cursos").selectedIndex].text,e.$store.state.datosCursos.forEach((function(t){t.id==e.idCurso&&(e.idNivel=t.id_nivel)})),e.listaEstudiantes=[],t.next=8,s.a.get(i["d"]+"consolidado/listaestudiantes/curso",{params:{idCurso:e.idCurso,vigencia:e.$store.state.aLectivo}}).then((function(t){t.data.error?e.mensajeEmergente("danger",i["h"],t.data.mensaje+" - Consulta Lista Curso"):0!=t.data.datos&&(e.listaEstudiantes=t.data.datos)})).catch((function(t){e.mensajeEmergente("danger",i["h"],"Algo salio mal y no se pudo realizar: Consulta Lista Curso. Intente m√°s tarde."+t)}));case 8:return e.dataConsultada=[],t.next=11,s.a.get(i["d"]+"consolidados/notasperdidas/curso/periodo",{params:{idCurso:e.idCurso,periodo:e.idPeriodo,vigencia:e.$store.state.aLectivo}}).then((function(t){t.data.error?(e.mensajeEmergente("danger",i["h"],t.data.mensaje+" - Consolidados areas perdidas curso periodo"),e.btnCargando=!1):0!=t.data.datos&&(e.dataConsultada=t.data.datos)})).catch((function(t){e.mensajeEmergente("danger",i["h"],"Algo salio mal y no se pudo realizar: Consolidados areas perdidas curso periodo. Intente m√°s tarde."+t),e.btnCargando=!1}));case 11:e.btnCargando=!1;case 12:case"end":return t.stop()}}),t)})))()},imprimir:function(){var e="Fecha: "+(new Date).toLocaleString(),t="CONSOLIDADO DE √ÅREAS PERDIDAS",o=document.querySelector("table").outerHTML,a=window.open("Perdidas","_blank");a.document.write('<html><head><title>Perdidas</title></head>\n      <style scoped>\n        .tabla-perdidas {\n          width: 100%;\n          border-collapse: collapse;\n          font-size: 13px;\n        }\n        .tabla-perdidas th, .tabla-perdidas td {\n          border: 1px solid #ccc;\n          padding: 1px;\n        }\n        .tabla-perdidas th {\n          background-color: #f2f8ff;\n          text-align: center;\n        }\n        .tabla-perdidas td {\n          vertical-align: top;\n        }\n      </style>\n        <body class="container">\n          <p style="text-align: center; font-size: 12px;">SECRETAR√çA DE EDUCACI√ìN TERRITORIAL DE TUNJA<br><b>'.concat(this.$store.state.nombreInstitucion,"</b><br>TUNJA - BOYAC√Å<br>").concat(t,"<br>Sede: ").concat(this.nombreSede," | Curso: ").concat(this.nombreCurso," | A√±o Lectivo ").concat(this.$store.state.aLectivo," | Periodo: ").concat(this.idPeriodo,"</p>\n          ").concat(o,'\n          <div style="text-align: right; font-size: 12px;"><i>').concat(e,"</i></div>\n        </body>\n      </html>")),a.document.close(),a.print()},exportarAExcel:function(){var e=document.querySelector("table"),t=p["utils"].table_to_book(e);p["writeFile"](t,"ausencias.xlsx")},ocuparComboCursosSede:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.comboCursosSede=[],e.$store.state.datosCursos.forEach((function(t){t.id_sede==e.idSede&&e.comboCursosSede.push({value:t.id,text:t.nomenclatura.toUpperCase()})}));case 2:case"end":return t.stop()}}),t)})))()},ocuparComboSedes:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.comboSedes=[],e.$store.state.datosSedes.forEach((function(t){e.comboSedes.push({value:t.id,text:t.sede.toUpperCase()})}));case 2:case"end":return t.stop()}}),t)})))()},ocuparComboPeriodos:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.comboPeriodos=[],e.$store.state.periodos.forEach((function(t){e.comboPeriodos.push({value:t.id,text:t.periodo.toUpperCase()})}));case 2:case"end":return t.stop()}}),t)})))()},redondear:function(e){var t=Number((10*Math.abs(e)).toPrecision(15));return Math.round(t)/10*Math.sign(e)},mensajeEmergente:function(e,t,o){this.$bvToast.toast(o,{title:t,variant:e,toaster:"b-toaster-top-center",solid:!0,autoHideDelay:4e3,appendToast:!1})}},computed:{informeAreasPerdidas:function(){var e=this;return this.listaEstudiantes.map((function(t){var o=e.dataConsultada.filter((function(e){return e.idMatricula===t.idMatricula&&98!==e.orden&&99!==e.orden})),a={};o.forEach((function(e){var t=e.area,o=parseFloat(e.definitiva)||0,n=parseFloat(e.recuperacion),r=parseFloat(e.porcentaje)||0,s=!isNaN(n)&&n>o?n:o;a[t]||(a[t]={acumulado:0,totalPorcentaje:0,tipo:parseInt(e.idTipoEspecialidad)}),a[t].acumulado+=s*r,a[t].totalPorcentaje+=r}));var n=Object.entries(a).map((function(t){var o=Object(u["a"])(t,2),a=o[0],n=o[1],r=n.totalPorcentaje>0?e.redondear(n.acumulado/n.totalPorcentaje).toFixed(1):0,s=1===n.tipo?r<e.datosSeccion.minBas:2===n.tipo&&r<e.datosSeccion.minBasT;return s?{area:a,promedio:r}:null})).filter(Boolean),r=n.map((function(e){return"".concat(e.area,"(").concat(e.promedio,")")}));return{estudiante:t.estudiante,perdidas:r,total:r.length}})).filter((function(e){return e.total>0}))}},beforeMount:function(){this.ocuparComboSedes(),this.ocuparComboPeriodos(),this.datosSeccion=this.$store.state.datosSecciones[this.$store.state.idSeccion-1]}},ge=Se,Ce=(o("8344"),Object(v["a"])(ge,ve,he,!1,null,"98a0c286",null)),Ae=Ce.exports,_e={name:"resumenpromocionareas",components:{},data:function(){return{idSede:null,comboSedes:[],idPeriodo:5,comboPeriodos:null,idCurso:null,comboCursosSede:[],nombreSede:null,nombreCurso:null,idNivel:null,btnCargando:!1,datosRaw:[],datosSeccion:{},listaAreasAsignaturas:[],periodosVisibles:[]}},methods:{mostrarEstadoPromocion:function(e){return this.$store.state.idInstitucion,0==e?"APROB√ì EL GRADO":e>=1&&e<=2?"PENDIENTE DE PROMOCI√ìN":"REPROBADO"},colspanArea:function(e){var t=this.encabezadoPorArea[e]||[],o=this.periodosVisibles.length+1,a=1;return t.length*o+a},totalBajosPorPeriodo:function(e,t,o){var a=this,n=0,r=this.listaAreasAsignaturas.find((function(o){return o.area===e&&o.asignatura===t})),s=null===r||void 0===r?void 0:r.idTipoEspecialidad;return Object.values(this.estudiantesNotas).forEach((function(r){var i,c,d,u,l,m=null===r||void 0===r||null===(i=r.areas)||void 0===i||null===(c=i[e])||void 0===c||null===(d=c.asignaturas)||void 0===d||null===(u=d[t])||void 0===u||null===(l=u.periodos)||void 0===l?void 0:l[o];1===s?m>0&&m<a.datosSeccion.minBas&&n++:m>0&&m<a.datosSeccion.minBasT&&n++})),n},totalBajosPromedioAsignatura:function(e,t){var o=this,a=0,n=this.listaAreasAsignaturas.find((function(o){return o.area===e&&o.asignatura===t})),r=null===n||void 0===n?void 0:n.idTipoEspecialidad;return Object.values(this.estudiantesNotas).forEach((function(n){var s,i,c,d=null===n||void 0===n||null===(s=n.areas)||void 0===s||null===(i=s[e])||void 0===i||null===(c=i.asignaturas)||void 0===c?void 0:c[t];if(d){var u=parseFloat(o.calcularPromedioAsignatura(d));1===r?u<o.datosSeccion.minBas&&a++:u<o.datosSeccion.minBasT&&a++}})),a},totalBajosPromedioArea:function(e){var t=this,o=0;return Object.values(this.estudiantesNotas).forEach((function(a){var n=parseFloat(t.obtenerPromedioArea(a,e));!isNaN(n)&&n<t.datosSeccion.minBas&&o++})),o},totalesGlobales:function(){var e=this,t=0,o=0,a=0,n=0,r=0,s=0;return Object.values(this.estudiantesNotas).forEach((function(i){t+=e.contarDesempenoEstudianteArea(i,"bajo"),o+=e.contarDesempenoEstudianteArea(i,"basico"),a+=e.contarDesempenoEstudianteArea(i,"alto"),n+=e.contarDesempenoEstudianteArea(i,"superior"),r+=i.ausJ||0,s+=i.ausS||0})),{bajo:t,basico:o,alto:a,superior:n,ausJ:r,ausS:s}},esAreaValida:function(e){var t=this.listaAreasAsignaturas.filter((function(t){return t.area===e}));return!!t.some((function(e){return 99!==e.orden&&98!==e.orden}))||!(!t.some((function(e){return 99===e.orden}))||1!=this.datosSeccion.promCompor)},obtenerPromedioArea:function(e,t){var o=e.areas&&e.areas[t];return o?this.calcularPromedioArea(o):""},obtenerNota:function(e,t,o,a){var n,r,s,i,c,d=null===e||void 0===e||null===(n=e.areas)||void 0===n||null===(r=n[t])||void 0===r||null===(s=r.asignaturas)||void 0===s||null===(i=s[o])||void 0===i||null===(c=i.periodos)||void 0===c?void 0:c[a];return 0===d&&(d=""),"number"===typeof d?d.toFixed(1):d},obtenerPromedioAsignatura:function(e,t,o){var a,n,r,s=null===e||void 0===e||null===(a=e.areas)||void 0===a||null===(n=a[t])||void 0===n||null===(r=n.asignaturas)||void 0===r?void 0:r[o];return s?this.calcularPromedioAsignatura(s):""},calcularPromedioAsignatura:function(e){var t=e.pesos,o=e.periodos,a=e.orden;if(99===a&&0==this.datosSeccion.promCompor)return"-";var n=0;if("acaa36d0-fcb1-11ec-8267-536b07c743c4"==this.$store.state.idInstitucion){if(12==a){for(var r=0,s=1;s<=4;s++){var i,c=null!==(i=o[s])&&void 0!==i?i:0;c>0&&(n+=c,r++)}return 0===n?"":(n/=r,this.redondear(n).toFixed(1)>0?this.redondear(n).toFixed(1):"")}for(var d=1;d<=4;d++){var u,l=null!==(u=o[d])&&void 0!==u?u:0;n+=l*t[d]/100}return this.redondear(n).toFixed(1)>0?this.redondear(n).toFixed(1):""}if("eb58bf60-fc83-11ec-a1d1-1dc2835404e5"==this.$store.state.idInstitucion){if(55==a){for(var m=0,p=1;p<=4;p++){var b,f=null!==(b=o[p])&&void 0!==b?b:0;f>0&&(n+=f,m++)}return 0===n?"":(n/=m,this.redondear(n).toFixed(1)>0?this.redondear(n).toFixed(1):"")}for(var v=1;v<=4;v++){var h,S=null!==(h=o[v])&&void 0!==h?h:0;n+=S*t[v]/100}return this.redondear(n).toFixed(1)>0?this.redondear(n).toFixed(1):""}if("c50f3d80-fca0-11ec-8267-536b07c743c4"==this.$store.state.idInstitucion){var g,C=null!==(g=o[5])&&void 0!==g?g:0;return C>0?C.toFixed(1):""}if("8a1bd1e0-fcb2-11ec-8267-536b07c743c4"==this.$store.state.idInstitucion){var A,_=null!==(A=o[5])&&void 0!==A?A:0;return _>0?_.toFixed(1):""}for(var x=0,E=1;E<=4;E++){var y,P=null!==(y=o[E])&&void 0!==y?y:0;P>0&&(n+=P,x++)}if(0===n)return"";var w=n/x;return this.redondear(w).toFixed(1)>0?this.redondear(w).toFixed(1):""},calcularPromedioArea:function(e){var t=this,o=Object.values(e.asignaturas);if(!o.length)return"0.00";var a=0;return o.forEach((function(e){if(99===e.orden&&0==t.datosSeccion.promCompor)return"-";a+=parseFloat(t.calcularPromedioAsignatura(e)*e.porcentaje/100)})),a>0?this.redondear(a).toFixed(1):""},contarDesempenoEstudianteArea:function(e,t){var o=this,a=Object.keys(e.areas||{}),n=0;return a.forEach((function(a){if(o.esAreaValida(a)){var r=o.listaAreasAsignaturas.find((function(e){return e.area===a})),s=null===r||void 0===r?void 0:r.idTipoArea,i=parseFloat(o.calcularPromedioArea(e.areas[a]));isNaN(i)||(1===s?("bajo"===t&&i<o.datosSeccion.minBas||"basico"===t&&i>=o.datosSeccion.minBas&&i<o.datosSeccion.minAlt||"alto"===t&&i>=o.datosSeccion.minAlt&&i<o.datosSeccion.minSup||"superior"===t&&i>=o.datosSeccion.minSup&&i<=o.datosSeccion.maxSup)&&n++:("bajo"===t&&i<o.datosSeccion.minBasT||"basico"===t&&i>=o.datosSeccion.minBasT&&i<o.datosSeccion.minAltT||"alto"===t&&i>=o.datosSeccion.minAltT&&i<o.datosSeccion.minSupT||"superior"===t&&i>=o.datosSeccion.minSupT&&i<=o.datosSeccion.maxSupT)&&n++)}})),n},calcularPromedioGeneral:function(e){var t=this,o=Object.keys(e.areas||{}),a=0,n=0;return o.forEach((function(o){if(t.esAreaValida(o)){var r=parseFloat(t.calcularPromedioArea(e.areas[o]));isNaN(r)||(a+=r,n++)}})),n>0?(a/n).toFixed(3):""},contarAusencias:function(e){var t=0;return Object.values(this.estudiantesNotas).forEach((function(o){"ausJ"===e&&(t+=o.ausJ||0),"ausS"===e&&(t+=o.ausS||0)})),t},contarNotasPorAsignatura:function(e,t,o){var a=this,n=0;return Object.values(this.estudiantesNotas).forEach((function(r){var s,i,c,d,u=null===r||void 0===r||null===(s=r[e])||void 0===s||null===(i=s[t])||void 0===i?void 0:i.nota,l=null===r||void 0===r||null===(c=r[e])||void 0===c||null===(d=c[t])||void 0===d?void 0:d.idTipoEspecialidad;"number"===typeof u&&(1===l?("bajo"===o&&u<a.datosSeccion.minBas||"basico"===o&&u>=a.datosSeccion.minBas&&u<a.datosSeccion.minAlt||"alto"===o&&u>=a.datosSeccion.minAlt&&u<a.datosSeccion.minSup||"superior"===o&&u>=a.datosSeccion.minSup&&u<=a.datosSeccion.maxSup)&&n++:("bajo"===o&&u<a.datosSeccion.minBasT||"basico"===o&&u>=a.datosSeccion.minBasT&&u<a.datosSeccion.minAltT||"alto"===o&&u>=a.datosSeccion.minAltT&&u<a.datosSeccion.minSupT||"superior"===o&&u>=a.datosSeccion.minSupT&&u<=a.datosSeccion.maxSupT)&&n++)})),n},contarNotasTotales:function(e){var t=this,o=0;return Object.values(this.estudiantesNotas).forEach((function(a){t.listaAreasAsignaturas.forEach((function(n){var r,s,i,c,d=n.area,u=n.asignatura,l=null===a||void 0===a||null===(r=a[d])||void 0===r||null===(s=r[u])||void 0===s?void 0:s.nota,m=null===a||void 0===a||null===(i=a[d])||void 0===i||null===(c=i[u])||void 0===c?void 0:c.idTipoEspecialidad;"number"===typeof l&&(1===m?("bajo"===e&&l<t.datosSeccion.minBas||"basico"===e&&l>=t.datosSeccion.minBas&&l<t.datosSeccion.minAlt||"alto"===e&&l>=t.datosSeccion.minAlt&&l<t.datosSeccion.minSup||"superior"===e&&l>=t.datosSeccion.minSup&&l<=t.datosSeccion.maxSup)&&o++:("bajo"===e&&l<t.datosSeccion.minBasT||"basico"===e&&l>=t.datosSeccion.minBasT&&l<t.datosSeccion.minAltT||"alto"===e&&l>=t.datosSeccion.minAltT&&l<t.datosSeccion.minSupT||"superior"===e&&l>=t.datosSeccion.minSupT&&l<=t.datosSeccion.maxSupT)&&o++)}))})),o},iconoPuesto:function(e){return 1===e?"ü•á":2===e?"ü•à":3===e?"ü•â":""},contarDesempenoEstudiante:function(e,t){var o=this,a=0;return Object.values(e||{}).forEach((function(e){Object.values(e.asignaturas||{}).forEach((function(e){var n=parseFloat(o.calcularPromedioAsignatura(e)),r=e.idTipoEspecialidad,s=e.orden;"eb58bf60-fc83-11ec-a1d1-1dc2835404e5"==o.$store.state.idInstitucion&&90==s||"097b7b10-fcaa-11ec-8267-536b07c743c4"==o.$store.state.idInstitucion&&98==s||"number"===typeof n&&(1===r?("bajo"===t&&n<o.datosSeccion.minBas||"basico"===t&&n>=o.datosSeccion.minBas&&n<o.datosSeccion.minAlt||"alto"===t&&n>=o.datosSeccion.minAlt&&n<o.datosSeccion.minSup||"superior"===t&&n>=o.datosSeccion.minSup&&n<=o.datosSeccion.maxSup)&&a++:("bajo"===t&&n<o.datosSeccion.minBasT||"basico"===t&&n>=o.datosSeccion.minBasT&&n<o.datosSeccion.minAltT||"alto"===t&&n>=o.datosSeccion.minAltT&&n<o.datosSeccion.minSupT||"superior"===t&&n>=o.datosSeccion.minSupT&&n<=o.datosSeccion.maxSupT)&&a++)}))})),a},fueRecuperada:function(e,t,o){var a,n,r;return null!==(a=null===e||void 0===e||null===(n=e[t])||void 0===n||null===(r=n[o])||void 0===r?void 0:r.fueRecuperada)&&void 0!==a&&a},obtenerOriginal:function(e,t,o){var a,n,r=null===e||void 0===e||null===(a=e[t])||void 0===a||null===(n=a[o])||void 0===n?void 0:n.original;return"number"===typeof r?r.toFixed(1):"0.0"},obtenerRecuperacion:function(e,t,o){var a,n,r=null===e||void 0===e||null===(a=e[t])||void 0===a||null===(n=a[o])||void 0===n?void 0:n.recuperacion;return"number"===typeof r?r.toFixed(1):"0.0"},obtenerColor:function(e,t,o,a){var n,r,s=null===t||void 0===t||null===(n=t[o])||void 0===n||null===(r=n[a])||void 0===r?void 0:r.idTipoEspecialidad;return 1===s?e<this.datosSeccion.minBas?"desempeno-bajo":e<this.datosSeccion.minAlt?"desempeno-basico":e<this.datosSeccion.minSup?"desempeno-alto":e<=this.datosSeccion.maxSup?"desempeno-superior":"desempeno-extra":e<this.datosSeccion.minBasT?"desempeno-bajo":e<this.datosSeccion.minAltT?"desempeno-basico":e<this.datosSeccion.minSupT?"desempeno-alto":e<=this.datosSeccion.maxSupT?"desempeno-superior":"desempeno-extra"},claseDesempeno:function(e){return"number"!==typeof e?"desempeno-extra":e<3?"desempeno-bajo":e<4?"desempeno-basico":e<4.6?"desempeno-alto":e<=5?"desempeno-superior":"desempeno-extra"},obtenerColorGeneral:function(e){return e<this.datosSeccion.minBas?"desempeno-bajo":e<this.datosSeccion.minAlt?"desempeno-basico":e<this.datosSeccion.minSup?"desempeno-alto":e<=this.datosSeccion.maxSup?"desempeno-superior":"desempeno-extra"},consultarEstudiantes:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.btnCargando=!0,1==e.idPeriodo&&(e.periodosVisibles=[1]),2==e.idPeriodo&&(e.periodosVisibles=[1,2]),3==e.idPeriodo&&(e.periodosVisibles=[1,2,3]),4==e.idPeriodo&&(e.periodosVisibles=[1,2,3,4]),e.nombreSede=document.getElementById("sedes")[document.getElementById("sedes").selectedIndex].text,null==e.idCurso){t.next=15;break}return e.nombreCurso=document.getElementById("cursos")[document.getElementById("cursos").selectedIndex].text,e.$store.state.datosCursos.forEach((function(t){t.id==e.idCurso&&(e.idNivel=t.id_nivel)})),e.listaAreasAsignaturas=[],t.next=12,s.a.get(i["d"]+"consolidados/areasasignaturas/curso",{params:{idCurso:e.idCurso}}).then((function(t){t.data.error?(e.mensajeEmergente("danger",i["h"],t.data.mensaje+" - Lista areas-asignaturas curso"),e.btnCargando=!1):0!=t.data.datos&&t.data.datos.forEach((function(t){"eb58bf60-fc83-11ec-a1d1-1dc2835404e5"==e.$store.state.idInstitucion?99!=t.orden&&90!=t.orden&&e.listaAreasAsignaturas.push(t):"f5529ba0-fcb3-11ec-8267-536b07c743c4"==e.$store.state.idInstitucion?99!=t.orden&&15!=t.orden&&16!=t.orden&&98!=t.orden&&e.listaAreasAsignaturas.push(t):"097b7b10-fcaa-11ec-8267-536b07c743c4"==e.$store.state.idInstitucion?99!=t.orden&&98!=t.orden&&e.listaAreasAsignaturas.push(t):("54fd7440-fc81-11ec-a1d1-1dc2835404e5"==e.$store.state.idInstitucion||"7c63ed50-fcb0-11ec-8267-536b07c743c4"==e.$store.state.idInstitucion||99!=t.orden)&&e.listaAreasAsignaturas.push(t)}))})).catch((function(t){e.mensajeEmergente("danger",i["h"],"Algo salio mal y no se pudo realizar: Lista areas-asignaturas curso. Intente m√°s tarde."+t),e.btnCargando=!1}));case 12:return e.datosRaw=[],t.next=15,s.a.get(i["d"]+"consolidados/asignaturas/curso/acumulado",{params:{idCurso:e.idCurso,periodo:e.idPeriodo,vigencia:e.$store.state.aLectivo}}).then((function(t){t.data.error?(e.mensajeEmergente("danger",i["h"],t.data.mensaje+" - Consolidados asignaturas curso periodo"),e.btnCargando=!1):0!=t.data.datos&&(e.datosRaw=t.data.datos)})).catch((function(t){e.mensajeEmergente("danger",i["h"],"Algo salio mal y no se pudo realizar: Consolidados asignaturas curso periodo. Intente m√°s tarde."+t),e.btnCargando=!1}));case 15:e.btnCargando=!1;case 16:case"end":return t.stop()}}),t)})))()},imprimir:function(){var e="Fecha: "+(new Date).toLocaleString(),t="REPORTE DE ESTADOS SIN SUPERACI√ìN FINAL",o=document.querySelector("table").outerHTML,a=window.open("Consolidados","_blank");a.document.write('<html><head><title>Imprimir</title></head>\n        <style scoped>\n          table {\n            border-collapse: collapse;\n            width: 100%;\n            text-align: center;\n            font-size: 10px;\n          }\n          th {\n            background: #eee;\n          }\n          .nota-recuperada {\n            border: 2px solid #ffa500;\n            box-shadow: 0 0 5px #ffa500;\n          }\n          .desempeno-bajo { background-color: #f8d7da; color: #721c24; }\n          .desempeno-basico { background-color: #d1ecf1; color: #0c5460; }\n          .desempeno-alto { background-color: #fff3cd; color: #856404; }\n          .desempeno-superior { background-color: #d4edda; color: #155724; }\n          .desempeno-extra { background-color: #f4ecf5; color: #2f2e2e; }\n        </style>\n          <body class="container">\n            <p style="text-align: center; font-size: 12px;">SECRETAR√çA DE EDUCACI√ìN TERRITORIAL DE TUNJA<br><b>'.concat(this.$store.state.nombreInstitucion,"</b><br>TUNJA - BOYAC√Å<br>").concat(t,"<br>Sede: ").concat(this.nombreSede," | Curso: ").concat(this.nombreCurso," | A√±o Lectivo ").concat(this.$store.state.aLectivo," | Periodo: FINAL</p>\n            ").concat(o,'\n            <div style="text-align: right; font-size: 12px;"><i>').concat(e,"</i></div>\n          </body>\n        </html>")),a.document.close(),a.print()},exportarAExcel:function(){var e=document.querySelector("table"),t=p["utils"].table_to_book(e);p["writeFile"](t,"ConsoldidaFinal.xlsx")},redondear:function(e){var t=Number((10*Math.abs(e)).toPrecision(15));return Math.round(t)/10*Math.sign(e)},ocuparComboCursosSede:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.comboCursosSede=[],e.$store.state.datosCursos.forEach((function(t){t.id_sede==e.idSede&&e.comboCursosSede.push({value:t.id,text:t.nomenclatura.toUpperCase()})}));case 2:case"end":return t.stop()}}),t)})))()},ocuparComboSedes:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.comboSedes=[],e.$store.state.datosSedes.forEach((function(t){e.comboSedes.push({value:t.id,text:t.sede.toUpperCase()})}));case 2:case"end":return t.stop()}}),t)})))()},ocuparComboPeriodos:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.comboPeriodos=[],e.$store.state.periodos.forEach((function(t){e.comboPeriodos.push({value:t.id,text:t.periodo.toUpperCase()})}));case 2:case"end":return t.stop()}}),t)})))()},mensajeEmergente:function(e,t,o){this.$bvToast.toast(o,{title:t,variant:e,toaster:"b-toaster-top-center",solid:!0,autoHideDelay:4e3,appendToast:!1})}},computed:{totales:function(){return this.totalesGlobales()},estudiantesNotas:function(){var e=this,t={};return this.datosRaw.forEach((function(o){var a=o.estudiante,n=o.area,r=o.asignatura,s=o.periodo,i=o.definitiva,c=o.recuperacion,d=o.orden,u=o.definitivacompor,l=o.definitivapree,m=o.idTipoEspecialidad,p=o.ausJ,b=o.ausS,f=o.porcentaje,v=o.id_conceptual;t[a]||(t[a]={id_conceptual:v,ausJ:0,ausS:0,areas:{}}),t[a].areas[n]||(t[a].areas[n]={asignaturas:{}}),t[a].areas[n].asignaturas[r]||(t[a].areas[n].asignaturas[r]={periodos:{},orden:d,idTipoEspecialidad:m,porcentaje:f,pesos:{1:e.datosSeccion.pesoP1,2:e.datosSeccion.pesoP2,3:e.datosSeccion.pesoP3,4:e.datosSeccion.pesoP4}});var h=0;h=99===d?1==e.datosSeccion.tipoValComp?i:null!=u?u:"":1==e.idNivel?null!=l&&0!=l&&""!=l?l:"":c>i?c:i,t[a].areas[n].asignaturas[r].periodos[s]=h,t[a].ausJ+=p||0,t[a].ausS+=b||0})),t},totalColumnasPromedioArea:function(){var e=new Set(this.listaAreasAsignaturas.map((function(e){return e.area})));return e.size},puestosPorEstudiante:function(){var e=this,t=Object.entries(this.estudiantesNotas).map((function(t){var o=Object(u["a"])(t,2),a=o[0],n=o[1],r=parseFloat(e.calcularPromedioGeneral(n));return{nombre:a,promedio:isNaN(r)?0:r}}));t.sort((function(e,t){return t.promedio-e.promedio}));var o={},a=1,n=1,r=null;return t.forEach((function(e){e.promedio!==r&&(a=n,r=e.promedio,n++),o[e.nombre]=a})),o},encabezadoPorArea:function(){var e={};return this.listaAreasAsignaturas.forEach((function(t){var o=t.area,a=t.asignatura;e[o]||(e[o]=[]),e[o].push(a)})),e}},beforeMount:function(){this.ocuparComboSedes(),this.ocuparComboPeriodos(),this.datosSeccion=this.$store.state.datosSecciones[this.$store.state.idSeccion-1]}},xe=_e,Ee=(o("a7f8"),Object(v["a"])(xe,be,fe,!1,null,"f56f20da",null)),ye=Ee.exports,Pe=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("b-row",{staticClass:"mt-2"},[o("b-col",{attrs:{lg:"12"}},[o("b-card",{scopedSlots:e._u([{key:"header",fn:function(){return[o("h5",{staticClass:"mb-0"},[o("b-icon",{attrs:{icon:"card-checklist","aria-hidden":"true"}}),e._v(" CONSOLIDADO ASIGNATURAS PERDIDAS")],1)]},proxy:!0}])},[o("b-card-text",[o("b-row",[o("b-col",{attrs:{lg:"2"}},[o("b-form-group",{staticClass:"etiqueta",attrs:{label:"Periodo:","label-for":"periodo"}},[o("b-form-select",{ref:"periodo",attrs:{id:"periodo",options:e.comboPeriodos},on:{change:function(t){e.idSede=null,e.idCurso=null}},model:{value:e.idPeriodo,callback:function(t){e.idPeriodo=t},expression:"idPeriodo"}})],1)],1),o("b-col",{attrs:{lg:"6"}},[o("b-form-group",{staticClass:"etiqueta",attrs:{label:"Seleccione la Sede:","label-for":"sedes"}},[o("b-form-select",{ref:"sedes",attrs:{id:"sedes",options:e.comboSedes,disabled:null==e.idPeriodo},on:{change:function(t){e.idCurso=null,e.ocuparComboCursosSede()}},model:{value:e.idSede,callback:function(t){e.idSede=t},expression:"idSede"}})],1)],1),o("b-col",{attrs:{lg:"4"}},[o("b-form-group",{staticClass:"etiqueta",attrs:{label:"Seleccione el Curso:","label-for":"cursos"}},[o("b-form-select",{ref:"cursos",attrs:{id:"cursos",options:e.comboCursosSede,disabled:null==e.idSede},on:{change:function(t){return e.consultarEstudiantes()}},model:{value:e.idCurso,callback:function(t){e.idCurso=t},expression:"idCurso"}})],1)],1)],1)],1)],1)],1)],1),o("b-row",[o("b-col",{attrs:{lg:"12"}},[e.btnCargando?o("div",[o("div",{staticClass:"text-center m-5 text-primary"},[o("b-spinner",{staticStyle:{width:"3rem",height:"3rem"},attrs:{label:"Spinner"}}),o("br"),o("strong",[e._v("Cargando informe...")])],1)]):e._e()])],1),e.btnCargando||null==e.idCurso?e._e():o("b-row",[o("b-col",{attrs:{lg:"12"}},[o("table",{staticClass:"tabla-perdidas",attrs:{border:"1",cellspacing:"0",cellpadding:"1"}},[o("thead",[o("tr",[o("th",[e._v("Estudiante")]),o("th",[e._v("Asignaturas Perdidas")]),o("th",[e._v("Total")])])]),o("tbody",e._l(e.informePerdidas,(function(t){return o("tr",{key:t.estudiante},[o("td",[e._v(e._s(t.estudiante))]),o("td",[e._v(e._s(t.perdidas.join(", ")))]),o("td",[e._v(e._s(t.total))])])})),0)]),o("div",{staticStyle:{"margin-bottom":"1rem"}},[o("b-button",{staticClass:"small mx-1 mt-3",attrs:{variant:"primary"},on:{click:e.imprimir}},[e._v("Imprimir Consolidado")]),o("b-button",{staticClass:"small mx-1 mt-3",attrs:{variant:"outline-primary"},on:{click:e.exportarAExcel}},[e._v("Exportar a Excel")])],1)])],1)],1)},we=[],Te={name:"asignaturasperdidas",props:{},components:{},data:function(){return{idSede:null,comboSedes:[],idPeriodo:null,comboPeriodos:null,idCurso:null,comboCursosSede:[],nombreSede:null,nombreCurso:null,idNivel:null,btnCargando:!1,dataConsultada:[],datosSeccion:{},listaAreasAsignaturas:[],listaEstudiantes:[],ausencias:[]}},methods:{consultarEstudiantes:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.btnCargando=!0,e.nombreSede=document.getElementById("sedes")[document.getElementById("sedes").selectedIndex].text,null==e.idCurso){t.next=11;break}return e.nombreCurso=document.getElementById("cursos")[document.getElementById("cursos").selectedIndex].text,e.$store.state.datosCursos.forEach((function(t){t.id==e.idCurso&&(e.idNivel=t.id_nivel)})),e.listaEstudiantes=[],t.next=8,s.a.get(i["d"]+"consolidado/listaestudiantes/curso",{params:{idCurso:e.idCurso,vigencia:e.$store.state.aLectivo}}).then((function(t){t.data.error?e.mensajeEmergente("danger",i["h"],t.data.mensaje+" - Consulta Lista Curso"):0!=t.data.datos&&(e.listaEstudiantes=t.data.datos)})).catch((function(t){e.mensajeEmergente("danger",i["h"],"Algo salio mal y no se pudo realizar: Consulta Lista Curso. Intente m√°s tarde."+t)}));case 8:return e.dataConsultada=[],t.next=11,s.a.get(i["d"]+"consolidados/notasperdidas/curso/periodo",{params:{idCurso:e.idCurso,periodo:e.idPeriodo,vigencia:e.$store.state.aLectivo}}).then((function(t){t.data.error?(e.mensajeEmergente("danger",i["h"],t.data.mensaje+" - Consolidados ausencias curso periodo"),e.btnCargando=!1):0!=t.data.datos&&(e.dataConsultada=t.data.datos)})).catch((function(t){e.mensajeEmergente("danger",i["h"],"Algo salio mal y no se pudo realizar: Consolidados ausencias curso periodo. Intente m√°s tarde."+t),e.btnCargando=!1}));case 11:e.btnCargando=!1;case 12:case"end":return t.stop()}}),t)})))()},imprimir:function(){var e="Fecha: "+(new Date).toLocaleString(),t="CONSOLIDADO DE ASIGNATURAS PERDIDAS",o=document.querySelector("table").outerHTML,a=window.open("Perdidas","_blank");a.document.write('<html><head><title>Perdidas</title></head>\n      <style scoped>\n        .tabla-perdidas {\n          width: 100%;\n          border-collapse: collapse;\n          font-size: 13px;\n        }\n        .tabla-perdidas th, .tabla-perdidas td {\n          border: 1px solid #ccc;\n          padding: 1px;\n        }\n        .tabla-perdidas th {\n          background-color: #f2f8ff;\n          text-align: center;\n        }\n        .tabla-perdidas td {\n          vertical-align: top;\n        }\n      </style>\n        <body class="container">\n          <p style="text-align: center; font-size: 12px;">SECRETAR√çA DE EDUCACI√ìN TERRITORIAL DE TUNJA<br><b>'.concat(this.$store.state.nombreInstitucion,"</b><br>TUNJA - BOYAC√Å<br>").concat(t,"<br>Sede: ").concat(this.nombreSede," | Curso: ").concat(this.nombreCurso," | A√±o Lectivo ").concat(this.$store.state.aLectivo," | Periodo: ").concat(this.idPeriodo,"</p>\n          ").concat(o,'\n          <div style="text-align: right; font-size: 12px;"><i>').concat(e,"</i></div>\n        </body>\n      </html>")),a.document.close(),a.print()},exportarAExcel:function(){var e=document.querySelector("table"),t=p["utils"].table_to_book(e);p["writeFile"](t,"ausencias.xlsx")},ocuparComboCursosSede:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.comboCursosSede=[],e.$store.state.datosCursos.forEach((function(t){t.id_sede==e.idSede&&e.comboCursosSede.push({value:t.id,text:t.nomenclatura.toUpperCase()})}));case 2:case"end":return t.stop()}}),t)})))()},ocuparComboSedes:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.comboSedes=[],e.$store.state.datosSedes.forEach((function(t){e.comboSedes.push({value:t.id,text:t.sede.toUpperCase()})}));case 2:case"end":return t.stop()}}),t)})))()},ocuparComboPeriodos:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.comboPeriodos=[],e.$store.state.periodos.forEach((function(t){e.comboPeriodos.push({value:t.id,text:t.periodo.toUpperCase()})}));case 2:case"end":return t.stop()}}),t)})))()},mensajeEmergente:function(e,t,o){this.$bvToast.toast(o,{title:t,variant:e,toaster:"b-toaster-top-center",solid:!0,autoHideDelay:4e3,appendToast:!1})}},computed:{informePerdidas:function(){var e=this;return this.listaEstudiantes.map((function(t){var o=e.dataConsultada.filter((function(e){return e.idMatricula===t.idMatricula&&98!==e.orden&&99!==e.orden})),a=o.map((function(t){var o=parseFloat(t.definitiva)||0,a=parseFloat(t.recuperacion),n=!isNaN(a)&&a>o?a:o,r=parseInt(t.idTipoEspecialidad),s=1===r?n<e.datosSeccion.minBas:2===r&&n<e.datosSeccion.minBasT;return s?{asignatura:t.asignatura,nota:n}:null})).filter(Boolean),n=a.map((function(e){return"".concat(e.asignatura,"(").concat(e.nota.toFixed(1),")")}));return{estudiante:t.estudiante,perdidas:n,total:n.length}})).filter((function(e){return e.total>0}))}},beforeMount:function(){this.ocuparComboSedes(),this.ocuparComboPeriodos(),this.datosSeccion=this.$store.state.datosSecciones[this.$store.state.idSeccion-1]}},je=Te,Ne=(o("0fa6"),Object(v["a"])(je,Pe,we,!1,null,"57fed324",null)),ke=Ne.exports,Oe=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("b-row",{staticClass:"mt-2"},[o("b-col",{attrs:{lg:"12"}},[o("b-card",{scopedSlots:e._u([{key:"header",fn:function(){return[o("h5",{staticClass:"mb-0"},[o("b-icon",{attrs:{icon:"card-checklist","aria-hidden":"true"}}),e._v(" CONSOLIDADO EVALUACIONES FINALES DE ASIGNATURAS")],1)]},proxy:!0}])},[o("b-card-text",[o("b-row",[o("b-col",{attrs:{lg:"6"}},[o("b-form-group",{staticClass:"etiqueta",attrs:{label:"Seleccione la Sede:","label-for":"sedes"}},[o("b-form-select",{ref:"sedes",attrs:{id:"sedes",options:e.comboSedes},on:{change:function(t){e.idCurso=null,e.ocuparComboCursosSede()}},model:{value:e.idSede,callback:function(t){e.idSede=t},expression:"idSede"}})],1)],1),o("b-col",{attrs:{lg:"4"}},[o("b-form-group",{staticClass:"etiqueta",attrs:{label:"Seleccione el Curso:","label-for":"cursos"}},[o("b-form-select",{ref:"cursos",attrs:{id:"cursos",options:e.comboCursosSede,disabled:null==e.idSede},on:{change:function(t){return e.consultarEstudiantes()}},model:{value:e.idCurso,callback:function(t){e.idCurso=t},expression:"idCurso"}})],1)],1)],1)],1)],1)],1)],1),o("b-row",[o("b-col",{attrs:{lg:"12"}},[e.btnCargando?o("div",[o("div",{staticClass:"text-center m-5 text-primary"},[o("b-spinner",{staticStyle:{width:"3rem",height:"3rem"},attrs:{label:"Spinner"}}),o("br"),o("strong",[e._v("Cargando informe...")])],1)]):e._e()])],1),e.btnCargando||null==e.idCurso?e._e():o("b-row",[o("b-col",{attrs:{lg:"12"}},[o("table",{staticClass:"table-responsive",attrs:{border:"1",cellspacing:"0",cellpadding:"1"}},[o("thead",[o("tr",[o("th",{attrs:{rowspan:"3"}},[e._v("#")]),o("th",{attrs:{rowspan:"3"}},[e._v("Estudiante")]),e._l(e.encabezadoPorArea,(function(t,a){return[o("th",{key:a,attrs:{colspan:e.colspanArea(a)}},[e._v(" "+e._s(a)+" ")])]})),o("th",{attrs:{rowspan:"3"}},[e._v("PRO GEN")]),o("th",{attrs:{rowspan:"3"}},[e._v("Tot"),o("br"),e._v("Asig"),o("br"),e._v("Baj")]),o("th",{attrs:{rowspan:"3"}},[e._v("Tot"),o("br"),e._v("Asig"),o("br"),e._v("Bas")]),o("th",{attrs:{rowspan:"3"}},[e._v("Tot"),o("br"),e._v("Asig"),o("br"),e._v("Alt")]),o("th",{attrs:{rowspan:"3"}},[e._v("Tot"),o("br"),e._v("Asig"),o("br"),e._v("Sup")]),o("th",{attrs:{rowspan:"3"}},[e._v("Tot"),o("br"),e._v("AuJ")]),o("th",{attrs:{rowspan:"3"}},[e._v("Tot"),o("br"),e._v("AuS")]),o("th",{attrs:{rowspan:"3"}},[e._v("Puesto")]),o("th",{attrs:{rowspan:"3"}},[e._v("#")])],2),o("tr",[e._l(e.encabezadoPorArea,(function(t,a){return[e._l(t,(function(t,a){return[o("th",{key:"area-"+t+a,attrs:{colspan:e.periodosVisibles.length+1}},[e._v(" "+e._s(t)+" ")])]})),o("th",{key:"prom-area-"+a,staticClass:"promedio-area"},[e._v("PRO AR")])]}))],2),o("tr",[e._l(e.encabezadoPorArea,(function(t,a){return[e._l(t,(function(t){return[e._l(e.periodosVisibles,(function(n){return o("th",{key:"h"+a+t+n},[e._v(" P"+e._s(n)+" ")])})),o("th",{key:"prom"+t+a},[e._v("PR")])]})),o("th",{key:"prom"+a})]}))],2)]),o("tbody",[e._l(e.estudiantesNotas,(function(t,a,n){return o("tr",{key:a},[o("td",{staticClass:"text-left"},[e._v(e._s(n+1))]),o("td",{staticStyle:{"text-align":"left"}},[e._v(e._s(a))]),e._l(e.encabezadoPorArea,(function(n,r){return[e._l(n,(function(n){return[e._l(e.periodosVisibles,(function(s){return o("td",{key:a+r+n+s},[e._v(" "+e._s("N"==t.id_conceptual?e.obtenerNota(t,r,n,s):"-")+" ")])})),o("td",{key:"prom"+a+r+n,staticClass:"bloque-area",staticStyle:{"font-weight":"bold","text-align":"center"}},[e._v(" "+e._s("N"==t.id_conceptual?e.obtenerPromedioAsignatura(t,r,n):"-")+" ")])]})),o("td",{key:"promArea"+a+r,staticClass:"promedio-area bloque-area"},[e._v(" "+e._s("N"==t.id_conceptual?e.obtenerPromedioArea(t,r):"-")+" ")])]})),o("td",[e._v(e._s("N"==t.id_conceptual?e.calcularPromedioGeneral(t):"-"))]),o("td",[e._v(e._s("N"==t.id_conceptual?e.contarDesempenoEstudiante(t.areas,"bajo"):"-"))]),o("td",[e._v(e._s("N"==t.id_conceptual?e.contarDesempenoEstudiante(t.areas,"basico"):"-"))]),o("td",[e._v(e._s("N"==t.id_conceptual?e.contarDesempenoEstudiante(t.areas,"alto"):"-"))]),o("td",[e._v(e._s("N"==t.id_conceptual?e.contarDesempenoEstudiante(t.areas,"superior"):"-"))]),o("td",[e._v(e._s("N"==t.id_conceptual?t.ausJ:"-"))]),o("td",[e._v(e._s("N"==t.id_conceptual?t.ausS:"-"))]),o("td",[e._v(e._s("N"==t.id_conceptual?e.iconoPuesto(e.puestosPorEstudiante[a]):"-")+" "+e._s("N"==t.id_conceptual?e.puestosPorEstudiante[a]:"-"))]),o("td",{staticClass:"text-left"},[e._v(e._s(n+1))])],2)})),o("tr",{staticStyle:{"background-color":"#f0f0f0","font-weight":"bold"}},[o("td",{attrs:{colspan:"2"}},[e._v("Total Bajos")]),e._l(e.encabezadoPorArea,(function(t,a){return[e._l(t,(function(t){return[e._l(e.periodosVisibles,(function(n){return o("td",{key:"bp"+a+t+n},[e._v(" "+e._s(e.totalBajosPorPeriodo(a,t,n))+" ")])})),o("td",{key:"bj"+a+t},[e._v(" "+e._s(e.totalBajosPromedioAsignatura(a,t))+" ")])]})),o("td",{key:"bja"+a,staticClass:"promedio-area"},[e._v(" "+e._s(e.totalBajosPromedioArea(a))+" ")])]})),o("td"),e._v(" "),o("td",[e._v(e._s(e.totales.bajo))]),o("td",[e._v(e._s(e.totales.basico))]),o("td",[e._v(e._s(e.totales.alto))]),o("td",[e._v(e._s(e.totales.superior))]),o("td",[e._v(e._s(e.totales.ausJ))]),o("td",[e._v(e._s(e.totales.ausS))]),o("td"),e._v(" "),o("td")],2)],2)]),o("div",{staticStyle:{"margin-bottom":"1rem"}},[o("b-button",{staticClass:"small mx-1 mt-3",attrs:{variant:"primary"},on:{click:e.imprimir}},[e._v("Imprimir Consolidado")]),o("b-button",{staticClass:"small mx-1 mt-3",attrs:{variant:"outline-primary"},on:{click:e.exportarAExcel}},[e._v("Exportar a Excel")])],1)])],1)],1)},Re=[],Ie={name:"consolidadopromedio",components:{},data:function(){return{idSede:null,comboSedes:[],idPeriodo:5,comboPeriodos:null,idCurso:null,comboCursosSede:[],nombreSede:null,nombreCurso:null,idNivel:null,btnCargando:!1,datosRaw:[],datosSeccion:{},listaAreasAsignaturas:[],periodosVisibles:[]}},methods:{colspanArea:function(e){var t=this.encabezadoPorArea[e]||[],o=this.periodosVisibles.length+1,a=1;return t.length*o+a},totalBajosPorPeriodo:function(e,t,o){var a=this,n=0,r=this.listaAreasAsignaturas.find((function(o){return o.area===e&&o.asignatura===t})),s=null===r||void 0===r?void 0:r.idTipoEspecialidad;return Object.values(this.estudiantesNotas).forEach((function(r){var i,c,d,u,l,m=null===r||void 0===r||null===(i=r.areas)||void 0===i||null===(c=i[e])||void 0===c||null===(d=c.asignaturas)||void 0===d||null===(u=d[t])||void 0===u||null===(l=u.periodos)||void 0===l?void 0:l[o];1===s?m>0&&m<a.datosSeccion.minBas&&n++:m>0&&m<a.datosSeccion.minBasT&&n++})),n},totalBajosPromedioAsignatura:function(e,t){var o=this,a=0,n=this.listaAreasAsignaturas.find((function(o){return o.area===e&&o.asignatura===t})),r=null===n||void 0===n?void 0:n.idTipoEspecialidad;return Object.values(this.estudiantesNotas).forEach((function(n){var s,i,c,d=null===n||void 0===n||null===(s=n.areas)||void 0===s||null===(i=s[e])||void 0===i||null===(c=i.asignaturas)||void 0===c?void 0:c[t];if(d){var u=parseFloat(o.calcularPromedioAsignatura(d));1===r?u<o.datosSeccion.minBas&&a++:u<o.datosSeccion.minBasT&&a++}})),a},totalBajosPromedioArea:function(e){var t=this,o=0;return Object.values(this.estudiantesNotas).forEach((function(a){var n=parseFloat(t.obtenerPromedioArea(a,e));!isNaN(n)&&n<t.datosSeccion.minBas&&o++})),o},totalesGlobales:function(){var e=this,t=0,o=0,a=0,n=0,r=0,s=0;return Object.values(this.estudiantesNotas).forEach((function(i){t+=e.contarDesempenoEstudiante(i.areas,"bajo"),o+=e.contarDesempenoEstudiante(i.areas,"basico"),a+=e.contarDesempenoEstudiante(i.areas,"alto"),n+=e.contarDesempenoEstudiante(i.areas,"superior"),r+=i.ausJ||0,s+=i.ausS||0})),{bajo:t,basico:o,alto:a,superior:n,ausJ:r,ausS:s}},esAreaValida:function(e){var t=this.listaAreasAsignaturas.filter((function(t){return t.area===e}));return!!t.some((function(e){return 99!==e.orden&&98!==e.orden}))||!(!t.some((function(e){return 99===e.orden}))||1!=this.datosSeccion.promCompor)},obtenerPromedioArea:function(e,t){var o=e.areas&&e.areas[t];return o?this.calcularPromedioArea(o):""},obtenerNota:function(e,t,o,a){var n,r,s,i,c,d=null===e||void 0===e||null===(n=e.areas)||void 0===n||null===(r=n[t])||void 0===r||null===(s=r.asignaturas)||void 0===s||null===(i=s[o])||void 0===i||null===(c=i.periodos)||void 0===c?void 0:c[a];return 0===d&&(d=""),"number"===typeof d?d.toFixed(1):d},obtenerPromedioAsignatura:function(e,t,o){var a,n,r,s=null===e||void 0===e||null===(a=e.areas)||void 0===a||null===(n=a[t])||void 0===n||null===(r=n.asignaturas)||void 0===r?void 0:r[o];return s?this.calcularPromedioAsignatura(s):""},calcularPromedioAsignatura:function(e){var t=e.pesos,o=e.periodos,a=e.orden;if(99===a&&0==this.datosSeccion.promCompor)return"-";var n=0;if("acaa36d0-fcb1-11ec-8267-536b07c743c4"==this.$store.state.idInstitucion){if(12==a){for(var r=0,s=1;s<=4;s++){var i,c=null!==(i=o[s])&&void 0!==i?i:0;c>0&&(n+=c,r++)}return 0===n?"":(n/=r,this.redondear(n).toFixed(1)>0?this.redondear(n).toFixed(1):"")}for(var d=1;d<=4;d++){var u,l=null!==(u=o[d])&&void 0!==u?u:0;n+=l*t[d]/100}return this.redondear(n).toFixed(1)>0?this.redondear(n).toFixed(1):""}if("eb58bf60-fc83-11ec-a1d1-1dc2835404e5"==this.$store.state.idInstitucion){if(55==a){for(var m=0,p=1;p<=4;p++){var b,f=null!==(b=o[p])&&void 0!==b?b:0;f>0&&(n+=f,m++)}return 0===n?"":(n/=m,this.redondear(n).toFixed(1)>0?this.redondear(n).toFixed(1):"")}for(var v=1;v<=4;v++){var h,S=null!==(h=o[v])&&void 0!==h?h:0;n+=S*t[v]/100}return this.redondear(n).toFixed(1)>0?this.redondear(n).toFixed(1):""}if("c50f3d80-fca0-11ec-8267-536b07c743c4"==this.$store.state.idInstitucion){var g,C=null!==(g=o[5])&&void 0!==g?g:0;return C>0?C.toFixed(1):""}if("8a1bd1e0-fcb2-11ec-8267-536b07c743c4"==this.$store.state.idInstitucion){var A,_=null!==(A=o[5])&&void 0!==A?A:0;return _>0?_.toFixed(1):""}for(var x=0,E=1;E<=4;E++){var y,P=null!==(y=o[E])&&void 0!==y?y:0;P>0&&(n+=P,x++)}if(0===n)return"";var w=n/x;return this.redondear(w).toFixed(1)>0?this.redondear(w).toFixed(1):""},calcularPromedioArea:function(e){var t=this,o=Object.values(e.asignaturas);if(!o.length)return"0.00";var a=0;return o.forEach((function(e){if(99===e.orden&&0==t.datosSeccion.promCompor)return"-";a+=parseFloat(t.calcularPromedioAsignatura(e)*e.porcentaje/100)})),a>0?this.redondear(a).toFixed(1):""},calcularPromedioGeneral:function(e){var t=this,o=Object.keys(e.areas||{}),a=0,n=0;return o.forEach((function(o){if(t.esAreaValida(o)){var r=parseFloat(t.calcularPromedioArea(e.areas[o]));isNaN(r)||(a+=r,n++)}})),n>0?(a/n).toFixed(3):""},contarAusencias:function(e){var t=0;return Object.values(this.estudiantesNotas).forEach((function(o){"ausJ"===e&&(t+=o.ausJ||0),"ausS"===e&&(t+=o.ausS||0)})),t},contarNotasPorAsignatura:function(e,t,o){var a=this,n=0;return Object.values(this.estudiantesNotas).forEach((function(r){var s,i,c,d,u=null===r||void 0===r||null===(s=r[e])||void 0===s||null===(i=s[t])||void 0===i?void 0:i.nota,l=null===r||void 0===r||null===(c=r[e])||void 0===c||null===(d=c[t])||void 0===d?void 0:d.idTipoEspecialidad;"number"===typeof u&&(1===l?("bajo"===o&&u<a.datosSeccion.minBas||"basico"===o&&u>=a.datosSeccion.minBas&&u<a.datosSeccion.minAlt||"alto"===o&&u>=a.datosSeccion.minAlt&&u<a.datosSeccion.minSup||"superior"===o&&u>=a.datosSeccion.minSup&&u<=a.datosSeccion.maxSup)&&n++:("bajo"===o&&u<a.datosSeccion.minBasT||"basico"===o&&u>=a.datosSeccion.minBasT&&u<a.datosSeccion.minAltT||"alto"===o&&u>=a.datosSeccion.minAltT&&u<a.datosSeccion.minSupT||"superior"===o&&u>=a.datosSeccion.minSupT&&u<=a.datosSeccion.maxSupT)&&n++)})),n},contarNotasTotales:function(e){var t=this,o=0;return Object.values(this.estudiantesNotas).forEach((function(a){t.listaAreasAsignaturas.forEach((function(n){var r,s,i,c,d=n.area,u=n.asignatura,l=null===a||void 0===a||null===(r=a[d])||void 0===r||null===(s=r[u])||void 0===s?void 0:s.nota,m=null===a||void 0===a||null===(i=a[d])||void 0===i||null===(c=i[u])||void 0===c?void 0:c.idTipoEspecialidad;"number"===typeof l&&(1===m?("bajo"===e&&l<t.datosSeccion.minBas||"basico"===e&&l>=t.datosSeccion.minBas&&l<t.datosSeccion.minAlt||"alto"===e&&l>=t.datosSeccion.minAlt&&l<t.datosSeccion.minSup||"superior"===e&&l>=t.datosSeccion.minSup&&l<=t.datosSeccion.maxSup)&&o++:("bajo"===e&&l<t.datosSeccion.minBasT||"basico"===e&&l>=t.datosSeccion.minBasT&&l<t.datosSeccion.minAltT||"alto"===e&&l>=t.datosSeccion.minAltT&&l<t.datosSeccion.minSupT||"superior"===e&&l>=t.datosSeccion.minSupT&&l<=t.datosSeccion.maxSupT)&&o++)}))})),o},iconoPuesto:function(e){return 1===e?"ü•á":2===e?"ü•à":3===e?"ü•â":""},contarDesempenoEstudiante:function(e,t){var o=this,a=0;return Object.values(e||{}).forEach((function(e){Object.values(e.asignaturas||{}).forEach((function(e){var n=parseFloat(o.calcularPromedioAsignatura(e)),r=e.idTipoEspecialidad,s=e.orden;"eb58bf60-fc83-11ec-a1d1-1dc2835404e5"==o.$store.state.idInstitucion&&90==s||"097b7b10-fcaa-11ec-8267-536b07c743c4"==o.$store.state.idInstitucion&&98==s||"number"===typeof n&&(1===r?("bajo"===t&&n<o.datosSeccion.minBas||"basico"===t&&n>=o.datosSeccion.minBas&&n<o.datosSeccion.minAlt||"alto"===t&&n>=o.datosSeccion.minAlt&&n<o.datosSeccion.minSup||"superior"===t&&n>=o.datosSeccion.minSup&&n<=o.datosSeccion.maxSup)&&a++:("bajo"===t&&n<o.datosSeccion.minBasT||"basico"===t&&n>=o.datosSeccion.minBasT&&n<o.datosSeccion.minAltT||"alto"===t&&n>=o.datosSeccion.minAltT&&n<o.datosSeccion.minSupT||"superior"===t&&n>=o.datosSeccion.minSupT&&n<=o.datosSeccion.maxSupT)&&a++)}))})),a},fueRecuperada:function(e,t,o){var a,n,r;return null!==(a=null===e||void 0===e||null===(n=e[t])||void 0===n||null===(r=n[o])||void 0===r?void 0:r.fueRecuperada)&&void 0!==a&&a},obtenerOriginal:function(e,t,o){var a,n,r=null===e||void 0===e||null===(a=e[t])||void 0===a||null===(n=a[o])||void 0===n?void 0:n.original;return"number"===typeof r?r.toFixed(1):"0.0"},obtenerRecuperacion:function(e,t,o){var a,n,r=null===e||void 0===e||null===(a=e[t])||void 0===a||null===(n=a[o])||void 0===n?void 0:n.recuperacion;return"number"===typeof r?r.toFixed(1):"0.0"},obtenerColor:function(e,t,o,a){var n,r,s=null===t||void 0===t||null===(n=t[o])||void 0===n||null===(r=n[a])||void 0===r?void 0:r.idTipoEspecialidad;return 1===s?e<this.datosSeccion.minBas?"desempeno-bajo":e<this.datosSeccion.minAlt?"desempeno-basico":e<this.datosSeccion.minSup?"desempeno-alto":e<=this.datosSeccion.maxSup?"desempeno-superior":"desempeno-extra":e<this.datosSeccion.minBasT?"desempeno-bajo":e<this.datosSeccion.minAltT?"desempeno-basico":e<this.datosSeccion.minSupT?"desempeno-alto":e<=this.datosSeccion.maxSupT?"desempeno-superior":"desempeno-extra"},claseDesempeno:function(e){return console.log(e),"number"!==typeof e?"desempeno-extra":e<3?"desempeno-bajo":e<4?"desempeno-basico":e<4.6?"desempeno-alto":e<=5?"desempeno-superior":"desempeno-extra"},obtenerColorGeneral:function(e){return e<this.datosSeccion.minBas?"desempeno-bajo":e<this.datosSeccion.minAlt?"desempeno-basico":e<this.datosSeccion.minSup?"desempeno-alto":e<=this.datosSeccion.maxSup?"desempeno-superior":"desempeno-extra"},consultarEstudiantes:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.btnCargando=!0,1==e.idPeriodo&&(e.periodosVisibles=[1]),2==e.idPeriodo&&(e.periodosVisibles=[1,2]),3==e.idPeriodo&&(e.periodosVisibles=[1,2,3]),4==e.idPeriodo&&(e.periodosVisibles=[1,2,3,4]),e.nombreSede=document.getElementById("sedes")[document.getElementById("sedes").selectedIndex].text,null==e.idCurso){t.next=15;break}return e.nombreCurso=document.getElementById("cursos")[document.getElementById("cursos").selectedIndex].text,e.$store.state.datosCursos.forEach((function(t){t.id==e.idCurso&&(e.idNivel=t.id_nivel)})),e.listaAreasAsignaturas=[],t.next=12,s.a.get(i["d"]+"consolidados/areasasignaturas/curso",{params:{idCurso:e.idCurso}}).then((function(t){t.data.error?(e.mensajeEmergente("danger",i["h"],t.data.mensaje+" - Lista areas-asignaturas curso"),e.btnCargando=!1):0!=t.data.datos&&t.data.datos.forEach((function(t){"eb58bf60-fc83-11ec-a1d1-1dc2835404e5"==e.$store.state.idInstitucion?99!=t.orden&&90!=t.orden&&e.listaAreasAsignaturas.push(t):"f5529ba0-fcb3-11ec-8267-536b07c743c4"==e.$store.state.idInstitucion?99!=t.orden&&15!=t.orden&&16!=t.orden&&98!=t.orden&&e.listaAreasAsignaturas.push(t):"097b7b10-fcaa-11ec-8267-536b07c743c4"==e.$store.state.idInstitucion?99!=t.orden&&98!=t.orden&&e.listaAreasAsignaturas.push(t):("54fd7440-fc81-11ec-a1d1-1dc2835404e5"==e.$store.state.idInstitucion||"7c63ed50-fcb0-11ec-8267-536b07c743c4"==e.$store.state.idInstitucion||99!=t.orden)&&e.listaAreasAsignaturas.push(t)}))})).catch((function(t){e.mensajeEmergente("danger",i["h"],"Algo salio mal y no se pudo realizar: Lista areas-asignaturas curso. Intente m√°s tarde."+t),e.btnCargando=!1}));case 12:return e.datosRaw=[],t.next=15,s.a.get(i["d"]+"consolidados/asignaturas/curso/acumulado",{params:{idCurso:e.idCurso,periodo:e.idPeriodo,vigencia:e.$store.state.aLectivo}}).then((function(t){t.data.error?(e.mensajeEmergente("danger",i["h"],t.data.mensaje+" - Consolidados asignaturas curso periodo"),e.btnCargando=!1):0!=t.data.datos&&(e.datosRaw=t.data.datos)})).catch((function(t){e.mensajeEmergente("danger",i["h"],"Algo salio mal y no se pudo realizar: Consolidados asignaturas curso periodo. Intente m√°s tarde."+t),e.btnCargando=!1}));case 15:e.btnCargando=!1;case 16:case"end":return t.stop()}}),t)})))()},imprimir:function(){var e="Fecha: "+(new Date).toLocaleString(),t="CONSOLIDADO EVALUACIONES FINALES POR ASIGNATURAS",o=document.querySelector("table").outerHTML,a=window.open("Consolidados","_blank");a.document.write('<html><head><title>Imprimir</title></head>\n      <style scoped>\n        table {\n          border-collapse: collapse;\n          width: 100%;\n          text-align: center;\n          font-size: 10px;\n        }\n        th {\n          background: #eee;\n        }\n        .nota-recuperada {\n          border: 2px solid #ffa500;\n          box-shadow: 0 0 5px #ffa500;\n        }\n        .desempeno-bajo { background-color: #f8d7da; color: #721c24; }\n        .desempeno-basico { background-color: #d1ecf1; color: #0c5460; }\n        .desempeno-alto { background-color: #fff3cd; color: #856404; }\n        .desempeno-superior { background-color: #d4edda; color: #155724; }\n        .desempeno-extra { background-color: #f4ecf5; color: #2f2e2e; }\n      </style>\n        <body class="container">\n          <p style="text-align: center; font-size: 12px;">SECRETAR√çA DE EDUCACI√ìN TERRITORIAL DE TUNJA<br><b>'.concat(this.$store.state.nombreInstitucion,"</b><br>TUNJA - BOYAC√Å<br>").concat(t,"<br>Sede: ").concat(this.nombreSede," | Curso: ").concat(this.nombreCurso," | A√±o Lectivo ").concat(this.$store.state.aLectivo," | Periodo: FINAL</p>\n          ").concat(o,'\n          <div style="text-align: right; font-size: 12px;"><i>').concat(e,"</i></div>\n        </body>\n      </html>")),a.document.close(),a.print()},exportarAExcel:function(){var e=document.querySelector("table"),t=p["utils"].table_to_book(e);p["writeFile"](t,"ConsoldidaFinal.xlsx")},redondear:function(e){var t=Number((10*Math.abs(e)).toPrecision(15));return Math.round(t)/10*Math.sign(e)},ocuparComboCursosSede:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.comboCursosSede=[],e.$store.state.datosCursos.forEach((function(t){t.id_sede==e.idSede&&e.comboCursosSede.push({value:t.id,text:t.nomenclatura.toUpperCase()})}));case 2:case"end":return t.stop()}}),t)})))()},ocuparComboSedes:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.comboSedes=[],e.$store.state.datosSedes.forEach((function(t){e.comboSedes.push({value:t.id,text:t.sede.toUpperCase()})}));case 2:case"end":return t.stop()}}),t)})))()},ocuparComboPeriodos:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.comboPeriodos=[],e.$store.state.periodos.forEach((function(t){e.comboPeriodos.push({value:t.id,text:t.periodo.toUpperCase()})}));case 2:case"end":return t.stop()}}),t)})))()},mensajeEmergente:function(e,t,o){this.$bvToast.toast(o,{title:t,variant:e,toaster:"b-toaster-top-center",solid:!0,autoHideDelay:4e3,appendToast:!1})}},computed:{totales:function(){return this.totalesGlobales()},estudiantesNotas:function(){var e=this,t={};return this.datosRaw.forEach((function(o){var a=o.estudiante,n=o.area,r=o.asignatura,s=o.periodo,i=o.definitiva,c=o.recuperacion,d=o.orden,u=o.definitivacompor,l=o.definitivapree,m=o.idTipoEspecialidad,p=o.ausJ,b=o.ausS,f=o.porcentaje,v=o.id_conceptual;t[a]||(t[a]={id_conceptual:v,ausJ:0,ausS:0,areas:{}}),t[a].areas[n]||(t[a].areas[n]={asignaturas:{}}),t[a].areas[n].asignaturas[r]||(t[a].areas[n].asignaturas[r]={periodos:{},orden:d,idTipoEspecialidad:m,porcentaje:f,pesos:{1:e.datosSeccion.pesoP1,2:e.datosSeccion.pesoP2,3:e.datosSeccion.pesoP3,4:e.datosSeccion.pesoP4}});var h=0;h=99===d?1==e.datosSeccion.tipoValComp?i:null!=u?u:"":1==e.idNivel?null!=l&&0!=l&&""!=l?l:"":c>i?c:i,t[a].areas[n].asignaturas[r].periodos[s]=h,t[a].ausJ+=p||0,t[a].ausS+=b||0})),t},totalColumnasPromedioArea:function(){var e=new Set(this.listaAreasAsignaturas.map((function(e){return e.area})));return e.size},puestosPorEstudiante:function(){var e=this,t=Object.entries(this.estudiantesNotas).map((function(t){var o=Object(u["a"])(t,2),a=o[0],n=o[1],r=parseFloat(e.calcularPromedioGeneral(n));return{nombre:a,promedio:isNaN(r)?0:r}}));t.sort((function(e,t){return t.promedio-e.promedio}));var o={},a=1,n=1,r=null;return t.forEach((function(e){e.promedio!==r&&(a=n,r=e.promedio,n++),o[e.nombre]=a})),o},encabezadoPorArea:function(){var e={};return this.listaAreasAsignaturas.forEach((function(t){var o=t.area,a=t.asignatura;e[o]||(e[o]=[]),e[o].push(a)})),e}},beforeMount:function(){this.ocuparComboSedes(),this.ocuparComboPeriodos(),this.datosSeccion=this.$store.state.datosSecciones[this.$store.state.idSeccion-1]}},Be=Ie,Fe=(o("2460"),Object(v["a"])(Be,Oe,Re,!1,null,"ae2d58f6",null)),De=Fe.exports,$e=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("b-row",{staticClass:"mt-2"},[o("b-col",{attrs:{lg:"12"}},[o("b-card",{scopedSlots:e._u([{key:"header",fn:function(){return[o("h5",{staticClass:"mb-0"},[o("b-icon",{attrs:{icon:"card-checklist","aria-hidden":"true"}}),e._v(" CONSOLIDADO EVALUACIONES FINALES")],1)]},proxy:!0}])},[o("b-card-text",[o("b-row",[o("b-col",{attrs:{lg:"6"}},[o("b-form-group",{staticClass:"etiqueta",attrs:{label:"Seleccione la Sede:","label-for":"sedes"}},[o("b-form-select",{ref:"sedes",attrs:{id:"sedes",options:e.comboSedes},on:{change:function(t){e.idCurso=null,e.ocuparComboCursosSede()}},model:{value:e.idSede,callback:function(t){e.idSede=t},expression:"idSede"}})],1)],1),o("b-col",{attrs:{lg:"4"}},[o("b-form-group",{staticClass:"etiqueta",attrs:{label:"Seleccione el Curso:","label-for":"cursos"}},[o("b-form-select",{ref:"cursos",attrs:{id:"cursos",options:e.comboCursosSede,disabled:null==e.idSede},on:{change:function(t){return e.consultarEstudiantes()}},model:{value:e.idCurso,callback:function(t){e.idCurso=t},expression:"idCurso"}})],1)],1)],1)],1)],1)],1)],1),o("b-row",[o("b-col",{attrs:{lg:"12"}},[e.btnCargando?o("div",[o("div",{staticClass:"text-center m-5 text-primary"},[o("b-spinner",{staticStyle:{width:"3rem",height:"3rem"},attrs:{label:"Spinner"}}),o("br"),o("strong",[e._v("Cargando informe...")])],1)]):e._e()])],1),e.btnCargando||null==e.idCurso?e._e():o("b-row",[o("b-col",{attrs:{lg:"12"}},[o("table",{staticClass:"table-responsive",attrs:{border:"1",cellspacing:"0",cellpadding:"1"}},[o("thead",[o("tr",[o("th",{attrs:{rowspan:"3"}},[e._v("#")]),o("th",{attrs:{rowspan:"3"}},[e._v("Estudiante")]),e._l(e.encabezadoPorArea,(function(t,a){return[o("th",{key:a,attrs:{colspan:e.colspanArea(a)}},[e._v(" "+e._s(a)+" ")])]})),o("th",{attrs:{rowspan:"3"}},[e._v("PRO GEN")]),o("th",{attrs:{rowspan:"3"}},[e._v("Tot"),o("br"),e._v("Asig"),o("br"),e._v("Baj")]),o("th",{attrs:{rowspan:"3"}},[e._v("Tot"),o("br"),e._v("Asig"),o("br"),e._v("Bas")]),o("th",{attrs:{rowspan:"3"}},[e._v("Tot"),o("br"),e._v("Asig"),o("br"),e._v("Alt")]),o("th",{attrs:{rowspan:"3"}},[e._v("Tot"),o("br"),e._v("Asig"),o("br"),e._v("Sup")]),o("th",{attrs:{rowspan:"3"}},[e._v("Tot"),o("br"),e._v("AuJ")]),o("th",{attrs:{rowspan:"3"}},[e._v("Tot"),o("br"),e._v("AuS")]),o("th",{attrs:{rowspan:"3"}},[e._v("Puesto")]),o("th",{attrs:{rowspan:"3"}},[e._v("#")])],2),o("tr",[e._l(e.encabezadoPorArea,(function(t,a){return[e._l(t,(function(t,a){return[o("th",{key:"area-"+t+a,attrs:{colspan:e.periodosVisibles.length+1}},[e._v(" "+e._s(t)+" ")])]})),o("th",{key:"prom-area-"+a,staticClass:"promedio-area"},[e._v("PRO AR")])]}))],2),o("tr",[e._l(e.encabezadoPorArea,(function(t,a){return[e._l(t,(function(t){return[e._l(e.periodosVisibles,(function(n){return o("th",{key:"h"+a+t+n},[e._v(" P"+e._s(n)+" ")])})),o("th",{key:"prom"+t+a},[e._v("PR")])]})),o("th",{key:"prom"+a})]}))],2)]),o("tbody",[e._l(e.estudiantesNotas,(function(t,a,n){return o("tr",{key:a},[o("td",{staticClass:"text-left"},[e._v(e._s(n+1))]),o("td",{staticStyle:{"text-align":"left"}},[e._v(e._s(a))]),e._l(e.encabezadoPorArea,(function(n,r){return[e._l(n,(function(n){return[e._l(e.periodosVisibles,(function(s){return o("td",{key:a+r+n+s},[e._v(" "+e._s("N"==t.id_conceptual?e.obtenerNota(t,r,n,s):"-")+" ")])})),o("td",{key:"prom"+a+r+n,staticClass:"bloque-area",staticStyle:{"font-weight":"bold","text-align":"center"}},[e._v(" "+e._s("N"==t.id_conceptual?e.obtenerPromedioAsignatura(t,r,n):"-")+" ")])]})),o("td",{key:"promArea"+a+r,staticClass:"promedio-area bloque-area"},[e._v(" "+e._s("N"==t.id_conceptual?e.obtenerPromedioArea(t,r):"-")+" ")])]})),o("td",[e._v(e._s("N"==t.id_conceptual?e.calcularPromedioGeneral(t):"-"))]),o("td",[e._v(e._s("N"==t.id_conceptual?e.contarDesempenoEstudiante(t.areas,"bajo"):"-"))]),o("td",[e._v(e._s("N"==t.id_conceptual?e.contarDesempenoEstudiante(t.areas,"basico"):"-"))]),o("td",[e._v(e._s("N"==t.id_conceptual?e.contarDesempenoEstudiante(t.areas,"alto"):"-"))]),o("td",[e._v(e._s("N"==t.id_conceptual?e.contarDesempenoEstudiante(t.areas,"superior"):"-"))]),o("td",[e._v(e._s("N"==t.id_conceptual?t.ausJ:"-"))]),o("td",[e._v(e._s("N"==t.id_conceptual?t.ausS:"-"))]),o("td",[e._v(e._s("N"==t.id_conceptual?e.iconoPuesto(e.puestosPorEstudiante[a]):"-")+" "+e._s("N"==t.id_conceptual?e.puestosPorEstudiante[a]:"-"))]),o("td",{staticClass:"text-left"},[e._v(e._s(n+1))])],2)})),o("tr",{staticStyle:{"background-color":"#f0f0f0","font-weight":"bold"}},[o("td",{attrs:{colspan:"2"}},[e._v("Total Bajos")]),e._l(e.encabezadoPorArea,(function(t,a){return[e._l(t,(function(t){return[e._l(e.periodosVisibles,(function(n){return o("td",{key:"bp"+a+t+n},[e._v(" "+e._s(e.totalBajosPorPeriodo(a,t,n))+" ")])})),o("td",{key:"bj"+a+t},[e._v(" "+e._s(e.totalBajosPromedioAsignatura(a,t))+" ")])]})),o("td",{key:"bja"+a,staticClass:"promedio-area"},[e._v(" "+e._s(e.totalBajosPromedioArea(a))+" ")])]})),o("td"),e._v(" "),o("td",[e._v(e._s(e.totales.bajo))]),o("td",[e._v(e._s(e.totales.basico))]),o("td",[e._v(e._s(e.totales.alto))]),o("td",[e._v(e._s(e.totales.superior))]),o("td",[e._v(e._s(e.totales.ausJ))]),o("td",[e._v(e._s(e.totales.ausS))]),o("td"),e._v(" "),o("td")],2)],2)]),o("div",{staticStyle:{"margin-bottom":"1rem"}},[o("b-button",{staticClass:"small mx-1 mt-3",attrs:{variant:"primary"},on:{click:e.imprimir}},[e._v("Imprimir Consolidado")]),o("b-button",{staticClass:"small mx-1 mt-3",attrs:{variant:"outline-primary"},on:{click:e.exportarAExcel}},[e._v("Exportar a Excel")])],1)])],1)],1)},Le=[],Je={name:"consolidadopromedio",components:{},data:function(){return{idSede:null,comboSedes:[],idPeriodo:5,comboPeriodos:null,idCurso:null,comboCursosSede:[],nombreSede:null,nombreCurso:null,idNivel:null,btnCargando:!1,datosRaw:[],datosSeccion:{},listaAreasAsignaturas:[],periodosVisibles:[]}},methods:{colspanArea:function(e){var t=this.encabezadoPorArea[e]||[],o=this.periodosVisibles.length+1,a=1;return t.length*o+a},totalBajosPorPeriodo:function(e,t,o){var a=this,n=0,r=this.listaAreasAsignaturas.find((function(o){return o.area===e&&o.asignatura===t})),s=null===r||void 0===r?void 0:r.idTipoEspecialidad;return Object.values(this.estudiantesNotas).forEach((function(r){var i,c,d,u,l,m=null===r||void 0===r||null===(i=r.areas)||void 0===i||null===(c=i[e])||void 0===c||null===(d=c.asignaturas)||void 0===d||null===(u=d[t])||void 0===u||null===(l=u.periodos)||void 0===l?void 0:l[o];1===s?m>0&&m<a.datosSeccion.minBas&&n++:m>0&&m<a.datosSeccion.minBasT&&n++})),n},totalBajosPromedioAsignatura:function(e,t){var o=this,a=0,n=this.listaAreasAsignaturas.find((function(o){return o.area===e&&o.asignatura===t})),r=null===n||void 0===n?void 0:n.idTipoEspecialidad;return Object.values(this.estudiantesNotas).forEach((function(n){var s,i,c,d=null===n||void 0===n||null===(s=n.areas)||void 0===s||null===(i=s[e])||void 0===i||null===(c=i.asignaturas)||void 0===c?void 0:c[t];if(d){var u=parseFloat(o.calcularPromedioAsignatura(d));1===r?u<o.datosSeccion.minBas&&a++:u<o.datosSeccion.minBasT&&a++}})),a},totalBajosPromedioArea:function(e){var t=this,o=0;return Object.values(this.estudiantesNotas).forEach((function(a){var n=parseFloat(t.obtenerPromedioArea(a,e));!isNaN(n)&&n<t.datosSeccion.minBas&&o++})),o},totalesGlobales:function(){var e=this,t=0,o=0,a=0,n=0,r=0,s=0;return Object.values(this.estudiantesNotas).forEach((function(i){t+=e.contarDesempenoEstudiante(i.areas,"bajo"),o+=e.contarDesempenoEstudiante(i.areas,"basico"),a+=e.contarDesempenoEstudiante(i.areas,"alto"),n+=e.contarDesempenoEstudiante(i.areas,"superior"),r+=i.ausJ||0,s+=i.ausS||0})),{bajo:t,basico:o,alto:a,superior:n,ausJ:r,ausS:s}},esAreaValida:function(e){var t=this.listaAreasAsignaturas.filter((function(t){return t.area===e}));return!!t.some((function(e){return 99!==e.orden&&98!==e.orden}))||!(!t.some((function(e){return 99===e.orden}))||1!=this.datosSeccion.promCompor)},obtenerPromedioArea:function(e,t){var o=e.areas&&e.areas[t];return o?this.calcularPromedioArea(o):""},obtenerNota:function(e,t,o,a){var n,r,s,i,c,d=null===e||void 0===e||null===(n=e.areas)||void 0===n||null===(r=n[t])||void 0===r||null===(s=r.asignaturas)||void 0===s||null===(i=s[o])||void 0===i||null===(c=i.periodos)||void 0===c?void 0:c[a];return 0===d&&(d=""),"number"===typeof d?d.toFixed(1):d},obtenerPromedioAsignatura:function(e,t,o){var a,n,r,s=null===e||void 0===e||null===(a=e.areas)||void 0===a||null===(n=a[t])||void 0===n||null===(r=n.asignaturas)||void 0===r?void 0:r[o];return s?this.calcularPromedioAsignatura(s):""},calcularPromedioAsignatura:function(e){var t=e.pesos,o=e.periodos,a=e.orden;if(99===a)return"-";for(var n=0,r=1;r<=4;r++){var s,i=null!==(s=o[r])&&void 0!==s?s:0;n+=i*t[r]/100}return n.toFixed(1)},calcularPromedioArea:function(e){var t=this,o=Object.values(e.asignaturas);if(!o.length)return"0.00";var a=0;return o.forEach((function(e){if(99===e.orden&&0==t.datosSeccion.promCompor)return"-";a+=parseFloat(t.calcularPromedioAsignatura(e)*e.porcentaje/100)})),a>0?this.redondear(a).toFixed(1):""},calcularPromedioGeneral:function(e){var t=this,o=Object.keys(e.areas||{}),a=0,n=0;return o.forEach((function(o){if(t.esAreaValida(o)){var r=parseFloat(t.calcularPromedioArea(e.areas[o]));isNaN(r)||(a+=r,n++)}})),n>0?(a/n).toFixed(3):""},contarAusencias:function(e){var t=0;return Object.values(this.estudiantesNotas).forEach((function(o){"ausJ"===e&&(t+=o.ausJ||0),"ausS"===e&&(t+=o.ausS||0)})),t},contarNotasPorAsignatura:function(e,t,o){var a=this,n=0;return Object.values(this.estudiantesNotas).forEach((function(r){var s,i,c,d,u=null===r||void 0===r||null===(s=r[e])||void 0===s||null===(i=s[t])||void 0===i?void 0:i.nota,l=null===r||void 0===r||null===(c=r[e])||void 0===c||null===(d=c[t])||void 0===d?void 0:d.idTipoEspecialidad;"number"===typeof u&&(1===l?("bajo"===o&&u<a.datosSeccion.minBas||"basico"===o&&u>=a.datosSeccion.minBas&&u<a.datosSeccion.minAlt||"alto"===o&&u>=a.datosSeccion.minAlt&&u<a.datosSeccion.minSup||"superior"===o&&u>=a.datosSeccion.minSup&&u<=a.datosSeccion.maxSup)&&n++:("bajo"===o&&u<a.datosSeccion.minBasT||"basico"===o&&u>=a.datosSeccion.minBasT&&u<a.datosSeccion.minAltT||"alto"===o&&u>=a.datosSeccion.minAltT&&u<a.datosSeccion.minSupT||"superior"===o&&u>=a.datosSeccion.minSupT&&u<=a.datosSeccion.maxSupT)&&n++)})),n},contarNotasTotales:function(e){var t=this,o=0;return Object.values(this.estudiantesNotas).forEach((function(a){t.listaAreasAsignaturas.forEach((function(n){var r,s,i,c,d=n.area,u=n.asignatura,l=null===a||void 0===a||null===(r=a[d])||void 0===r||null===(s=r[u])||void 0===s?void 0:s.nota,m=null===a||void 0===a||null===(i=a[d])||void 0===i||null===(c=i[u])||void 0===c?void 0:c.idTipoEspecialidad;"number"===typeof l&&(1===m?("bajo"===e&&l<t.datosSeccion.minBas||"basico"===e&&l>=t.datosSeccion.minBas&&l<t.datosSeccion.minAlt||"alto"===e&&l>=t.datosSeccion.minAlt&&l<t.datosSeccion.minSup||"superior"===e&&l>=t.datosSeccion.minSup&&l<=t.datosSeccion.maxSup)&&o++:("bajo"===e&&l<t.datosSeccion.minBasT||"basico"===e&&l>=t.datosSeccion.minBasT&&l<t.datosSeccion.minAltT||"alto"===e&&l>=t.datosSeccion.minAltT&&l<t.datosSeccion.minSupT||"superior"===e&&l>=t.datosSeccion.minSupT&&l<=t.datosSeccion.maxSupT)&&o++)}))})),o},iconoPuesto:function(e){return 1===e?"ü•á":2===e?"ü•à":3===e?"ü•â":""},contarDesempenoEstudiante:function(e,t){var o=this,a=0;return Object.values(e||{}).forEach((function(e){Object.values(e.asignaturas||{}).forEach((function(e){var n=parseFloat(o.calcularPromedioAsignatura(e)),r=e.idTipoEspecialidad;"number"===typeof n&&(1===r?("bajo"===t&&n<o.datosSeccion.minBas||"basico"===t&&n>=o.datosSeccion.minBas&&n<o.datosSeccion.minAlt||"alto"===t&&n>=o.datosSeccion.minAlt&&n<o.datosSeccion.minSup||"superior"===t&&n>=o.datosSeccion.minSup&&n<=o.datosSeccion.maxSup)&&a++:("bajo"===t&&n<o.datosSeccion.minBasT||"basico"===t&&n>=o.datosSeccion.minBasT&&n<o.datosSeccion.minAltT||"alto"===t&&n>=o.datosSeccion.minAltT&&n<o.datosSeccion.minSupT||"superior"===t&&n>=o.datosSeccion.minSupT&&n<=o.datosSeccion.maxSupT)&&a++)}))})),a},fueRecuperada:function(e,t,o){var a,n,r;return null!==(a=null===e||void 0===e||null===(n=e[t])||void 0===n||null===(r=n[o])||void 0===r?void 0:r.fueRecuperada)&&void 0!==a&&a},obtenerOriginal:function(e,t,o){var a,n,r=null===e||void 0===e||null===(a=e[t])||void 0===a||null===(n=a[o])||void 0===n?void 0:n.original;return"number"===typeof r?r.toFixed(1):"0.0"},obtenerRecuperacion:function(e,t,o){var a,n,r=null===e||void 0===e||null===(a=e[t])||void 0===a||null===(n=a[o])||void 0===n?void 0:n.recuperacion;return"number"===typeof r?r.toFixed(1):"0.0"},obtenerColor:function(e,t,o,a){var n,r,s=null===t||void 0===t||null===(n=t[o])||void 0===n||null===(r=n[a])||void 0===r?void 0:r.idTipoEspecialidad;return 1===s?e<this.datosSeccion.minBas?"desempeno-bajo":e<this.datosSeccion.minAlt?"desempeno-basico":e<this.datosSeccion.minSup?"desempeno-alto":e<=this.datosSeccion.maxSup?"desempeno-superior":"desempeno-extra":e<this.datosSeccion.minBasT?"desempeno-bajo":e<this.datosSeccion.minAltT?"desempeno-basico":e<this.datosSeccion.minSupT?"desempeno-alto":e<=this.datosSeccion.maxSupT?"desempeno-superior":"desempeno-extra"},claseDesempeno:function(e){return console.log(e),"number"!==typeof e?"desempeno-extra":e<3?"desempeno-bajo":e<4?"desempeno-basico":e<4.6?"desempeno-alto":e<=5?"desempeno-superior":"desempeno-extra"},obtenerColorGeneral:function(e){return e<this.datosSeccion.minBas?"desempeno-bajo":e<this.datosSeccion.minAlt?"desempeno-basico":e<this.datosSeccion.minSup?"desempeno-alto":e<=this.datosSeccion.maxSup?"desempeno-superior":"desempeno-extra"},consultarEstudiantes:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.btnCargando=!0,1==e.idPeriodo&&(e.periodosVisibles=[1]),2==e.idPeriodo&&(e.periodosVisibles=[1,2]),3==e.idPeriodo&&(e.periodosVisibles=[1,2,3]),4==e.idPeriodo&&(e.periodosVisibles=[1,2,3,4]),e.nombreSede=document.getElementById("sedes")[document.getElementById("sedes").selectedIndex].text,null==e.idCurso){t.next=15;break}return e.nombreCurso=document.getElementById("cursos")[document.getElementById("cursos").selectedIndex].text,e.$store.state.datosCursos.forEach((function(t){t.id==e.idCurso&&(e.idNivel=t.id_nivel)})),e.listaAreasAsignaturas=[],t.next=12,s.a.get(i["d"]+"consolidados/areasasignaturas/curso",{params:{idCurso:e.idCurso}}).then((function(t){t.data.error?(e.mensajeEmergente("danger",i["h"],t.data.mensaje+" - Lista areas-asignaturas curso"),e.btnCargando=!1):0!=t.data.datos&&t.data.datos.forEach((function(t){99!=t.orden&&e.listaAreasAsignaturas.push(t)}))})).catch((function(t){e.mensajeEmergente("danger",i["h"],"Algo salio mal y no se pudo realizar: Lista areas-asignaturas curso. Intente m√°s tarde."+t),e.btnCargando=!1}));case 12:return e.datosRaw=[],t.next=15,s.a.get(i["d"]+"consolidados/asignaturas/curso/acumulado",{params:{idCurso:e.idCurso,periodo:e.idPeriodo,vigencia:e.$store.state.aLectivo}}).then((function(t){t.data.error?(e.mensajeEmergente("danger",i["h"],t.data.mensaje+" - Consolidados asignaturas curso periodo"),e.btnCargando=!1):0!=t.data.datos&&(e.datosRaw=t.data.datos)})).catch((function(t){e.mensajeEmergente("danger",i["h"],"Algo salio mal y no se pudo realizar: Consolidados asignaturas curso periodo. Intente m√°s tarde."+t),e.btnCargando=!1}));case 15:e.btnCargando=!1;case 16:case"end":return t.stop()}}),t)})))()},imprimir:function(){var e="Fecha: "+(new Date).toLocaleString(),t="CONSOLIDADO EVALUACIONES FINALES",o=document.querySelector("table").outerHTML,a=window.open("Consolidados","_blank");a.document.write('<html><head><title>Imprimir</title></head>\n      <style scoped>\n        table {\n          border-collapse: collapse;\n          width: 100%;\n          text-align: center;\n          font-size: 10px;\n        }\n        th {\n          background: #eee;\n        }\n        .nota-recuperada {\n          border: 2px solid #ffa500;\n          box-shadow: 0 0 5px #ffa500;\n        }\n        .desempeno-bajo { background-color: #f8d7da; color: #721c24; }\n        .desempeno-basico { background-color: #d1ecf1; color: #0c5460; }\n        .desempeno-alto { background-color: #fff3cd; color: #856404; }\n        .desempeno-superior { background-color: #d4edda; color: #155724; }\n        .desempeno-extra { background-color: #f4ecf5; color: #2f2e2e; }\n      </style>\n        <body class="container">\n          <p style="text-align: center; font-size: 12px;">SECRETAR√çA DE EDUCACI√ìN TERRITORIAL DE TUNJA<br><b>'.concat(this.$store.state.nombreInstitucion,"</b><br>TUNJA - BOYAC√Å<br>").concat(t,"<br>Sede: ").concat(this.nombreSede," | Curso: ").concat(this.nombreCurso," | A√±o Lectivo ").concat(this.$store.state.aLectivo," | Periodo: FINAL</p>\n          ").concat(o,'\n          <div style="text-align: right; font-size: 12px;"><i>').concat(e,"</i></div>\n        </body>\n      </html>")),a.document.close(),a.print()},exportarAExcel:function(){var e=document.querySelector("table"),t=p["utils"].table_to_book(e);p["writeFile"](t,"ConsoldidaFinal.xlsx")},redondear:function(e){var t=Number((10*Math.abs(e)).toPrecision(15));return Math.round(t)/10*Math.sign(e)},ocuparComboCursosSede:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.comboCursosSede=[],e.$store.state.datosCursos.forEach((function(t){t.id_sede==e.idSede&&e.comboCursosSede.push({value:t.id,text:t.nomenclatura.toUpperCase()})}));case 2:case"end":return t.stop()}}),t)})))()},ocuparComboSedes:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.comboSedes=[],e.$store.state.datosSedes.forEach((function(t){e.comboSedes.push({value:t.id,text:t.sede.toUpperCase()})}));case 2:case"end":return t.stop()}}),t)})))()},ocuparComboPeriodos:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.comboPeriodos=[],e.$store.state.periodos.forEach((function(t){e.comboPeriodos.push({value:t.id,text:t.periodo.toUpperCase()})}));case 2:case"end":return t.stop()}}),t)})))()},mensajeEmergente:function(e,t,o){this.$bvToast.toast(o,{title:t,variant:e,toaster:"b-toaster-top-center",solid:!0,autoHideDelay:4e3,appendToast:!1})}},computed:{totales:function(){return this.totalesGlobales()},estudiantesNotas:function(){var e=this,t={};return this.datosRaw.forEach((function(o){var a=o.estudiante,n=o.area,r=o.asignatura,s=o.periodo,i=o.definitiva,c=o.recuperacion,d=o.orden,u=o.definitivacompor,l=o.definitivapree,m=o.idTipoEspecialidad,p=o.ausJ,b=o.ausS,f=o.porcentaje,v=o.id_conceptual;t[a]||(t[a]={id_conceptual:v,ausJ:0,ausS:0,areas:{}}),t[a].areas[n]||(t[a].areas[n]={asignaturas:{}}),t[a].areas[n].asignaturas[r]||(t[a].areas[n].asignaturas[r]={periodos:{},orden:d,idTipoEspecialidad:m,porcentaje:f,pesos:{1:.2,2:.2,3:.3,4:.3}});var h=0;h=99===d?1==e.datosSeccion.tipoValComp?i:null!=u?u:"":1==e.idNivel?null!=l&&0!=l&&""!=l?l:"":c>i?c:i,t[a].areas[n].asignaturas[r].periodos[s]=h,t[a].ausJ+=p||0,t[a].ausS+=b||0})),t},totalColumnasPromedioArea:function(){var e=new Set(this.listaAreasAsignaturas.map((function(e){return e.area})));return e.size},puestosPorEstudiante:function(){var e=this,t=Object.entries(this.estudiantesNotas).map((function(t){var o=Object(u["a"])(t,2),a=o[0],n=o[1],r=parseFloat(e.calcularPromedioGeneral(n));return{nombre:a,promedio:isNaN(r)?0:r}}));t.sort((function(e,t){return t.promedio-e.promedio}));var o={},a=1,n=1,r=null;return t.forEach((function(e){e.promedio!==r&&(a=n,r=e.promedio,n++),o[e.nombre]=a})),o},encabezadoPorArea:function(){var e={};return this.listaAreasAsignaturas.forEach((function(t){var o=t.area,a=t.asignatura;e[o]||(e[o]=[]),e[o].push(a)})),e}},beforeMount:function(){this.ocuparComboSedes(),this.ocuparComboPeriodos(),this.datosSeccion=this.$store.state.datosSecciones[this.$store.state.idSeccion-1]}},ze=Je,Ue=(o("30c3"),Object(v["a"])(ze,$e,Le,!1,null,"fbc2034a",null)),Me=Ue.exports,Ve=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("b-row",{staticClass:"mt-2"},[o("b-col",{attrs:{lg:"12"}},[o("b-card",{scopedSlots:e._u([{key:"header",fn:function(){return[o("h5",{staticClass:"mb-0"},[o("b-icon",{attrs:{icon:"card-checklist","aria-hidden":"true"}}),e._v(" CONSOLIDADO EVALUACIONES FINALES")],1)]},proxy:!0}])},[o("b-card-text",[o("b-row",[o("b-col",{attrs:{lg:"6"}},[o("b-form-group",{staticClass:"etiqueta",attrs:{label:"Seleccione la Sede:","label-for":"sedes"}},[o("b-form-select",{ref:"sedes",attrs:{id:"sedes",options:e.comboSedes,disabled:null==e.idPeriodo},on:{change:function(t){e.idCurso=null,e.ocuparComboCursosSede()}},model:{value:e.idSede,callback:function(t){e.idSede=t},expression:"idSede"}})],1)],1),o("b-col",{attrs:{lg:"4"}},[o("b-form-group",{staticClass:"etiqueta",attrs:{label:"Seleccione el Curso:","label-for":"cursos"}},[o("b-form-select",{ref:"cursos",attrs:{id:"cursos",options:e.comboCursosSede,disabled:null==e.idSede},on:{change:function(t){return e.consultarEstudiantes()}},model:{value:e.idCurso,callback:function(t){e.idCurso=t},expression:"idCurso"}})],1)],1)],1)],1)],1)],1)],1),o("b-row",[o("b-col",{attrs:{lg:"12"}},[e.btnCargando?o("div",[o("div",{staticClass:"text-center m-5 text-primary"},[o("b-spinner",{staticStyle:{width:"3rem",height:"3rem"},attrs:{label:"Spinner"}}),o("br"),o("strong",[e._v("Cargando informe...")])],1)]):e._e()])],1),e.btnCargando||null==e.idCurso?e._e():o("b-row",[o("b-col",{attrs:{lg:"12"}},[o("table",{staticClass:"table-responsive",attrs:{border:"1",cellspacing:"0",cellpadding:"1"}},[o("thead",[o("tr",[o("th",{attrs:{rowspan:"3"}},[e._v("#")]),o("th",{attrs:{rowspan:"3"}},[e._v("Estudiante")]),e._l(e.encabezadoPorArea,(function(t,a){return[o("th",{key:a,attrs:{colspan:5*t.length+1}},[e._v(e._s(a))])]})),o("th",{attrs:{rowspan:"2"}},[e._v("AuJ")]),o("th",{attrs:{rowspan:"2"}},[e._v("AuS")])],2),o("tr",[e._l(e.encabezadoPorArea,(function(t,a){return[e._l(t,(function(t,a){return[o("th",{key:"area-"+t+a,attrs:{colspan:"5"}},[e._v(e._s(t))])]})),o("th",{key:"prom-area-"+a,attrs:{rowspan:"2"}},[e._v("PRO AR")])]}))],2),o("tr",[e._l(e.encabezadoPorArea,(function(t,a){return[e._l(t,(function(t){return[o("th",{key:"p1"+t+a},[e._v("P1")]),o("th",{key:"p2"+t+a},[e._v("P2")]),o("th",{key:"p3"+t+a},[e._v("P3")]),o("th",{key:"p4"+t+a},[e._v("P4")]),o("th",{key:"prom"+t+a},[e._v("PR")])]}))]})),o("th"),e._v(" "),o("th")],2)]),o("tbody",e._l(e.estudiantesNotas,(function(t,a,n){return o("tr",{key:a},[o("td",{staticClass:"text-left"},[e._v(e._s(n+1))]),o("td",{staticStyle:{"text-align":"left"}},[e._v(e._s(a))]),e._l(e.encabezadoPorArea,(function(n,r){return[e._l(n,(function(n){return[e._l([1,2,3,4],(function(s){return o("td",{key:a+r+n+s},[e._v(" "+e._s(e.obtenerNota(t,r,n,s))+" ")])})),o("td",{key:"prom"+a+r+n},[e._v(" "+e._s(e.obtenerPromedioAsignatura(t,r,n))+" ")])]})),o("td",{key:"promArea"+a+r},[e._v(" "+e._s(e.obtenerPromedioArea(t,r))+" ")])]})),o("td",[e._v(e._s(t.ausJ))]),o("td",[e._v(e._s(t.ausS))])],2)})),0)]),o("div",{staticStyle:{"margin-bottom":"1rem"}},[o("b-button",{staticClass:"small mx-1 mt-3",attrs:{variant:"primary"},on:{click:e.imprimir}},[e._v("Imprimir Consolidado")]),o("b-button",{staticClass:"small mx-1 mt-3",attrs:{variant:"outline-primary"},on:{click:e.exportarAExcel}},[e._v("Exportar a Excel")])],1)])],1)],1)},qe=[],Ge={name:"consolidadoponderado",components:{},data:function(){return{idSede:null,comboSedes:[],idPeriodo:5,comboPeriodos:null,idCurso:null,comboCursosSede:[],nombreSede:null,nombreCurso:null,idNivel:null,btnCargando:!1,datosRaw:[],datosSeccion:{},listaAreasAsignaturas:[]}},methods:{obtenerPromedioArea:function(e,t){var o=e.areas&&e.areas[t];return o?this.calcularPromedioArea(o):"0.00"},obtenerNota:function(e,t,o,a){var n,r,s,i,c,d=null===e||void 0===e||null===(n=e.areas)||void 0===n||null===(r=n[t])||void 0===r||null===(s=r.asignaturas)||void 0===s||null===(i=s[o])||void 0===i||null===(c=i.periodos)||void 0===c?void 0:c[a];return"number"===typeof d?d.toFixed(1):d},obtenerPromedioAsignatura:function(e,t,o){var a,n,r,s=null===e||void 0===e||null===(a=e.areas)||void 0===a||null===(n=a[t])||void 0===n||null===(r=n.asignaturas)||void 0===r?void 0:r[o];return s?this.calcularPromedioAsignatura(s):"0.00"},calcularPromedioAsignatura:function(e){var t=e.pesos,o=e.periodos,a=e.orden;if(99===a)return"";for(var n=0,r=1;r<=4;r++){var s,i=null!==(s=o[r])&&void 0!==s?s:0;n+=i*t[r]/100}return n.toFixed(1)},calcularPromedioArea:function(e){var t=this,o=Object.values(e.asignaturas);if(!o.length)return"0.00";var a=0;return o.forEach((function(e){a+=parseFloat(t.calcularPromedioAsignatura(e))})),(a/o.length).toFixed(1)},calcularPromedioGeneral:function(e){var t=this,o=Object.values(e.areas);if(!o.length)return"0.00";var a=0;return o.forEach((function(e){a+=parseFloat(t.calcularPromedioArea(e))})),(a/o.length).toFixed(2)},contarAusencias:function(e){var t=0;return Object.values(this.estudiantesNotas).forEach((function(o){"ausJ"===e&&(t+=o.ausJ||0),"ausS"===e&&(t+=o.ausS||0)})),t},contarNotasPorAsignatura:function(e,t,o){var a=this,n=0;return Object.values(this.estudiantesNotas).forEach((function(r){var s,i,c,d,u=null===r||void 0===r||null===(s=r[e])||void 0===s||null===(i=s[t])||void 0===i?void 0:i.nota,l=null===r||void 0===r||null===(c=r[e])||void 0===c||null===(d=c[t])||void 0===d?void 0:d.idTipoEspecialidad;"number"===typeof u&&(1===l?("bajo"===o&&u<a.datosSeccion.minBas||"basico"===o&&u>=a.datosSeccion.minBas&&u<a.datosSeccion.minAlt||"alto"===o&&u>=a.datosSeccion.minAlt&&u<a.datosSeccion.minSup||"superior"===o&&u>=a.datosSeccion.minSup&&u<=a.datosSeccion.maxSup)&&n++:("bajo"===o&&u<a.datosSeccion.minBasT||"basico"===o&&u>=a.datosSeccion.minBasT&&u<a.datosSeccion.minAltT||"alto"===o&&u>=a.datosSeccion.minAltT&&u<a.datosSeccion.minSupT||"superior"===o&&u>=a.datosSeccion.minSupT&&u<=a.datosSeccion.maxSupT)&&n++)})),n},contarNotasTotales:function(e){var t=this,o=0;return Object.values(this.estudiantesNotas).forEach((function(a){t.listaAreasAsignaturas.forEach((function(n){var r,s,i,c,d=n.area,u=n.asignatura,l=null===a||void 0===a||null===(r=a[d])||void 0===r||null===(s=r[u])||void 0===s?void 0:s.nota,m=null===a||void 0===a||null===(i=a[d])||void 0===i||null===(c=i[u])||void 0===c?void 0:c.idTipoEspecialidad;"number"===typeof l&&(1===m?("bajo"===e&&l<t.datosSeccion.minBas||"basico"===e&&l>=t.datosSeccion.minBas&&l<t.datosSeccion.minAlt||"alto"===e&&l>=t.datosSeccion.minAlt&&l<t.datosSeccion.minSup||"superior"===e&&l>=t.datosSeccion.minSup&&l<=t.datosSeccion.maxSup)&&o++:("bajo"===e&&l<t.datosSeccion.minBasT||"basico"===e&&l>=t.datosSeccion.minBasT&&l<t.datosSeccion.minAltT||"alto"===e&&l>=t.datosSeccion.minAltT&&l<t.datosSeccion.minSupT||"superior"===e&&l>=t.datosSeccion.minSupT&&l<=t.datosSeccion.maxSupT)&&o++)}))})),o},iconoPuesto:function(e){return 1===e?"ü•á":2===e?"ü•à":3===e?"ü•â":""},contarDesempenoEstudiante:function(e,t){var o=this,a=0;return this.listaAreasAsignaturas.forEach((function(n){var r,s,i,c,d=n.area,u=n.asignatura,l=null===e||void 0===e||null===(r=e[d])||void 0===r||null===(s=r[u])||void 0===s?void 0:s.nota,m=null===e||void 0===e||null===(i=e[d])||void 0===i||null===(c=i[u])||void 0===c?void 0:c.idTipoEspecialidad;"number"===typeof l&&(1===m?("bajo"===t&&l<o.datosSeccion.minBas||"basico"===t&&l>=o.datosSeccion.minBas&&l<o.datosSeccion.minAlt||"alto"===t&&l>=o.datosSeccion.minAlt&&l<o.datosSeccion.minSup||"superior"===t&&l>=o.datosSeccion.minSup&&l<=o.datosSeccion.maxSup)&&a++:("bajo"===t&&l<o.datosSeccion.minBasT||"basico"===t&&l>=o.datosSeccion.minBasT&&l<o.datosSeccion.minAltT||"alto"===t&&l>=o.datosSeccion.minAltT&&l<o.datosSeccion.minSupT||"superior"===t&&l>=o.datosSeccion.minSupT&&l<=o.datosSeccion.maxSupT)&&a++)})),a},fueRecuperada:function(e,t,o){var a,n,r;return null!==(a=null===e||void 0===e||null===(n=e[t])||void 0===n||null===(r=n[o])||void 0===r?void 0:r.fueRecuperada)&&void 0!==a&&a},obtenerOriginal:function(e,t,o){var a,n,r=null===e||void 0===e||null===(a=e[t])||void 0===a||null===(n=a[o])||void 0===n?void 0:n.original;return"number"===typeof r?r.toFixed(1):"0.0"},obtenerRecuperacion:function(e,t,o){var a,n,r=null===e||void 0===e||null===(a=e[t])||void 0===a||null===(n=a[o])||void 0===n?void 0:n.recuperacion;return"number"===typeof r?r.toFixed(1):"0.0"},obtenerColor:function(e,t,o,a){var n,r,s=null===t||void 0===t||null===(n=t[o])||void 0===n||null===(r=n[a])||void 0===r?void 0:r.idTipoEspecialidad;return 1===s?e<this.datosSeccion.minBas?"desempeno-bajo":e<this.datosSeccion.minAlt?"desempeno-basico":e<this.datosSeccion.minSup?"desempeno-alto":e<=this.datosSeccion.maxSup?"desempeno-superior":"desempeno-extra":e<this.datosSeccion.minBasT?"desempeno-bajo":e<this.datosSeccion.minAltT?"desempeno-basico":e<this.datosSeccion.minSupT?"desempeno-alto":e<=this.datosSeccion.maxSupT?"desempeno-superior":"desempeno-extra"},obtenerColorGeneral:function(e){return e<this.datosSeccion.minBas?"desempeno-bajo":e<this.datosSeccion.minAlt?"desempeno-basico":e<this.datosSeccion.minSup?"desempeno-alto":e<=this.datosSeccion.maxSup?"desempeno-superior":"desempeno-extra"},consultarEstudiantes:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.btnCargando=!0,e.nombreSede=document.getElementById("sedes")[document.getElementById("sedes").selectedIndex].text,null==e.idCurso){t.next=11;break}return e.nombreCurso=document.getElementById("cursos")[document.getElementById("cursos").selectedIndex].text,e.$store.state.datosCursos.forEach((function(t){t.id==e.idCurso&&(e.idNivel=t.id_nivel)})),e.listaAreasAsignaturas=[],t.next=8,s.a.get(i["d"]+"consolidados/areasasignaturas/curso",{params:{idCurso:e.idCurso}}).then((function(t){t.data.error?(e.mensajeEmergente("danger",i["h"],t.data.mensaje+" - Lista areas-asignaturas curso"),e.btnCargando=!1):0!=t.data.datos&&t.data.datos.forEach((function(t){99!=t.orden&&e.listaAreasAsignaturas.push(t)}))})).catch((function(t){e.mensajeEmergente("danger",i["h"],"Algo salio mal y no se pudo realizar: Lista areas-asignaturas curso. Intente m√°s tarde."+t),e.btnCargando=!1}));case 8:return e.datosRaw=[],t.next=11,s.a.get(i["d"]+"consolidados/asignaturas/curso/acumulado",{params:{idCurso:e.idCurso,periodo:e.idPeriodo,vigencia:e.$store.state.aLectivo}}).then((function(t){t.data.error?(e.mensajeEmergente("danger",i["h"],t.data.mensaje+" - Consolidados asignaturas curso periodo"),e.btnCargando=!1):0!=t.data.datos&&(e.datosRaw=t.data.datos)})).catch((function(t){e.mensajeEmergente("danger",i["h"],"Algo salio mal y no se pudo realizar: Consolidados asignaturas curso periodo. Intente m√°s tarde."+t),e.btnCargando=!1}));case 11:e.btnCargando=!1;case 12:case"end":return t.stop()}}),t)})))()},imprimir:function(){var e="Fecha: "+(new Date).toLocaleString(),t="CONSOLIDADO EVALUACIONES FINALES",o=document.querySelector("table").outerHTML,a=window.open("Consolidados","_blank");a.document.write('<html><head><title>Imprimir</title></head>\n      <style scoped>\n        table {\n          border-collapse: collapse;\n          width: 100%;\n          text-align: center;\n          font-size: 10px;\n        }\n        th {\n          background: #eee;\n        }\n        .nota-recuperada {\n          border: 2px solid #ffa500;\n          box-shadow: 0 0 5px #ffa500;\n        }\n        .desempeno-bajo { background-color: #f8d7da; color: #721c24; }\n        .desempeno-basico { background-color: #d1ecf1; color: #0c5460; }\n        .desempeno-alto { background-color: #fff3cd; color: #856404; }\n        .desempeno-superior { background-color: #d4edda; color: #155724; }\n        .desempeno-extra { background-color: #f4ecf5; color: #2f2e2e; }\n      </style>\n        <body class="container">\n          <p style="text-align: center; font-size: 12px;">SECRETAR√çA DE EDUCACI√ìN TERRITORIAL DE TUNJA<br><b>'.concat(this.$store.state.nombreInstitucion,"</b><br>TUNJA - BOYAC√Å<br>").concat(t,"<br>Sede: ").concat(this.nombreSede," | Curso: ").concat(this.nombreCurso," | A√±o Lectivo ").concat(this.$store.state.aLectivo," | Periodo: FINAL</p>\n          ").concat(o,'\n          <div style="text-align: right; font-size: 12px;"><i>').concat(e,"</i></div>\n        </body>\n      </html>")),a.document.close(),a.print()},exportarAExcel:function(){var e=document.querySelector("table"),t=p["utils"].table_to_book(e);p["writeFile"](t,"ConsolidadoFinal.xlsx")},redondear:function(e){var t=Number((10*Math.abs(e)).toPrecision(15));return Math.round(t)/10*Math.sign(e)},ocuparComboCursosSede:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.comboCursosSede=[],e.$store.state.datosCursos.forEach((function(t){t.id_sede==e.idSede&&e.comboCursosSede.push({value:t.id,text:t.nomenclatura.toUpperCase()})}));case 2:case"end":return t.stop()}}),t)})))()},ocuparComboSedes:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.comboSedes=[],e.$store.state.datosSedes.forEach((function(t){e.comboSedes.push({value:t.id,text:t.sede.toUpperCase()})}));case 2:case"end":return t.stop()}}),t)})))()},ocuparComboPeriodos:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.comboPeriodos=[],e.$store.state.periodos.forEach((function(t){e.comboPeriodos.push({value:t.id,text:t.periodo.toUpperCase()})}));case 2:case"end":return t.stop()}}),t)})))()},mensajeEmergente:function(e,t,o){this.$bvToast.toast(o,{title:t,variant:e,toaster:"b-toaster-top-center",solid:!0,autoHideDelay:4e3,appendToast:!1})}},computed:{estudiantesNotas:function(){var e=this,t={};return this.datosRaw.forEach((function(o){var a=o.estudiante,n=o.area,r=o.asignatura,s=o.periodo,i=o.definitiva,c=o.recuperacion,d=o.orden,u=o.definitivacompor,l=(o.idTipoEspecialidad,o.ausJ),m=o.ausS;t[a]||(t[a]={ausJ:0,ausS:0,areas:{}}),t[a].areas[n]||(t[a].areas[n]={asignaturas:{}}),t[a].areas[n].asignaturas[r]||(t[a].areas[n].asignaturas[r]={periodos:{},orden:d,pesos:{1:e.datosSeccion.pesoP1,2:e.datosSeccion.pesoP2,3:e.datosSeccion.pesoP3,4:e.datosSeccion.pesoP4}});var p=0;p=99===d?null!=u?u:"":c>i?c:i,t[a].areas[n].asignaturas[r].periodos[s]=p,t[a].ausJ+=l||0,t[a].ausS+=m||0})),t},totalColumnasPromedioArea:function(){var e=new Set(this.listaAreasAsignaturas.map((function(e){return e.area})));return e.size},puestosPorEstudiante:function(){var e=this,t=Object.entries(this.estudiantesNotas).map((function(t){var o=Object(u["a"])(t,2),a=o[0],n=o[1],r=parseFloat(e.calcularPromedioGeneral(n));return{nombre:a,promedio:isNaN(r)?0:r}}));t.sort((function(e,t){return t.promedio-e.promedio}));var o={},a=1,n=1,r=null;return t.forEach((function(e){e.promedio!==r&&(a=n,r=e.promedio),o[e.nombre]=a,n++})),o},encabezadoPorArea:function(){var e={};return this.listaAreasAsignaturas.forEach((function(t){var o=t.area,a=t.asignatura;e[o]||(e[o]=[]),e[o].push(a)})),e}},beforeMount:function(){this.ocuparComboSedes(),this.ocuparComboPeriodos(),this.datosSeccion=this.$store.state.datosSecciones[this.$store.state.idSeccion-1]}},He=Ge,Ye=(o("6c0e"),Object(v["a"])(He,Ve,qe,!1,null,"63f0d732",null)),Ke=Ye.exports,Qe=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("b-row",{staticClass:"mt-2"},[o("b-col",{attrs:{lg:"12"}},[o("b-card",{scopedSlots:e._u([{key:"header",fn:function(){return[o("h5",{staticClass:"mb-0"},[o("b-icon",{attrs:{icon:"card-checklist","aria-hidden":"true"}}),e._v(" CONSOLIDADO EVALUACIONES FINALES POR ASIGNATURA")],1)]},proxy:!0}])},[o("b-card-text",[o("b-row",[o("b-col",{attrs:{lg:"6"}},[o("b-form-group",{staticClass:"etiqueta",attrs:{label:"Seleccione la Sede:","label-for":"sedes"}},[o("b-form-select",{ref:"sedes",attrs:{id:"sedes",options:e.comboSedes},on:{change:function(t){e.idCurso=null,e.ocuparComboCursosSede()}},model:{value:e.idSede,callback:function(t){e.idSede=t},expression:"idSede"}})],1)],1),o("b-col",{attrs:{lg:"4"}},[o("b-form-group",{staticClass:"etiqueta",attrs:{label:"Seleccione el Curso:","label-for":"cursos"}},[o("b-form-select",{ref:"cursos",attrs:{id:"cursos",options:e.comboCursosSede,disabled:null==e.idSede},on:{change:function(t){return e.consultarEstudiantes()}},model:{value:e.idCurso,callback:function(t){e.idCurso=t},expression:"idCurso"}})],1)],1)],1)],1)],1)],1)],1),o("b-row",[o("b-col",{attrs:{lg:"12"}},[e.btnCargando?o("div",[o("div",{staticClass:"text-center m-5 text-primary"},[o("b-spinner",{staticStyle:{width:"3rem",height:"3rem"},attrs:{label:"Spinner"}}),o("br"),o("strong",[e._v("Cargando informe...")])],1)]):e._e()])],1),e.btnCargando||null==e.idCurso?e._e():o("b-row",[o("b-col",{attrs:{lg:"12"}},[o("table",{staticClass:"table-responsive",attrs:{border:"1",cellspacing:"0",cellpadding:"1"}},[o("thead",[o("tr",[o("th",{attrs:{rowspan:"3"}},[e._v("#")]),o("th",{attrs:{rowspan:"3"}},[e._v("Estudiante")]),o("th",{attrs:{rowspan:"3"}},[e._v("Tot"),o("br"),e._v("Asig"),o("br"),e._v("Baj")]),o("th",{attrs:{rowspan:"3"}},[e._v("Asignaturas Perdidas")]),o("th",{attrs:{rowspan:"3"}},[e._v("PRO GEN")]),o("th",{attrs:{rowspan:"3"}},[e._v("Tot"),o("br"),e._v("AuJ")]),o("th",{attrs:{rowspan:"3"}},[e._v("Tot"),o("br"),e._v("AuS")]),o("th",{attrs:{rowspan:"3"}},[e._v("Puesto")]),o("th",{attrs:{rowspan:"3"}},[e._v("#")])])]),o("tbody",[e._l(e.estudiantesNotas,(function(t,a,n){return o("tr",{key:a},[o("td",{staticClass:"text-left"},[e._v(e._s(n+1))]),o("td",{staticStyle:{"text-align":"left"}},[e._v(e._s(a))]),o("td",[e._v(e._s("N"==t.id_conceptual?e.contarDesempenoEstudiante(t.areas,"bajo"):"-"))]),o("td",{staticStyle:{"text-align":"left"}},[e._v(e._s("N"==t.id_conceptual?e.mostrarNotasPorAsignaturaPerdidas(t.areas,"bajo"):"-"))]),o("td",[e._v(e._s("N"==t.id_conceptual?e.calcularPromedioGeneral(t):"-"))]),o("td",[e._v(e._s("N"==t.id_conceptual?t.ausJ:"-"))]),o("td",[e._v(e._s("N"==t.id_conceptual?t.ausS:"-"))]),o("td",[e._v(e._s("N"==t.id_conceptual?e.iconoPuesto(e.puestosPorEstudiante[a]):"-")+" "+e._s("N"==t.id_conceptual?e.puestosPorEstudiante[a]:"-"))]),o("td",{staticClass:"text-left"},[e._v(e._s(n+1))])])})),o("tr",{staticStyle:{"background-color":"#f0f0f0","font-weight":"bold"}},[o("td",{attrs:{colspan:"2"}},[e._v("Total Bajos")]),o("td",[e._v(e._s(e.totales.bajo))]),o("td"),o("td"),o("td",[e._v(e._s(e.totales.ausJ))]),o("td",[e._v(e._s(e.totales.ausS))]),o("td"),o("td")])],2)]),o("div",{staticStyle:{"margin-bottom":"1rem"}},[o("b-button",{staticClass:"small mx-1 mt-3",attrs:{variant:"primary"},on:{click:e.imprimir}},[e._v("Imprimir Consolidado")]),o("b-button",{staticClass:"small mx-1 mt-3",attrs:{variant:"outline-primary"},on:{click:e.exportarAExcel}},[e._v("Exportar a Excel")])],1)])],1)],1)},We=[],Xe={name:"consolidadopromedio",components:{},data:function(){return{idSede:null,comboSedes:[],idPeriodo:5,comboPeriodos:null,idCurso:null,comboCursosSede:[],nombreSede:null,nombreCurso:null,idNivel:null,btnCargando:!1,datosRaw:[],datosSeccion:{},listaAreasAsignaturas:[],periodosVisibles:[]}},methods:{colspanArea:function(e){var t=this.encabezadoPorArea[e]||[],o=this.periodosVisibles.length+1,a=1;return t.length*o+a},totalBajosPorPeriodo:function(e,t,o){var a=this,n=0,r=this.listaAreasAsignaturas.find((function(o){return o.area===e&&o.asignatura===t})),s=null===r||void 0===r?void 0:r.idTipoEspecialidad;return Object.values(this.estudiantesNotas).forEach((function(r){var i,c,d,u,l,m=null===r||void 0===r||null===(i=r.areas)||void 0===i||null===(c=i[e])||void 0===c||null===(d=c.asignaturas)||void 0===d||null===(u=d[t])||void 0===u||null===(l=u.periodos)||void 0===l?void 0:l[o];1===s?m>0&&m<a.datosSeccion.minBas&&n++:m>0&&m<a.datosSeccion.minBasT&&n++})),n},totalBajosPromedioAsignatura:function(e,t){var o=this,a=0,n=this.listaAreasAsignaturas.find((function(o){return o.area===e&&o.asignatura===t})),r=null===n||void 0===n?void 0:n.idTipoEspecialidad;return Object.values(this.estudiantesNotas).forEach((function(n){var s,i,c,d=null===n||void 0===n||null===(s=n.areas)||void 0===s||null===(i=s[e])||void 0===i||null===(c=i.asignaturas)||void 0===c?void 0:c[t];if(d){var u=parseFloat(o.calcularPromedioAsignatura(d));1===r?u<o.datosSeccion.minBas&&a++:u<o.datosSeccion.minBasT&&a++}})),a},totalBajosPromedioArea:function(e){var t=this,o=0;return Object.values(this.estudiantesNotas).forEach((function(a){var n=parseFloat(t.obtenerPromedioArea(a,e));!isNaN(n)&&n<t.datosSeccion.minBas&&o++})),o},totalesGlobales:function(){var e=this,t=0,o=0,a=0,n=0,r=0,s=0;return Object.values(this.estudiantesNotas).forEach((function(i){t+=e.contarDesempenoEstudiante(i.areas,"bajo"),o+=e.contarDesempenoEstudiante(i.areas,"basico"),a+=e.contarDesempenoEstudiante(i.areas,"alto"),n+=e.contarDesempenoEstudiante(i.areas,"superior"),r+=i.ausJ||0,s+=i.ausS||0})),{bajo:t,basico:o,alto:a,superior:n,ausJ:r,ausS:s}},esAreaValida:function(e){var t=this.listaAreasAsignaturas.filter((function(t){return t.area===e}));return!!t.some((function(e){return 99!==e.orden&&98!==e.orden}))||!(!t.some((function(e){return 99===e.orden}))||1!=this.datosSeccion.promCompor)},obtenerPromedioArea:function(e,t){var o=e.areas&&e.areas[t];return o?this.calcularPromedioArea(o):""},calcularPromedioArea:function(e){var t=this,o=Object.values(e.asignaturas);if(!o.length)return"0.00";var a=0;return o.forEach((function(e){if(99===e.orden&&0==t.datosSeccion.promCompor)return"-";a+=parseFloat(t.calcularPromedioAsignatura(e)*e.porcentaje/100)})),a>0?this.redondear(a).toFixed(1):""},obtenerNota:function(e,t,o,a){var n,r,s,i,c,d=null===e||void 0===e||null===(n=e.areas)||void 0===n||null===(r=n[t])||void 0===r||null===(s=r.asignaturas)||void 0===s||null===(i=s[o])||void 0===i||null===(c=i.periodos)||void 0===c?void 0:c[a];return 0===d&&(d=""),"number"===typeof d?d.toFixed(1):d},obtenerPromedioAsignatura:function(e,t,o){var a,n,r,s=null===e||void 0===e||null===(a=e.areas)||void 0===a||null===(n=a[t])||void 0===n||null===(r=n.asignaturas)||void 0===r?void 0:r[o];return s?this.calcularPromedioAsignatura(s):""},calcularPromedioAsignatura:function(e){var t=e.pesos,o=e.periodos,a=e.orden;if(99===a&&0==this.datosSeccion.promCompor)return"-";var n=0;if("acaa36d0-fcb1-11ec-8267-536b07c743c4"==this.$store.state.idInstitucion){for(var r=1;r<=4;r++){var s,i=null!==(s=o[r])&&void 0!==s?s:0;n+=i*t[r]/100}return this.redondear(n).toFixed(1)}if("eb58bf60-fc83-11ec-a1d1-1dc2835404e5"==this.$store.state.idInstitucion){if(55==a){for(var c=0,d=1;d<=4;d++){var u,l=null!==(u=o[d])&&void 0!==u?u:0;l>0&&(n+=l,c++)}return 0===n?"":(n/=c,this.redondear(n).toFixed(1))}for(var m=1;m<=4;m++){var p,b=null!==(p=o[m])&&void 0!==p?p:0;n+=b*t[m]/100}return this.redondear(n).toFixed(1)}if("c50f3d80-fca0-11ec-8267-536b07c743c4"==this.$store.state.idInstitucion){var f,v=null!==(f=o[5])&&void 0!==f?f:0;return v>0?v.toFixed(1):""}if("8a1bd1e0-fcb2-11ec-8267-536b07c743c4"==this.$store.state.idInstitucion){var h,S=null!==(h=o[5])&&void 0!==h?h:0;return S>0?S.toFixed(1):""}for(var g=0,C=1;C<=4;C++){var A,_=null!==(A=o[C])&&void 0!==A?A:0;_>0&&(n+=_,g++)}if(0===n)return"";var x=n/g;return this.redondear(x).toFixed(1)},calcularPromedioGeneral:function(e){var t=this,o=Object.keys(e.areas||{}),a=0,n=0;return o.forEach((function(o){if(t.esAreaValida(o)){var r=parseFloat(t.calcularPromedioArea(e.areas[o]));isNaN(r)||(a+=r,n++)}})),n>0?(a/n).toFixed(3):""},contarAusencias:function(e){var t=0;return Object.values(this.estudiantesNotas).forEach((function(o){"ausJ"===e&&(t+=o.ausJ||0),"ausS"===e&&(t+=o.ausS||0)})),t},contarNotasPorAsignatura:function(e,t,o){var a=this,n=0;return Object.values(this.estudiantesNotas).forEach((function(r){var s,i,c,d,u=null===r||void 0===r||null===(s=r[e])||void 0===s||null===(i=s[t])||void 0===i?void 0:i.nota,l=null===r||void 0===r||null===(c=r[e])||void 0===c||null===(d=c[t])||void 0===d?void 0:d.idTipoEspecialidad;"number"===typeof u&&(1===l?("bajo"===o&&u<a.datosSeccion.minBas||"basico"===o&&u>=a.datosSeccion.minBas&&u<a.datosSeccion.minAlt||"alto"===o&&u>=a.datosSeccion.minAlt&&u<a.datosSeccion.minSup||"superior"===o&&u>=a.datosSeccion.minSup&&u<=a.datosSeccion.maxSup)&&n++:("bajo"===o&&u<a.datosSeccion.minBasT||"basico"===o&&u>=a.datosSeccion.minBasT&&u<a.datosSeccion.minAltT||"alto"===o&&u>=a.datosSeccion.minAltT&&u<a.datosSeccion.minSupT||"superior"===o&&u>=a.datosSeccion.minSupT&&u<=a.datosSeccion.maxSupT)&&n++)})),n},contarNotasTotales:function(e){var t=this,o=0;return Object.values(this.estudiantesNotas).forEach((function(a){t.listaAreasAsignaturas.forEach((function(n){var r,s,i,c,d=n.area,u=n.asignatura,l=null===a||void 0===a||null===(r=a[d])||void 0===r||null===(s=r[u])||void 0===s?void 0:s.nota,m=null===a||void 0===a||null===(i=a[d])||void 0===i||null===(c=i[u])||void 0===c?void 0:c.idTipoEspecialidad;"number"===typeof l&&(1===m?("bajo"===e&&l<t.datosSeccion.minBas||"basico"===e&&l>=t.datosSeccion.minBas&&l<t.datosSeccion.minAlt||"alto"===e&&l>=t.datosSeccion.minAlt&&l<t.datosSeccion.minSup||"superior"===e&&l>=t.datosSeccion.minSup&&l<=t.datosSeccion.maxSup)&&o++:("bajo"===e&&l<t.datosSeccion.minBasT||"basico"===e&&l>=t.datosSeccion.minBasT&&l<t.datosSeccion.minAltT||"alto"===e&&l>=t.datosSeccion.minAltT&&l<t.datosSeccion.minSupT||"superior"===e&&l>=t.datosSeccion.minSupT&&l<=t.datosSeccion.maxSupT)&&o++)}))})),o},iconoPuesto:function(e){return 1===e?"ü•á":2===e?"ü•à":3===e?"ü•â":""},contarDesempenoEstudiante:function(e,t){var o=this,a=0;return Object.values(e||{}).forEach((function(e){Object.values(e.asignaturas||{}).forEach((function(e){var n=parseFloat(o.calcularPromedioAsignatura(e)),r=e.idTipoEspecialidad,s=e.orden;"eb58bf60-fc83-11ec-a1d1-1dc2835404e5"==o.$store.state.idInstitucion&&90==s||"097b7b10-fcaa-11ec-8267-536b07c743c4"==o.$store.state.idInstitucion&&98==s||"number"===typeof n&&0!=n&&(1===r?("bajo"===t&&n<o.datosSeccion.minBas||"basico"===t&&n>=o.datosSeccion.minBas&&n<o.datosSeccion.minAlt||"alto"===t&&n>=o.datosSeccion.minAlt&&n<o.datosSeccion.minSup||"superior"===t&&n>=o.datosSeccion.minSup&&n<=o.datosSeccion.maxSup)&&a++:("bajo"===t&&n<o.datosSeccion.minBasT||"basico"===t&&n>=o.datosSeccion.minBasT&&n<o.datosSeccion.minAltT||"alto"===t&&n>=o.datosSeccion.minAltT&&n<o.datosSeccion.minSupT||"superior"===t&&n>=o.datosSeccion.minSupT&&n<=o.datosSeccion.maxSupT)&&a++)}))})),a},mostrarNotasPorAsignaturaPerdidas:function(e,t){var o=this,a="";return Object.values(e||{}).forEach((function(e){Object.values(e.asignaturas||{}).forEach((function(e){var n=e.orden,r=e.asignatura,s=e.idTipoEspecialidad;if("eb58bf60-fc83-11ec-a1d1-1dc2835404e5"!=o.$store.state.idInstitucion||90!=n){if(("54fd7440-fc81-11ec-a1d1-1dc2835404e5"==o.$store.state.idInstitucion||"7c63ed50-fcb0-11ec-8267-536b07c743c4"==o.$store.state.idInstitucion)&&99==n){var i=parseFloat(o.calcularPromedioAsignatura(e));if("number"!==typeof i)return;1===s?"bajo"===t&&i>0&&i<o.datosSeccion.minBas&&(a+=r+"("+i+") "):"bajo"===t&&i>0&&i<o.datosSeccion.minBasT&&(a+=r+"("+i+") ")}if(99!==n&&98!==n){var c=parseFloat(o.calcularPromedioAsignatura(e));if("number"!==typeof c)return;1===s?"bajo"===t&&c>0&&c<o.datosSeccion.minBas&&(a+=r+"("+c+") "):"bajo"===t&&c>0&&c<o.datosSeccion.minBasT&&(a+=r+"("+c+") ")}}}))})),a},fueRecuperada:function(e,t,o){var a,n,r;return null!==(a=null===e||void 0===e||null===(n=e[t])||void 0===n||null===(r=n[o])||void 0===r?void 0:r.fueRecuperada)&&void 0!==a&&a},obtenerOriginal:function(e,t,o){var a,n,r=null===e||void 0===e||null===(a=e[t])||void 0===a||null===(n=a[o])||void 0===n?void 0:n.original;return"number"===typeof r?r.toFixed(1):"0.0"},obtenerRecuperacion:function(e,t,o){var a,n,r=null===e||void 0===e||null===(a=e[t])||void 0===a||null===(n=a[o])||void 0===n?void 0:n.recuperacion;return"number"===typeof r?r.toFixed(1):"0.0"},obtenerColor:function(e,t,o,a){var n,r,s=null===t||void 0===t||null===(n=t[o])||void 0===n||null===(r=n[a])||void 0===r?void 0:r.idTipoEspecialidad;return 1===s?e<this.datosSeccion.minBas?"desempeno-bajo":e<this.datosSeccion.minAlt?"desempeno-basico":e<this.datosSeccion.minSup?"desempeno-alto":e<=this.datosSeccion.maxSup?"desempeno-superior":"desempeno-extra":e<this.datosSeccion.minBasT?"desempeno-bajo":e<this.datosSeccion.minAltT?"desempeno-basico":e<this.datosSeccion.minSupT?"desempeno-alto":e<=this.datosSeccion.maxSupT?"desempeno-superior":"desempeno-extra"},claseDesempeno:function(e){return console.log(e),"number"!==typeof e?"desempeno-extra":e<3?"desempeno-bajo":e<4?"desempeno-basico":e<4.6?"desempeno-alto":e<=5?"desempeno-superior":"desempeno-extra"},obtenerColorGeneral:function(e){return e<this.datosSeccion.minBas?"desempeno-bajo":e<this.datosSeccion.minAlt?"desempeno-basico":e<this.datosSeccion.minSup?"desempeno-alto":e<=this.datosSeccion.maxSup?"desempeno-superior":"desempeno-extra"},consultarEstudiantes:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.btnCargando=!0,1==e.idPeriodo&&(e.periodosVisibles=[1]),2==e.idPeriodo&&(e.periodosVisibles=[1,2]),3==e.idPeriodo&&(e.periodosVisibles=[1,2,3]),4==e.idPeriodo&&(e.periodosVisibles=[1,2,3,4]),e.nombreSede=document.getElementById("sedes")[document.getElementById("sedes").selectedIndex].text,null==e.idCurso){t.next=15;break}return e.nombreCurso=document.getElementById("cursos")[document.getElementById("cursos").selectedIndex].text,e.$store.state.datosCursos.forEach((function(t){t.id==e.idCurso&&(e.idNivel=t.id_nivel)})),e.listaAreasAsignaturas=[],t.next=12,s.a.get(i["d"]+"consolidados/areasasignaturas/curso",{params:{idCurso:e.idCurso}}).then((function(t){t.data.error?(e.mensajeEmergente("danger",i["h"],t.data.mensaje+" - Lista areas-asignaturas curso"),e.btnCargando=!1):0!=t.data.datos&&t.data.datos.forEach((function(t){"eb58bf60-fc83-11ec-a1d1-1dc2835404e5"==e.$store.state.idInstitucion?99!=t.orden&&90!=t.orden&&e.listaAreasAsignaturas.push(t):"f5529ba0-fcb3-11ec-8267-536b07c743c4"==e.$store.state.idInstitucion?99!=t.orden&&15!=t.orden&&16!=t.orden&&98!=t.orden&&e.listaAreasAsignaturas.push(t):"097b7b10-fcaa-11ec-8267-536b07c743c4"==e.$store.state.idInstitucion?99!=t.orden&&98!=t.orden&&e.listaAreasAsignaturas.push(t):("54fd7440-fc81-11ec-a1d1-1dc2835404e5"==e.$store.state.idInstitucion||"7c63ed50-fcb0-11ec-8267-536b07c743c4"==e.$store.state.idInstitucion||99!=t.orden)&&e.listaAreasAsignaturas.push(t)}))})).catch((function(t){e.mensajeEmergente("danger",i["h"],"Algo salio mal y no se pudo realizar: Lista areas-asignaturas curso. Intente m√°s tarde."+t),e.btnCargando=!1}));case 12:return e.datosRaw=[],t.next=15,s.a.get(i["d"]+"consolidados/asignaturas/curso/acumulado",{params:{idCurso:e.idCurso,periodo:e.idPeriodo,vigencia:e.$store.state.aLectivo}}).then((function(t){t.data.error?(e.mensajeEmergente("danger",i["h"],t.data.mensaje+" - Consolidados asignaturas curso periodo"),e.btnCargando=!1):0!=t.data.datos&&(e.datosRaw=t.data.datos)})).catch((function(t){e.mensajeEmergente("danger",i["h"],"Algo salio mal y no se pudo realizar: Consolidados asignaturas curso periodo. Intente m√°s tarde."+t),e.btnCargando=!1}));case 15:e.btnCargando=!1;case 16:case"end":return t.stop()}}),t)})))()},imprimir:function(){var e="Fecha: "+(new Date).toLocaleString(),t="INFORME DE ASIGNATURAS PERDIDAS",o=document.querySelector("table").outerHTML,a=window.open("Consolidados","_blank");a.document.write('<html><head><title>Imprimir</title></head>\n      <style scoped>\n        table {\n          border-collapse: collapse;\n          width: 100%;\n          text-align: center;\n          font-size: 10px;\n        }\n        th {\n          background: #eee;\n        }\n        .nota-recuperada {\n          border: 2px solid #ffa500;\n          box-shadow: 0 0 5px #ffa500;\n        }\n        .desempeno-bajo { background-color: #f8d7da; color: #721c24; }\n        .desempeno-basico { background-color: #d1ecf1; color: #0c5460; }\n        .desempeno-alto { background-color: #fff3cd; color: #856404; }\n        .desempeno-superior { background-color: #d4edda; color: #155724; }\n        .desempeno-extra { background-color: #f4ecf5; color: #2f2e2e; }\n      </style>\n        <body class="container">\n          <p style="text-align: center; font-size: 12px;">SECRETAR√çA DE EDUCACI√ìN TERRITORIAL DE TUNJA<br><b>'.concat(this.$store.state.nombreInstitucion,"</b><br>TUNJA - BOYAC√Å<br>").concat(t,"<br>Sede: ").concat(this.nombreSede," | Curso: ").concat(this.nombreCurso," | A√±o Lectivo ").concat(this.$store.state.aLectivo," | Periodo: FINAL</p>\n          ").concat(o,'\n          <div style="text-align: right; font-size: 12px;"><i>').concat(e,"</i></div>\n        </body>\n      </html>")),a.document.close(),a.print()},exportarAExcel:function(){var e=document.querySelector("table"),t=p["utils"].table_to_book(e);p["writeFile"](t,"ConsoldidaFinal.xlsx")},redondear:function(e){var t=Number((10*Math.abs(e)).toPrecision(15));return Math.round(t)/10*Math.sign(e)},ocuparComboCursosSede:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.comboCursosSede=[],e.$store.state.datosCursos.forEach((function(t){t.id_sede==e.idSede&&e.comboCursosSede.push({value:t.id,text:t.nomenclatura.toUpperCase()})}));case 2:case"end":return t.stop()}}),t)})))()},ocuparComboSedes:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.comboSedes=[],e.$store.state.datosSedes.forEach((function(t){e.comboSedes.push({value:t.id,text:t.sede.toUpperCase()})}));case 2:case"end":return t.stop()}}),t)})))()},ocuparComboPeriodos:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.comboPeriodos=[],e.$store.state.periodos.forEach((function(t){e.comboPeriodos.push({value:t.id,text:t.periodo.toUpperCase()})}));case 2:case"end":return t.stop()}}),t)})))()},mensajeEmergente:function(e,t,o){this.$bvToast.toast(o,{title:t,variant:e,toaster:"b-toaster-top-center",solid:!0,autoHideDelay:4e3,appendToast:!1})}},computed:{totales:function(){return this.totalesGlobales()},estudiantesNotas:function(){var e=this,t={};return this.datosRaw.forEach((function(o){var a=o.estudiante,n=o.area,r=o.asignatura,s=o.periodo,i=o.definitiva,c=o.recuperacion,d=o.orden,u=o.definitivacompor,l=o.definitivapree,m=o.idTipoEspecialidad,p=o.ausJ,b=o.ausS,f=o.porcentaje,v=o.id_conceptual;t[a]||(t[a]={id_conceptual:v,ausJ:0,ausS:0,areas:{}}),t[a].areas[n]||(t[a].areas[n]={asignaturas:{}}),t[a].areas[n].asignaturas[r]||(t[a].areas[n].asignaturas[r]={asignatura:r,periodos:{},orden:d,idTipoEspecialidad:m,porcentaje:f,pesos:{1:e.datosSeccion.pesoP1,2:e.datosSeccion.pesoP2,3:e.datosSeccion.pesoP3,4:e.datosSeccion.pesoP4}});var h=0;h=99===d?1==e.datosSeccion.tipoValComp?i:null!=u?u:"":1==e.idNivel?null!=l&&0!=l&&""!=l?l:"":c>i?c:i,t[a].areas[n].asignaturas[r].periodos[s]=h,t[a].ausJ+=p||0,t[a].ausS+=b||0})),t},totalColumnasPromedioArea:function(){var e=new Set(this.listaAreasAsignaturas.map((function(e){return e.area})));return e.size},puestosPorEstudiante:function(){var e=this,t=Object.entries(this.estudiantesNotas).map((function(t){var o=Object(u["a"])(t,2),a=o[0],n=o[1],r=parseFloat(e.calcularPromedioGeneral(n));return{nombre:a,promedio:isNaN(r)?0:r}}));t.sort((function(e,t){return t.promedio-e.promedio}));var o={},a=1,n=1,r=null;return t.forEach((function(e){e.promedio!==r&&(a=n,r=e.promedio,n++),o[e.nombre]=a})),o},encabezadoPorArea:function(){var e={};return this.listaAreasAsignaturas.forEach((function(t){var o=t.area,a=t.asignatura;e[o]||(e[o]=[]),e[o].push(a)})),e}},beforeMount:function(){this.ocuparComboSedes(),this.ocuparComboPeriodos(),this.datosSeccion=this.$store.state.datosSecciones[this.$store.state.idSeccion-1]}},Ze=Xe,et=(o("802b"),Object(v["a"])(Ze,Qe,We,!1,null,"4d1f46c6",null)),tt=et.exports,ot=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("b-row",{staticClass:"mt-2"},[o("b-col",{attrs:{lg:"12"}},[o("b-card",{scopedSlots:e._u([{key:"header",fn:function(){return[o("h5",{staticClass:"mb-0"},[o("b-icon",{attrs:{icon:"card-checklist","aria-hidden":"true"}}),e._v(" CONSOLIDADO EVALUACIONES FINALES DE AREAS")],1)]},proxy:!0}])},[o("b-card-text",[o("b-row",[o("b-col",{attrs:{lg:"6"}},[o("b-form-group",{staticClass:"etiqueta",attrs:{label:"Seleccione la Sede:","label-for":"sedes"}},[o("b-form-select",{ref:"sedes",attrs:{id:"sedes",options:e.comboSedes},on:{change:function(t){e.idCurso=null,e.ocuparComboCursosSede()}},model:{value:e.idSede,callback:function(t){e.idSede=t},expression:"idSede"}})],1)],1),o("b-col",{attrs:{lg:"4"}},[o("b-form-group",{staticClass:"etiqueta",attrs:{label:"Seleccione el Curso:","label-for":"cursos"}},[o("b-form-select",{ref:"cursos",attrs:{id:"cursos",options:e.comboCursosSede,disabled:null==e.idSede},on:{change:function(t){return e.consultarEstudiantes()}},model:{value:e.idCurso,callback:function(t){e.idCurso=t},expression:"idCurso"}})],1)],1)],1)],1)],1)],1)],1),o("b-row",[o("b-col",{attrs:{lg:"12"}},[e.btnCargando?o("div",[o("div",{staticClass:"text-center m-5 text-primary"},[o("b-spinner",{staticStyle:{width:"3rem",height:"3rem"},attrs:{label:"Spinner"}}),o("br"),o("strong",[e._v("Cargando informe...")])],1)]):e._e()])],1),e.btnCargando||null==e.idCurso?e._e():o("b-row",[o("b-col",{attrs:{lg:"12"}},[o("table",{staticClass:"table-responsive",attrs:{border:"1",cellspacing:"0",cellpadding:"1"}},[o("thead",[o("tr",[o("th",{attrs:{rowspan:"3"}},[e._v("#")]),o("th",{attrs:{rowspan:"3"}},[e._v("Estudiante")]),e._l(e.encabezadoPorArea,(function(t,a){return[o("th",{key:a,attrs:{colspan:e.colspanArea(a)}},[e._v(" "+e._s(a)+" ")])]})),o("th",{attrs:{rowspan:"3"}},[e._v("PRO GEN")]),o("th",{attrs:{rowspan:"3"}},[e._v("Tot"),o("br"),e._v("Area"),o("br"),e._v("Baj")]),o("th",{attrs:{rowspan:"3"}},[e._v("Tot"),o("br"),e._v("Area"),o("br"),e._v("Bas")]),o("th",{attrs:{rowspan:"3"}},[e._v("Tot"),o("br"),e._v("Area"),o("br"),e._v("Alt")]),o("th",{attrs:{rowspan:"3"}},[e._v("Tot"),o("br"),e._v("Area"),o("br"),e._v("Sup")]),o("th",{attrs:{rowspan:"3"}},[e._v("Tot"),o("br"),e._v("AuJ")]),o("th",{attrs:{rowspan:"3"}},[e._v("Tot"),o("br"),e._v("AuS")]),o("th",{attrs:{rowspan:"3"}},[e._v("Puesto")]),o("th",{attrs:{rowspan:"3"}},[e._v("#")])],2),o("tr",[e._l(e.encabezadoPorArea,(function(t,a){return[e._l(t,(function(t,a){return[o("th",{key:"area-"+t+a,attrs:{colspan:e.periodosVisibles.length+1}},[e._v(" "+e._s(t)+" ")])]})),o("th",{key:"prom-area-"+a,staticClass:"promedio-area"},[e._v("PRO AR")])]}))],2),o("tr",[e._l(e.encabezadoPorArea,(function(t,a){return[e._l(t,(function(t){return[e._l(e.periodosVisibles,(function(n){return o("th",{key:"h"+a+t+n},[e._v(" P"+e._s(n)+" ")])})),o("th",{key:"prom"+t+a},[e._v("PR")])]})),o("th",{key:"prom"+a})]}))],2)]),o("tbody",[e._l(e.estudiantesNotas,(function(t,a,n){return o("tr",{key:a},[o("td",{staticClass:"text-left"},[e._v(e._s(n+1))]),o("td",{staticStyle:{"text-align":"left"}},[e._v(e._s(a))]),e._l(e.encabezadoPorArea,(function(n,r){return[e._l(n,(function(n){return[e._l(e.periodosVisibles,(function(s){return o("td",{key:a+r+n+s},[e._v(" "+e._s("N"==t.id_conceptual?e.obtenerNota(t,r,n,s):"-")+" ")])})),o("td",{key:"prom"+a+r+n,staticClass:"bloque-area",staticStyle:{"font-weight":"bold","text-align":"center"}},[e._v(" "+e._s("N"==t.id_conceptual?e.obtenerPromedioAsignatura(t,r,n):"-")+" ")])]})),o("td",{key:"promArea"+a+r,staticClass:"promedio-area bloque-area"},[e._v(" "+e._s("N"==t.id_conceptual?e.obtenerPromedioArea(t,r):"-")+" ")])]})),o("td",[e._v(e._s("N"==t.id_conceptual?e.calcularPromedioGeneral(t):"-"))]),o("td",[e._v(e._s("N"==t.id_conceptual?e.contarDesempenoEstudianteArea(t,"bajo"):"-"))]),o("td",[e._v(e._s("N"==t.id_conceptual?e.contarDesempenoEstudianteArea(t,"basico"):"-"))]),o("td",[e._v(e._s("N"==t.id_conceptual?e.contarDesempenoEstudianteArea(t,"alto"):"-"))]),o("td",[e._v(e._s("N"==t.id_conceptual?e.contarDesempenoEstudianteArea(t,"superior"):"-"))]),o("td",[e._v(e._s("N"==t.id_conceptual?t.ausJ:"-"))]),o("td",[e._v(e._s("N"==t.id_conceptual?t.ausS:"-"))]),o("td",[e._v(e._s("N"==t.id_conceptual?e.iconoPuesto(e.puestosPorEstudiante[a]):"-")+" "+e._s("N"==t.id_conceptual?e.puestosPorEstudiante[a]:"-"))]),o("td",{staticClass:"text-left"},[e._v(e._s(n+1))])],2)})),o("tr",{staticStyle:{"background-color":"#f0f0f0","font-weight":"bold"}},[o("td",{attrs:{colspan:"2"}},[e._v("Total Bajos")]),e._l(e.encabezadoPorArea,(function(t,a){return[e._l(t,(function(t){return[e._l(e.periodosVisibles,(function(n){return o("td",{key:"bp"+a+t+n},[e._v(" "+e._s(e.totalBajosPorPeriodo(a,t,n))+" ")])})),o("td",{key:"bj"+a+t},[e._v(" "+e._s(e.totalBajosPromedioAsignatura(a,t))+" ")])]})),o("td",{key:"bja"+a,staticClass:"promedio-area"},[e._v(" "+e._s(e.totalBajosPromedioArea(a))+" ")])]})),o("td"),e._v(" "),o("td",[e._v(e._s(e.totales.bajo))]),o("td",[e._v(e._s(e.totales.basico))]),o("td",[e._v(e._s(e.totales.alto))]),o("td",[e._v(e._s(e.totales.superior))]),o("td",[e._v(e._s(e.totales.ausJ))]),o("td",[e._v(e._s(e.totales.ausS))]),o("td"),e._v(" "),o("td")],2)],2)]),o("div",{staticStyle:{"margin-bottom":"1rem"}},[o("b-button",{staticClass:"small mx-1 mt-3",attrs:{variant:"primary"},on:{click:e.imprimir}},[e._v("Imprimir Consolidado")]),o("b-button",{staticClass:"small mx-1 mt-3",attrs:{variant:"outline-primary"},on:{click:e.exportarAExcel}},[e._v("Exportar a Excel")])],1)])],1)],1)},at=[],nt={name:"consolidadopromedio",components:{},data:function(){return{idSede:null,comboSedes:[],idPeriodo:5,comboPeriodos:null,idCurso:null,comboCursosSede:[],nombreSede:null,nombreCurso:null,idNivel:null,btnCargando:!1,datosRaw:[],datosSeccion:{},listaAreasAsignaturas:[],periodosVisibles:[]}},methods:{colspanArea:function(e){var t=this.encabezadoPorArea[e]||[],o=this.periodosVisibles.length+1,a=1;return t.length*o+a},totalBajosPorPeriodo:function(e,t,o){var a=this,n=0,r=this.listaAreasAsignaturas.find((function(o){return o.area===e&&o.asignatura===t})),s=null===r||void 0===r?void 0:r.idTipoEspecialidad;return Object.values(this.estudiantesNotas).forEach((function(r){var i,c,d,u,l,m=null===r||void 0===r||null===(i=r.areas)||void 0===i||null===(c=i[e])||void 0===c||null===(d=c.asignaturas)||void 0===d||null===(u=d[t])||void 0===u||null===(l=u.periodos)||void 0===l?void 0:l[o];1===s?m>0&&m<a.datosSeccion.minBas&&n++:m>0&&m<a.datosSeccion.minBasT&&n++})),n},totalBajosPromedioAsignatura:function(e,t){var o=this,a=0,n=this.listaAreasAsignaturas.find((function(o){return o.area===e&&o.asignatura===t})),r=null===n||void 0===n?void 0:n.idTipoEspecialidad;return Object.values(this.estudiantesNotas).forEach((function(n){var s,i,c,d=null===n||void 0===n||null===(s=n.areas)||void 0===s||null===(i=s[e])||void 0===i||null===(c=i.asignaturas)||void 0===c?void 0:c[t];if(d){var u=parseFloat(o.calcularPromedioAsignatura(d));1===r?u<o.datosSeccion.minBas&&a++:u<o.datosSeccion.minBasT&&a++}})),a},totalBajosPromedioArea:function(e){var t=this,o=0;return Object.values(this.estudiantesNotas).forEach((function(a){var n=parseFloat(t.obtenerPromedioArea(a,e));!isNaN(n)&&n<t.datosSeccion.minBas&&o++})),o},totalesGlobales:function(){var e=this,t=0,o=0,a=0,n=0,r=0,s=0;return Object.values(this.estudiantesNotas).forEach((function(i){t+=e.contarDesempenoEstudianteArea(i,"bajo"),o+=e.contarDesempenoEstudianteArea(i,"basico"),a+=e.contarDesempenoEstudianteArea(i,"alto"),n+=e.contarDesempenoEstudianteArea(i,"superior"),r+=i.ausJ||0,s+=i.ausS||0})),{bajo:t,basico:o,alto:a,superior:n,ausJ:r,ausS:s}},esAreaValida:function(e){var t=this.listaAreasAsignaturas.filter((function(t){return t.area===e}));return!!t.some((function(e){return 99!==e.orden&&98!==e.orden}))||!(!t.some((function(e){return 99===e.orden}))||1!=this.datosSeccion.promCompor)},obtenerPromedioArea:function(e,t){var o=e.areas&&e.areas[t];return o?this.calcularPromedioArea(o):""},obtenerNota:function(e,t,o,a){var n,r,s,i,c,d=null===e||void 0===e||null===(n=e.areas)||void 0===n||null===(r=n[t])||void 0===r||null===(s=r.asignaturas)||void 0===s||null===(i=s[o])||void 0===i||null===(c=i.periodos)||void 0===c?void 0:c[a];return 0===d&&(d=""),"number"===typeof d?d.toFixed(1):d},obtenerPromedioAsignatura:function(e,t,o){var a,n,r,s=null===e||void 0===e||null===(a=e.areas)||void 0===a||null===(n=a[t])||void 0===n||null===(r=n.asignaturas)||void 0===r?void 0:r[o];return s?this.calcularPromedioAsignatura(s):""},calcularPromedioAsignatura:function(e){var t=e.pesos,o=e.periodos,a=e.orden;if(99===a&&0==this.datosSeccion.promCompor)return"-";var n=0;if("acaa36d0-fcb1-11ec-8267-536b07c743c4"==this.$store.state.idInstitucion){if(12==a){for(var r=0,s=1;s<=4;s++){var i,c=null!==(i=o[s])&&void 0!==i?i:0;c>0&&(n+=c,r++)}return 0===n?"":(n/=r,this.redondear(n).toFixed(1)>0?this.redondear(n).toFixed(1):"")}for(var d=1;d<=4;d++){var u,l=null!==(u=o[d])&&void 0!==u?u:0;n+=l*t[d]/100}return this.redondear(n).toFixed(1)>0?this.redondear(n).toFixed(1):""}if("eb58bf60-fc83-11ec-a1d1-1dc2835404e5"==this.$store.state.idInstitucion){if(55==a){for(var m=0,p=1;p<=4;p++){var b,f=null!==(b=o[p])&&void 0!==b?b:0;f>0&&(n+=f,m++)}return 0===n?"":(n/=m,this.redondear(n).toFixed(1)>0?this.redondear(n).toFixed(1):"")}for(var v=1;v<=4;v++){var h,S=null!==(h=o[v])&&void 0!==h?h:0;n+=S*t[v]/100}return this.redondear(n).toFixed(1)>0?this.redondear(n).toFixed(1):""}if("c50f3d80-fca0-11ec-8267-536b07c743c4"==this.$store.state.idInstitucion){var g,C=null!==(g=o[5])&&void 0!==g?g:0;return C>0?C.toFixed(1):""}if("8a1bd1e0-fcb2-11ec-8267-536b07c743c4"==this.$store.state.idInstitucion){var A,_=null!==(A=o[5])&&void 0!==A?A:0;return _>0?_.toFixed(1):""}for(var x=0,E=1;E<=4;E++){var y,P=null!==(y=o[E])&&void 0!==y?y:0;P>0&&(n+=P,x++)}if(0===n)return"";var w=n/x;return this.redondear(w).toFixed(1)>0?this.redondear(w).toFixed(1):""},calcularPromedioArea:function(e){var t=this,o=Object.values(e.asignaturas);if(!o.length)return"0.00";var a=0;return o.forEach((function(e){if(99===e.orden&&0==t.datosSeccion.promCompor)return"-";a+=parseFloat(t.calcularPromedioAsignatura(e)*e.porcentaje/100)})),a>0?this.redondear(a).toFixed(1):""},contarDesempenoEstudianteArea:function(e,t){var o=this,a=Object.keys(e.areas||{}),n=0;return a.forEach((function(a){if(o.esAreaValida(a)){var r=o.listaAreasAsignaturas.find((function(e){return e.area===a})),s=null===r||void 0===r?void 0:r.idTipoArea,i=parseFloat(o.calcularPromedioArea(e.areas[a]));isNaN(i)||(1===s?("bajo"===t&&i<o.datosSeccion.minBas||"basico"===t&&i>=o.datosSeccion.minBas&&i<o.datosSeccion.minAlt||"alto"===t&&i>=o.datosSeccion.minAlt&&i<o.datosSeccion.minSup||"superior"===t&&i>=o.datosSeccion.minSup&&i<=o.datosSeccion.maxSup)&&n++:("bajo"===t&&i<o.datosSeccion.minBasT||"basico"===t&&i>=o.datosSeccion.minBasT&&i<o.datosSeccion.minAltT||"alto"===t&&i>=o.datosSeccion.minAltT&&i<o.datosSeccion.minSupT||"superior"===t&&i>=o.datosSeccion.minSupT&&i<=o.datosSeccion.maxSupT)&&n++)}})),n},calcularPromedioGeneral:function(e){var t=this,o=Object.keys(e.areas||{}),a=0,n=0;return o.forEach((function(o){if(t.esAreaValida(o)){var r=parseFloat(t.calcularPromedioArea(e.areas[o]));isNaN(r)||(a+=r,n++)}})),n>0?(a/n).toFixed(3):""},contarAusencias:function(e){var t=0;return Object.values(this.estudiantesNotas).forEach((function(o){"ausJ"===e&&(t+=o.ausJ||0),"ausS"===e&&(t+=o.ausS||0)})),t},contarNotasPorAsignatura:function(e,t,o){var a=this,n=0;return Object.values(this.estudiantesNotas).forEach((function(r){var s,i,c,d,u=null===r||void 0===r||null===(s=r[e])||void 0===s||null===(i=s[t])||void 0===i?void 0:i.nota,l=null===r||void 0===r||null===(c=r[e])||void 0===c||null===(d=c[t])||void 0===d?void 0:d.idTipoEspecialidad;"number"===typeof u&&(1===l?("bajo"===o&&u<a.datosSeccion.minBas||"basico"===o&&u>=a.datosSeccion.minBas&&u<a.datosSeccion.minAlt||"alto"===o&&u>=a.datosSeccion.minAlt&&u<a.datosSeccion.minSup||"superior"===o&&u>=a.datosSeccion.minSup&&u<=a.datosSeccion.maxSup)&&n++:("bajo"===o&&u<a.datosSeccion.minBasT||"basico"===o&&u>=a.datosSeccion.minBasT&&u<a.datosSeccion.minAltT||"alto"===o&&u>=a.datosSeccion.minAltT&&u<a.datosSeccion.minSupT||"superior"===o&&u>=a.datosSeccion.minSupT&&u<=a.datosSeccion.maxSupT)&&n++)})),n},contarNotasTotales:function(e){var t=this,o=0;return Object.values(this.estudiantesNotas).forEach((function(a){t.listaAreasAsignaturas.forEach((function(n){var r,s,i,c,d=n.area,u=n.asignatura,l=null===a||void 0===a||null===(r=a[d])||void 0===r||null===(s=r[u])||void 0===s?void 0:s.nota,m=null===a||void 0===a||null===(i=a[d])||void 0===i||null===(c=i[u])||void 0===c?void 0:c.idTipoEspecialidad;"number"===typeof l&&(1===m?("bajo"===e&&l<t.datosSeccion.minBas||"basico"===e&&l>=t.datosSeccion.minBas&&l<t.datosSeccion.minAlt||"alto"===e&&l>=t.datosSeccion.minAlt&&l<t.datosSeccion.minSup||"superior"===e&&l>=t.datosSeccion.minSup&&l<=t.datosSeccion.maxSup)&&o++:("bajo"===e&&l<t.datosSeccion.minBasT||"basico"===e&&l>=t.datosSeccion.minBasT&&l<t.datosSeccion.minAltT||"alto"===e&&l>=t.datosSeccion.minAltT&&l<t.datosSeccion.minSupT||"superior"===e&&l>=t.datosSeccion.minSupT&&l<=t.datosSeccion.maxSupT)&&o++)}))})),o},iconoPuesto:function(e){return 1===e?"ü•á":2===e?"ü•à":3===e?"ü•â":""},contarDesempenoEstudiante:function(e,t){var o=this,a=0;return Object.values(e||{}).forEach((function(e){Object.values(e.asignaturas||{}).forEach((function(e){var n=parseFloat(o.calcularPromedioAsignatura(e)),r=e.idTipoEspecialidad,s=e.orden;"eb58bf60-fc83-11ec-a1d1-1dc2835404e5"==o.$store.state.idInstitucion&&90==s||"097b7b10-fcaa-11ec-8267-536b07c743c4"==o.$store.state.idInstitucion&&98==s||"number"===typeof n&&(1===r?("bajo"===t&&n<o.datosSeccion.minBas||"basico"===t&&n>=o.datosSeccion.minBas&&n<o.datosSeccion.minAlt||"alto"===t&&n>=o.datosSeccion.minAlt&&n<o.datosSeccion.minSup||"superior"===t&&n>=o.datosSeccion.minSup&&n<=o.datosSeccion.maxSup)&&a++:("bajo"===t&&n<o.datosSeccion.minBasT||"basico"===t&&n>=o.datosSeccion.minBasT&&n<o.datosSeccion.minAltT||"alto"===t&&n>=o.datosSeccion.minAltT&&n<o.datosSeccion.minSupT||"superior"===t&&n>=o.datosSeccion.minSupT&&n<=o.datosSeccion.maxSupT)&&a++)}))})),a},fueRecuperada:function(e,t,o){var a,n,r;return null!==(a=null===e||void 0===e||null===(n=e[t])||void 0===n||null===(r=n[o])||void 0===r?void 0:r.fueRecuperada)&&void 0!==a&&a},obtenerOriginal:function(e,t,o){var a,n,r=null===e||void 0===e||null===(a=e[t])||void 0===a||null===(n=a[o])||void 0===n?void 0:n.original;return"number"===typeof r?r.toFixed(1):"0.0"},obtenerRecuperacion:function(e,t,o){var a,n,r=null===e||void 0===e||null===(a=e[t])||void 0===a||null===(n=a[o])||void 0===n?void 0:n.recuperacion;return"number"===typeof r?r.toFixed(1):"0.0"},obtenerColor:function(e,t,o,a){var n,r,s=null===t||void 0===t||null===(n=t[o])||void 0===n||null===(r=n[a])||void 0===r?void 0:r.idTipoEspecialidad;return 1===s?e<this.datosSeccion.minBas?"desempeno-bajo":e<this.datosSeccion.minAlt?"desempeno-basico":e<this.datosSeccion.minSup?"desempeno-alto":e<=this.datosSeccion.maxSup?"desempeno-superior":"desempeno-extra":e<this.datosSeccion.minBasT?"desempeno-bajo":e<this.datosSeccion.minAltT?"desempeno-basico":e<this.datosSeccion.minSupT?"desempeno-alto":e<=this.datosSeccion.maxSupT?"desempeno-superior":"desempeno-extra"},claseDesempeno:function(e){return console.log(e),"number"!==typeof e?"desempeno-extra":e<3?"desempeno-bajo":e<4?"desempeno-basico":e<4.6?"desempeno-alto":e<=5?"desempeno-superior":"desempeno-extra"},obtenerColorGeneral:function(e){return e<this.datosSeccion.minBas?"desempeno-bajo":e<this.datosSeccion.minAlt?"desempeno-basico":e<this.datosSeccion.minSup?"desempeno-alto":e<=this.datosSeccion.maxSup?"desempeno-superior":"desempeno-extra"},consultarEstudiantes:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.btnCargando=!0,1==e.idPeriodo&&(e.periodosVisibles=[1]),2==e.idPeriodo&&(e.periodosVisibles=[1,2]),3==e.idPeriodo&&(e.periodosVisibles=[1,2,3]),4==e.idPeriodo&&(e.periodosVisibles=[1,2,3,4]),e.nombreSede=document.getElementById("sedes")[document.getElementById("sedes").selectedIndex].text,null==e.idCurso){t.next=15;break}return e.nombreCurso=document.getElementById("cursos")[document.getElementById("cursos").selectedIndex].text,e.$store.state.datosCursos.forEach((function(t){t.id==e.idCurso&&(e.idNivel=t.id_nivel)})),e.listaAreasAsignaturas=[],t.next=12,s.a.get(i["d"]+"consolidados/areasasignaturas/curso",{params:{idCurso:e.idCurso}}).then((function(t){t.data.error?(e.mensajeEmergente("danger",i["h"],t.data.mensaje+" - Lista areas-asignaturas curso"),e.btnCargando=!1):0!=t.data.datos&&t.data.datos.forEach((function(t){"eb58bf60-fc83-11ec-a1d1-1dc2835404e5"==e.$store.state.idInstitucion?99!=t.orden&&90!=t.orden&&e.listaAreasAsignaturas.push(t):"f5529ba0-fcb3-11ec-8267-536b07c743c4"==e.$store.state.idInstitucion?99!=t.orden&&15!=t.orden&&16!=t.orden&&98!=t.orden&&e.listaAreasAsignaturas.push(t):"097b7b10-fcaa-11ec-8267-536b07c743c4"==e.$store.state.idInstitucion?99!=t.orden&&98!=t.orden&&e.listaAreasAsignaturas.push(t):("54fd7440-fc81-11ec-a1d1-1dc2835404e5"==e.$store.state.idInstitucion||"7c63ed50-fcb0-11ec-8267-536b07c743c4"==e.$store.state.idInstitucion||99!=t.orden)&&e.listaAreasAsignaturas.push(t)}))})).catch((function(t){e.mensajeEmergente("danger",i["h"],"Algo salio mal y no se pudo realizar: Lista areas-asignaturas curso. Intente m√°s tarde."+t),e.btnCargando=!1}));case 12:return e.datosRaw=[],t.next=15,s.a.get(i["d"]+"consolidados/asignaturas/curso/acumulado",{params:{idCurso:e.idCurso,periodo:e.idPeriodo,vigencia:e.$store.state.aLectivo}}).then((function(t){t.data.error?(e.mensajeEmergente("danger",i["h"],t.data.mensaje+" - Consolidados asignaturas curso periodo"),e.btnCargando=!1):0!=t.data.datos&&(e.datosRaw=t.data.datos)})).catch((function(t){e.mensajeEmergente("danger",i["h"],"Algo salio mal y no se pudo realizar: Consolidados asignaturas curso periodo. Intente m√°s tarde."+t),e.btnCargando=!1}));case 15:e.btnCargando=!1;case 16:case"end":return t.stop()}}),t)})))()},imprimir:function(){var e="Fecha: "+(new Date).toLocaleString(),t="CONSOLIDADO EVALUACIONES FINALES POR AREAS",o=document.querySelector("table").outerHTML,a=window.open("Consolidados","_blank");a.document.write('<html><head><title>Imprimir</title></head>\n      <style scoped>\n        table {\n          border-collapse: collapse;\n          width: 100%;\n          text-align: center;\n          font-size: 10px;\n        }\n        th {\n          background: #eee;\n        }\n        .nota-recuperada {\n          border: 2px solid #ffa500;\n          box-shadow: 0 0 5px #ffa500;\n        }\n        .desempeno-bajo { background-color: #f8d7da; color: #721c24; }\n        .desempeno-basico { background-color: #d1ecf1; color: #0c5460; }\n        .desempeno-alto { background-color: #fff3cd; color: #856404; }\n        .desempeno-superior { background-color: #d4edda; color: #155724; }\n        .desempeno-extra { background-color: #f4ecf5; color: #2f2e2e; }\n      </style>\n        <body class="container">\n          <p style="text-align: center; font-size: 12px;">SECRETAR√çA DE EDUCACI√ìN TERRITORIAL DE TUNJA<br><b>'.concat(this.$store.state.nombreInstitucion,"</b><br>TUNJA - BOYAC√Å<br>").concat(t,"<br>Sede: ").concat(this.nombreSede," | Curso: ").concat(this.nombreCurso," | A√±o Lectivo ").concat(this.$store.state.aLectivo," | Periodo: FINAL</p>\n          ").concat(o,'\n          <div style="text-align: right; font-size: 12px;"><i>').concat(e,"</i></div>\n        </body>\n      </html>")),a.document.close(),a.print()},exportarAExcel:function(){var e=document.querySelector("table"),t=p["utils"].table_to_book(e);p["writeFile"](t,"ConsoldidaFinal.xlsx")},redondear:function(e){var t=Number((10*Math.abs(e)).toPrecision(15));return Math.round(t)/10*Math.sign(e)},ocuparComboCursosSede:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.comboCursosSede=[],e.$store.state.datosCursos.forEach((function(t){t.id_sede==e.idSede&&e.comboCursosSede.push({value:t.id,text:t.nomenclatura.toUpperCase()})}));case 2:case"end":return t.stop()}}),t)})))()},ocuparComboSedes:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.comboSedes=[],e.$store.state.datosSedes.forEach((function(t){e.comboSedes.push({value:t.id,text:t.sede.toUpperCase()})}));case 2:case"end":return t.stop()}}),t)})))()},ocuparComboPeriodos:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.comboPeriodos=[],e.$store.state.periodos.forEach((function(t){e.comboPeriodos.push({value:t.id,text:t.periodo.toUpperCase()})}));case 2:case"end":return t.stop()}}),t)})))()},mensajeEmergente:function(e,t,o){this.$bvToast.toast(o,{title:t,variant:e,toaster:"b-toaster-top-center",solid:!0,autoHideDelay:4e3,appendToast:!1})}},computed:{totales:function(){return this.totalesGlobales()},estudiantesNotas:function(){var e=this,t={};return this.datosRaw.forEach((function(o){var a=o.estudiante,n=o.area,r=o.asignatura,s=o.periodo,i=o.definitiva,c=o.recuperacion,d=o.orden,u=o.definitivacompor,l=o.definitivapree,m=o.idTipoEspecialidad,p=o.ausJ,b=o.ausS,f=o.porcentaje,v=o.id_conceptual;t[a]||(t[a]={id_conceptual:v,ausJ:0,ausS:0,areas:{}}),t[a].areas[n]||(t[a].areas[n]={asignaturas:{}}),t[a].areas[n].asignaturas[r]||(t[a].areas[n].asignaturas[r]={periodos:{},orden:d,idTipoEspecialidad:m,porcentaje:f,pesos:{1:e.datosSeccion.pesoP1,2:e.datosSeccion.pesoP2,3:e.datosSeccion.pesoP3,4:e.datosSeccion.pesoP4}});var h=0;h=99===d?1==e.datosSeccion.tipoValComp?i:null!=u?u:"":1==e.idNivel?null!=l&&0!=l&&""!=l?l:"":c>i?c:i,t[a].areas[n].asignaturas[r].periodos[s]=h,t[a].ausJ+=p||0,t[a].ausS+=b||0})),t},totalColumnasPromedioArea:function(){var e=new Set(this.listaAreasAsignaturas.map((function(e){return e.area})));return e.size},puestosPorEstudiante:function(){var e=this,t=Object.entries(this.estudiantesNotas).map((function(t){var o=Object(u["a"])(t,2),a=o[0],n=o[1],r=parseFloat(e.calcularPromedioGeneral(n));return{nombre:a,promedio:isNaN(r)?0:r}}));t.sort((function(e,t){return t.promedio-e.promedio}));var o={},a=1,n=1,r=null;return t.forEach((function(e){e.promedio!==r&&(a=n,r=e.promedio,n++),o[e.nombre]=a})),o},encabezadoPorArea:function(){var e={};return this.listaAreasAsignaturas.forEach((function(t){var o=t.area,a=t.asignatura;e[o]||(e[o]=[]),e[o].push(a)})),e}},beforeMount:function(){this.ocuparComboSedes(),this.ocuparComboPeriodos(),this.datosSeccion=this.$store.state.datosSecciones[this.$store.state.idSeccion-1]}},rt=nt,st=(o("b16c"),Object(v["a"])(rt,ot,at,!1,null,"26ab95d5",null)),it=st.exports,ct=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("b-row",{staticClass:"mt-2"},[o("b-col",{attrs:{lg:"12"}},[o("b-card",{scopedSlots:e._u([{key:"header",fn:function(){return[o("h5",{staticClass:"mb-0"},[o("b-icon",{attrs:{icon:"card-checklist","aria-hidden":"true"}}),e._v(" RESUMEN DE PROMOCI√ìN DEFINITIVO POR AREAS")],1)]},proxy:!0}])},[o("b-card-text",[o("b-row",[o("b-col",{attrs:{lg:"6"}},[o("b-form-group",{staticClass:"etiqueta",attrs:{label:"Seleccione la Sede:","label-for":"sedes"}},[o("b-form-select",{ref:"sedes",attrs:{id:"sedes",options:e.comboSedes},on:{change:function(t){e.idCurso=null,e.ocuparComboCursosSede()}},model:{value:e.idSede,callback:function(t){e.idSede=t},expression:"idSede"}})],1)],1),o("b-col",{attrs:{lg:"4"}},[o("b-form-group",{staticClass:"etiqueta",attrs:{label:"Seleccione el Curso:","label-for":"cursos"}},[o("b-form-select",{ref:"cursos",attrs:{id:"cursos",options:e.comboCursosSede,disabled:null==e.idSede},on:{change:function(t){return e.consultarEstudiantes()}},model:{value:e.idCurso,callback:function(t){e.idCurso=t},expression:"idCurso"}})],1)],1)],1)],1)],1)],1)],1),o("b-row",[o("b-col",{attrs:{lg:"12"}},[e.btnCargando?o("div",[o("div",{staticClass:"text-center m-5 text-primary"},[o("b-spinner",{staticStyle:{width:"3rem",height:"3rem"},attrs:{label:"Spinner"}}),o("br"),o("strong",[e._v("Cargando informe...")])],1)]):e._e()])],1),e.btnCargando||null==e.idCurso?e._e():o("b-row",[o("b-col",{attrs:{lg:"12"}},[o("table",{staticClass:"table-responsive",attrs:{border:"1",cellspacing:"0",cellpadding:"1"}},[o("thead",[o("tr",[o("th",[e._v("#")]),o("th",[e._v("Estudiante")]),o("th",[e._v("Estado Final Promoci√≥n")]),o("th",[e._v("#")])])]),o("tbody",e._l(e.estudiantesNotas,(function(t,a,n){return o("tr",{key:a},[o("td",{staticClass:"text-left"},[e._v(e._s(n+1))]),o("td",{staticStyle:{"text-align":"left"}},[e._v(e._s(a))]),o("td",{staticStyle:{"text-align":"left"}},[e._v(e._s("N"==t.id_conceptual?e.mostrarEstadoPromocion(t.obs_comision,e.contarDesempenoEstudianteArea(t,"bajo"),t.idMatricula):"-"))]),o("td",{staticClass:"text-left"},[e._v(e._s(n+1))])])})),0)]),o("div",{staticStyle:{"margin-bottom":"1rem"}},[o("b-button",{staticClass:"small mx-1 mt-3",attrs:{variant:"primary"},on:{click:e.imprimir}},[e._v("Imprimir Consolidado")]),o("b-button",{staticClass:"small mx-1 mt-3",attrs:{variant:"outline-primary"},on:{click:e.exportarAExcel}},[e._v("Exportar a Excel")])],1)])],1)],1)},dt=[],ut={name:"resumenpromocionareas",components:{},data:function(){return{idSede:null,comboSedes:[],idPeriodo:5,comboPeriodos:null,idCurso:null,comboCursosSede:[],nombreSede:null,nombreCurso:null,idNivel:null,btnCargando:!1,datosRaw:[],datosSeccion:{},listaAreasAsignaturas:[],periodosVisibles:[],listaHabilitaciones:[]}},methods:{mostrarEstadoPromocion:function(e,t,o){if(9999!=t){var a=0,n=0,r=this.listaHabilitaciones.filter((function(e){return e.id_matricula===o}));return r.forEach((function(e){e.habilitacion<3&&a++,n++})),"f5529ba0-fcb3-11ec-8267-536b07c743c4"==this.$store.state.idInstitucion?null===e||""===e?a>0?"REPROBADO":0==t?0==n?"APROB√ì EL GRADO":"PROMOVIDO":"REPROBADO":"PROMOVIDO POR COMISI√ìN DE EVALUACI√ìN":"17ee4f30-fc80-11ec-a1d1-1dc2835404e5"==this.$store.state.idInstitucion||"7c63ed50-fcb0-11ec-8267-536b07c743c4"==this.$store.state.idInstitucion?1==this.$store.state.idSeccion?0==t?"APROB√ì EL GRADO":"REPROB√ì":0==t?"APROB√ì EL SEMESTRE":"REPROB√ì EL SEMESTRE":(this.$store.state.idInstitucion,0==t?"APROB√ì EL GRADO":"REPROB√ì")}return"REPROB√ì (Sin Notas)"},colspanArea:function(e){var t=this.encabezadoPorArea[e]||[],o=this.periodosVisibles.length+1,a=1;return t.length*o+a},totalBajosPorPeriodo:function(e,t,o){var a=this,n=0,r=this.listaAreasAsignaturas.find((function(o){return o.area===e&&o.asignatura===t})),s=null===r||void 0===r?void 0:r.idTipoEspecialidad;return Object.values(this.estudiantesNotas).forEach((function(r){var i,c,d,u,l,m=null===r||void 0===r||null===(i=r.areas)||void 0===i||null===(c=i[e])||void 0===c||null===(d=c.asignaturas)||void 0===d||null===(u=d[t])||void 0===u||null===(l=u.periodos)||void 0===l?void 0:l[o];1===s?m>0&&m<a.datosSeccion.minBas&&n++:m>0&&m<a.datosSeccion.minBasT&&n++})),n},totalBajosPromedioAsignatura:function(e,t){var o=this,a=0,n=this.listaAreasAsignaturas.find((function(o){return o.area===e&&o.asignatura===t})),r=null===n||void 0===n?void 0:n.idTipoEspecialidad;return Object.values(this.estudiantesNotas).forEach((function(n){var s,i,c,d=null===n||void 0===n||null===(s=n.areas)||void 0===s||null===(i=s[e])||void 0===i||null===(c=i.asignaturas)||void 0===c?void 0:c[t];if(d){var u=parseFloat(o.calcularPromedioAsignatura(d));1===r?u<o.datosSeccion.minBas&&a++:u<o.datosSeccion.minBasT&&a++}})),a},totalBajosPromedioArea:function(e){var t=this,o=0;return Object.values(this.estudiantesNotas).forEach((function(a){var n=parseFloat(t.obtenerPromedioArea(a,e));!isNaN(n)&&n<t.datosSeccion.minBas&&o++})),o},totalesGlobales:function(){var e=this,t=0,o=0,a=0,n=0,r=0,s=0;return Object.values(this.estudiantesNotas).forEach((function(i){t+=e.contarDesempenoEstudianteArea(i,"bajo"),o+=e.contarDesempenoEstudianteArea(i,"basico"),a+=e.contarDesempenoEstudianteArea(i,"alto"),n+=e.contarDesempenoEstudianteArea(i,"superior"),r+=i.ausJ||0,s+=i.ausS||0})),{bajo:t,basico:o,alto:a,superior:n,ausJ:r,ausS:s}},esAreaValida:function(e){var t=this.listaAreasAsignaturas.filter((function(t){return t.area===e}));return!!t.some((function(e){return 99!==e.orden&&98!==e.orden}))||!(!t.some((function(e){return 99===e.orden}))||1!=this.datosSeccion.promCompor)},obtenerPromedioArea:function(e,t){var o=e.areas&&e.areas[t];return o?this.calcularPromedioArea(o):""},obtenerNota:function(e,t,o,a){var n,r,s,i,c,d=null===e||void 0===e||null===(n=e.areas)||void 0===n||null===(r=n[t])||void 0===r||null===(s=r.asignaturas)||void 0===s||null===(i=s[o])||void 0===i||null===(c=i.periodos)||void 0===c?void 0:c[a];return 0===d&&(d=""),"number"===typeof d?d.toFixed(1):d},obtenerPromedioAsignatura:function(e,t,o){var a,n,r,s=null===e||void 0===e||null===(a=e.areas)||void 0===a||null===(n=a[t])||void 0===n||null===(r=n.asignaturas)||void 0===r?void 0:r[o];return s?this.calcularPromedioAsignatura(s):""},calcularPromedioAsignatura:function(e){var t=e.pesos,o=e.periodos,a=e.orden;if(99===a&&0==this.datosSeccion.promCompor)return"-";var n=0;if("acaa36d0-fcb1-11ec-8267-536b07c743c4"==this.$store.state.idInstitucion){if(12==a){for(var r=0,s=1;s<=4;s++){var i,c=null!==(i=o[s])&&void 0!==i?i:0;c>0&&(n+=c,r++)}return 0===n?"":(n/=r,this.redondear(n).toFixed(1)>0?this.redondear(n).toFixed(1):"")}for(var d=1;d<=4;d++){var u,l=null!==(u=o[d])&&void 0!==u?u:0;n+=l*t[d]/100}return this.redondear(n).toFixed(1)>0?this.redondear(n).toFixed(1):""}if("eb58bf60-fc83-11ec-a1d1-1dc2835404e5"==this.$store.state.idInstitucion){if(55==a){for(var m=0,p=1;p<=4;p++){var b,f=null!==(b=o[p])&&void 0!==b?b:0;f>0&&(n+=f,m++)}return 0===n?"":(n/=m,this.redondear(n).toFixed(1)>0?this.redondear(n).toFixed(1):"")}for(var v=1;v<=4;v++){var h,S=null!==(h=o[v])&&void 0!==h?h:0;n+=S*t[v]/100}return this.redondear(n).toFixed(1)>0?this.redondear(n).toFixed(1):""}if("c50f3d80-fca0-11ec-8267-536b07c743c4"==this.$store.state.idInstitucion){var g,C=null!==(g=o[5])&&void 0!==g?g:0;return C>0?C.toFixed(1):""}if("8a1bd1e0-fcb2-11ec-8267-536b07c743c4"==this.$store.state.idInstitucion){var A,_=null!==(A=o[5])&&void 0!==A?A:0;return _>0?_.toFixed(1):""}if("17ee4f30-fc80-11ec-a1d1-1dc2835404e5"==this.$store.state.idInstitucion){for(var x=1;x<=4;x++){var E,y=null!==(E=e.periodos[x])&&void 0!==E?E:0;y>0&&(n+=y)}if(0===n)return"";var P=1==this.$store.state.idSeccion?n/4:n;return this.redondear(P).toFixed(1)>0?this.redondear(P).toFixed(1):""}if("7c63ed50-fcb0-11ec-8267-536b07c743c4"==this.$store.state.idInstitucion){for(var w=0,T=1;T<=4;T++){var j,N=null!==(j=e.periodos[T])&&void 0!==j?j:0;N>0&&(n+=N,w++)}if(0===n)return"";var k=n/w;return this.redondear(k).toFixed(1)>0?this.redondear(k).toFixed(1):""}if("54fd7440-fc81-11ec-a1d1-1dc2835404e5"==this.$store.state.idInstitucion){for(var O=1;O<=4;O++){var R,I=null!==(R=e.periodos[O])&&void 0!==R?R:0;I>0&&(n+=I)}if(0===n)return"";var B=n/4;return this.redondear(B).toFixed(1)>0?this.redondear(B).toFixed(1):""}for(var F=0,D=1;D<=4;D++){var $,L=null!==($=o[D])&&void 0!==$?$:0;L>0&&(n+=L,F++)}if(0===n)return"";var J=n/F;return this.redondear(J).toFixed(1)>0?this.redondear(J).toFixed(1):""},calcularPromedioArea:function(e){var t=this,o=Object.values(e.asignaturas);if(!o.length)return"0.00";var a=0;return o.forEach((function(e){if(99===e.orden&&0==t.datosSeccion.promCompor)return"-";var o=e.idAsignaturaCurso,n=e.idMatricula,r=t.mostrarHabilitacion(n,o),s=parseFloat(t.calcularPromedioAsignatura(e)*e.porcentaje/100),i=r.habilitacion>s?r.habilitacion:s;a+=i})),a>0?this.redondear(a).toFixed(1):""},contarDesempenoEstudianteArea:function(e,t){var o=this,a=Object.keys(e.areas||{}),n=0,r=0;return a.forEach((function(a){if(o.esAreaValida(a)){var s=o.listaAreasAsignaturas.find((function(e){return e.area===a})),i=null===s||void 0===s?void 0:s.idTipoArea,c=parseFloat(o.calcularPromedioArea(e.areas[a]));isNaN(c)||(r++,1===i?("bajo"===t&&c<o.datosSeccion.minBas||"basico"===t&&c>=o.datosSeccion.minBas&&c<o.datosSeccion.minAlt||"alto"===t&&c>=o.datosSeccion.minAlt&&c<o.datosSeccion.minSup||"superior"===t&&c>=o.datosSeccion.minSup&&c<=o.datosSeccion.maxSup)&&n++:("bajo"===t&&c<o.datosSeccion.minBasT||"basico"===t&&c>=o.datosSeccion.minBasT&&c<o.datosSeccion.minAltT||"alto"===t&&c>=o.datosSeccion.minAltT&&c<o.datosSeccion.minSupT||"superior"===t&&c>=o.datosSeccion.minSupT&&c<=o.datosSeccion.maxSupT)&&n++)}})),r>0?n:9999},calcularPromedioGeneral:function(e){var t=this,o=Object.keys(e.areas||{}),a=0,n=0;return o.forEach((function(o){if(t.esAreaValida(o)){var r=parseFloat(t.calcularPromedioArea(e.areas[o]));isNaN(r)||(a+=r,n++)}})),n>0?(a/n).toFixed(3):""},contarAusencias:function(e){var t=0;return Object.values(this.estudiantesNotas).forEach((function(o){"ausJ"===e&&(t+=o.ausJ||0),"ausS"===e&&(t+=o.ausS||0)})),t},contarNotasPorAsignatura:function(e,t,o){var a=this,n=0;return Object.values(this.estudiantesNotas).forEach((function(r){var s,i,c,d,u=null===r||void 0===r||null===(s=r[e])||void 0===s||null===(i=s[t])||void 0===i?void 0:i.nota,l=null===r||void 0===r||null===(c=r[e])||void 0===c||null===(d=c[t])||void 0===d?void 0:d.idTipoEspecialidad;"number"===typeof u&&(1===l?("bajo"===o&&u<a.datosSeccion.minBas||"basico"===o&&u>=a.datosSeccion.minBas&&u<a.datosSeccion.minAlt||"alto"===o&&u>=a.datosSeccion.minAlt&&u<a.datosSeccion.minSup||"superior"===o&&u>=a.datosSeccion.minSup&&u<=a.datosSeccion.maxSup)&&n++:("bajo"===o&&u<a.datosSeccion.minBasT||"basico"===o&&u>=a.datosSeccion.minBasT&&u<a.datosSeccion.minAltT||"alto"===o&&u>=a.datosSeccion.minAltT&&u<a.datosSeccion.minSupT||"superior"===o&&u>=a.datosSeccion.minSupT&&u<=a.datosSeccion.maxSupT)&&n++)})),n},contarNotasTotales:function(e){var t=this,o=0;return Object.values(this.estudiantesNotas).forEach((function(a){t.listaAreasAsignaturas.forEach((function(n){var r,s,i,c,d=n.area,u=n.asignatura,l=null===a||void 0===a||null===(r=a[d])||void 0===r||null===(s=r[u])||void 0===s?void 0:s.nota,m=null===a||void 0===a||null===(i=a[d])||void 0===i||null===(c=i[u])||void 0===c?void 0:c.idTipoEspecialidad;"number"===typeof l&&(1===m?("bajo"===e&&l<t.datosSeccion.minBas||"basico"===e&&l>=t.datosSeccion.minBas&&l<t.datosSeccion.minAlt||"alto"===e&&l>=t.datosSeccion.minAlt&&l<t.datosSeccion.minSup||"superior"===e&&l>=t.datosSeccion.minSup&&l<=t.datosSeccion.maxSup)&&o++:("bajo"===e&&l<t.datosSeccion.minBasT||"basico"===e&&l>=t.datosSeccion.minBasT&&l<t.datosSeccion.minAltT||"alto"===e&&l>=t.datosSeccion.minAltT&&l<t.datosSeccion.minSupT||"superior"===e&&l>=t.datosSeccion.minSupT&&l<=t.datosSeccion.maxSupT)&&o++)}))})),o},iconoPuesto:function(e){return 1===e?"ü•á":2===e?"ü•à":3===e?"ü•â":""},contarDesempenoEstudiante:function(e,t){var o=this,a=0;return Object.values(e||{}).forEach((function(e){Object.values(e.asignaturas||{}).forEach((function(e){var n=parseFloat(o.calcularPromedioAsignatura(e)),r=e.idTipoEspecialidad,s=e.orden;"eb58bf60-fc83-11ec-a1d1-1dc2835404e5"==o.$store.state.idInstitucion&&90==s||"097b7b10-fcaa-11ec-8267-536b07c743c4"==o.$store.state.idInstitucion&&98==s||"number"===typeof n&&(1===r?("bajo"===t&&n<o.datosSeccion.minBas||"basico"===t&&n>=o.datosSeccion.minBas&&n<o.datosSeccion.minAlt||"alto"===t&&n>=o.datosSeccion.minAlt&&n<o.datosSeccion.minSup||"superior"===t&&n>=o.datosSeccion.minSup&&n<=o.datosSeccion.maxSup)&&a++:("bajo"===t&&n<o.datosSeccion.minBasT||"basico"===t&&n>=o.datosSeccion.minBasT&&n<o.datosSeccion.minAltT||"alto"===t&&n>=o.datosSeccion.minAltT&&n<o.datosSeccion.minSupT||"superior"===t&&n>=o.datosSeccion.minSupT&&n<=o.datosSeccion.maxSupT)&&a++)}))})),a},fueRecuperada:function(e,t,o){var a,n,r;return null!==(a=null===e||void 0===e||null===(n=e[t])||void 0===n||null===(r=n[o])||void 0===r?void 0:r.fueRecuperada)&&void 0!==a&&a},obtenerOriginal:function(e,t,o){var a,n,r=null===e||void 0===e||null===(a=e[t])||void 0===a||null===(n=a[o])||void 0===n?void 0:n.original;return"number"===typeof r?r.toFixed(1):"0.0"},obtenerRecuperacion:function(e,t,o){var a,n,r=null===e||void 0===e||null===(a=e[t])||void 0===a||null===(n=a[o])||void 0===n?void 0:n.recuperacion;return"number"===typeof r?r.toFixed(1):"0.0"},obtenerColor:function(e,t,o,a){var n,r,s=null===t||void 0===t||null===(n=t[o])||void 0===n||null===(r=n[a])||void 0===r?void 0:r.idTipoEspecialidad;return 1===s?e<this.datosSeccion.minBas?"desempeno-bajo":e<this.datosSeccion.minAlt?"desempeno-basico":e<this.datosSeccion.minSup?"desempeno-alto":e<=this.datosSeccion.maxSup?"desempeno-superior":"desempeno-extra":e<this.datosSeccion.minBasT?"desempeno-bajo":e<this.datosSeccion.minAltT?"desempeno-basico":e<this.datosSeccion.minSupT?"desempeno-alto":e<=this.datosSeccion.maxSupT?"desempeno-superior":"desempeno-extra"},claseDesempeno:function(e){return"number"!==typeof e?"desempeno-extra":e<3?"desempeno-bajo":e<4?"desempeno-basico":e<4.6?"desempeno-alto":e<=5?"desempeno-superior":"desempeno-extra"},obtenerColorGeneral:function(e){return e<this.datosSeccion.minBas?"desempeno-bajo":e<this.datosSeccion.minAlt?"desempeno-basico":e<this.datosSeccion.minSup?"desempeno-alto":e<=this.datosSeccion.maxSup?"desempeno-superior":"desempeno-extra"},mostrarHabilitacion:function(e,t){var o=this.listaHabilitaciones.find((function(o){return o.id_matricula===e&&o.id_asignatura_curso===t}));if(void 0!==o){var a=o.habilitacion>0?o.habilitacion.toFixed(1):"",n=null!==o.fecha&&""!==o.fecha?o.fecha.substr(0,10):"",r=null!=o.acta?o.acta:"";return{habilitacion:a,acta:r,fecha:n}}return{habilitacion:"",acta:"",fecha:""}},consultarHabilitaciones:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.listaHabilitaciones=[],t.next=3,s.a.get(i["d"]+"boletines/habilitaciones/curso",{params:{vigencia:e.$store.state.aLectivo}}).then((function(t){t.data.error?(e.mensajeEmergente("danger",i["h"],t.data.mensaje+" - Consulta habilitacion"),e.btnCargando=!1):0!=t.data.datos&&(e.listaHabilitaciones=t.data.datos)})).catch((function(t){e.mensajeEmergente("danger",i["h"],"Algo salio mal y no se pudo realizar: Consulta habilitacion. Intente m√°s tarde."+t)}));case 3:case"end":return t.stop()}}),t)})))()},consultarEstudiantes:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.btnCargando=!0,1==e.idPeriodo&&(e.periodosVisibles=[1]),2==e.idPeriodo&&(e.periodosVisibles=[1,2]),3==e.idPeriodo&&(e.periodosVisibles=[1,2,3]),4==e.idPeriodo&&(e.periodosVisibles=[1,2,3,4]),e.nombreSede=document.getElementById("sedes")[document.getElementById("sedes").selectedIndex].text,null==e.idCurso){t.next=15;break}return e.nombreCurso=document.getElementById("cursos")[document.getElementById("cursos").selectedIndex].text,e.$store.state.datosCursos.forEach((function(t){t.id==e.idCurso&&(e.idNivel=t.id_nivel)})),e.listaAreasAsignaturas=[],t.next=12,s.a.get(i["d"]+"consolidados/areasasignaturas/curso",{params:{idCurso:e.idCurso}}).then((function(t){t.data.error?(e.mensajeEmergente("danger",i["h"],t.data.mensaje+" - Lista areas-asignaturas curso"),e.btnCargando=!1):0!=t.data.datos&&t.data.datos.forEach((function(t){"eb58bf60-fc83-11ec-a1d1-1dc2835404e5"==e.$store.state.idInstitucion?99!=t.orden&&90!=t.orden&&e.listaAreasAsignaturas.push(t):"f5529ba0-fcb3-11ec-8267-536b07c743c4"==e.$store.state.idInstitucion?99!=t.orden&&15!=t.orden&&16!=t.orden&&98!=t.orden&&e.listaAreasAsignaturas.push(t):"097b7b10-fcaa-11ec-8267-536b07c743c4"==e.$store.state.idInstitucion?99!=t.orden&&98!=t.orden&&e.listaAreasAsignaturas.push(t):("54fd7440-fc81-11ec-a1d1-1dc2835404e5"==e.$store.state.idInstitucion||"7c63ed50-fcb0-11ec-8267-536b07c743c4"==e.$store.state.idInstitucion||99!=t.orden)&&e.listaAreasAsignaturas.push(t)}))})).catch((function(t){e.mensajeEmergente("danger",i["h"],"Algo salio mal y no se pudo realizar: Lista areas-asignaturas curso. Intente m√°s tarde."+t),e.btnCargando=!1}));case 12:return e.datosRaw=[],t.next=15,s.a.get(i["d"]+"consolidados/asignaturas/curso/acumulado",{params:{idCurso:e.idCurso,periodo:e.idPeriodo,vigencia:e.$store.state.aLectivo}}).then((function(t){t.data.error?(e.mensajeEmergente("danger",i["h"],t.data.mensaje+" - Consolidados asignaturas curso periodo"),e.btnCargando=!1):0!=t.data.datos&&(e.datosRaw=t.data.datos)})).catch((function(t){e.mensajeEmergente("danger",i["h"],"Algo salio mal y no se pudo realizar: Consolidados asignaturas curso periodo. Intente m√°s tarde."+t),e.btnCargando=!1}));case 15:e.btnCargando=!1;case 16:case"end":return t.stop()}}),t)})))()},imprimir:function(){var e="Fecha: "+(new Date).toLocaleString(),t="ESTADOS FINALES DE PROMOCI√ìN ESCOLAR",o=document.querySelector("table").outerHTML,a=window.open("Consolidados","_blank");a.document.write('<html><head><title>Imprimir</title></head>\n        <style scoped>\n          table {\n            border-collapse: collapse;\n            width: 100%;\n            text-align: center;\n            font-size: 10px;\n          }\n          th {\n            background: #eee;\n          }\n          .nota-recuperada {\n            border: 2px solid #ffa500;\n            box-shadow: 0 0 5px #ffa500;\n          }\n          .desempeno-bajo { background-color: #f8d7da; color: #721c24; }\n          .desempeno-basico { background-color: #d1ecf1; color: #0c5460; }\n          .desempeno-alto { background-color: #fff3cd; color: #856404; }\n          .desempeno-superior { background-color: #d4edda; color: #155724; }\n          .desempeno-extra { background-color: #f4ecf5; color: #2f2e2e; }\n        </style>\n          <body class="container">\n            <p style="text-align: center; font-size: 12px;">SECRETAR√çA DE EDUCACI√ìN TERRITORIAL DE TUNJA<br><b>'.concat(this.$store.state.nombreInstitucion,"</b><br>TUNJA - BOYAC√Å<br>").concat(t,"<br>Sede: ").concat(this.nombreSede," | Curso: ").concat(this.nombreCurso," | A√±o Lectivo ").concat(this.$store.state.aLectivo," | Periodo: FINAL</p>\n            ").concat(o,'\n            <div style="text-align: right; font-size: 12px;"><i>').concat(e,"</i></div>\n          </body>\n        </html>")),a.document.close(),a.print()},exportarAExcel:function(){var e=document.querySelector("table"),t=p["utils"].table_to_book(e);p["writeFile"](t,"ConsoldidaFinal.xlsx")},redondear:function(e){var t=Number((10*Math.abs(e)).toPrecision(15));return Math.round(t)/10*Math.sign(e)},ocuparComboCursosSede:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.comboCursosSede=[],e.$store.state.datosCursos.forEach((function(t){t.id_sede==e.idSede&&e.comboCursosSede.push({value:t.id,text:t.nomenclatura.toUpperCase()})}));case 2:case"end":return t.stop()}}),t)})))()},ocuparComboSedes:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.comboSedes=[],e.$store.state.datosSedes.forEach((function(t){e.comboSedes.push({value:t.id,text:t.sede.toUpperCase()})}));case 2:case"end":return t.stop()}}),t)})))()},ocuparComboPeriodos:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.comboPeriodos=[],e.$store.state.periodos.forEach((function(t){e.comboPeriodos.push({value:t.id,text:t.periodo.toUpperCase()})}));case 2:case"end":return t.stop()}}),t)})))()},mensajeEmergente:function(e,t,o){this.$bvToast.toast(o,{title:t,variant:e,toaster:"b-toaster-top-center",solid:!0,autoHideDelay:4e3,appendToast:!1})}},computed:{totales:function(){return this.totalesGlobales()},estudiantesNotas:function(){var e=this,t={};return this.datosRaw.forEach((function(o){var a=o.obs_comision,n=o.id_matricula,r=o.idAsignaturaCurso,s=o.estudiante,i=o.area,c=o.asignatura,d=o.ih,u=o.periodo,l=o.definitiva,m=o.recuperacion,p=o.orden,b=o.definitivacompor,f=o.definitivapree,v=o.idTipoEspecialidad,h=o.ausJ,S=o.ausS,g=o.porcentaje,C=o.id_conceptual;t[s]||(t[s]={idMatricula:n,obs_comision:a,id_conceptual:C,ausJ:0,ausS:0,areas:{}}),t[s].areas[i]||(t[s].areas[i]={asignaturas:{}}),t[s].areas[i].asignaturas[c]||(t[s].areas[i].asignaturas[c]={idMatricula:n,idAsignaturaCurso:r,ih:d,periodos:{},orden:p,idTipoEspecialidad:v,porcentaje:g,pesos:{1:e.datosSeccion.pesoP1,2:e.datosSeccion.pesoP2,3:e.datosSeccion.pesoP3,4:e.datosSeccion.pesoP4}});var A=0;A=99===p?1==e.datosSeccion.tipoValComp?l:null!=b?b:"":1==e.idNivel?null!=f&&0!=f&&""!=f?f:"":m>l?m:l,t[s].areas[i].asignaturas[c].periodos[u]=A,t[s].ausJ+=h||0,t[s].ausS+=S||0})),t},totalColumnasPromedioArea:function(){var e=new Set(this.listaAreasAsignaturas.map((function(e){return e.area})));return e.size},puestosPorEstudiante:function(){var e=this,t=Object.entries(this.estudiantesNotas).map((function(t){var o=Object(u["a"])(t,2),a=o[0],n=o[1],r=parseFloat(e.calcularPromedioGeneral(n));return{nombre:a,promedio:isNaN(r)?0:r}}));t.sort((function(e,t){return t.promedio-e.promedio}));var o={},a=1,n=1,r=null;return t.forEach((function(e){e.promedio!==r&&(a=n,r=e.promedio,n++),o[e.nombre]=a})),o},encabezadoPorArea:function(){var e={};return this.listaAreasAsignaturas.forEach((function(t){var o=t.area,a=t.asignatura;e[o]||(e[o]=[]),e[o].push(a)})),e}},beforeMount:function(){this.ocuparComboSedes(),this.ocuparComboPeriodos(),this.consultarHabilitaciones(),this.datosSeccion=this.$store.state.datosSecciones[this.$store.state.idSeccion-1]}},lt=ut,mt=(o("da31"),Object(v["a"])(lt,ct,dt,!1,null,"a4b7125e",null)),pt=mt.exports,bt={name:"consolidados",components:{ResumenPeriodo:S,ConsolidadoPromedio:E,ConsolidadoPonderado:U,NotasFaltantes:N,NotasFaltantesArea:F,AusenciasPeriodo:Y,AusenciasPeriodos:ee,ResumenFinal:ie,ResumenFinalHab:pe,ResumenPromocionAreas:ye,AsignaturasPerdidas:ke,AreasPerdidas:Ae,ConsolidadoFinal:De,ConsolidadoFinalEmiliani:Me,ConsolidadoFinalInem:Ke,ResumenFinalAsigPerdidas:tt,ConsolidadoFinalAreas:it,ResumenPromocionAreasDefinitivo:pt},data:function(){return{idConsolidado:null}},methods:{mensajeEmergente:function(e,t,o){this.$bvToast.toast(o,{title:t,variant:e,toaster:"b-toaster-top-center",solid:!0,autoHideDelay:4e3,appendToast:!1})}},beforeMount:function(){}},ft=bt,vt=Object(v["a"])(ft,a,n,!1,null,null,null);t["default"]=vt.exports},2460:function(e,t,o){"use strict";o("ef37")},2909:function(e,t,o){"use strict";o.d(t,"a",(function(){return c}));var a=o("6b75");function n(e){if(Array.isArray(e))return Object(a["a"])(e)}o("a4d3"),o("e01a"),o("d3b7"),o("d28b"),o("3ca3"),o("ddb0"),o("a630");function r(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}var s=o("06c5");function i(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function c(e){return n(e)||r(e)||Object(s["a"])(e)||i()}},"30c3":function(e,t,o){"use strict";o("ee1d")},4529:function(e,t,o){"use strict";o("6cb5")},"475c":function(e,t,o){},"57d2":function(e,t,o){"use strict";o("6bca")},"6bca":function(e,t,o){},"6c0e":function(e,t,o){"use strict";o("0119")},"6cb5":function(e,t,o){},"6d63":function(e,t,o){"use strict";o("83a1")},"6efb":function(e,t,o){},"75dc":function(e,t,o){},"783a":function(e,t,o){},"7dca":function(e,t,o){},"802b":function(e,t,o){"use strict";o("b315")},8103:function(e,t,o){},8344:function(e,t,o){"use strict";o("aaf6")},"83a1":function(e,t,o){},"96cf":function(e,t,o){var a=function(e){"use strict";var t,o=Object.prototype,a=o.hasOwnProperty,n="function"===typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",s=n.asyncIterator||"@@asyncIterator",i=n.toStringTag||"@@toStringTag";function c(e,t,o){return Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(O){c=function(e,t,o){return e[t]=o}}function d(e,t,o,a){var n=t&&t.prototype instanceof v?t:v,r=Object.create(n.prototype),s=new j(a||[]);return r._invoke=y(e,o,s),r}function u(e,t,o){try{return{type:"normal",arg:e.call(t,o)}}catch(O){return{type:"throw",arg:O}}}e.wrap=d;var l="suspendedStart",m="suspendedYield",p="executing",b="completed",f={};function v(){}function h(){}function S(){}var g={};g[r]=function(){return this};var C=Object.getPrototypeOf,A=C&&C(C(N([])));A&&A!==o&&a.call(A,r)&&(g=A);var _=S.prototype=v.prototype=Object.create(g);function x(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function E(e,t){function o(n,r,s,i){var c=u(e[n],e,r);if("throw"!==c.type){var d=c.arg,l=d.value;return l&&"object"===typeof l&&a.call(l,"__await")?t.resolve(l.__await).then((function(e){o("next",e,s,i)}),(function(e){o("throw",e,s,i)})):t.resolve(l).then((function(e){d.value=e,s(d)}),(function(e){return o("throw",e,s,i)}))}i(c.arg)}var n;function r(e,a){function r(){return new t((function(t,n){o(e,a,t,n)}))}return n=n?n.then(r,r):r()}this._invoke=r}function y(e,t,o){var a=l;return function(n,r){if(a===p)throw new Error("Generator is already running");if(a===b){if("throw"===n)throw r;return k()}o.method=n,o.arg=r;while(1){var s=o.delegate;if(s){var i=P(s,o);if(i){if(i===f)continue;return i}}if("next"===o.method)o.sent=o._sent=o.arg;else if("throw"===o.method){if(a===l)throw a=b,o.arg;o.dispatchException(o.arg)}else"return"===o.method&&o.abrupt("return",o.arg);a=p;var c=u(e,t,o);if("normal"===c.type){if(a=o.done?b:m,c.arg===f)continue;return{value:c.arg,done:o.done}}"throw"===c.type&&(a=b,o.method="throw",o.arg=c.arg)}}}function P(e,o){var a=e.iterator[o.method];if(a===t){if(o.delegate=null,"throw"===o.method){if(e.iterator["return"]&&(o.method="return",o.arg=t,P(e,o),"throw"===o.method))return f;o.method="throw",o.arg=new TypeError("The iterator does not provide a 'throw' method")}return f}var n=u(a,e.iterator,o.arg);if("throw"===n.type)return o.method="throw",o.arg=n.arg,o.delegate=null,f;var r=n.arg;return r?r.done?(o[e.resultName]=r.value,o.next=e.nextLoc,"return"!==o.method&&(o.method="next",o.arg=t),o.delegate=null,f):r:(o.method="throw",o.arg=new TypeError("iterator result is not an object"),o.delegate=null,f)}function w(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function j(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(w,this),this.reset(!0)}function N(e){if(e){var o=e[r];if(o)return o.call(e);if("function"===typeof e.next)return e;if(!isNaN(e.length)){var n=-1,s=function o(){while(++n<e.length)if(a.call(e,n))return o.value=e[n],o.done=!1,o;return o.value=t,o.done=!0,o};return s.next=s}}return{next:k}}function k(){return{value:t,done:!0}}return h.prototype=_.constructor=S,S.constructor=h,h.displayName=c(S,i,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"===typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,S):(e.__proto__=S,c(e,i,"GeneratorFunction")),e.prototype=Object.create(_),e},e.awrap=function(e){return{__await:e}},x(E.prototype),E.prototype[s]=function(){return this},e.AsyncIterator=E,e.async=function(t,o,a,n,r){void 0===r&&(r=Promise);var s=new E(d(t,o,a,n),r);return e.isGeneratorFunction(o)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},x(_),c(_,i,"Generator"),_[r]=function(){return this},_.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var o in e)t.push(o);return t.reverse(),function o(){while(t.length){var a=t.pop();if(a in e)return o.value=a,o.done=!1,o}return o.done=!0,o}},e.values=N,j.prototype={constructor:j,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var o in this)"t"===o.charAt(0)&&a.call(this,o)&&!isNaN(+o.slice(1))&&(this[o]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0],t=e.completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var o=this;function n(a,n){return i.type="throw",i.arg=e,o.next=a,n&&(o.method="next",o.arg=t),!!n}for(var r=this.tryEntries.length-1;r>=0;--r){var s=this.tryEntries[r],i=s.completion;if("root"===s.tryLoc)return n("end");if(s.tryLoc<=this.prev){var c=a.call(s,"catchLoc"),d=a.call(s,"finallyLoc");if(c&&d){if(this.prev<s.catchLoc)return n(s.catchLoc,!0);if(this.prev<s.finallyLoc)return n(s.finallyLoc)}else if(c){if(this.prev<s.catchLoc)return n(s.catchLoc,!0)}else{if(!d)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return n(s.finallyLoc)}}}},abrupt:function(e,t){for(var o=this.tryEntries.length-1;o>=0;--o){var n=this.tryEntries[o];if(n.tryLoc<=this.prev&&a.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var r=n;break}}r&&("break"===e||"continue"===e)&&r.tryLoc<=t&&t<=r.finallyLoc&&(r=null);var s=r?r.completion:{};return s.type=e,s.arg=t,r?(this.method="next",this.next=r.finallyLoc,f):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),f},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var o=this.tryEntries[t];if(o.finallyLoc===e)return this.complete(o.completion,o.afterLoc),T(o),f}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var o=this.tryEntries[t];if(o.tryLoc===e){var a=o.completion;if("throw"===a.type){var n=a.arg;T(o)}return n}}throw new Error("illegal catch attempt")},delegateYield:function(e,o,a){return this.delegate={iterator:N(e),resultName:o,nextLoc:a},"next"===this.method&&(this.arg=t),f}},e}(e.exports);try{regeneratorRuntime=a}catch(n){Function("r","regeneratorRuntime = r")(a)}},"9d0c":function(e,t,o){"use strict";o("7dca")},a4bd:function(e,t,o){"use strict";o("6efb")},a5ab:function(e,t,o){"use strict";o("d896")},a7f8:function(e,t,o){"use strict";o("049f")},aaf6:function(e,t,o){},b16c:function(e,t,o){"use strict";o("8103")},b315:function(e,t,o){},b45a:function(e,t,o){"use strict";o("475c")},d896:function(e,t,o){},da31:function(e,t,o){"use strict";o("75dc")},ee1d:function(e,t,o){},ef37:function(e,t,o){}}]);
//# sourceMappingURL=chunk-6aa8cf37.636a8c67.js.map